<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD> <TITLE>cURL - Security Advisory (cookie domain tailmatch)</TITLE>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<link rel="stylesheet" type="text/css" href="http://curl.haxx.se/curl.css">
<link rel="shortcut icon" href="http://curl.haxx.se/favicon.ico">
<link rel="STYLESHEET" type="text/css" href="http://curl.haxx.se/manpage.css">
</HEAD>
<body bgcolor="#ffffff" text="#000000">
<div class="main">
<div class="menu">
<a href="index.html" class="menuitem" title="Documentation main page">Docs Overview</a>
</div>
<div class="contents">
<div class="where"><a href="http://curl.haxx.se/">cURL</a> / <a href="index.html">Docs</a> / <a href="security.html">Security</a> / <b>libcurl cookie domain tailmatch</b></div>
<h1> libcurl cookie domain tailmatch </h1>
<div class="relatedbox">
<b>Related:</b>
<br><a href="http://curl.haxx.se/changes.html">Changelog</a>
<br><a href="faq.html">FAQ</a>
<br><a href="http://curl.haxx.se/dev/security.html">Security dev process</a>
<br><a href="vulnerabilities.html">Vulnerabilities Table</a>
</div>
<pre>
                       libcurl cookie domain tailmatch
                       ===============================
&nbsp;
Project cURL Security Advisory, April 12th 2013
http://curl.haxx.se/docs/security.html
&nbsp;
1. VULNERABILITY
&nbsp;
  libcurl is vulnerable to a cookie leak vulnerability when doing requests
  across domains with matching tails.
&nbsp;
  When communicating over HTTP(S) and having libcurl's cookie engine enabled,
  libcurl will store and hold cookies for use when subsequent requests are
  done to hosts and paths that match those kept cookies. Due to a bug in the
  tailmatching function, libcurl could wrongly send cookies meant for the
  domain 'ample.com' when communicating with 'example.com'.
&nbsp;
  This vulnerability can be used to hijack sessions in targetted attacks since
  registering domains using a known domain's name as an ending is trivial.
&nbsp;
  Both curl the command line tool and applications using the libcurl library
  are vulnerable.
&nbsp;
  There are no known exploits available at this time.
&nbsp;
  The Common Vulnerabilities and Exposures (CVE) project has assigned the name
  CVE-2013-1944 to this issue.
&nbsp;
2. AFFECTED VERSIONS
&nbsp;
  Affected versions: all versions to and including 7.29.0
  Not affected versions: curl &gt;= 7.30.0
&nbsp;
  libcurl is used by many applications, but not always advertised as such!
&nbsp;
3. THE SOLUTION
&nbsp;
  libcurl 7.30.0 implements the function properly and will not send cookies to
  sites just because the host names use the same tail.
&nbsp;
4. RECOMMENDATIONS
&nbsp;
  We suggest you take one of the following actions immediately, in order of
  preference:
&nbsp;
  A - Upgrade to curl and libcurl 7.30.0
&nbsp;
  B - Apply this patch and rebuild libcurl
&nbsp;
      http://curl.haxx.se/curl-tailmatch.patch
&nbsp;
  C - Disable use of cookies or HTTP entirely in your application
&nbsp;
5. TIME LINE
&nbsp;
  Vulnerability found and patched by YAMADA Yasuharu.
&nbsp;
  It was reported (publicly) to the curl project on April 9th 2013.
&nbsp;
  curl 7.30.0 was released on April 12th 2013, coordinated with the
  publication of this advisory.
&nbsp;
6. CREDITS
&nbsp;
  Reported and fixed by YAMADA Yasuharu. Thanks a lot!
</pre>
</div>
</div>
</body> </html>
