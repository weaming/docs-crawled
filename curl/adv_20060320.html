<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD> <TITLE>cURL - Security Advisory (March 20, 2006)</TITLE>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<link rel="stylesheet" type="text/css" href="http://curl.haxx.se/curl.css">
<link rel="shortcut icon" href="http://curl.haxx.se/favicon.ico">
<link rel="STYLESHEET" type="text/css" href="http://curl.haxx.se/manpage.css">
</HEAD>
<body bgcolor="#ffffff" text="#000000">
<div class="main">
<div class="menu">
<a href="index.html" class="menuitem" title="Documentation main page">Docs Overview</a>
</div>
<div class="contents">
<div class="where"><a href="http://curl.haxx.se/">cURL</a> / <a href="index.html">Docs</a> / <a href="security.html">Security</a> / <b>Advisory</b></div>
<h1> Security Advisory March 20 2006 </h1>
<div class="relatedbox">
<b>Related:</b>
<br><a href="http://curl.haxx.se/changes.html">Changelog</a>
<br><a href="faq.html">FAQ</a>
<br><a href="http://curl.haxx.se/dev/security.html">Security dev process</a>
<br><a href="vulnerabilities.html">Vulnerabilities Table</a>
</div>
<pre>
              libcurl TFTP Packet Buffer Overflow Vulnerability
              =================================================
&nbsp;
Project cURL Security Advisory, March 20th 2006
http://curl.haxx.se/docs/security.html
&nbsp;
1. VULNERABILITY
&nbsp;
libcurl uses the given file part of a TFTP URL in a manner that allows a
malicious user to overflow a heap-based memory buffer due to the lack of
boundary check.
&nbsp;
This overflow happens if you pass in a URL with a TFTP protocol prefix
("tftp://"), using a valid host and a path part that is longer than 512 bytes.
&nbsp;
The affected flaw can be triggered by a redirect, if curl/libcurl is told to
follow redirects and an HTTP server points the client to a tftp URL with the
characteristics described above.
&nbsp;
There is no known exploit at the time of this writing.
&nbsp;
The Common Vulnerabilities and Exposures (CVE) project has assigned the name
CVE-2006-1061 to this issue.
&nbsp;
2. AFFECTED VERSIONS
&nbsp;
Affected versions: curl and libcurl 7.15.0 to and including 7.15.2
Not affected versions: curl and libcurl 7.14.1 and earlier, 7.15.3 and later
&nbsp;
libcurl 7.15.1 and 7.15.2 contain code that prevents this code from being
executed on architecures where a struct is not of the same assumed packed size
it has on x86, thus they are not vulnerable. For exact details on this, please
review the code and patch.
&nbsp;
Also note that (lib)curl is used by many applications, and not always
advertised as such.
&nbsp;
3. RECOMMENDATIONS
&nbsp;
We suggest you take one of the following actions immediately:
&nbsp;
 I - Upgrade to curl and libcurl 7.15.3
&nbsp;
 II - Apply the patch http://curl.haxx.se/libcurl-tftp.patch to your
      libcurl version and install this
&nbsp;
 III - Build curl with TFTP disabled with configure --disable-tftp
&nbsp;
4. TIME LINE
&nbsp;
We were notified by Ulf Harnhammar on March 10th, 2006. His notification email
contained a valid patch.
&nbsp;
Daniel didn't read the mail until the 12th due to vacations.
&nbsp;
curl 7.15.3 was released on March 20 2006, just before this flaw was
publicly disclosed.
&nbsp;
5. CREDITS
&nbsp;
Reported to us by Ulf Harnhammar. Thanks a lot!
</pre>
</div>
</div>
</body> </html>
