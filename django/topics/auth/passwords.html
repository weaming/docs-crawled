<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Password management in Django &mdash; Django 1.9.1.dev20151230225111 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.9.1.dev20151230225111',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Django 1.9.1.dev20151230225111 documentation" href="../../index.html" />
    <link rel="up" title="User authentication in Django" href="index.html" />
    <link rel="next" title="Customizing authentication in Django" href="customizing.html" />
    <link rel="prev" title="Using the Django authentication system" href="default.html" />



 
<script type="text/javascript" src="../../templatebuiltins.js"></script>
<script type="text/javascript">
(function($) {
    if (!django_template_builtins) {
       // templatebuiltins.js missing, do nothing.
       return;
    }
    $(document).ready(function() {
        // Hyperlink Django template tags and filters
        var base = "../../ref/templates/builtins.html";
        if (base == "#") {
            // Special case for builtins.html itself
            base = "";
        }
        // Tags are keywords, class '.k'
        $("div.highlight\\-html\\+django span.k").each(function(i, elem) {
             var tagname = $(elem).text();
             if ($.inArray(tagname, django_template_builtins.ttags) != -1) {
                 var fragment = tagname.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + tagname + "</a>");
             }
        });
        // Filters are functions, class '.nf'
        $("div.highlight\\-html\\+django span.nf").each(function(i, elem) {
             var filtername = $(elem).text();
             if ($.inArray(filtername, django_template_builtins.tfilters) != -1) {
                 var fragment = filtername.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + filtername + "</a>");
             }
        });
    });
})(jQuery);
</script>


  </head>
  <body>

    <div class="document">
  <div id="custom-doc" class="yui-t6">
    <div id="hd">
      <h1><a href="../../index.html">Django 1.9.1.dev20151230225111 documentation</a></h1>
      <div id="global-nav">
        <a title="Home page" href="../../index.html">Home</a>  |
        <a title="Table of contents" href="../../contents.html">Table of contents</a>  |
        <a title="Global index" href="../../genindex.html">Index</a>  |
        <a title="Module index" href="../../py-modindex.html">Modules</a>
      </div>
      <div class="nav">
    &laquo; <a href="default.html" title="Using the Django authentication system">previous</a>
     |
    <a href="../index.html" title="Using Django" accesskey="U">up</a>
   |
    <a href="customizing.html" title="Customizing authentication in Django">next</a> &raquo;</div>
    </div>

    <div id="bd">
      <div id="yui-main">
        <div class="yui-b">
          <div class="yui-g" id="topics-auth-passwords">
            
  <div class="section" id="s-password-management-in-django">
<span id="password-management-in-django"></span><h1>Password management in Django<a class="headerlink" href="#password-management-in-django" title="Permalink to this headline">¶</a></h1>
<p>Password management is something that should generally not be reinvented
unnecessarily, and Django endeavors to provide a secure and flexible set of
tools for managing user passwords. This document describes how Django stores
passwords, how the storage hashing can be configured, and some utilities to
work with hashed passwords.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Even though users may use strong passwords, attackers might be able to
eavesdrop on their connections. Use <a class="reference internal" href="../security.html#security-recommendation-ssl"><em>HTTPS</em></a> to avoid sending passwords (or any other
sensitive data) over plain HTTP connections because they will be vulnerable
to password sniffing.</p>
</div>
<div class="section" id="s-how-django-stores-passwords">
<span id="s-auth-password-storage"></span><span id="how-django-stores-passwords"></span><span id="auth-password-storage"></span><h2>How Django stores passwords<a class="headerlink" href="#how-django-stores-passwords" title="Permalink to this headline">¶</a></h2>
<p>Django provides a flexible password storage system and uses PBKDF2 by default.</p>
<p>The <a class="reference internal" href="../../ref/contrib/auth.html#django.contrib.auth.models.User.password" title="django.contrib.auth.models.User.password"><tt class="xref py py-attr docutils literal"><span class="pre">password</span></tt></a> attribute of a
<a class="reference internal" href="../../ref/contrib/auth.html#django.contrib.auth.models.User" title="django.contrib.auth.models.User"><tt class="xref py py-class docutils literal"><span class="pre">User</span></tt></a> object is a string in this format:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;algorithm&gt;$&lt;iterations&gt;$&lt;salt&gt;$&lt;hash&gt;
</pre></div>
</div>
<p>Those are the components used for storing a User&#8217;s password, separated by the
dollar-sign character and consist of: the hashing algorithm, the number of
algorithm iterations (work factor), the random salt, and the resulting password
hash.  The algorithm is one of a number of one-way hashing or password storage
algorithms Django can use; see below. Iterations describe the number of times
the algorithm is run over the hash. Salt is the random seed used and the hash
is the result of the one-way function.</p>
<p>By default, Django uses the <a class="reference external" href="https://en.wikipedia.org/wiki/PBKDF2">PBKDF2</a> algorithm with a SHA256 hash, a
password stretching mechanism recommended by <a class="reference external" href="http://csrc.nist.gov/publications/nistpubs/800-132/nist-sp800-132.pdf">NIST</a>. This should be
sufficient for most users: it&#8217;s quite secure, requiring massive
amounts of computing time to break.</p>
<p>However, depending on your requirements, you may choose a different
algorithm, or even use a custom algorithm to match your specific
security situation. Again, most users shouldn&#8217;t need to do this &#8211; if
you&#8217;re not sure, you probably don&#8217;t.  If you do, please read on:</p>
<p>Django chooses the algorithm to use by consulting the
<a class="reference internal" href="../../ref/settings.html#std:setting-PASSWORD_HASHERS"><tt class="xref std std-setting docutils literal"><span class="pre">PASSWORD_HASHERS</span></tt></a> setting. This is a list of hashing algorithm
classes that this Django installation supports. The first entry in this list
(that is, <tt class="docutils literal"><span class="pre">settings.PASSWORD_HASHERS[0]</span></tt>) will be used to store passwords,
and all the other entries are valid hashers that can be used to check existing
passwords.  This means that if you want to use a different algorithm, you&#8217;ll
need to modify <a class="reference internal" href="../../ref/settings.html#std:setting-PASSWORD_HASHERS"><tt class="xref std std-setting docutils literal"><span class="pre">PASSWORD_HASHERS</span></tt></a> to list your preferred algorithm
first in the list.</p>
<p>The default for <a class="reference internal" href="../../ref/settings.html#std:setting-PASSWORD_HASHERS"><tt class="xref std std-setting docutils literal"><span class="pre">PASSWORD_HASHERS</span></tt></a> is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">PASSWORD_HASHERS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">&#39;django.contrib.auth.hashers.PBKDF2PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.PBKDF2SHA1PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.BCryptSHA256PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.BCryptPasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.SHA1PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.MD5PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.CryptPasswordHasher&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
<p>This means that Django will use <a class="reference external" href="https://en.wikipedia.org/wiki/PBKDF2">PBKDF2</a> to store all passwords, but will support
checking passwords stored with PBKDF2SHA1, <a class="reference external" href="https://en.wikipedia.org/wiki/Bcrypt">bcrypt</a>, <a class="reference external" href="https://en.wikipedia.org/wiki/SHA1">SHA1</a>, etc. The next few
sections describe a couple of common ways advanced users may want to modify this
setting.</p>
<div class="section" id="s-using-bcrypt-with-django">
<span id="s-bcrypt-usage"></span><span id="using-bcrypt-with-django"></span><span id="bcrypt-usage"></span><h3>Using bcrypt with Django<a class="headerlink" href="#using-bcrypt-with-django" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Bcrypt">Bcrypt</a> is a popular password storage algorithm that&#8217;s specifically designed
for long-term password storage. It&#8217;s not the default used by Django since it
requires the use of third-party libraries, but since many people may want to
use it Django supports bcrypt with minimal effort.</p>
<p>To use Bcrypt as your default storage algorithm, do the following:</p>
<ol class="arabic">
<li><p class="first">Install the <a class="reference external" href="https://pypi.python.org/pypi/bcrypt/">bcrypt library</a>. This can be done by running <tt class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span>
<span class="pre">django[bcrypt]</span></tt>, or by downloading the library and installing it with
<tt class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">install</span></tt>.</p>
</li>
<li><p class="first">Modify <a class="reference internal" href="../../ref/settings.html#std:setting-PASSWORD_HASHERS"><tt class="xref std std-setting docutils literal"><span class="pre">PASSWORD_HASHERS</span></tt></a> to list <tt class="docutils literal"><span class="pre">BCryptSHA256PasswordHasher</span></tt>
first. That is, in your settings file, you&#8217;d put:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">PASSWORD_HASHERS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">&#39;django.contrib.auth.hashers.BCryptSHA256PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.BCryptPasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.PBKDF2PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.PBKDF2SHA1PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.SHA1PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.MD5PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.CryptPasswordHasher&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
<p>(You need to keep the other entries in this list, or else Django won&#8217;t
be able to upgrade passwords; see below).</p>
</li>
</ol>
<p>That&#8217;s it &#8211; now your Django install will use Bcrypt as the default storage
algorithm.</p>
<div class="admonition-password-truncation-with-bcryptpasswordhasher admonition">
<p class="first admonition-title">Password truncation with BCryptPasswordHasher</p>
<p class="last">The designers of bcrypt truncate all passwords at 72 characters which means
that <tt class="docutils literal"><span class="pre">bcrypt(password_with_100_chars)</span> <span class="pre">==</span> <span class="pre">bcrypt(password_with_100_chars[:72])</span></tt>.
The original <tt class="docutils literal"><span class="pre">BCryptPasswordHasher</span></tt> does not have any special handling and
thus is also subject to this hidden password length limit.
<tt class="docutils literal"><span class="pre">BCryptSHA256PasswordHasher</span></tt> fixes this by first first hashing the
password using sha256. This prevents the password truncation and so should
be preferred over the <tt class="docutils literal"><span class="pre">BCryptPasswordHasher</span></tt>. The practical ramification
of this truncation is pretty marginal as the average user does not have a
password greater than 72 characters in length and even being truncated at 72
the compute powered required to brute force bcrypt in any useful amount of
time is still astronomical. Nonetheless, we recommend you use
<tt class="docutils literal"><span class="pre">BCryptSHA256PasswordHasher</span></tt> anyway on the principle of &#8220;better safe than
sorry&#8221;.</p>
</div>
<div class="admonition-other-bcrypt-implementations admonition">
<p class="first admonition-title">Other bcrypt implementations</p>
<p class="last">There are several other implementations that allow bcrypt to be
used with Django. Django&#8217;s bcrypt support is NOT directly
compatible with these. To upgrade, you will need to modify the
hashes in your database to be in the form <tt class="docutils literal"><span class="pre">bcrypt$(raw</span> <span class="pre">bcrypt</span>
<span class="pre">output)</span></tt>. For example:
<tt class="docutils literal"><span class="pre">bcrypt$$2a$12$NT0I31Sa7ihGEWpka9ASYrEFkhuTNeBQ2xfZskIiiJeyFXhRgS.Sy</span></tt>.</p>
</div>
</div>
<div class="section" id="s-increasing-the-work-factor">
<span id="s-increasing-password-algorithm-work-factor"></span><span id="increasing-the-work-factor"></span><span id="increasing-password-algorithm-work-factor"></span><h3>Increasing the work factor<a class="headerlink" href="#increasing-the-work-factor" title="Permalink to this headline">¶</a></h3>
<p>The PBKDF2 and bcrypt algorithms use a number of iterations or rounds of
hashing. This deliberately slows down attackers, making attacks against hashed
passwords harder. However, as computing power increases, the number of
iterations needs to be increased. We&#8217;ve chosen a reasonable default (and will
increase it with each release of Django), but you may wish to tune it up or
down, depending on your security needs and available processing power. To do so,
you&#8217;ll subclass the appropriate algorithm and override the <tt class="docutils literal"><span class="pre">iterations</span></tt>
parameters. For example, to increase the number of iterations used by the
default PBKDF2 algorithm:</p>
<ol class="arabic">
<li><p class="first">Create a subclass of <tt class="docutils literal"><span class="pre">django.contrib.auth.hashers.PBKDF2PasswordHasher</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.contrib.auth.hashers</span> <span class="kn">import</span> <span class="n">PBKDF2PasswordHasher</span>

<span class="k">class</span> <span class="nc">MyPBKDF2PasswordHasher</span><span class="p">(</span><span class="n">PBKDF2PasswordHasher</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A subclass of PBKDF2PasswordHasher that uses 100 times more iterations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">iterations</span> <span class="o">=</span> <span class="n">PBKDF2PasswordHasher</span><span class="o">.</span><span class="n">iterations</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
<p>Save this somewhere in your project. For example, you might put this in
a file like <tt class="docutils literal"><span class="pre">myproject/hashers.py</span></tt>.</p>
</li>
<li><p class="first">Add your new hasher as the first entry in <a class="reference internal" href="../../ref/settings.html#std:setting-PASSWORD_HASHERS"><tt class="xref std std-setting docutils literal"><span class="pre">PASSWORD_HASHERS</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">PASSWORD_HASHERS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">&#39;myproject.hashers.MyPBKDF2PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.PBKDF2PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.PBKDF2SHA1PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.BCryptSHA256PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.BCryptPasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.SHA1PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.MD5PasswordHasher&#39;</span><span class="p">,</span>
    <span class="s">&#39;django.contrib.auth.hashers.CryptPasswordHasher&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</li>
</ol>
<p>That&#8217;s it &#8211; now your Django install will use more iterations when it
stores passwords using PBKDF2.</p>
</div>
<div class="section" id="s-password-upgrading">
<span id="s-password-upgrades"></span><span id="password-upgrading"></span><span id="password-upgrades"></span><h3>Password upgrading<a class="headerlink" href="#password-upgrading" title="Permalink to this headline">¶</a></h3>
<p>When users log in, if their passwords are stored with anything other than
the preferred algorithm, Django will automatically upgrade the algorithm
to the preferred one. This means that old installs of Django will get
automatically more secure as users log in, and it also means that you
can switch to new (and better) storage algorithms as they get invented.</p>
<p>However, Django can only upgrade passwords that use algorithms mentioned in
<a class="reference internal" href="../../ref/settings.html#std:setting-PASSWORD_HASHERS"><tt class="xref std std-setting docutils literal"><span class="pre">PASSWORD_HASHERS</span></tt></a>, so as you upgrade to new systems you should make
sure never to <em>remove</em> entries from this list. If you do, users using
unmentioned algorithms won&#8217;t be able to upgrade. Hashed passwords will be
updated when increasing (or decreasing) the number of PBKDF2 iterations or
bcrypt rounds.</p>
<div class="versionchanged">
<span class="title">Changed in Django 1.9:</span> <p>Passwords updates when changing the number of bcrypt rounds was added.</p>
</div>
</div>
</div>
<div class="section" id="s-module-django.contrib.auth.hashers">
<span id="s-manually-managing-a-user-s-password"></span><span id="module-django.contrib.auth.hashers"></span><span id="manually-managing-a-user-s-password"></span><h2>Manually managing a user&#8217;s password<a class="headerlink" href="#module-django.contrib.auth.hashers" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#module-django.contrib.auth.hashers" title="django.contrib.auth.hashers"><tt class="xref py py-mod docutils literal"><span class="pre">django.contrib.auth.hashers</span></tt></a> module provides a set of functions
to create and validate hashed password. You can use them independently
from the <tt class="docutils literal"><span class="pre">User</span></tt> model.</p>
<dl class="function">
<dt id="django.contrib.auth.hashers.check_password">
<tt class="descname">check_password</tt>(<em>password</em>, <em>encoded</em>)<a class="reference internal" href="../../_modules/django/contrib/auth/hashers.html#check_password"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.auth.hashers.check_password" title="Permalink to this definition">¶</a></dt>
<dd><p>If you&#8217;d like to manually authenticate a user by comparing a plain-text
password to the hashed password in the database, use the convenience
function <a class="reference internal" href="#django.contrib.auth.hashers.check_password" title="django.contrib.auth.hashers.check_password"><tt class="xref py py-func docutils literal"><span class="pre">check_password()</span></tt></a>. It takes two arguments: the plain-text
password to check, and the full value of a user&#8217;s <tt class="docutils literal"><span class="pre">password</span></tt> field in the
database to check against, and returns <tt class="docutils literal"><span class="pre">True</span></tt> if they match, <tt class="docutils literal"><span class="pre">False</span></tt>
otherwise.</p>
</dd></dl>

<dl class="function">
<dt id="django.contrib.auth.hashers.make_password">
<tt class="descname">make_password</tt>(<em>password</em>, <em>salt=None</em>, <em>hasher='default'</em>)<a class="reference internal" href="../../_modules/django/contrib/auth/hashers.html#make_password"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.auth.hashers.make_password" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a hashed password in the format used by this application. It takes
one mandatory argument: the password in plain-text. Optionally, you can
provide a salt and a hashing algorithm to use, if you don&#8217;t want to use the
defaults (first entry of <tt class="docutils literal"><span class="pre">PASSWORD_HASHERS</span></tt> setting).
Currently supported algorithms are: <tt class="docutils literal"><span class="pre">'pbkdf2_sha256'</span></tt>, <tt class="docutils literal"><span class="pre">'pbkdf2_sha1'</span></tt>,
<tt class="docutils literal"><span class="pre">'bcrypt_sha256'</span></tt> (see <a class="reference internal" href="#bcrypt-usage"><em>Using bcrypt with Django</em></a>), <tt class="docutils literal"><span class="pre">'bcrypt'</span></tt>, <tt class="docutils literal"><span class="pre">'sha1'</span></tt>,
<tt class="docutils literal"><span class="pre">'md5'</span></tt>, <tt class="docutils literal"><span class="pre">'unsalted_md5'</span></tt> (only for backward compatibility) and <tt class="docutils literal"><span class="pre">'crypt'</span></tt>
if you have the <tt class="docutils literal"><span class="pre">crypt</span></tt> library installed. If the password argument is
<tt class="docutils literal"><span class="pre">None</span></tt>, an unusable password is returned (a one that will be never
accepted by <a class="reference internal" href="#django.contrib.auth.hashers.check_password" title="django.contrib.auth.hashers.check_password"><tt class="xref py py-func docutils literal"><span class="pre">check_password()</span></tt></a>).</p>
</dd></dl>

<dl class="function">
<dt id="django.contrib.auth.hashers.is_password_usable">
<tt class="descname">is_password_usable</tt>(<em>encoded_password</em>)<a class="reference internal" href="../../_modules/django/contrib/auth/hashers.html#is_password_usable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.auth.hashers.is_password_usable" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the given string is a hashed password that has a chance
of being verified against <a class="reference internal" href="#django.contrib.auth.hashers.check_password" title="django.contrib.auth.hashers.check_password"><tt class="xref py py-func docutils literal"><span class="pre">check_password()</span></tt></a>.</p>
</dd></dl>

</div>
<div class="section" id="s-module-django.contrib.auth.password_validation">
<span id="s-id1"></span><span id="s-password-validation"></span><span id="module-django.contrib.auth.password_validation"></span><span id="id1"></span><span id="password-validation"></span><h2>Password validation<a class="headerlink" href="#module-django.contrib.auth.password_validation" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<span class="title">New in Django 1.9.</span> </div>
<p>Users often choose poor passwords. To help mitigate this problem, Django
offers pluggable password validation. You can configure multiple password
validators at the same time. A few validators are included in Django, but it&#8217;s
simple to write your own as well.</p>
<p>Each password validator must provide a help text to explain the requirements to
the user, validate a given password and return an error message if it does not
meet the requirements, and optionally receive passwords that have been set.
Validators can also have optional settings to fine tune their behavior.</p>
<p>Validation is controlled by the <a class="reference internal" href="../../ref/settings.html#std:setting-AUTH_PASSWORD_VALIDATORS"><tt class="xref std std-setting docutils literal"><span class="pre">AUTH_PASSWORD_VALIDATORS</span></tt></a> setting.
By default, validators are used in the forms to reset or change passwords.
The default for the setting is an empty list, which means no validators are
applied. In new projects created with the default <a class="reference internal" href="../../ref/django-admin.html#django-admin-startproject"><tt class="xref std std-djadmin docutils literal"><span class="pre">startproject</span></tt></a>
template, a simple set of validators is enabled.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Password validation can prevent the use of many types of weak passwords.
However, the fact that a password passes all the validators doesn&#8217;t
guarantee that it is a strong password. There are many factors that can
weaken a password that are not detectable by even the most advanced
password validators.</p>
</div>
<div class="section" id="s-enabling-password-validation">
<span id="enabling-password-validation"></span><h3>Enabling password validation<a class="headerlink" href="#enabling-password-validation" title="Permalink to this headline">¶</a></h3>
<p>Password validation is configured in the
<a class="reference internal" href="../../ref/settings.html#std:setting-AUTH_PASSWORD_VALIDATORS"><tt class="xref std std-setting docutils literal"><span class="pre">AUTH_PASSWORD_VALIDATORS</span></tt></a> setting:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">AUTH_PASSWORD_VALIDATORS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s">&#39;NAME&#39;</span><span class="p">:</span> <span class="s">&#39;django.contrib.auth.password_validation.UserAttributeSimilarityValidator&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s">&#39;NAME&#39;</span><span class="p">:</span> <span class="s">&#39;django.contrib.auth.password_validation.MinimumLengthValidator&#39;</span><span class="p">,</span>
        <span class="s">&#39;OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&#39;min_length&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s">&#39;NAME&#39;</span><span class="p">:</span> <span class="s">&#39;django.contrib.auth.password_validation.CommonPasswordValidator&#39;</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s">&#39;NAME&#39;</span><span class="p">:</span> <span class="s">&#39;django.contrib.auth.password_validation.NumericPasswordValidator&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
<p>This example enables all four included validators:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">UserAttributeSimilarityValidator</span></tt>, which checks the similarity between
the password and a set of attributes of the user.</li>
<li><tt class="docutils literal"><span class="pre">MinimumLengthValidator</span></tt>, which simply checks whether the password meets a
minimum length. This validator is configured with a custom option: it now
requires the minimum length to be nine characters, instead of the default
eight.</li>
<li><tt class="docutils literal"><span class="pre">CommonPasswordValidator</span></tt>, which checks whether the password occurs in a
list of common passwords. By default, it compares to an included list of
1000 common passwords.</li>
<li><tt class="docutils literal"><span class="pre">NumericPasswordValidator</span></tt>, which checks whether the password isn&#8217;t
entirely numeric.</li>
</ul>
<p>For <tt class="docutils literal"><span class="pre">UserAttributeSimilarityValidator</span></tt> and <tt class="docutils literal"><span class="pre">CommonPasswordValidator</span></tt>,
we&#8217;re simply using the default settings in this example.
<tt class="docutils literal"><span class="pre">NumericPasswordValidator</span></tt> has no settings.</p>
<p>The help texts and any errors from password validators are always returned in
the order they are listed in <a class="reference internal" href="../../ref/settings.html#std:setting-AUTH_PASSWORD_VALIDATORS"><tt class="xref std std-setting docutils literal"><span class="pre">AUTH_PASSWORD_VALIDATORS</span></tt></a>.</p>
</div>
<div class="section" id="s-included-validators">
<span id="included-validators"></span><h3>Included validators<a class="headerlink" href="#included-validators" title="Permalink to this headline">¶</a></h3>
<p>Django includes four validators:</p>
<dl class="class">
<dt id="django.contrib.auth.password_validation.MinimumLengthValidator">
<em class="property">class </em><tt class="descname">MinimumLengthValidator</tt>(<em>min_length=8</em>)<a class="reference internal" href="../../_modules/django/contrib/auth/password_validation.html#MinimumLengthValidator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.auth.password_validation.MinimumLengthValidator" title="Permalink to this definition">¶</a></dt>
<dd><p>Validates whether the password meets a minimum length.
The minimum length can be customized with the <tt class="docutils literal"><span class="pre">min_length</span></tt> parameter.</p>
</dd></dl>

<dl class="class">
<dt id="django.contrib.auth.password_validation.UserAttributeSimilarityValidator">
<em class="property">class </em><tt class="descname">UserAttributeSimilarityValidator</tt>(<em>user_attributes=DEFAULT_USER_ATTRIBUTES</em>, <em>max_similarity=0.7</em>)<a class="reference internal" href="../../_modules/django/contrib/auth/password_validation.html#UserAttributeSimilarityValidator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.auth.password_validation.UserAttributeSimilarityValidator" title="Permalink to this definition">¶</a></dt>
<dd><p>Validates whether the password is sufficiently different from certain
attributes of the user.</p>
<p>The <tt class="docutils literal"><span class="pre">user_attributes</span></tt> parameter should be an iterable of names of user
attributes to compare to. If this argument is not provided, the default
is used: <tt class="docutils literal"><span class="pre">'username',</span> <span class="pre">'first_name',</span> <span class="pre">'last_name',</span> <span class="pre">'email'</span></tt>.
Attributes that don&#8217;t exist are ignored.</p>
<p>The maximum similarity the password can have, before it is rejected, can
be set with the <tt class="docutils literal"><span class="pre">max_similarity</span></tt> parameter, on a scale of 0 to 1.
A setting of 0 will cause all passwords to be rejected, whereas a setting
of 1 will cause it to only reject passwords that are identical to an
attribute&#8217;s value.</p>
</dd></dl>

<dl class="class">
<dt id="django.contrib.auth.password_validation.CommonPasswordValidator">
<em class="property">class </em><tt class="descname">CommonPasswordValidator</tt>(<em>password_list_path=DEFAULT_PASSWORD_LIST_PATH</em>)<a class="reference internal" href="../../_modules/django/contrib/auth/password_validation.html#CommonPasswordValidator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.auth.password_validation.CommonPasswordValidator" title="Permalink to this definition">¶</a></dt>
<dd><p>Validates whether the password is not a common password. By default, this
checks against a list of 1000 common password created by
<a class="reference external" href="https://web.archive.org/web/20150315154609/https://xato.net/passwords/more-top-worst-passwords/">Mark Burnett</a>.</p>
<p>The <tt class="docutils literal"><span class="pre">password_list_path</span></tt> can be set to the path of a custom file of
common passwords. This file should contain one password per line and
may be plain text or gzipped.</p>
</dd></dl>

<dl class="class">
<dt id="django.contrib.auth.password_validation.NumericPasswordValidator">
<em class="property">class </em><tt class="descname">NumericPasswordValidator</tt><a class="reference internal" href="../../_modules/django/contrib/auth/password_validation.html#NumericPasswordValidator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.auth.password_validation.NumericPasswordValidator" title="Permalink to this definition">¶</a></dt>
<dd><p>Validates whether the password is not entirely numeric.</p>
</dd></dl>

</div>
<div class="section" id="s-integrating-validation">
<span id="integrating-validation"></span><h3>Integrating validation<a class="headerlink" href="#integrating-validation" title="Permalink to this headline">¶</a></h3>
<p>There are a few functions in <tt class="docutils literal"><span class="pre">django.contrib.auth.password_validation</span></tt> that
you can call from your own forms or other code to integrate password
validation. This can be useful if you use custom forms for password setting,
or if you have API calls that allow passwords to be set, for example.</p>
<dl class="function">
<dt id="django.contrib.auth.password_validation.validate_password">
<tt class="descname">validate_password</tt>(<em>password</em>, <em>user=None</em>, <em>password_validators=None</em>)<a class="reference internal" href="../../_modules/django/contrib/auth/password_validation.html#validate_password"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.auth.password_validation.validate_password" title="Permalink to this definition">¶</a></dt>
<dd><p>Validates a password. If all validators find the password valid, returns
<tt class="docutils literal"><span class="pre">None</span></tt>. If one or more validators reject the password, raises a
<a class="reference internal" href="../../ref/exceptions.html#django.core.exceptions.ValidationError" title="django.core.exceptions.ValidationError"><tt class="xref py py-exc docutils literal"><span class="pre">ValidationError</span></tt></a> with all the error messages
from the validators.</p>
<p>The <tt class="docutils literal"><span class="pre">user</span></tt> object is optional: if it&#8217;s not provided, some validators may
not be able to perform any validation and will accept any password.</p>
</dd></dl>

<dl class="function">
<dt id="django.contrib.auth.password_validation.password_changed">
<tt class="descname">password_changed</tt>(<em>password</em>, <em>user=None</em>, <em>password_validators=None</em>)<a class="reference internal" href="../../_modules/django/contrib/auth/password_validation.html#password_changed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.auth.password_validation.password_changed" title="Permalink to this definition">¶</a></dt>
<dd><p>Informs all validators that the password has been changed. This can be used
by validators such as one that prevents password reuse. This should be
called once the password has been successfully changed.</p>
<p>For subclasses of <a class="reference internal" href="customizing.html#django.contrib.auth.models.AbstractBaseUser" title="django.contrib.auth.models.AbstractBaseUser"><tt class="xref py py-class docutils literal"><span class="pre">AbstractBaseUser</span></tt></a>,
the password field will be marked as &#8220;dirty&#8221; when calling
<a class="reference internal" href="customizing.html#django.contrib.auth.models.AbstractBaseUser.set_password" title="django.contrib.auth.models.AbstractBaseUser.set_password"><tt class="xref py py-meth docutils literal"><span class="pre">set_password()</span></tt></a> which
triggers a call to <tt class="docutils literal"><span class="pre">password_changed()</span></tt> after the user is saved.</p>
</dd></dl>

<dl class="function">
<dt id="django.contrib.auth.password_validation.password_validators_help_texts">
<tt class="descname">password_validators_help_texts</tt>(<em>password_validators=None</em>)<a class="reference internal" href="../../_modules/django/contrib/auth/password_validation.html#password_validators_help_texts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.auth.password_validation.password_validators_help_texts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the help texts of all validators. These explain the
password requirements to the user.</p>
</dd></dl>

<dl class="function">
<dt id="django.contrib.auth.password_validation.password_validators_help_text_html">
<tt class="descname">password_validators_help_text_html</tt>(<em>password_validators=None</em>)<a class="reference internal" href="../../_modules/django/contrib/auth/password_validation.html#password_validators_help_text_html"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.auth.password_validation.password_validators_help_text_html" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an HTML string with all help texts in an <tt class="docutils literal"><span class="pre">&lt;ul&gt;</span></tt>. This is
helpful when adding password validation to forms, as you can pass the
output directly to the <tt class="docutils literal"><span class="pre">help_text</span></tt> parameter of a form field.</p>
</dd></dl>

<dl class="function">
<dt id="django.contrib.auth.password_validation.get_password_validators">
<tt class="descname">get_password_validators</tt>(<em>validator_config</em>)<a class="reference internal" href="../../_modules/django/contrib/auth/password_validation.html#get_password_validators"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.auth.password_validation.get_password_validators" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a set of validator objects based on the <tt class="docutils literal"><span class="pre">validator_config</span></tt>
parameter. By default, all functions use the validators defined in
<a class="reference internal" href="../../ref/settings.html#std:setting-AUTH_PASSWORD_VALIDATORS"><tt class="xref std std-setting docutils literal"><span class="pre">AUTH_PASSWORD_VALIDATORS</span></tt></a>, but by calling this function with an
alternate set of validators and then passing the result into the
<tt class="docutils literal"><span class="pre">password_validators</span></tt> parameter of the other functions, your custom set
of validators will be used instead. This is useful when you have a typical
set of validators to use for most scenarios, but also have a special
situation that requires a custom set. If you always use the same set
of validators, there is no need to use this function, as the configuration
from <a class="reference internal" href="../../ref/settings.html#std:setting-AUTH_PASSWORD_VALIDATORS"><tt class="xref std std-setting docutils literal"><span class="pre">AUTH_PASSWORD_VALIDATORS</span></tt></a> is used by default.</p>
<p>The structure of <tt class="docutils literal"><span class="pre">validator_config</span></tt> is identical to the
structure of <a class="reference internal" href="../../ref/settings.html#std:setting-AUTH_PASSWORD_VALIDATORS"><tt class="xref std std-setting docutils literal"><span class="pre">AUTH_PASSWORD_VALIDATORS</span></tt></a>. The return value of
this function can be passed into the <tt class="docutils literal"><span class="pre">password_validators</span></tt> parameter
of the functions listed above.</p>
</dd></dl>

<p>Note that where the password is passed to one of these functions, this should
always be the clear text password - not a hashed password.</p>
</div>
<div class="section" id="s-writing-your-own-validator">
<span id="writing-your-own-validator"></span><h3>Writing your own validator<a class="headerlink" href="#writing-your-own-validator" title="Permalink to this headline">¶</a></h3>
<p>If Django&#8217;s built-in validators are not sufficient, you can write your own
password validators. Validators are fairly simple classes. They must implement
two methods:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">validate(self,</span> <span class="pre">password,</span> <span class="pre">user=None)</span></tt>: validate a password. Return
<tt class="docutils literal"><span class="pre">None</span></tt> if the password is valid, or raise a
<a class="reference internal" href="../../ref/exceptions.html#django.core.exceptions.ValidationError" title="django.core.exceptions.ValidationError"><tt class="xref py py-exc docutils literal"><span class="pre">ValidationError</span></tt></a> with an error message if the
password is not valid. You must be able to deal with <tt class="docutils literal"><span class="pre">user</span></tt> being
<tt class="docutils literal"><span class="pre">None</span></tt> - if that means your validator can&#8217;t run, simply return <tt class="docutils literal"><span class="pre">None</span></tt>
for no error.</li>
<li><tt class="docutils literal"><span class="pre">get_help_text()</span></tt>: provide a help text to explain the requirements to
the user.</li>
</ul>
<p>Any items in the <tt class="docutils literal"><span class="pre">OPTIONS</span></tt> in <a class="reference internal" href="../../ref/settings.html#std:setting-AUTH_PASSWORD_VALIDATORS"><tt class="xref std std-setting docutils literal"><span class="pre">AUTH_PASSWORD_VALIDATORS</span></tt></a> for your
validator will be passed to the constructor. All constructor arguments should
have a default value.</p>
<p>Here&#8217;s a basic example of a validator, with one optional setting:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.core.exceptions</span> <span class="kn">import</span> <span class="n">ValidationError</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext</span> <span class="k">as</span> <span class="n">_</span>

<span class="k">class</span> <span class="nc">MinimumLengthValidator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_length</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_length</span> <span class="o">=</span> <span class="n">min_length</span>

    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">password</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
                <span class="n">_</span><span class="p">(</span><span class="s">&quot;This password must contain at least </span><span class="si">%(min_length)d</span><span class="s"> characters.&quot;</span><span class="p">),</span>
                <span class="n">code</span><span class="o">=</span><span class="s">&#39;password_too_short&#39;</span><span class="p">,</span>
                <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;min_length&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">},</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_help_text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_</span><span class="p">(</span>
            <span class="s">&quot;Your password must contain at least </span><span class="si">%(min_length)d</span><span class="s"> characters.&quot;</span>
            <span class="o">%</span> <span class="p">{</span><span class="s">&#39;min_length&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_length</span><span class="p">}</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>You can also implement <tt class="docutils literal"><span class="pre">password_changed(password,</span> <span class="pre">user=None</span></tt>), which will
be called after a successful password change. That can be used to prevent
password reuse, for example. However, if you decide to store a user&#8217;s previous
passwords, you should never do so in clear text.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      
        
          <div class="yui-b" id="sidebar">
            
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Password management in Django</a><ul>
<li><a class="reference internal" href="#how-django-stores-passwords">How Django stores passwords</a><ul>
<li><a class="reference internal" href="#using-bcrypt-with-django">Using bcrypt with Django</a></li>
<li><a class="reference internal" href="#increasing-the-work-factor">Increasing the work factor</a></li>
<li><a class="reference internal" href="#password-upgrading">Password upgrading</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-django.contrib.auth.hashers">Manually managing a user&#8217;s password</a></li>
<li><a class="reference internal" href="#module-django.contrib.auth.password_validation">Password validation</a><ul>
<li><a class="reference internal" href="#enabling-password-validation">Enabling password validation</a></li>
<li><a class="reference internal" href="#included-validators">Included validators</a></li>
<li><a class="reference internal" href="#integrating-validation">Integrating validation</a></li>
<li><a class="reference internal" href="#writing-your-own-validator">Writing your own validator</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h3>Browse</h3>
  <ul>
    
      <li>Prev: <a href="default.html">Using the Django authentication system</a></li>
    
    
      <li>Next: <a href="customizing.html">Customizing authentication in Django</a></li>
    
  </ul>
  <h3>You are here:</h3>
  <ul>
      <li>
        <a href="../../index.html">Django 1.9.1.dev20151230225111 documentation</a>
        
          <ul><li><a href="../index.html">Using Django</a>
        
          <ul><li><a href="index.html">User authentication in Django</a>
        
        <ul><li>Password management in Django</li></ul>
        </li></ul></li></ul>
      </li>
  </ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/topics/auth/passwords.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
              <h3>Last update:</h3>
              <p class="topless">Dec 30, 2015</p>
          </div>
        
      
    </div>

    <div id="ft">
      <div class="nav">
    &laquo; <a href="default.html" title="Using the Django authentication system">previous</a>
     |
    <a href="../index.html" title="Using Django" accesskey="U">up</a>
   |
    <a href="customizing.html" title="Customizing authentication in Django">next</a> &raquo;</div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
  </body>
</html>