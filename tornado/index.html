

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tornado 4.3 documentation</title>
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  
    <link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />
  

  
    <link rel="top" title="None" href="index.html#document-index"/>
 
<!-- RTD Extra Head -->

    

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="http://www.tornadoweb.org/en/stable/" />


  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html#document-index" class="icon icon-home"> Tornado
          

          
          </a>

          
            
            
            
              <div class="version">
                stable
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-guide">User&#8217;s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-webframework">Web framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-http">HTTP servers and clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-networking">Asynchronous networking</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-coroutine">Coroutines and concurrency</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-integration">Integration with other services</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-utilities">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-faq">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-releases">Release notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html#document-index">Tornado</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html#document-index">Docs</a> &raquo;</li>
      
    <li>Tornado 4.3 documentation</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="https://github.com/tornadoweb/tornado/blob/stable/docs/index.rst" class="fa fa-github"> Edit on GitHub</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tornado-web-server">
<h1><img alt="Tornado Web Server" src="_images/tornado.png" /><a class="headerlink" href="#tornado-web-server" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="http://www.tornadoweb.org">Tornado</a> is a Python web framework and
asynchronous networking library, originally developed at <a class="reference external" href="http://friendfeed.com">FriendFeed</a>.  By using non-blocking network I/O, Tornado
can scale to tens of thousands of open connections, making it ideal for
<a class="reference external" href="http://en.wikipedia.org/wiki/Push_technology#Long_polling">long polling</a>,
<a class="reference external" href="http://en.wikipedia.org/wiki/WebSocket">WebSockets</a>, and other
applications that require a long-lived connection to each user.</p>
<div class="section" id="quick-links">
<h2>Quick links<a class="headerlink" href="#quick-links" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Download version 4.3: <a class="reference external" href="https://pypi.python.org/packages/source/t/tornado/tornado-4.3.tar.gz">tornado-4.3.tar.gz</a> (<a class="reference internal" href="index.html#document-releases"><em>release notes</em></a>)</li>
<li><a class="reference external" href="https://github.com/tornadoweb/tornado">Source (github)</a></li>
<li>Mailing lists: <a class="reference external" href="http://groups.google.com/group/python-tornado">discussion</a> and <a class="reference external" href="http://groups.google.com/group/python-tornado-announce">announcements</a></li>
<li><a class="reference external" href="http://stackoverflow.com/questions/tagged/tornado">Stack Overflow</a></li>
<li><a class="reference external" href="https://github.com/tornadoweb/tornado/wiki/Links">Wiki</a></li>
</ul>
</div>
<div class="section" id="hello-world">
<h2>Hello, world<a class="headerlink" href="#hello-world" title="Permalink to this headline">¶</a></h2>
<p>Here is a simple &#8220;Hello, world&#8221; example web app for Tornado:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">tornado.ioloop</span>
<span class="kn">import</span> <span class="nn">tornado.web</span>

<span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Hello, world&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">make_app</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
        <span class="p">(</span><span class="s">r&quot;/&quot;</span><span class="p">,</span> <span class="n">MainHandler</span><span class="p">),</span>
    <span class="p">])</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">make_app</span><span class="p">()</span>
    <span class="n">app</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">8888</span><span class="p">)</span>
    <span class="n">tornado</span><span class="o">.</span><span class="n">ioloop</span><span class="o">.</span><span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>This example does not use any of Tornado&#8217;s asynchronous features; for
that see this <a class="reference external" href="https://github.com/tornadoweb/tornado/tree/stable/demos/chat">simple chat room</a>.</p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p><strong>Automatic installation</strong>:</p>
<div class="highlight-python"><div class="highlight"><pre>pip install tornado
</pre></div>
</div>
<p>Tornado is listed in <a class="reference external" href="http://pypi.python.org/pypi/tornado">PyPI</a> and
can be installed with <code class="docutils literal"><span class="pre">pip</span></code> or <code class="docutils literal"><span class="pre">easy_install</span></code>.  Note that the
source distribution includes demo applications that are not present
when Tornado is installed in this way, so you may wish to download a
copy of the source tarball as well.</p>
<p><strong>Manual installation</strong>: Download <a class="reference external" href="https://pypi.python.org/packages/source/t/tornado/tornado-4.3.tar.gz">tornado-4.3.tar.gz</a>:</p>
<pre class="literal-block">
tar xvzf tornado-4.3.tar.gz
cd tornado-4.3
python setup.py build
sudo python setup.py install
</pre>
<p>The Tornado source code is <a class="reference external" href="https://github.com/tornadoweb/tornado">hosted on GitHub</a>.</p>
<p><strong>Prerequisites</strong>: Tornado 4.3 runs on Python 2.6, 2.7, and 3.2+
(support for Python 2.6 and 3.2 is deprecated and will be removed in
the next release). For Python 2, version 2.7.9 or newer is <em>strongly</em>
recommended for the improved SSL support. In addition to the requirements
which will be installed automatically by <code class="docutils literal"><span class="pre">pip</span></code> or <code class="docutils literal"><span class="pre">setup.py</span> <span class="pre">install</span></code>,
the following optional packages may be useful:</p>
<ul class="simple">
<li><a class="reference external" href="https://pypi.python.org/pypi/unittest2">unittest2</a> is needed to run
Tornado&#8217;s test suite on Python 2.6 (it is unnecessary on more recent
versions of Python)</li>
<li><a class="reference external" href="https://pypi.python.org/pypi/futures">concurrent.futures</a> is the
recommended thread pool for use with Tornado and enables the use of
<a class="reference internal" href="index.html#tornado.netutil.ThreadedResolver" title="tornado.netutil.ThreadedResolver"><code class="xref py py-obj docutils literal"><span class="pre">ThreadedResolver</span></code></a>.  It is needed only on Python 2;
Python 3 includes this package in the standard library.</li>
<li><a class="reference external" href="http://pycurl.sourceforge.net">pycurl</a> is used by the optional
<code class="docutils literal"><span class="pre">tornado.curl_httpclient</span></code>.  Libcurl version 7.19.3.1 or higher is required;
version 7.21.1 or higher is recommended.</li>
<li><a class="reference external" href="http://www.twistedmatrix.com">Twisted</a> may be used with the classes in
<a class="reference internal" href="index.html#module-tornado.platform.twisted" title="tornado.platform.twisted"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.twisted</span></code></a>.</li>
<li><a class="reference external" href="https://pypi.python.org/pypi/pycares">pycares</a> is an alternative
non-blocking DNS resolver that can be used when threads are not
appropriate.</li>
<li><a class="reference external" href="https://pypi.python.org/pypi/Monotime">Monotime</a> adds support for
a monotonic clock, which improves reliability in environments
where clock adjustments are frequent.  No longer needed in Python 3.3.</li>
</ul>
<p><strong>Platforms</strong>: Tornado should run on any Unix-like platform, although
for the best performance and scalability only Linux (with <code class="docutils literal"><span class="pre">epoll</span></code>)
and BSD (with <code class="docutils literal"><span class="pre">kqueue</span></code>) are recommended for production deployment
(even though Mac OS X is derived from BSD and supports kqueue, its
networking performance is generally poor so it is recommended only for
development use).  Tornado will also run on Windows, although this
configuration is not officially supported and is recommended only for
development use.</p>
</div>
<div class="section" id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<p>This documentation is also available in <a class="reference external" href="https://readthedocs.org/projects/tornado/downloads/">PDF and Epub formats</a>.</p>
<div class="toctree-wrapper compound">
<span id="document-guide"></span><div class="section" id="user-s-guide">
<h3>User&#8217;s guide<a class="headerlink" href="#user-s-guide" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
<span id="document-guide/intro"></span><div class="section" id="introduction">
<h4>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="http://www.tornadoweb.org">Tornado</a> is a Python web framework and
asynchronous networking library, originally developed at <a class="reference external" href="http://friendfeed.com">FriendFeed</a>.  By using non-blocking network I/O, Tornado
can scale to tens of thousands of open connections, making it ideal for
<a class="reference external" href="http://en.wikipedia.org/wiki/Push_technology#Long_polling">long polling</a>,
<a class="reference external" href="http://en.wikipedia.org/wiki/WebSocket">WebSockets</a>, and other
applications that require a long-lived connection to each user.</p>
<p>Tornado can be roughly divided into four major components:</p>
<ul class="simple">
<li>A web framework (including <a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> which is subclassed to
create web applications, and various supporting classes).</li>
<li>Client- and server-side implementions of HTTP (<a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> and
<a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a>).</li>
<li>An asynchronous networking library (<a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> and <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a>),
which serve as the building blocks for the HTTP components and can
also be used to implement other protocols.</li>
<li>A coroutine library (<a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a>) which allows asynchronous
code to be written in a more straightforward way than chaining
callbacks.</li>
</ul>
<p>The Tornado web framework and HTTP server together offer a full-stack
alternative to <a class="reference external" href="http://www.python.org/dev/peps/pep-3333/">WSGI</a>.
While it is possible to use the Tornado web framework in a WSGI
container (<a class="reference internal" href="index.html#tornado.wsgi.WSGIAdapter" title="tornado.wsgi.WSGIAdapter"><code class="xref py py-obj docutils literal"><span class="pre">WSGIAdapter</span></code></a>), or use the Tornado HTTP server as a
container for other WSGI frameworks (<a class="reference internal" href="index.html#tornado.wsgi.WSGIContainer" title="tornado.wsgi.WSGIContainer"><code class="xref py py-obj docutils literal"><span class="pre">WSGIContainer</span></code></a>), each of these
combinations has limitations and to take full advantage of Tornado you
will need to use the Tornado&#8217;s web framework and HTTP server together.</p>
</div>
<span id="document-guide/async"></span><div class="section" id="asynchronous-and-non-blocking-i-o">
<h4>Asynchronous and non-Blocking I/O<a class="headerlink" href="#asynchronous-and-non-blocking-i-o" title="Permalink to this headline">¶</a></h4>
<p>Real-time web features require a long-lived mostly-idle connection per
user.  In a traditional synchronous web server, this implies devoting
one thread to each user, which can be very expensive.</p>
<p>To minimize the cost of concurrent connections, Tornado uses a
single-threaded event loop.  This means that all application code
should aim to be asynchronous and non-blocking because only one
operation can be active at a time.</p>
<p>The terms asynchronous and non-blocking are closely related and are
often used interchangeably, but they are not quite the same thing.</p>
<div class="section" id="blocking">
<h5>Blocking<a class="headerlink" href="#blocking" title="Permalink to this headline">¶</a></h5>
<p>A function <strong>blocks</strong> when it waits for something to happen before
returning.  A function may block for many reasons: network I/O, disk
I/O, mutexes, etc.  In fact, <em>every</em> function blocks, at least a
little bit, while it is running and using the CPU (for an extreme
example that demonstrates why CPU blocking must be taken as seriously
as other kinds of blocking, consider password hashing functions like
<a class="reference external" href="http://bcrypt.sourceforge.net/">bcrypt</a>, which by design use
hundreds of milliseconds of CPU time, far more than a typical network
or disk access).</p>
<p>A function can be blocking in some respects and non-blocking in
others.  For example, <a class="reference internal" href="index.html#module-tornado.httpclient" title="tornado.httpclient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient</span></code></a> in the default
configuration blocks on DNS resolution but not on other network access
(to mitigate this use <a class="reference internal" href="index.html#tornado.netutil.ThreadedResolver" title="tornado.netutil.ThreadedResolver"><code class="xref py py-obj docutils literal"><span class="pre">ThreadedResolver</span></code></a> or a
<code class="docutils literal"><span class="pre">tornado.curl_httpclient</span></code> with a properly-configured build of
<code class="docutils literal"><span class="pre">libcurl</span></code>).  In the context of Tornado we generally talk about
blocking in the context of network I/O, although all kinds of blocking
are to be minimized.</p>
</div>
<div class="section" id="asynchronous">
<h5>Asynchronous<a class="headerlink" href="#asynchronous" title="Permalink to this headline">¶</a></h5>
<p>An <strong>asynchronous</strong> function returns before it is finished, and
generally causes some work to happen in the background before
triggering some future action in the application (as opposed to normal
<strong>synchronous</strong> functions, which do everything they are going to do
before returning).  There are many styles of asynchronous interfaces:</p>
<ul class="simple">
<li>Callback argument</li>
<li>Return a placeholder (<a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>, <code class="docutils literal"><span class="pre">Promise</span></code>, <code class="docutils literal"><span class="pre">Deferred</span></code>)</li>
<li>Deliver to a queue</li>
<li>Callback registry (e.g. POSIX signals)</li>
</ul>
<p>Regardless of which type of interface is used, asynchronous functions
<em>by definition</em> interact differently with their callers; there is no
free way to make a synchronous function asynchronous in a way that is
transparent to its callers (systems like <a class="reference external" href="http://www.gevent.org">gevent</a> use lightweight threads to offer performance
comparable to asynchronous systems, but they do not actually make
things asynchronous).</p>
</div>
<div class="section" id="examples">
<h5>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h5>
<p>Here is a sample synchronous function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado.httpclient</span> <span class="kn">import</span> <span class="n">HTTPClient</span>

<span class="k">def</span> <span class="nf">synchronous_fetch</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">http_client</span> <span class="o">=</span> <span class="n">HTTPClient</span><span class="p">()</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">body</span>
</pre></div>
</div>
<p>And here is the same function rewritten to be asynchronous with a
callback argument:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado.httpclient</span> <span class="kn">import</span> <span class="n">AsyncHTTPClient</span>

<span class="k">def</span> <span class="nf">asynchronous_fetch</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
    <span class="n">http_client</span> <span class="o">=</span> <span class="n">AsyncHTTPClient</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">handle_response</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
        <span class="n">callback</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
    <span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">handle_response</span><span class="p">)</span>
</pre></div>
</div>
<p>And again with a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> instead of a callback:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado.concurrent</span> <span class="kn">import</span> <span class="n">Future</span>

<span class="k">def</span> <span class="nf">async_fetch_future</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">http_client</span> <span class="o">=</span> <span class="n">AsyncHTTPClient</span><span class="p">()</span>
    <span class="n">my_future</span> <span class="o">=</span> <span class="n">Future</span><span class="p">()</span>
    <span class="n">fetch_future</span> <span class="o">=</span> <span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">fetch_future</span><span class="o">.</span><span class="n">add_done_callback</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">f</span><span class="p">:</span> <span class="n">my_future</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">result</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">my_future</span>
</pre></div>
</div>
<p>The raw <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> version is more complex, but <code class="docutils literal"><span class="pre">Futures</span></code> are
nonetheless recommended practice in Tornado because they have two
major advantages.  Error handling is more consistent since the
<a class="reference internal" href="index.html#tornado.concurrent.Future.result" title="tornado.concurrent.Future.result"><code class="xref py py-obj docutils literal"><span class="pre">Future.result</span></code></a> method can simply raise an exception (as opposed to
the ad-hoc error handling common in callback-oriented interfaces), and
<code class="docutils literal"><span class="pre">Futures</span></code> lend themselves well to use with coroutines.  Coroutines
will be discussed in depth in the next section of this guide.  Here is
the coroutine version of our sample function, which is very similar to
the original synchronous version:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado</span> <span class="kn">import</span> <span class="n">gen</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">fetch_coroutine</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">http_client</span> <span class="o">=</span> <span class="n">AsyncHTTPClient</span><span class="p">()</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">raise</span> <span class="n">gen</span><span class="o">.</span><span class="n">Return</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
</pre></div>
</div>
<p>The statement <code class="docutils literal"><span class="pre">raise</span> <span class="pre">gen.Return(response.body)</span></code> is an artifact of
Python 2 (and 3.2), in which generators aren&#8217;t allowed to return
values. To overcome this, Tornado coroutines raise a special kind of
exception called a <a class="reference internal" href="index.html#tornado.gen.Return" title="tornado.gen.Return"><code class="xref py py-obj docutils literal"><span class="pre">Return</span></code></a>. The coroutine catches this exception and
treats it like a returned value. In Python 3.3 and later, a <code class="docutils literal"><span class="pre">return</span>
<span class="pre">response.body</span></code> achieves the same result.</p>
</div>
</div>
<span id="document-guide/coroutines"></span><div class="section" id="coroutines">
<h4>Coroutines<a class="headerlink" href="#coroutines" title="Permalink to this headline">¶</a></h4>
<p><strong>Coroutines</strong> are the recommended way to write asynchronous code in
Tornado.  Coroutines use the Python <code class="docutils literal"><span class="pre">yield</span></code> keyword to suspend and
resume execution instead of a chain of callbacks (cooperative
lightweight threads as seen in frameworks like <a class="reference external" href="http://www.gevent.org">gevent</a> are sometimes called coroutines as well, but
in Tornado all coroutines use explicit context switches and are called
as asynchronous functions).</p>
<p>Coroutines are almost as simple as synchronous code, but without the
expense of a thread.  They also <a class="reference external" href="https://glyph.twistedmatrix.com/2014/02/unyielding.html">make concurrency easier</a> to reason
about by reducing the number of places where a context switch can
happen.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado</span> <span class="kn">import</span> <span class="n">gen</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">fetch_coroutine</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">http_client</span> <span class="o">=</span> <span class="n">AsyncHTTPClient</span><span class="p">()</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="c"># In Python versions prior to 3.3, returning a value from</span>
    <span class="c"># a generator is not allowed and you must use</span>
    <span class="c">#   raise gen.Return(response.body)</span>
    <span class="c"># instead.</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">body</span>
</pre></div>
</div>
<div class="section" id="python-3-5-async-and-await">
<span id="native-coroutines"></span><h5>Python 3.5: <code class="docutils literal"><span class="pre">async</span></code> and <code class="docutils literal"><span class="pre">await</span></code><a class="headerlink" href="#python-3-5-async-and-await" title="Permalink to this headline">¶</a></h5>
<p>Python 3.5 introduces the <code class="docutils literal"><span class="pre">async</span></code> and <code class="docutils literal"><span class="pre">await</span></code> keywords (functions
using these keywords are also called &#8220;native coroutines&#8221;). Starting in
Tornado 4.3, you can use them in place of <code class="docutils literal"><span class="pre">yield</span></code>-based coroutines.
Simply use <code class="docutils literal"><span class="pre">async</span> <span class="pre">def</span> <span class="pre">foo()</span></code> in place of a function definition with
the <code class="docutils literal"><span class="pre">&#64;gen.coroutine</span></code> decorator, and <code class="docutils literal"><span class="pre">await</span></code> in place of yield. The
rest of this document still uses the <code class="docutils literal"><span class="pre">yield</span></code> style for compatibility
with older versions of Python, but <code class="docutils literal"><span class="pre">async</span></code> and <code class="docutils literal"><span class="pre">await</span></code> will run
faster when they are available:</p>
<div class="highlight-python"><div class="highlight"><pre>async def fetch_coroutine(url):
    http_client = AsyncHTTPClient()
    response = await http_client.fetch(url)
    return response.body
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">await</span></code> keyword is less versatile than the <code class="docutils literal"><span class="pre">yield</span></code> keyword.
For example, in a <code class="docutils literal"><span class="pre">yield</span></code>-based coroutine you can yield a list of
<code class="docutils literal"><span class="pre">Futures</span></code>, while in a native coroutine you must wrap the list in
<a class="reference internal" href="index.html#tornado.gen.multi" title="tornado.gen.multi"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.multi</span></code></a>. You can also use <a class="reference internal" href="index.html#tornado.gen.convert_yielded" title="tornado.gen.convert_yielded"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.convert_yielded</span></code></a>
to convert anything that would work with <code class="docutils literal"><span class="pre">yield</span></code> into a form that
will work with <code class="docutils literal"><span class="pre">await</span></code>.</p>
<p>While native coroutines are not visibly tied to a particular framework
(i.e. they do not use a decorator like <a class="reference internal" href="index.html#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.coroutine</span></code></a> or
<a class="reference external" href="https://docs.python.org/3.4/library/asyncio-task.html#asyncio.coroutine" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">asyncio.coroutine</span></code></a>), not all coroutines are compatible with each
other. There is a <em>coroutine runner</em> which is selected by the first
coroutine to be called, and then shared by all coroutines which are
called directly with <code class="docutils literal"><span class="pre">await</span></code>. The Tornado coroutine runner is
designed to be versatile and accept awaitable objects from any
framework; other coroutine runners may be more limited (for example,
the <code class="docutils literal"><span class="pre">asyncio</span></code> coroutine runner does not accept coroutines from other
frameworks). For this reason, it is recommended to use the Tornado
coroutine runner for any application which combines multiple
frameworks. To call a coroutine using the Tornado runner from within a
coroutine that is already using the asyncio runner, use the
<a class="reference internal" href="index.html#tornado.platform.asyncio.to_asyncio_future" title="tornado.platform.asyncio.to_asyncio_future"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.asyncio.to_asyncio_future</span></code></a> adapter.</p>
</div>
<div class="section" id="how-it-works">
<h5>How it works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h5>
<p>A function containing <code class="docutils literal"><span class="pre">yield</span></code> is a <strong>generator</strong>.  All generators
are asynchronous; when called they return a generator object instead
of running to completion.  The <code class="docutils literal"><span class="pre">&#64;gen.coroutine</span></code> decorator
communicates with the generator via the <code class="docutils literal"><span class="pre">yield</span></code> expressions, and
with the coroutine&#8217;s caller by returning a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.</p>
<p>Here is a simplified version of the coroutine decorator&#8217;s inner loop:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Simplified inner loop of tornado.gen.Runner</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c"># send(x) makes the current yield return x.</span>
    <span class="c"># It returns when the next yield is reached</span>
    <span class="n">future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">future</span><span class="o">.</span><span class="n">add_done_callback</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
</pre></div>
</div>
<p>The decorator receives a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> from the generator, waits (without
blocking) for that <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> to complete, then &#8220;unwraps&#8221; the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>
and sends the result back into the generator as the result of the
<code class="docutils literal"><span class="pre">yield</span></code> expression.  Most asynchronous code never touches the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>
class directly except to immediately pass the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> returned by
an asynchronous function to a <code class="docutils literal"><span class="pre">yield</span></code> expression.</p>
</div>
<div class="section" id="how-to-call-a-coroutine">
<h5>How to call a coroutine<a class="headerlink" href="#how-to-call-a-coroutine" title="Permalink to this headline">¶</a></h5>
<p>Coroutines do not raise exceptions in the normal way: any exception
they raise will be trapped in the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> until it is yielded. This
means it is important to call coroutines in the right way, or you may
have errors that go unnoticed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">divide</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">bad_call</span><span class="p">():</span>
    <span class="c"># This should raise a ZeroDivisionError, but it won&#39;t because</span>
    <span class="c"># the coroutine is called incorrectly.</span>
    <span class="n">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>In nearly all cases, any function that calls a coroutine must be a
coroutine itself, and use the <code class="docutils literal"><span class="pre">yield</span></code> keyword in the call. When you
are overriding a method defined in a superclass, consult the
documentation to see if coroutines are allowed (the documentation
should say that the method &#8220;may be a coroutine&#8221; or &#8220;may return a
<a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>&#8221;):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">good_call</span><span class="p">():</span>
    <span class="c"># yield will unwrap the Future returned by divide() and raise</span>
    <span class="c"># the exception.</span>
    <span class="k">yield</span> <span class="n">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Sometimes you may want to &#8220;fire and forget&#8221; a coroutine without waiting
for its result. In this case it is recommended to use <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.spawn_callback" title="tornado.ioloop.IOLoop.spawn_callback"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.spawn_callback</span></code></a>,
which makes the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> responsible for the call. If it fails,
the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> will log a stack trace:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># The IOLoop will catch the exception and print a stack trace in</span>
<span class="c"># the logs. Note that this doesn&#39;t look like a normal call, since</span>
<span class="c"># we pass the function object to be called by the IOLoop.</span>
<span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">spawn_callback</span><span class="p">(</span><span class="n">divide</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, at the top level of a program, <em>if the `.IOLoop` is not yet
running,</em> you can start the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>, run the coroutine, and then
stop the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> with the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.run_sync" title="tornado.ioloop.IOLoop.run_sync"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.run_sync</span></code></a> method. This is often
used to start the <code class="docutils literal"><span class="pre">main</span></code> function of a batch-oriented program:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># run_sync() doesn&#39;t take arguments, so we must wrap the</span>
<span class="c"># call in a lambda.</span>
<span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">run_sync</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="coroutine-patterns">
<h5>Coroutine patterns<a class="headerlink" href="#coroutine-patterns" title="Permalink to this headline">¶</a></h5>
<div class="section" id="interaction-with-callbacks">
<h6>Interaction with callbacks<a class="headerlink" href="#interaction-with-callbacks" title="Permalink to this headline">¶</a></h6>
<p>To interact with asynchronous code that uses callbacks instead of
<a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>, wrap the call in a <a class="reference internal" href="index.html#tornado.gen.Task" title="tornado.gen.Task"><code class="xref py py-obj docutils literal"><span class="pre">Task</span></code></a>.  This will add the callback
argument for you and return a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> which you can yield:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">call_task</span><span class="p">():</span>
    <span class="c"># Note that there are no parens on some_function.</span>
    <span class="c"># This will be translated by Task into</span>
    <span class="c">#   some_function(other_args, callback=callback)</span>
    <span class="k">yield</span> <span class="n">gen</span><span class="o">.</span><span class="n">Task</span><span class="p">(</span><span class="n">some_function</span><span class="p">,</span> <span class="n">other_args</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="calling-blocking-functions">
<h6>Calling blocking functions<a class="headerlink" href="#calling-blocking-functions" title="Permalink to this headline">¶</a></h6>
<p>The simplest way to call a blocking function from a coroutine is to
use a <a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#concurrent.futures.ThreadPoolExecutor" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ThreadPoolExecutor</span></code></a>, which returns
<code class="docutils literal"><span class="pre">Futures</span></code> that are compatible with coroutines:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">thread_pool</span> <span class="o">=</span> <span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">call_blocking</span><span class="p">():</span>
    <span class="k">yield</span> <span class="n">thread_pool</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">blocking_func</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="parallelism">
<h6>Parallelism<a class="headerlink" href="#parallelism" title="Permalink to this headline">¶</a></h6>
<p>The coroutine decorator recognizes lists and dicts whose values are
<code class="docutils literal"><span class="pre">Futures</span></code>, and waits for all of those <code class="docutils literal"><span class="pre">Futures</span></code> in parallel:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">parallel_fetch</span><span class="p">(</span><span class="n">url1</span><span class="p">,</span> <span class="n">url2</span><span class="p">):</span>
    <span class="n">resp1</span><span class="p">,</span> <span class="n">resp2</span> <span class="o">=</span> <span class="k">yield</span> <span class="p">[</span><span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">url1</span><span class="p">),</span>
                          <span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">url2</span><span class="p">)]</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">parallel_fetch_many</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
    <span class="n">responses</span> <span class="o">=</span> <span class="k">yield</span> <span class="p">[</span><span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">]</span>
    <span class="c"># responses is a list of HTTPResponses in the same order</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">parallel_fetch_dict</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
    <span class="n">responses</span> <span class="o">=</span> <span class="k">yield</span> <span class="p">{</span><span class="n">url</span><span class="p">:</span> <span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">}</span>
    <span class="c"># responses is a dict {url: HTTPResponse}</span>
</pre></div>
</div>
</div>
<div class="section" id="interleaving">
<h6>Interleaving<a class="headerlink" href="#interleaving" title="Permalink to this headline">¶</a></h6>
<p>Sometimes it is useful to save a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> instead of yielding it
immediately, so you can start another operation before waiting:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">fetch_future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_next_chunk</span><span class="p">()</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">chunk</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">fetch_future</span>
        <span class="k">if</span> <span class="n">chunk</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">break</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
        <span class="n">fetch_future</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch_next_chunk</span><span class="p">()</span>
        <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="looping">
<h6>Looping<a class="headerlink" href="#looping" title="Permalink to this headline">¶</a></h6>
<p>Looping is tricky with coroutines since there is no way in Python
to <code class="docutils literal"><span class="pre">yield</span></code> on every iteration of a <code class="docutils literal"><span class="pre">for</span></code> or <code class="docutils literal"><span class="pre">while</span></code> loop and
capture the result of the yield.  Instead, you&#8217;ll need to separate
the loop condition from accessing the results, as in this example
from <a class="reference external" href="http://motor.readthedocs.org/en/stable/">Motor</a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">motor</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">motor</span><span class="o">.</span><span class="n">MotorClient</span><span class="p">()</span><span class="o">.</span><span class="n">test</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">loop_example</span><span class="p">(</span><span class="n">collection</span><span class="p">):</span>
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">collection</span><span class="o">.</span><span class="n">find</span><span class="p">()</span>
    <span class="k">while</span> <span class="p">(</span><span class="k">yield</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetch_next</span><span class="p">):</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">next_object</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="running-in-the-background">
<h6>Running in the background<a class="headerlink" href="#running-in-the-background" title="Permalink to this headline">¶</a></h6>
<p><a class="reference internal" href="index.html#tornado.ioloop.PeriodicCallback" title="tornado.ioloop.PeriodicCallback"><code class="xref py py-obj docutils literal"><span class="pre">PeriodicCallback</span></code></a> is not normally used with coroutines. Instead, a
coroutine can contain a <code class="docutils literal"><span class="pre">while</span> <span class="pre">True:</span></code> loop and use
<a class="reference internal" href="index.html#tornado.gen.sleep" title="tornado.gen.sleep"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.sleep</span></code></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">minute_loop</span><span class="p">():</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">do_something</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">gen</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>

<span class="c"># Coroutines that loop forever are generally started with</span>
<span class="c"># spawn_callback().</span>
<span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">spawn_callback</span><span class="p">(</span><span class="n">minute_loop</span><span class="p">)</span>
</pre></div>
</div>
<p>Sometimes a more complicated loop may be desirable. For example, the
previous loop runs every <code class="docutils literal"><span class="pre">60+N</span></code> seconds, where <code class="docutils literal"><span class="pre">N</span></code> is the running
time of <code class="docutils literal"><span class="pre">do_something()</span></code>. To run exactly every 60 seconds, use the
interleaving pattern from above:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">minute_loop2</span><span class="p">():</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">nxt</span> <span class="o">=</span> <span class="n">gen</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>   <span class="c"># Start the clock.</span>
        <span class="k">yield</span> <span class="n">do_something</span><span class="p">()</span>  <span class="c"># Run while the clock is ticking.</span>
        <span class="k">yield</span> <span class="n">nxt</span>             <span class="c"># Wait for the timer to run out.</span>
</pre></div>
</div>
</div>
</div>
</div>
<span id="document-guide/queues"></span><div class="section" id="queue-example-a-concurrent-web-spider">
<h4><a class="reference internal" href="index.html#tornado.queues.Queue" title="tornado.queues.Queue"><code class="xref py py-class docutils literal"><span class="pre">Queue</span></code></a> example - a concurrent web spider<a class="headerlink" href="#queue-example-a-concurrent-web-spider" title="Permalink to this headline">¶</a></h4>
<p>Tornado&#8217;s <a class="reference internal" href="index.html#module-tornado.queues" title="tornado.queues"><code class="xref py py-obj docutils literal"><span class="pre">tornado.queues</span></code></a> module implements an asynchronous producer /
consumer pattern for coroutines, analogous to the pattern implemented for
threads by the Python standard library&#8217;s <a class="reference external" href="https://docs.python.org/3.4/library/queue.html#module-queue" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">queue</span></code></a> module.</p>
<p>A coroutine that yields <a class="reference internal" href="index.html#tornado.queues.Queue.get" title="tornado.queues.Queue.get"><code class="xref py py-obj docutils literal"><span class="pre">Queue.get</span></code></a> pauses until there is an item in the queue.
If the queue has a maximum size set, a coroutine that yields <a class="reference internal" href="index.html#tornado.queues.Queue.put" title="tornado.queues.Queue.put"><code class="xref py py-obj docutils literal"><span class="pre">Queue.put</span></code></a> pauses
until there is room for another item.</p>
<p>A <a class="reference internal" href="index.html#tornado.queues.Queue" title="tornado.queues.Queue"><code class="xref py py-obj docutils literal"><span class="pre">Queue</span></code></a> maintains a count of unfinished tasks, which begins at zero.
<a class="reference internal" href="index.html#tornado.queues.Queue.put" title="tornado.queues.Queue.put"><code class="xref py py-obj docutils literal"><span class="pre">put</span></code></a> increments the count; <a class="reference internal" href="index.html#tornado.queues.Queue.task_done" title="tornado.queues.Queue.task_done"><code class="xref py py-obj docutils literal"><span class="pre">task_done</span></code></a> decrements it.</p>
<p>In the web-spider example here, the queue begins containing only base_url. When
a worker fetches a page it parses the links and puts new ones in the queue,
then calls <a class="reference internal" href="index.html#tornado.queues.Queue.task_done" title="tornado.queues.Queue.task_done"><code class="xref py py-obj docutils literal"><span class="pre">task_done</span></code></a> to decrement the counter once. Eventually, a
worker fetches a page whose URLs have all been seen before, and there is also
no work left in the queue. Thus that worker&#8217;s call to <a class="reference internal" href="index.html#tornado.queues.Queue.task_done" title="tornado.queues.Queue.task_done"><code class="xref py py-obj docutils literal"><span class="pre">task_done</span></code></a>
decrements the counter to zero. The main coroutine, which is waiting for
<a class="reference internal" href="index.html#tornado.queues.Queue.join" title="tornado.queues.Queue.join"><code class="xref py py-obj docutils literal"><span class="pre">join</span></code></a>, is unpaused and finishes.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">HTMLParser</span> <span class="kn">import</span> <span class="n">HTMLParser</span>
    <span class="kn">from</span> <span class="nn">urlparse</span> <span class="kn">import</span> <span class="n">urljoin</span><span class="p">,</span> <span class="n">urldefrag</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">html.parser</span> <span class="kn">import</span> <span class="n">HTMLParser</span>
    <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urljoin</span><span class="p">,</span> <span class="n">urldefrag</span>

<span class="kn">from</span> <span class="nn">tornado</span> <span class="kn">import</span> <span class="n">httpclient</span><span class="p">,</span> <span class="n">gen</span><span class="p">,</span> <span class="n">ioloop</span><span class="p">,</span> <span class="n">queues</span>

<span class="n">base_url</span> <span class="o">=</span> <span class="s">&#39;http://www.tornadoweb.org/en/stable/&#39;</span>
<span class="n">concurrency</span> <span class="o">=</span> <span class="mi">10</span>


<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">get_links_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Download the page at `url` and parse it for links.</span>

<span class="sd">    Returned links have had the fragment after `#` removed, and have been made</span>
<span class="sd">    absolute so, e.g. the URL &#39;gen.html#tornado.gen.coroutine&#39; becomes</span>
<span class="sd">    &#39;http://www.tornadoweb.org/en/stable/gen.html&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">httpclient</span><span class="o">.</span><span class="n">AsyncHTTPClient</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;fetched </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">url</span><span class="p">)</span>

        <span class="n">html</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">body</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> \
            <span class="k">else</span> <span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="n">urljoin</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">remove_fragment</span><span class="p">(</span><span class="n">new_url</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">new_url</span> <span class="ow">in</span> <span class="n">get_links</span><span class="p">(</span><span class="n">html</span><span class="p">)]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Exception: </span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">url</span><span class="p">))</span>
        <span class="k">raise</span> <span class="n">gen</span><span class="o">.</span><span class="n">Return</span><span class="p">([])</span>

    <span class="k">raise</span> <span class="n">gen</span><span class="o">.</span><span class="n">Return</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">remove_fragment</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">pure_url</span><span class="p">,</span> <span class="n">frag</span> <span class="o">=</span> <span class="n">urldefrag</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pure_url</span>


<span class="k">def</span> <span class="nf">get_links</span><span class="p">(</span><span class="n">html</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">URLSeeker</span><span class="p">(</span><span class="n">HTMLParser</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">HTMLParser</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">urls</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span> <span class="nf">handle_starttag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
            <span class="n">href</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">attrs</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;href&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">href</span> <span class="ow">and</span> <span class="n">tag</span> <span class="o">==</span> <span class="s">&#39;a&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">urls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">href</span><span class="p">)</span>

    <span class="n">url_seeker</span> <span class="o">=</span> <span class="n">URLSeeker</span><span class="p">()</span>
    <span class="n">url_seeker</span><span class="o">.</span><span class="n">feed</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">url_seeker</span><span class="o">.</span><span class="n">urls</span>


<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">queues</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">fetching</span><span class="p">,</span> <span class="n">fetched</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(),</span> <span class="nb">set</span><span class="p">()</span>

    <span class="nd">@gen.coroutine</span>
    <span class="k">def</span> <span class="nf">fetch_url</span><span class="p">():</span>
        <span class="n">current_url</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">q</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">current_url</span> <span class="ow">in</span> <span class="n">fetching</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="k">print</span><span class="p">(</span><span class="s">&#39;fetching </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">current_url</span><span class="p">)</span>
            <span class="n">fetching</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">current_url</span><span class="p">)</span>
            <span class="n">urls</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">get_links_from_url</span><span class="p">(</span><span class="n">current_url</span><span class="p">)</span>
            <span class="n">fetched</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">current_url</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">new_url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
                <span class="c"># Only follow links beneath the base URL</span>
                <span class="k">if</span> <span class="n">new_url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">base_url</span><span class="p">):</span>
                    <span class="k">yield</span> <span class="n">q</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">new_url</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="n">q</span><span class="o">.</span><span class="n">task_done</span><span class="p">()</span>

    <span class="nd">@gen.coroutine</span>
    <span class="k">def</span> <span class="nf">worker</span><span class="p">():</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">fetch_url</span><span class="p">()</span>

    <span class="n">q</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">base_url</span><span class="p">)</span>

    <span class="c"># Start workers, then wait for the work queue to be empty.</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">concurrency</span><span class="p">):</span>
        <span class="n">worker</span><span class="p">()</span>
    <span class="k">yield</span> <span class="n">q</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">300</span><span class="p">))</span>
    <span class="k">assert</span> <span class="n">fetching</span> <span class="o">==</span> <span class="n">fetched</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Done in </span><span class="si">%d</span><span class="s"> seconds, fetched </span><span class="si">%s</span><span class="s"> URLs.&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fetched</span><span class="p">)))</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">logging</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">()</span>
    <span class="n">io_loop</span> <span class="o">=</span> <span class="n">ioloop</span><span class="o">.</span><span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span>
    <span class="n">io_loop</span><span class="o">.</span><span class="n">run_sync</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
</pre></div>
</div>
</div>
<span id="document-guide/structure"></span><div class="section" id="structure-of-a-tornado-web-application">
<h4>Structure of a Tornado web application<a class="headerlink" href="#structure-of-a-tornado-web-application" title="Permalink to this headline">¶</a></h4>
<p>A Tornado web application generally consists of one or more
<a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> subclasses, an <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> object which
routes incoming requests to handlers, and a <code class="docutils literal"><span class="pre">main()</span></code> function
to start the server.</p>
<p>A minimal &#8220;hello world&#8221; example looks something like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">tornado.ioloop</span>
<span class="kn">import</span> <span class="nn">tornado.web</span>

<span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Hello, world&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">make_app</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
        <span class="p">(</span><span class="s">r&quot;/&quot;</span><span class="p">,</span> <span class="n">MainHandler</span><span class="p">),</span>
    <span class="p">])</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">make_app</span><span class="p">()</span>
    <span class="n">app</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">8888</span><span class="p">)</span>
    <span class="n">tornado</span><span class="o">.</span><span class="n">ioloop</span><span class="o">.</span><span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="the-application-object">
<h5>The <code class="docutils literal"><span class="pre">Application</span></code> object<a class="headerlink" href="#the-application-object" title="Permalink to this headline">¶</a></h5>
<p>The <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> object is responsible for global configuration, including
the routing table that maps requests to handlers.</p>
<p>The routing table is a list of <a class="reference internal" href="index.html#tornado.web.URLSpec" title="tornado.web.URLSpec"><code class="xref py py-obj docutils literal"><span class="pre">URLSpec</span></code></a> objects (or tuples), each of
which contains (at least) a regular expression and a handler class.
Order matters; the first matching rule is used.  If the regular
expression contains capturing groups, these groups are the <em>path
arguments</em> and will be passed to the handler&#8217;s HTTP method.  If a
dictionary is passed as the third element of the <a class="reference internal" href="index.html#tornado.web.URLSpec" title="tornado.web.URLSpec"><code class="xref py py-obj docutils literal"><span class="pre">URLSpec</span></code></a>, it
supplies the <em>initialization arguments</em> which will be passed to
<a class="reference internal" href="index.html#tornado.web.RequestHandler.initialize" title="tornado.web.RequestHandler.initialize"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.initialize</span></code></a>.  Finally, the <a class="reference internal" href="index.html#tornado.web.URLSpec" title="tornado.web.URLSpec"><code class="xref py py-obj docutils literal"><span class="pre">URLSpec</span></code></a> may have a
name, which will allow it to be used with
<a class="reference internal" href="index.html#tornado.web.RequestHandler.reverse_url" title="tornado.web.RequestHandler.reverse_url"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.reverse_url</span></code></a>.</p>
<p>For example, in this fragment the root URL <code class="docutils literal"><span class="pre">/</span></code> is mapped to
<code class="docutils literal"><span class="pre">MainHandler</span></code> and URLs of the form <code class="docutils literal"><span class="pre">/story/</span></code> followed by a number
are mapped to <code class="docutils literal"><span class="pre">StoryHandler</span></code>.  That number is passed (as a string) to
<code class="docutils literal"><span class="pre">StoryHandler.get</span></code>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&lt;a href=&quot;</span><span class="si">%s</span><span class="s">&quot;&gt;link to story 1&lt;/a&gt;&#39;</span> <span class="o">%</span>
                   <span class="bp">self</span><span class="o">.</span><span class="n">reverse_url</span><span class="p">(</span><span class="s">&quot;story&quot;</span><span class="p">,</span> <span class="s">&quot;1&quot;</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">StoryHandler</span><span class="p">(</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">db</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">db</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">story_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;this is story </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">story_id</span><span class="p">)</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">([</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&quot;/&quot;</span><span class="p">,</span> <span class="n">MainHandler</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&quot;/story/([0-9]+)&quot;</span><span class="p">,</span> <span class="n">StoryHandler</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="n">db</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;story&quot;</span><span class="p">)</span>
    <span class="p">])</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> constructor takes many keyword arguments that
can be used to customize the behavior of the application and enable
optional features; see <a class="reference internal" href="index.html#tornado.web.Application.settings" title="tornado.web.Application.settings"><code class="xref py py-obj docutils literal"><span class="pre">Application.settings</span></code></a> for the complete list.</p>
</div>
<div class="section" id="subclassing-requesthandler">
<h5>Subclassing <code class="docutils literal"><span class="pre">RequestHandler</span></code><a class="headerlink" href="#subclassing-requesthandler" title="Permalink to this headline">¶</a></h5>
<p>Most of the work of a Tornado web application is done in subclasses
of <a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a>.  The main entry point for a handler subclass
is a method named after the HTTP method being handled: <code class="docutils literal"><span class="pre">get()</span></code>,
<code class="docutils literal"><span class="pre">post()</span></code>, etc.  Each handler may define one or more of these methods
to handle different HTTP actions.  As described above, these methods
will be called with arguments corresponding to the capturing groups
of the routing rule that matched.</p>
<p>Within a handler, call methods such as <a class="reference internal" href="index.html#tornado.web.RequestHandler.render" title="tornado.web.RequestHandler.render"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.render</span></code></a> or
<a class="reference internal" href="index.html#tornado.web.RequestHandler.write" title="tornado.web.RequestHandler.write"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.write</span></code></a> to produce a response.  <code class="docutils literal"><span class="pre">render()</span></code> loads a
<a class="reference internal" href="index.html#tornado.template.Template" title="tornado.template.Template"><code class="xref py py-obj docutils literal"><span class="pre">Template</span></code></a> by name and renders it with the given
arguments. <code class="docutils literal"><span class="pre">write()</span></code> is used for non-template-based output; it
accepts strings, bytes, and dictionaries (dicts will be encoded as
JSON).</p>
<p>Many methods in <a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> are designed to be overridden in
subclasses and be used throughout the application.  It is common
to define a <code class="docutils literal"><span class="pre">BaseHandler</span></code> class that overrides methods such as
<a class="reference internal" href="index.html#tornado.web.RequestHandler.write_error" title="tornado.web.RequestHandler.write_error"><code class="xref py py-obj docutils literal"><span class="pre">write_error</span></code></a> and <a class="reference internal" href="index.html#tornado.web.RequestHandler.get_current_user" title="tornado.web.RequestHandler.get_current_user"><code class="xref py py-obj docutils literal"><span class="pre">get_current_user</span></code></a>
and then subclass your own <code class="docutils literal"><span class="pre">BaseHandler</span></code> instead of <a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a>
for all your specific handlers.</p>
</div>
<div class="section" id="handling-request-input">
<h5>Handling request input<a class="headerlink" href="#handling-request-input" title="Permalink to this headline">¶</a></h5>
<p>The request handler can access the object representing the current
request with <code class="docutils literal"><span class="pre">self.request</span></code>.  See the class definition for
<a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest" title="tornado.httputil.HTTPServerRequest"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerRequest</span></code></a> for a complete list of
attributes.</p>
<p>Request data in the formats used by HTML forms will be parsed for you
and is made available in methods like <a class="reference internal" href="index.html#tornado.web.RequestHandler.get_query_argument" title="tornado.web.RequestHandler.get_query_argument"><code class="xref py py-obj docutils literal"><span class="pre">get_query_argument</span></code></a>
and <a class="reference internal" href="index.html#tornado.web.RequestHandler.get_body_argument" title="tornado.web.RequestHandler.get_body_argument"><code class="xref py py-obj docutils literal"><span class="pre">get_body_argument</span></code></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyFormHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&lt;html&gt;&lt;body&gt;&lt;form action=&quot;/myform&quot; method=&quot;POST&quot;&gt;&#39;</span>
                   <span class="s">&#39;&lt;input type=&quot;text&quot; name=&quot;message&quot;&gt;&#39;</span>
                   <span class="s">&#39;&lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;&#39;</span>
                   <span class="s">&#39;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s">&quot;text/plain&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;You wrote &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_body_argument</span><span class="p">(</span><span class="s">&quot;message&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Since the HTML form encoding is ambiguous as to whether an argument is
a single value or a list with one element, <a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> has
distinct methods to allow the application to indicate whether or not
it expects a list.  For lists, use
<a class="reference internal" href="index.html#tornado.web.RequestHandler.get_query_arguments" title="tornado.web.RequestHandler.get_query_arguments"><code class="xref py py-obj docutils literal"><span class="pre">get_query_arguments</span></code></a> and
<a class="reference internal" href="index.html#tornado.web.RequestHandler.get_body_arguments" title="tornado.web.RequestHandler.get_body_arguments"><code class="xref py py-obj docutils literal"><span class="pre">get_body_arguments</span></code></a> instead of their singular
counterparts.</p>
<p>Files uploaded via a form are available in <code class="docutils literal"><span class="pre">self.request.files</span></code>,
which maps names (the name of the HTML <code class="docutils literal"><span class="pre">&lt;input</span> <span class="pre">type=&quot;file&quot;&gt;</span></code>
element) to a list of files. Each file is a dictionary of the form
<code class="docutils literal"><span class="pre">{&quot;filename&quot;:...,</span> <span class="pre">&quot;content_type&quot;:...,</span> <span class="pre">&quot;body&quot;:...}</span></code>.  The <code class="docutils literal"><span class="pre">files</span></code>
object is only present if the files were uploaded with a form wrapper
(i.e. a <code class="docutils literal"><span class="pre">multipart/form-data</span></code> Content-Type); if this format was not used
the raw uploaded data is available in <code class="docutils literal"><span class="pre">self.request.body</span></code>.
By default uploaded files are fully buffered in memory; if you need to
handle files that are too large to comfortably keep in memory see the
<a class="reference internal" href="index.html#tornado.web.stream_request_body" title="tornado.web.stream_request_body"><code class="xref py py-obj docutils literal"><span class="pre">stream_request_body</span></code></a> class decorator.</p>
<p>Due to the quirks of the HTML form encoding (e.g. the ambiguity around
singular versus plural arguments), Tornado does not attempt to unify
form arguments with other types of input.  In particular, we do not
parse JSON request bodies.  Applications that wish to use JSON instead
of form-encoding may override <a class="reference internal" href="index.html#tornado.web.RequestHandler.prepare" title="tornado.web.RequestHandler.prepare"><code class="xref py py-obj docutils literal"><span class="pre">prepare</span></code></a> to parse their
requests:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&quot;Content-Type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;application/json&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">json_args</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">json_args</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>
</div>
</div>
<div class="section" id="overriding-requesthandler-methods">
<h5>Overriding RequestHandler methods<a class="headerlink" href="#overriding-requesthandler-methods" title="Permalink to this headline">¶</a></h5>
<p>In addition to <code class="docutils literal"><span class="pre">get()</span></code>/<code class="docutils literal"><span class="pre">post()</span></code>/etc, certain other methods in
<a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> are designed to be overridden by subclasses when
necessary. On every request, the following sequence of calls takes
place:</p>
<ol class="arabic simple">
<li>A new <a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> object is created on each request</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.initialize" title="tornado.web.RequestHandler.initialize"><code class="xref py py-obj docutils literal"><span class="pre">initialize()</span></code></a> is called with the initialization
arguments from the <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> configuration. <code class="docutils literal"><span class="pre">initialize</span></code>
should typically just save the arguments passed into member
variables; it may not produce any output or call methods like
<a class="reference internal" href="index.html#tornado.web.RequestHandler.send_error" title="tornado.web.RequestHandler.send_error"><code class="xref py py-obj docutils literal"><span class="pre">send_error</span></code></a>.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.prepare" title="tornado.web.RequestHandler.prepare"><code class="xref py py-obj docutils literal"><span class="pre">prepare()</span></code></a> is called. This is most useful in a
base class shared by all of your handler subclasses, as <code class="docutils literal"><span class="pre">prepare</span></code>
is called no matter which HTTP method is used. <code class="docutils literal"><span class="pre">prepare</span></code> may
produce output; if it calls <a class="reference internal" href="index.html#tornado.web.RequestHandler.finish" title="tornado.web.RequestHandler.finish"><code class="xref py py-obj docutils literal"><span class="pre">finish</span></code></a> (or
<code class="docutils literal"><span class="pre">redirect</span></code>, etc), processing stops here.</li>
<li>One of the HTTP methods is called: <code class="docutils literal"><span class="pre">get()</span></code>, <code class="docutils literal"><span class="pre">post()</span></code>, <code class="docutils literal"><span class="pre">put()</span></code>,
etc. If the URL regular expression contains capturing groups, they
are passed as arguments to this method.</li>
<li>When the request is finished, <a class="reference internal" href="index.html#tornado.web.RequestHandler.on_finish" title="tornado.web.RequestHandler.on_finish"><code class="xref py py-obj docutils literal"><span class="pre">on_finish()</span></code></a> is
called.  For synchronous handlers this is immediately after
<code class="docutils literal"><span class="pre">get()</span></code> (etc) return; for asynchronous handlers it is after the
call to <a class="reference internal" href="index.html#tornado.web.RequestHandler.finish" title="tornado.web.RequestHandler.finish"><code class="xref py py-obj docutils literal"><span class="pre">finish()</span></code></a>.</li>
</ol>
<p>All methods designed to be overridden are noted as such in the
<a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> documentation.  Some of the most commonly
overridden methods include:</p>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.write_error" title="tornado.web.RequestHandler.write_error"><code class="xref py py-obj docutils literal"><span class="pre">write_error</span></code></a> -
outputs HTML for use on error pages.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.on_connection_close" title="tornado.web.RequestHandler.on_connection_close"><code class="xref py py-obj docutils literal"><span class="pre">on_connection_close</span></code></a> - called when the client
disconnects; applications may choose to detect this case and halt
further processing.  Note that there is no guarantee that a closed
connection can be detected promptly.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.get_current_user" title="tornado.web.RequestHandler.get_current_user"><code class="xref py py-obj docutils literal"><span class="pre">get_current_user</span></code></a> - see <a class="reference internal" href="index.html#user-authentication"><span>User authentication</span></a></li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.get_user_locale" title="tornado.web.RequestHandler.get_user_locale"><code class="xref py py-obj docutils literal"><span class="pre">get_user_locale</span></code></a> - returns <a class="reference internal" href="index.html#tornado.locale.Locale" title="tornado.locale.Locale"><code class="xref py py-obj docutils literal"><span class="pre">Locale</span></code></a> object to use
for the current user</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.set_default_headers" title="tornado.web.RequestHandler.set_default_headers"><code class="xref py py-obj docutils literal"><span class="pre">set_default_headers</span></code></a> - may be used to set
additional headers on the response (such as a custom <code class="docutils literal"><span class="pre">Server</span></code>
header)</li>
</ul>
</div>
<div class="section" id="error-handling">
<h5>Error Handling<a class="headerlink" href="#error-handling" title="Permalink to this headline">¶</a></h5>
<p>If a handler raises an exception, Tornado will call
<a class="reference internal" href="index.html#tornado.web.RequestHandler.write_error" title="tornado.web.RequestHandler.write_error"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.write_error</span></code></a> to generate an error page.
<a class="reference internal" href="index.html#tornado.web.HTTPError" title="tornado.web.HTTPError"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.HTTPError</span></code></a> can be used to generate a specified status
code; all other exceptions return a 500 status.</p>
<p>The default error page includes a stack trace in debug mode and a
one-line description of the error (e.g. &#8220;500: Internal Server Error&#8221;)
otherwise.  To produce a custom error page, override
<a class="reference internal" href="index.html#tornado.web.RequestHandler.write_error" title="tornado.web.RequestHandler.write_error"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.write_error</span></code></a> (probably in a base class shared by all
your handlers).  This method may produce output normally via
methods such as <a class="reference internal" href="index.html#tornado.web.RequestHandler.write" title="tornado.web.RequestHandler.write"><code class="xref py py-obj docutils literal"><span class="pre">write</span></code></a> and <a class="reference internal" href="index.html#tornado.web.RequestHandler.render" title="tornado.web.RequestHandler.render"><code class="xref py py-obj docutils literal"><span class="pre">render</span></code></a>.
If the error was caused by an exception, an <code class="docutils literal"><span class="pre">exc_info</span></code> triple will
be passed as a keyword argument (note that this exception is not
guaranteed to be the current exception in <a class="reference external" href="https://docs.python.org/3.4/library/sys.html#sys.exc_info" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">sys.exc_info</span></code></a>, so
<code class="docutils literal"><span class="pre">write_error</span></code> must use e.g.  <a class="reference external" href="https://docs.python.org/3.4/library/traceback.html#traceback.format_exception" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">traceback.format_exception</span></code></a> instead of
<a class="reference external" href="https://docs.python.org/3.4/library/traceback.html#traceback.format_exc" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">traceback.format_exc</span></code></a>).</p>
<p>It is also possible to generate an error page from regular handler
methods instead of <code class="docutils literal"><span class="pre">write_error</span></code> by calling
<a class="reference internal" href="index.html#tornado.web.RequestHandler.set_status" title="tornado.web.RequestHandler.set_status"><code class="xref py py-obj docutils literal"><span class="pre">set_status</span></code></a>, writing a response, and returning.
The special exception <a class="reference internal" href="index.html#tornado.web.Finish" title="tornado.web.Finish"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.Finish</span></code></a> may be raised to terminate
the handler without calling <code class="docutils literal"><span class="pre">write_error</span></code> in situations where simply
returning is not convenient.</p>
<p>For 404 errors, use the <code class="docutils literal"><span class="pre">default_handler_class</span></code> <a class="reference internal" href="index.html#tornado.web.Application.settings" title="tornado.web.Application.settings"><code class="xref py py-obj docutils literal"><span class="pre">Application</span> <span class="pre">setting</span></code></a>.  This handler should override
<a class="reference internal" href="index.html#tornado.web.RequestHandler.prepare" title="tornado.web.RequestHandler.prepare"><code class="xref py py-obj docutils literal"><span class="pre">prepare</span></code></a> instead of a more specific method like
<code class="docutils literal"><span class="pre">get()</span></code> so it works with any HTTP method.  It should produce its
error page as described above: either by raising a <code class="docutils literal"><span class="pre">HTTPError(404)</span></code>
and overriding <code class="docutils literal"><span class="pre">write_error</span></code>, or calling <code class="docutils literal"><span class="pre">self.set_status(404)</span></code>
and producing the response directly in <code class="docutils literal"><span class="pre">prepare()</span></code>.</p>
</div>
<div class="section" id="redirection">
<h5>Redirection<a class="headerlink" href="#redirection" title="Permalink to this headline">¶</a></h5>
<p>There are two main ways you can redirect requests in Tornado:
<a class="reference internal" href="index.html#tornado.web.RequestHandler.redirect" title="tornado.web.RequestHandler.redirect"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.redirect</span></code></a> and with the <a class="reference internal" href="index.html#tornado.web.RedirectHandler" title="tornado.web.RedirectHandler"><code class="xref py py-obj docutils literal"><span class="pre">RedirectHandler</span></code></a>.</p>
<p>You can use <code class="docutils literal"><span class="pre">self.redirect()</span></code> within a <a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> method to
redirect users elsewhere. There is also an optional parameter
<code class="docutils literal"><span class="pre">permanent</span></code> which you can use to indicate that the redirection is
considered permanent.  The default value of <code class="docutils literal"><span class="pre">permanent</span></code> is
<code class="docutils literal"><span class="pre">False</span></code>, which generates a <code class="docutils literal"><span class="pre">302</span> <span class="pre">Found</span></code> HTTP response code and is
appropriate for things like redirecting users after successful
<code class="docutils literal"><span class="pre">POST</span></code> requests.  If <code class="docutils literal"><span class="pre">permanent</span></code> is true, the <code class="docutils literal"><span class="pre">301</span> <span class="pre">Moved</span>
<span class="pre">Permanently</span></code> HTTP response code is used, which is useful for
e.g. redirecting to a canonical URL for a page in an SEO-friendly
manner.</p>
<p><a class="reference internal" href="index.html#tornado.web.RedirectHandler" title="tornado.web.RedirectHandler"><code class="xref py py-obj docutils literal"><span class="pre">RedirectHandler</span></code></a> lets you configure redirects directly in your
<a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> routing table.  For example, to configure a single
static redirect:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&quot;/app&quot;</span><span class="p">,</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RedirectHandler</span><span class="p">,</span>
        <span class="nb">dict</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s">&quot;http://itunes.apple.com/my-app-id&quot;</span><span class="p">)),</span>
    <span class="p">])</span>
</pre></div>
</div>
<p><a class="reference internal" href="index.html#tornado.web.RedirectHandler" title="tornado.web.RedirectHandler"><code class="xref py py-obj docutils literal"><span class="pre">RedirectHandler</span></code></a> also supports regular expression substitutions.
The following rule redirects all requests beginning with <code class="docutils literal"><span class="pre">/pictures/</span></code>
to the prefix <code class="docutils literal"><span class="pre">/photos/</span></code> instead:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">app</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&quot;/photos/(.*)&quot;</span><span class="p">,</span> <span class="n">MyPhotoHandler</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&quot;/pictures/(.*)&quot;</span><span class="p">,</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RedirectHandler</span><span class="p">,</span>
        <span class="nb">dict</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s">r&quot;/photos/\1&quot;</span><span class="p">)),</span>
    <span class="p">])</span>
</pre></div>
</div>
<p>Unlike <a class="reference internal" href="index.html#tornado.web.RequestHandler.redirect" title="tornado.web.RequestHandler.redirect"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.redirect</span></code></a>, <a class="reference internal" href="index.html#tornado.web.RedirectHandler" title="tornado.web.RedirectHandler"><code class="xref py py-obj docutils literal"><span class="pre">RedirectHandler</span></code></a> uses permanent
redirects by default.  This is because the routing table does not change
at runtime and is presumed to be permanent, while redirects found in
handlers are likely to be the result of other logic that may change.
To send a temporary redirect with a <a class="reference internal" href="index.html#tornado.web.RedirectHandler" title="tornado.web.RedirectHandler"><code class="xref py py-obj docutils literal"><span class="pre">RedirectHandler</span></code></a>, add
<code class="docutils literal"><span class="pre">permanent=False</span></code> to the <a class="reference internal" href="index.html#tornado.web.RedirectHandler" title="tornado.web.RedirectHandler"><code class="xref py py-obj docutils literal"><span class="pre">RedirectHandler</span></code></a> initialization arguments.</p>
</div>
<div class="section" id="asynchronous-handlers">
<h5>Asynchronous handlers<a class="headerlink" href="#asynchronous-handlers" title="Permalink to this headline">¶</a></h5>
<p>Tornado handlers are synchronous by default: when the
<code class="docutils literal"><span class="pre">get()</span></code>/<code class="docutils literal"><span class="pre">post()</span></code> method returns, the request is considered
finished and the response is sent.  Since all other requests are
blocked while one handler is running, any long-running handler should
be made asynchronous so it can call its slow operations in a
non-blocking way.  This topic is covered in more detail in
<a class="reference internal" href="index.html#document-guide/async"><em>Asynchronous and non-Blocking I/O</em></a>; this section is about the particulars of
asynchronous techniques in <a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> subclasses.</p>
<p>The simplest way to make a handler asynchronous is to use the
<a class="reference internal" href="index.html#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">coroutine</span></code></a> decorator.  This allows you to perform non-blocking I/O
with the <code class="docutils literal"><span class="pre">yield</span></code> keyword, and no response will be sent until the
coroutine has returned.  See <a class="reference internal" href="index.html#document-guide/coroutines"><em>Coroutines</em></a> for more details.</p>
<p>In some cases, coroutines may be less convenient than a
callback-oriented style, in which case the <a class="reference internal" href="index.html#tornado.web.asynchronous" title="tornado.web.asynchronous"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.asynchronous</span></code></a>
decorator can be used instead.  When this decorator is used the response
is not automatically sent; instead the request will be kept open until
some callback calls <a class="reference internal" href="index.html#tornado.web.RequestHandler.finish" title="tornado.web.RequestHandler.finish"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.finish</span></code></a>.  It is up to the application
to ensure that this method is called, or else the user&#8217;s browser will
simply hang.</p>
<p>Here is an example that makes a call to the FriendFeed API using
Tornado&#8217;s built-in <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="nd">@tornado.web.asynchronous</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">http</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">httpclient</span><span class="o">.</span><span class="n">AsyncHTTPClient</span><span class="p">()</span>
        <span class="n">http</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s">&quot;http://friendfeed-api.com/v2/feed/bret&quot;</span><span class="p">,</span>
                   <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">error</span><span class="p">:</span> <span class="k">raise</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
        <span class="n">json</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">escape</span><span class="o">.</span><span class="n">json_decode</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Fetched &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s">&quot;entries&quot;</span><span class="p">]))</span> <span class="o">+</span> <span class="s">&quot; entries &quot;</span>
                   <span class="s">&quot;from the FriendFeed API&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span>
</pre></div>
</div>
<p>When <code class="docutils literal"><span class="pre">get()</span></code> returns, the request has not finished. When the HTTP
client eventually calls <code class="docutils literal"><span class="pre">on_response()</span></code>, the request is still open,
and the response is finally flushed to the client with the call to
<code class="docutils literal"><span class="pre">self.finish()</span></code>.</p>
<p>For comparison, here is the same example using a coroutine:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="nd">@tornado.gen.coroutine</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">http</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">httpclient</span><span class="o">.</span><span class="n">AsyncHTTPClient</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">http</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s">&quot;http://friendfeed-api.com/v2/feed/bret&quot;</span><span class="p">)</span>
        <span class="n">json</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">escape</span><span class="o">.</span><span class="n">json_decode</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Fetched &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s">&quot;entries&quot;</span><span class="p">]))</span> <span class="o">+</span> <span class="s">&quot; entries &quot;</span>
                   <span class="s">&quot;from the FriendFeed API&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>For a more advanced asynchronous example, take a look at the <a class="reference external" href="https://github.com/tornadoweb/tornado/tree/stable/demos/chat">chat
example application</a>, which
implements an AJAX chat room using <a class="reference external" href="http://en.wikipedia.org/wiki/Push_technology#Long_polling">long polling</a>.  Users
of long polling may want to override <code class="docutils literal"><span class="pre">on_connection_close()</span></code> to
clean up after the client closes the connection (but see that method&#8217;s
docstring for caveats).</p>
</div>
</div>
<span id="document-guide/templates"></span><div class="section" id="templates-and-ui">
<h4>Templates and UI<a class="headerlink" href="#templates-and-ui" title="Permalink to this headline">¶</a></h4>
<p>Tornado includes a simple, fast, and flexible templating language.
This section describes that language as well as related issues
such as internationalization.</p>
<p>Tornado can also be used with any other Python template language,
although there is no provision for integrating these systems into
<a class="reference internal" href="index.html#tornado.web.RequestHandler.render" title="tornado.web.RequestHandler.render"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.render</span></code></a>.  Simply render the template to a string
and pass it to <a class="reference internal" href="index.html#tornado.web.RequestHandler.write" title="tornado.web.RequestHandler.write"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.write</span></code></a></p>
<div class="section" id="configuring-templates">
<h5>Configuring templates<a class="headerlink" href="#configuring-templates" title="Permalink to this headline">¶</a></h5>
<p>By default, Tornado looks for template files in the same directory as
the <code class="docutils literal"><span class="pre">.py</span></code> files that refer to them.  To put your template files in a
different directory, use the <code class="docutils literal"><span class="pre">template_path</span></code> <a class="reference internal" href="index.html#tornado.web.Application.settings" title="tornado.web.Application.settings"><code class="xref py py-obj docutils literal"><span class="pre">Application</span> <span class="pre">setting</span></code></a> (or override <a class="reference internal" href="index.html#tornado.web.RequestHandler.get_template_path" title="tornado.web.RequestHandler.get_template_path"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_template_path</span></code></a>
if you have different template paths for different handlers).</p>
<p>To load templates from a non-filesystem location, subclass
<a class="reference internal" href="index.html#tornado.template.BaseLoader" title="tornado.template.BaseLoader"><code class="xref py py-obj docutils literal"><span class="pre">tornado.template.BaseLoader</span></code></a> and pass an instance as the
<code class="docutils literal"><span class="pre">template_loader</span></code> application setting.</p>
<p>Compiled templates are cached by default; to turn off this caching
and reload templates so changes to the underlying files are always
visible, use the application settings <code class="docutils literal"><span class="pre">compiled_template_cache=False</span></code>
or <code class="docutils literal"><span class="pre">debug=True</span></code>.</p>
</div>
<div class="section" id="template-syntax">
<h5>Template syntax<a class="headerlink" href="#template-syntax" title="Permalink to this headline">¶</a></h5>
<p>A Tornado template is just HTML (or any other text-based format) with
Python control sequences and expressions embedded within the markup:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;html&gt;
   &lt;head&gt;
      &lt;title&gt;{{ title }}&lt;/title&gt;
   &lt;/head&gt;
   &lt;body&gt;
     &lt;ul&gt;
       {% for item in items %}
         &lt;li&gt;{{ escape(item) }}&lt;/li&gt;
       {% end %}
     &lt;/ul&gt;
   &lt;/body&gt;
 &lt;/html&gt;
</pre></div>
</div>
<p>If you saved this template as &#8220;template.html&#8221; and put it in the same
directory as your Python file, you could render this template with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">items</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;Item 1&quot;</span><span class="p">,</span> <span class="s">&quot;Item 2&quot;</span><span class="p">,</span> <span class="s">&quot;Item 3&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s">&quot;template.html&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;My title&quot;</span><span class="p">,</span> <span class="n">items</span><span class="o">=</span><span class="n">items</span><span class="p">)</span>
</pre></div>
</div>
<p>Tornado templates support <em>control statements</em> and <em>expressions</em>.
Control statements are surrounded by <code class="docutils literal"><span class="pre">{%</span></code> and <code class="docutils literal"><span class="pre">%}</span></code>, e.g.,
<code class="docutils literal"><span class="pre">{%</span> <span class="pre">if</span> <span class="pre">len(items)</span> <span class="pre">&gt;</span> <span class="pre">2</span> <span class="pre">%}</span></code>. Expressions are surrounded by <code class="docutils literal"><span class="pre">{{</span></code> and
<code class="docutils literal"><span class="pre">}}</span></code>, e.g., <code class="docutils literal"><span class="pre">{{</span> <span class="pre">items[0]</span> <span class="pre">}}</span></code>.</p>
<p>Control statements more or less map exactly to Python statements. We
support <code class="docutils literal"><span class="pre">if</span></code>, <code class="docutils literal"><span class="pre">for</span></code>, <code class="docutils literal"><span class="pre">while</span></code>, and <code class="docutils literal"><span class="pre">try</span></code>, all of which are
terminated with <code class="docutils literal"><span class="pre">{%</span> <span class="pre">end</span> <span class="pre">%}</span></code>. We also support <em>template inheritance</em>
using the <code class="docutils literal"><span class="pre">extends</span></code> and <code class="docutils literal"><span class="pre">block</span></code> statements, which are described in
detail in the documentation for the <a class="reference internal" href="index.html#module-tornado.template" title="tornado.template"><code class="xref py py-obj docutils literal"><span class="pre">tornado.template</span></code></a>.</p>
<p>Expressions can be any Python expression, including function calls.
Template code is executed in a namespace that includes the following
objects and functions (Note that this list applies to templates
rendered using <a class="reference internal" href="index.html#tornado.web.RequestHandler.render" title="tornado.web.RequestHandler.render"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.render</span></code></a> and
<a class="reference internal" href="index.html#tornado.web.RequestHandler.render_string" title="tornado.web.RequestHandler.render_string"><code class="xref py py-obj docutils literal"><span class="pre">render_string</span></code></a>. If you&#8217;re using the
<a class="reference internal" href="index.html#module-tornado.template" title="tornado.template"><code class="xref py py-obj docutils literal"><span class="pre">tornado.template</span></code></a> module directly outside of a <a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> many
of these entries are not present).</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">escape</span></code>: alias for <a class="reference internal" href="index.html#tornado.escape.xhtml_escape" title="tornado.escape.xhtml_escape"><code class="xref py py-obj docutils literal"><span class="pre">tornado.escape.xhtml_escape</span></code></a></li>
<li><code class="docutils literal"><span class="pre">xhtml_escape</span></code>: alias for <a class="reference internal" href="index.html#tornado.escape.xhtml_escape" title="tornado.escape.xhtml_escape"><code class="xref py py-obj docutils literal"><span class="pre">tornado.escape.xhtml_escape</span></code></a></li>
<li><code class="docutils literal"><span class="pre">url_escape</span></code>: alias for <a class="reference internal" href="index.html#tornado.escape.url_escape" title="tornado.escape.url_escape"><code class="xref py py-obj docutils literal"><span class="pre">tornado.escape.url_escape</span></code></a></li>
<li><code class="docutils literal"><span class="pre">json_encode</span></code>: alias for <a class="reference internal" href="index.html#tornado.escape.json_encode" title="tornado.escape.json_encode"><code class="xref py py-obj docutils literal"><span class="pre">tornado.escape.json_encode</span></code></a></li>
<li><code class="docutils literal"><span class="pre">squeeze</span></code>: alias for <a class="reference internal" href="index.html#tornado.escape.squeeze" title="tornado.escape.squeeze"><code class="xref py py-obj docutils literal"><span class="pre">tornado.escape.squeeze</span></code></a></li>
<li><code class="docutils literal"><span class="pre">linkify</span></code>: alias for <a class="reference internal" href="index.html#tornado.escape.linkify" title="tornado.escape.linkify"><code class="xref py py-obj docutils literal"><span class="pre">tornado.escape.linkify</span></code></a></li>
<li><code class="docutils literal"><span class="pre">datetime</span></code>: the Python <a class="reference external" href="https://docs.python.org/3.4/library/datetime.html#module-datetime" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">datetime</span></code></a> module</li>
<li><code class="docutils literal"><span class="pre">handler</span></code>: the current <a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> object</li>
<li><code class="docutils literal"><span class="pre">request</span></code>: alias for <a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest" title="tornado.httputil.HTTPServerRequest"><code class="xref py py-obj docutils literal"><span class="pre">handler.request</span></code></a></li>
<li><code class="docutils literal"><span class="pre">current_user</span></code>: alias for <a class="reference internal" href="index.html#tornado.web.RequestHandler.current_user" title="tornado.web.RequestHandler.current_user"><code class="xref py py-obj docutils literal"><span class="pre">handler.current_user</span></code></a></li>
<li><code class="docutils literal"><span class="pre">locale</span></code>: alias for <a class="reference internal" href="index.html#tornado.locale.Locale" title="tornado.locale.Locale"><code class="xref py py-obj docutils literal"><span class="pre">handler.locale</span></code></a></li>
<li><code class="docutils literal"><span class="pre">_</span></code>: alias for <a class="reference internal" href="index.html#tornado.locale.Locale.translate" title="tornado.locale.Locale.translate"><code class="xref py py-obj docutils literal"><span class="pre">handler.locale.translate</span></code></a></li>
<li><code class="docutils literal"><span class="pre">static_url</span></code>: alias for <a class="reference internal" href="index.html#tornado.web.RequestHandler.static_url" title="tornado.web.RequestHandler.static_url"><code class="xref py py-obj docutils literal"><span class="pre">handler.static_url</span></code></a></li>
<li><code class="docutils literal"><span class="pre">xsrf_form_html</span></code>: alias for <a class="reference internal" href="index.html#tornado.web.RequestHandler.xsrf_form_html" title="tornado.web.RequestHandler.xsrf_form_html"><code class="xref py py-obj docutils literal"><span class="pre">handler.xsrf_form_html</span></code></a></li>
<li><code class="docutils literal"><span class="pre">reverse_url</span></code>: alias for <a class="reference internal" href="index.html#tornado.web.Application.reverse_url" title="tornado.web.Application.reverse_url"><code class="xref py py-obj docutils literal"><span class="pre">Application.reverse_url</span></code></a></li>
<li>All entries from the <code class="docutils literal"><span class="pre">ui_methods</span></code> and <code class="docutils literal"><span class="pre">ui_modules</span></code>
<code class="docutils literal"><span class="pre">Application</span></code> settings</li>
<li>Any keyword arguments passed to <a class="reference internal" href="index.html#tornado.web.RequestHandler.render" title="tornado.web.RequestHandler.render"><code class="xref py py-obj docutils literal"><span class="pre">render</span></code></a> or
<a class="reference internal" href="index.html#tornado.web.RequestHandler.render_string" title="tornado.web.RequestHandler.render_string"><code class="xref py py-obj docutils literal"><span class="pre">render_string</span></code></a></li>
</ul>
<p>When you are building a real application, you are going to want to use
all of the features of Tornado templates, especially template
inheritance. Read all about those features in the <a class="reference internal" href="index.html#module-tornado.template" title="tornado.template"><code class="xref py py-obj docutils literal"><span class="pre">tornado.template</span></code></a>
section (some features, including <code class="docutils literal"><span class="pre">UIModules</span></code> are implemented in the
<a class="reference internal" href="index.html#module-tornado.web" title="tornado.web"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web</span></code></a> module)</p>
<p>Under the hood, Tornado templates are translated directly to Python. The
expressions you include in your template are copied verbatim into a
Python function representing your template. We don&#8217;t try to prevent
anything in the template language; we created it explicitly to provide
the flexibility that other, stricter templating systems prevent.
Consequently, if you write random stuff inside of your template
expressions, you will get random Python errors when you execute the
template.</p>
<p>All template output is escaped by default, using the
<a class="reference internal" href="index.html#tornado.escape.xhtml_escape" title="tornado.escape.xhtml_escape"><code class="xref py py-obj docutils literal"><span class="pre">tornado.escape.xhtml_escape</span></code></a> function. This behavior can be changed
globally by passing <code class="docutils literal"><span class="pre">autoescape=None</span></code> to the <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> or
<a class="reference internal" href="index.html#tornado.template.Loader" title="tornado.template.Loader"><code class="xref py py-obj docutils literal"><span class="pre">tornado.template.Loader</span></code></a> constructors, for a template file with the
<code class="docutils literal"><span class="pre">{%</span> <span class="pre">autoescape</span> <span class="pre">None</span> <span class="pre">%}</span></code> directive, or for a single expression by
replacing <code class="docutils literal"><span class="pre">{{</span> <span class="pre">...</span> <span class="pre">}}</span></code> with <code class="docutils literal"><span class="pre">{%</span> <span class="pre">raw</span> <span class="pre">...%}</span></code>. Additionally, in each of
these places the name of an alternative escaping function may be used
instead of <code class="docutils literal"><span class="pre">None</span></code>.</p>
<p>Note that while Tornado&#8217;s automatic escaping is helpful in avoiding
XSS vulnerabilities, it is not sufficient in all cases.  Expressions
that appear in certain locations, such as in Javascript or CSS, may need
additional escaping.  Additionally, either care must be taken to always
use double quotes and <a class="reference internal" href="index.html#tornado.escape.xhtml_escape" title="tornado.escape.xhtml_escape"><code class="xref py py-obj docutils literal"><span class="pre">xhtml_escape</span></code></a> in HTML attributes that may contain
untrusted content, or a separate escaping function must be used for
attributes (see e.g. <a class="reference external" href="http://wonko.com/post/html-escaping">http://wonko.com/post/html-escaping</a>)</p>
</div>
<div class="section" id="internationalization">
<h5>Internationalization<a class="headerlink" href="#internationalization" title="Permalink to this headline">¶</a></h5>
<p>The locale of the current user (whether they are logged in or not) is
always available as <code class="docutils literal"><span class="pre">self.locale</span></code> in the request handler and as
<code class="docutils literal"><span class="pre">locale</span></code> in templates. The name of the locale (e.g., <code class="docutils literal"><span class="pre">en_US</span></code>) is
available as <code class="docutils literal"><span class="pre">locale.name</span></code>, and you can translate strings with the
<a class="reference internal" href="index.html#tornado.locale.Locale.translate" title="tornado.locale.Locale.translate"><code class="xref py py-obj docutils literal"><span class="pre">Locale.translate</span></code></a> method. Templates also have the global function
call <code class="docutils literal"><span class="pre">_()</span></code> available for string translation. The translate function
has two forms:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">_</span><span class="p">(</span><span class="s">&quot;Translate this string&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>which translates the string directly based on the current locale, and:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">_</span><span class="p">(</span><span class="s">&quot;A person liked this&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="si">%(num)d</span><span class="s"> people liked this&quot;</span><span class="p">,</span>
  <span class="nb">len</span><span class="p">(</span><span class="n">people</span><span class="p">))</span> <span class="o">%</span> <span class="p">{</span><span class="s">&quot;num&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">people</span><span class="p">)}</span>
</pre></div>
</div>
<p>which translates a string that can be singular or plural based on the
value of the third argument. In the example above, a translation of the
first string will be returned if <code class="docutils literal"><span class="pre">len(people)</span></code> is <code class="docutils literal"><span class="pre">1</span></code>, or a
translation of the second string will be returned otherwise.</p>
<p>The most common pattern for translations is to use Python named
placeholders for variables (the <code class="docutils literal"><span class="pre">%(num)d</span></code> in the example above) since
placeholders can move around on translation.</p>
<p>Here is a properly internationalized template:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;html&gt;
   &lt;head&gt;
      &lt;title&gt;FriendFeed - {{ _(&quot;Sign in&quot;) }}&lt;/title&gt;
   &lt;/head&gt;
   &lt;body&gt;
     &lt;form action=&quot;{{ request.path }}&quot; method=&quot;post&quot;&gt;
       &lt;div&gt;{{ _(&quot;Username&quot;) }} &lt;input type=&quot;text&quot; name=&quot;username&quot;/&gt;&lt;/div&gt;
       &lt;div&gt;{{ _(&quot;Password&quot;) }} &lt;input type=&quot;password&quot; name=&quot;password&quot;/&gt;&lt;/div&gt;
       &lt;div&gt;&lt;input type=&quot;submit&quot; value=&quot;{{ _(&quot;Sign in&quot;) }}&quot;/&gt;&lt;/div&gt;
       {% module xsrf_form_html() %}
     &lt;/form&gt;
   &lt;/body&gt;
 &lt;/html&gt;
</pre></div>
</div>
<p>By default, we detect the user&#8217;s locale using the <code class="docutils literal"><span class="pre">Accept-Language</span></code>
header sent by the user&#8217;s browser. We choose <code class="docutils literal"><span class="pre">en_US</span></code> if we can&#8217;t find
an appropriate <code class="docutils literal"><span class="pre">Accept-Language</span></code> value. If you let user&#8217;s set their
locale as a preference, you can override this default locale selection
by overriding <a class="reference internal" href="index.html#tornado.web.RequestHandler.get_user_locale" title="tornado.web.RequestHandler.get_user_locale"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_user_locale</span></code></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">BaseHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_current_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">user_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_secure_cookie</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">user_id</span><span class="p">:</span> <span class="k">return</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">get_user_by_id</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_user_locale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s">&quot;locale&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_user</span><span class="o">.</span><span class="n">prefs</span><span class="p">:</span>
            <span class="c"># Use the Accept-Language header</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_user</span><span class="o">.</span><span class="n">prefs</span><span class="p">[</span><span class="s">&quot;locale&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>If <code class="docutils literal"><span class="pre">get_user_locale</span></code> returns <code class="docutils literal"><span class="pre">None</span></code>, we fall back on the
<code class="docutils literal"><span class="pre">Accept-Language</span></code> header.</p>
<p>The <a class="reference internal" href="index.html#module-tornado.locale" title="tornado.locale"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locale</span></code></a> module supports loading translations in two
formats: the <code class="docutils literal"><span class="pre">.mo</span></code> format used by <a class="reference external" href="https://docs.python.org/3.4/library/gettext.html#module-gettext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">gettext</span></code></a> and related tools, and a
simple <code class="docutils literal"><span class="pre">.csv</span></code> format.  An application will generally call either
<a class="reference internal" href="index.html#tornado.locale.load_translations" title="tornado.locale.load_translations"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locale.load_translations</span></code></a> or
<a class="reference internal" href="index.html#tornado.locale.load_gettext_translations" title="tornado.locale.load_gettext_translations"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locale.load_gettext_translations</span></code></a> once at startup; see those
methods for more details on the supported formats..</p>
<p>You can get the list of supported locales in your application with
<a class="reference internal" href="index.html#tornado.locale.get_supported_locales" title="tornado.locale.get_supported_locales"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locale.get_supported_locales()</span></code></a>. The user&#8217;s locale is chosen
to be the closest match based on the supported locales. For example, if
the user&#8217;s locale is <code class="docutils literal"><span class="pre">es_GT</span></code>, and the <code class="docutils literal"><span class="pre">es</span></code> locale is supported,
<code class="docutils literal"><span class="pre">self.locale</span></code> will be <code class="docutils literal"><span class="pre">es</span></code> for that request. We fall back on
<code class="docutils literal"><span class="pre">en_US</span></code> if no close match can be found.</p>
</div>
<div class="section" id="ui-modules">
<span id="id1"></span><h5>UI modules<a class="headerlink" href="#ui-modules" title="Permalink to this headline">¶</a></h5>
<p>Tornado supports <em>UI modules</em> to make it easy to support standard,
reusable UI widgets across your application. UI modules are like special
function calls to render components of your page, and they can come
packaged with their own CSS and JavaScript.</p>
<p>For example, if you are implementing a blog, and you want to have blog
entries appear on both the blog home page and on each blog entry page,
you can make an <code class="docutils literal"><span class="pre">Entry</span></code> module to render them on both pages. First,
create a Python module for your UI modules, e.g., <code class="docutils literal"><span class="pre">uimodules.py</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">UIModule</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">,</span> <span class="n">show_comments</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">render_string</span><span class="p">(</span>
            <span class="s">&quot;module-entry.html&quot;</span><span class="p">,</span> <span class="n">entry</span><span class="o">=</span><span class="n">entry</span><span class="p">,</span> <span class="n">show_comments</span><span class="o">=</span><span class="n">show_comments</span><span class="p">)</span>
</pre></div>
</div>
<p>Tell Tornado to use <code class="docutils literal"><span class="pre">uimodules.py</span></code> using the <code class="docutils literal"><span class="pre">ui_modules</span></code> setting in
your application:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">uimodules</span>

<span class="k">class</span> <span class="nc">HomeHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">entries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s">&quot;SELECT * FROM entries ORDER BY date DESC&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s">&quot;home.html&quot;</span><span class="p">,</span> <span class="n">entries</span><span class="o">=</span><span class="n">entries</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">EntryHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry_id</span><span class="p">):</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;SELECT * FROM entries WHERE id = </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">entry_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">entry</span><span class="p">:</span> <span class="k">raise</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s">&quot;entry.html&quot;</span><span class="p">,</span> <span class="n">entry</span><span class="o">=</span><span class="n">entry</span><span class="p">)</span>

<span class="n">settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&quot;ui_modules&quot;</span><span class="p">:</span> <span class="n">uimodules</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">application</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="s">r&quot;/&quot;</span><span class="p">,</span> <span class="n">HomeHandler</span><span class="p">),</span>
    <span class="p">(</span><span class="s">r&quot;/entry/([0-9]+)&quot;</span><span class="p">,</span> <span class="n">EntryHandler</span><span class="p">),</span>
<span class="p">],</span> <span class="o">**</span><span class="n">settings</span><span class="p">)</span>
</pre></div>
</div>
<p>Within a template, you can call a module with the <code class="docutils literal"><span class="pre">{%</span> <span class="pre">module</span> <span class="pre">%}</span></code>
statement.  For example, you could call the <code class="docutils literal"><span class="pre">Entry</span></code> module from both
<code class="docutils literal"><span class="pre">home.html</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>{% for entry in entries %}
  {% module Entry(entry) %}
{% end %}
</pre></div>
</div>
<p>and <code class="docutils literal"><span class="pre">entry.html</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>{% module Entry(entry, show_comments=True) %}
</pre></div>
</div>
<p>Modules can include custom CSS and JavaScript functions by overriding
the <code class="docutils literal"><span class="pre">embedded_css</span></code>, <code class="docutils literal"><span class="pre">embedded_javascript</span></code>, <code class="docutils literal"><span class="pre">javascript_files</span></code>, or
<code class="docutils literal"><span class="pre">css_files</span></code> methods:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">UIModule</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">embedded_css</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;.entry { margin-bottom: 1em; }&quot;</span>

    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">,</span> <span class="n">show_comments</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">render_string</span><span class="p">(</span>
            <span class="s">&quot;module-entry.html&quot;</span><span class="p">,</span> <span class="n">show_comments</span><span class="o">=</span><span class="n">show_comments</span><span class="p">)</span>
</pre></div>
</div>
<p>Module CSS and JavaScript will be included once no matter how many times
a module is used on a page. CSS is always included in the <code class="docutils literal"><span class="pre">&lt;head&gt;</span></code> of
the page, and JavaScript is always included just before the <code class="docutils literal"><span class="pre">&lt;/body&gt;</span></code>
tag at the end of the page.</p>
<p>When additional Python code is not required, a template file itself may
be used as a module. For example, the preceding example could be
rewritten to put the following in <code class="docutils literal"><span class="pre">module-entry.html</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>{{ set_resources(embedded_css=&quot;.entry { margin-bottom: 1em; }&quot;) }}
&lt;!-- more template html... --&gt;
</pre></div>
</div>
<p>This revised template module would be invoked with:</p>
<div class="highlight-python"><div class="highlight"><pre>{% module Template(&quot;module-entry.html&quot;, show_comments=True) %}
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">set_resources</span></code> function is only available in templates invoked
via <code class="docutils literal"><span class="pre">{%</span> <span class="pre">module</span> <span class="pre">Template(...)</span> <span class="pre">%}</span></code>. Unlike the <code class="docutils literal"><span class="pre">{%</span> <span class="pre">include</span> <span class="pre">...</span> <span class="pre">%}</span></code>
directive, template modules have a distinct namespace from their
containing template - they can only see the global template namespace
and their own keyword arguments.</p>
</div>
</div>
<span id="document-guide/security"></span><div class="section" id="authentication-and-security">
<h4>Authentication and security<a class="headerlink" href="#authentication-and-security" title="Permalink to this headline">¶</a></h4>
<div class="section" id="cookies-and-secure-cookies">
<h5>Cookies and secure cookies<a class="headerlink" href="#cookies-and-secure-cookies" title="Permalink to this headline">¶</a></h5>
<p>You can set cookies in the user&#8217;s browser with the <code class="docutils literal"><span class="pre">set_cookie</span></code>
method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cookie</span><span class="p">(</span><span class="s">&quot;mycookie&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="s">&quot;mycookie&quot;</span><span class="p">,</span> <span class="s">&quot;myvalue&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Your cookie was not set yet!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Your cookie was set!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Cookies are not secure and can easily be modified by clients.  If you
need to set cookies to, e.g., identify the currently logged in user,
you need to sign your cookies to prevent forgery. Tornado supports
signed cookies with the <a class="reference internal" href="index.html#tornado.web.RequestHandler.set_secure_cookie" title="tornado.web.RequestHandler.set_secure_cookie"><code class="xref py py-obj docutils literal"><span class="pre">set_secure_cookie</span></code></a> and
<a class="reference internal" href="index.html#tornado.web.RequestHandler.get_secure_cookie" title="tornado.web.RequestHandler.get_secure_cookie"><code class="xref py py-obj docutils literal"><span class="pre">get_secure_cookie</span></code></a> methods. To use these methods,
you need to specify a secret key named <code class="docutils literal"><span class="pre">cookie_secret</span></code> when you
create your application. You can pass in application settings as
keyword arguments to your application:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">application</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="s">r&quot;/&quot;</span><span class="p">,</span> <span class="n">MainHandler</span><span class="p">),</span>
<span class="p">],</span> <span class="n">cookie_secret</span><span class="o">=</span><span class="s">&quot;__TODO:_GENERATE_YOUR_OWN_RANDOM_VALUE_HERE__&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Signed cookies contain the encoded value of the cookie in addition to a
timestamp and an <a class="reference external" href="http://en.wikipedia.org/wiki/HMAC">HMAC</a> signature.
If the cookie is old or if the signature doesn&#8217;t match,
<code class="docutils literal"><span class="pre">get_secure_cookie</span></code> will return <code class="docutils literal"><span class="pre">None</span></code> just as if the cookie isn&#8217;t
set. The secure version of the example above:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_secure_cookie</span><span class="p">(</span><span class="s">&quot;mycookie&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_secure_cookie</span><span class="p">(</span><span class="s">&quot;mycookie&quot;</span><span class="p">,</span> <span class="s">&quot;myvalue&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Your cookie was not set yet!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Your cookie was set!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Tornado&#8217;s secure cookies guarantee integrity but not confidentiality.
That is, the cookie cannot be modified but its contents can be seen by the
user.  The <code class="docutils literal"><span class="pre">cookie_secret</span></code> is a symmetric key and must be kept secret &#8211;
anyone who obtains the value of this key could produce their own signed
cookies.</p>
<p>By default, Tornado&#8217;s secure cookies expire after 30 days.  To change this,
use the <code class="docutils literal"><span class="pre">expires_days</span></code> keyword argument to <code class="docutils literal"><span class="pre">set_secure_cookie</span></code> <em>and</em> the
<code class="docutils literal"><span class="pre">max_age_days</span></code> argument to <code class="docutils literal"><span class="pre">get_secure_cookie</span></code>.  These two values are
passed separately so that you may e.g. have a cookie that is valid for 30 days
for most purposes, but for certain sensitive actions (such as changing billing
information) you use a smaller <code class="docutils literal"><span class="pre">max_age_days</span></code> when reading the cookie.</p>
<p>Tornado also supports multiple signing keys to enable signing key
rotation. <code class="docutils literal"><span class="pre">cookie_secret</span></code> then must be a dict with integer key versions
as keys and the corresponding secrets as values. The currently used
signing key must then be set as <code class="docutils literal"><span class="pre">key_version</span></code> application setting
but all other keys in the dict are allowed for cookie signature validation,
if the correct key version is set in the cookie.
To implement cookie updates, the current signing key version can be
queried via <a class="reference internal" href="index.html#tornado.web.RequestHandler.get_secure_cookie_key_version" title="tornado.web.RequestHandler.get_secure_cookie_key_version"><code class="xref py py-obj docutils literal"><span class="pre">get_secure_cookie_key_version</span></code></a>.</p>
</div>
<div class="section" id="user-authentication">
<span id="id1"></span><h5>User authentication<a class="headerlink" href="#user-authentication" title="Permalink to this headline">¶</a></h5>
<p>The currently authenticated user is available in every request handler
as <a class="reference internal" href="index.html#tornado.web.RequestHandler.current_user" title="tornado.web.RequestHandler.current_user"><code class="xref py py-obj docutils literal"><span class="pre">self.current_user</span></code></a>, and in every
template as <code class="docutils literal"><span class="pre">current_user</span></code>. By default, <code class="docutils literal"><span class="pre">current_user</span></code> is
<code class="docutils literal"><span class="pre">None</span></code>.</p>
<p>To implement user authentication in your application, you need to
override the <code class="docutils literal"><span class="pre">get_current_user()</span></code> method in your request handlers to
determine the current user based on, e.g., the value of a cookie. Here
is an example that lets users log into the application simply by
specifying a nickname, which is then saved in a cookie:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">BaseHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_current_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_secure_cookie</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">BaseHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_user</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">redirect</span><span class="p">(</span><span class="s">&quot;/login&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">escape</span><span class="o">.</span><span class="n">xhtml_escape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_user</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Hello, &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">LoginHandler</span><span class="p">(</span><span class="n">BaseHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&lt;html&gt;&lt;body&gt;&lt;form action=&quot;/login&quot; method=&quot;post&quot;&gt;&#39;</span>
                   <span class="s">&#39;Name: &lt;input type=&quot;text&quot; name=&quot;name&quot;&gt;&#39;</span>
                   <span class="s">&#39;&lt;input type=&quot;submit&quot; value=&quot;Sign in&quot;&gt;&#39;</span>
                   <span class="s">&#39;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_secure_cookie</span><span class="p">(</span><span class="s">&quot;user&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_argument</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redirect</span><span class="p">(</span><span class="s">&quot;/&quot;</span><span class="p">)</span>

<span class="n">application</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="s">r&quot;/&quot;</span><span class="p">,</span> <span class="n">MainHandler</span><span class="p">),</span>
    <span class="p">(</span><span class="s">r&quot;/login&quot;</span><span class="p">,</span> <span class="n">LoginHandler</span><span class="p">),</span>
<span class="p">],</span> <span class="n">cookie_secret</span><span class="o">=</span><span class="s">&quot;__TODO:_GENERATE_YOUR_OWN_RANDOM_VALUE_HERE__&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can require that the user be logged in using the <a class="reference external" href="http://www.python.org/dev/peps/pep-0318/">Python
decorator</a>
<a class="reference internal" href="index.html#tornado.web.authenticated" title="tornado.web.authenticated"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.authenticated</span></code></a>. If a request goes to a method with this
decorator, and the user is not logged in, they will be redirected to
<code class="docutils literal"><span class="pre">login_url</span></code> (another application setting). The example above could be
rewritten:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">BaseHandler</span><span class="p">):</span>
    <span class="nd">@tornado.web.authenticated</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">escape</span><span class="o">.</span><span class="n">xhtml_escape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_user</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Hello, &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>

<span class="n">settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&quot;cookie_secret&quot;</span><span class="p">:</span> <span class="s">&quot;__TODO:_GENERATE_YOUR_OWN_RANDOM_VALUE_HERE__&quot;</span><span class="p">,</span>
    <span class="s">&quot;login_url&quot;</span><span class="p">:</span> <span class="s">&quot;/login&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">application</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="s">r&quot;/&quot;</span><span class="p">,</span> <span class="n">MainHandler</span><span class="p">),</span>
    <span class="p">(</span><span class="s">r&quot;/login&quot;</span><span class="p">,</span> <span class="n">LoginHandler</span><span class="p">),</span>
<span class="p">],</span> <span class="o">**</span><span class="n">settings</span><span class="p">)</span>
</pre></div>
</div>
<p>If you decorate <code class="docutils literal"><span class="pre">post()</span></code> methods with the <code class="docutils literal"><span class="pre">authenticated</span></code>
decorator, and the user is not logged in, the server will send a
<code class="docutils literal"><span class="pre">403</span></code> response.  The <code class="docutils literal"><span class="pre">&#64;authenticated</span></code> decorator is simply
shorthand for <code class="docutils literal"><span class="pre">if</span> <span class="pre">not</span> <span class="pre">self.current_user:</span> <span class="pre">self.redirect()</span></code> and may
not be appropriate for non-browser-based login schemes.</p>
<p>Check out the <a class="reference external" href="https://github.com/tornadoweb/tornado/tree/stable/demos/blog">Tornado Blog example application</a> for a
complete example that uses authentication (and stores user data in a
MySQL database).</p>
</div>
<div class="section" id="third-party-authentication">
<h5>Third party authentication<a class="headerlink" href="#third-party-authentication" title="Permalink to this headline">¶</a></h5>
<p>The <a class="reference internal" href="index.html#module-tornado.auth" title="tornado.auth"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth</span></code></a> module implements the authentication and
authorization protocols for a number of the most popular sites on the
web, including Google/Gmail, Facebook, Twitter, and FriendFeed.
The module includes methods to log users in via these sites and, where
applicable, methods to authorize access to the service so you can, e.g.,
download a user&#8217;s address book or publish a Twitter message on their
behalf.</p>
<p>Here is an example handler that uses Google for authentication, saving
the Google credentials in a cookie for later access:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">GoogleOAuth2LoginHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">,</span>
                               <span class="n">tornado</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">GoogleOAuth2Mixin</span><span class="p">):</span>
    <span class="nd">@tornado.gen.coroutine</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_argument</span><span class="p">(</span><span class="s">&#39;code&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">user</span> <span class="o">=</span> <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_authenticated_user</span><span class="p">(</span>
                <span class="n">redirect_uri</span><span class="o">=</span><span class="s">&#39;http://your.site.com/auth/google&#39;</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_argument</span><span class="p">(</span><span class="s">&#39;code&#39;</span><span class="p">))</span>
            <span class="c"># Save the user with e.g. set_secure_cookie</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorize_redirect</span><span class="p">(</span>
                <span class="n">redirect_uri</span><span class="o">=</span><span class="s">&#39;http://your.site.com/auth/google&#39;</span><span class="p">,</span>
                <span class="n">client_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s">&#39;google_oauth&#39;</span><span class="p">][</span><span class="s">&#39;key&#39;</span><span class="p">],</span>
                <span class="n">scope</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;profile&#39;</span><span class="p">,</span> <span class="s">&#39;email&#39;</span><span class="p">],</span>
                <span class="n">response_type</span><span class="o">=</span><span class="s">&#39;code&#39;</span><span class="p">,</span>
                <span class="n">extra_params</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;approval_prompt&#39;</span><span class="p">:</span> <span class="s">&#39;auto&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="index.html#module-tornado.auth" title="tornado.auth"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth</span></code></a> module documentation for more details.</p>
</div>
<div class="section" id="cross-site-request-forgery-protection">
<span id="xsrf"></span><h5>Cross-site request forgery protection<a class="headerlink" href="#cross-site-request-forgery-protection" title="Permalink to this headline">¶</a></h5>
<p><a class="reference external" href="http://en.wikipedia.org/wiki/Cross-site_request_forgery">Cross-site request
forgery</a>, or
XSRF, is a common problem for personalized web applications. See the
<a class="reference external" href="http://en.wikipedia.org/wiki/Cross-site_request_forgery">Wikipedia
article</a> for
more information on how XSRF works.</p>
<p>The generally accepted solution to prevent XSRF is to cookie every user
with an unpredictable value and include that value as an additional
argument with every form submission on your site. If the cookie and the
value in the form submission do not match, then the request is likely
forged.</p>
<p>Tornado comes with built-in XSRF protection. To include it in your site,
include the application setting <code class="docutils literal"><span class="pre">xsrf_cookies</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&quot;cookie_secret&quot;</span><span class="p">:</span> <span class="s">&quot;__TODO:_GENERATE_YOUR_OWN_RANDOM_VALUE_HERE__&quot;</span><span class="p">,</span>
    <span class="s">&quot;login_url&quot;</span><span class="p">:</span> <span class="s">&quot;/login&quot;</span><span class="p">,</span>
    <span class="s">&quot;xsrf_cookies&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">application</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="s">r&quot;/&quot;</span><span class="p">,</span> <span class="n">MainHandler</span><span class="p">),</span>
    <span class="p">(</span><span class="s">r&quot;/login&quot;</span><span class="p">,</span> <span class="n">LoginHandler</span><span class="p">),</span>
<span class="p">],</span> <span class="o">**</span><span class="n">settings</span><span class="p">)</span>
</pre></div>
</div>
<p>If <code class="docutils literal"><span class="pre">xsrf_cookies</span></code> is set, the Tornado web application will set the
<code class="docutils literal"><span class="pre">_xsrf</span></code> cookie for all users and reject all <code class="docutils literal"><span class="pre">POST</span></code>, <code class="docutils literal"><span class="pre">PUT</span></code>, and
<code class="docutils literal"><span class="pre">DELETE</span></code> requests that do not contain a correct <code class="docutils literal"><span class="pre">_xsrf</span></code> value. If
you turn this setting on, you need to instrument all forms that submit
via <code class="docutils literal"><span class="pre">POST</span></code> to contain this field. You can do this with the special
<a class="reference internal" href="index.html#tornado.web.UIModule" title="tornado.web.UIModule"><code class="xref py py-obj docutils literal"><span class="pre">UIModule</span></code></a> <code class="docutils literal"><span class="pre">xsrf_form_html()</span></code>, available in all templates:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;form action=&quot;/new_message&quot; method=&quot;post&quot;&gt;
  {% module xsrf_form_html() %}
  &lt;input type=&quot;text&quot; name=&quot;message&quot;/&gt;
  &lt;input type=&quot;submit&quot; value=&quot;Post&quot;/&gt;
&lt;/form&gt;
</pre></div>
</div>
<p>If you submit AJAX <code class="docutils literal"><span class="pre">POST</span></code> requests, you will also need to instrument
your JavaScript to include the <code class="docutils literal"><span class="pre">_xsrf</span></code> value with each request. This
is the <a class="reference external" href="http://jquery.com/">jQuery</a> function we use at FriendFeed for
AJAX <code class="docutils literal"><span class="pre">POST</span></code> requests that automatically adds the <code class="docutils literal"><span class="pre">_xsrf</span></code> value to
all requests:</p>
<div class="highlight-python"><div class="highlight"><pre>function getCookie(name) {
    var r = document.cookie.match(&quot;\\b&quot; + name + &quot;=([^;]*)\\b&quot;);
    return r ? r[1] : undefined;
}

jQuery.postJSON = function(url, args, callback) {
    args._xsrf = getCookie(&quot;_xsrf&quot;);
    $.ajax({url: url, data: $.param(args), dataType: &quot;text&quot;, type: &quot;POST&quot;,
        success: function(response) {
        callback(eval(&quot;(&quot; + response + &quot;)&quot;));
    }});
};
</pre></div>
</div>
<p>For <code class="docutils literal"><span class="pre">PUT</span></code> and <code class="docutils literal"><span class="pre">DELETE</span></code> requests (as well as <code class="docutils literal"><span class="pre">POST</span></code> requests that
do not use form-encoded arguments), the XSRF token may also be passed
via an HTTP header named <code class="docutils literal"><span class="pre">X-XSRFToken</span></code>.  The XSRF cookie is normally
set when <code class="docutils literal"><span class="pre">xsrf_form_html</span></code> is used, but in a pure-Javascript application
that does not use any regular forms you may need to access
<code class="docutils literal"><span class="pre">self.xsrf_token</span></code> manually (just reading the property is enough to
set the cookie as a side effect).</p>
<p>If you need to customize XSRF behavior on a per-handler basis, you can
override <a class="reference internal" href="index.html#tornado.web.RequestHandler.check_xsrf_cookie" title="tornado.web.RequestHandler.check_xsrf_cookie"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.check_xsrf_cookie()</span></code></a>. For example, if you
have an API whose authentication does not use cookies, you may want to
disable XSRF protection by making <code class="docutils literal"><span class="pre">check_xsrf_cookie()</span></code> do nothing.
However, if you support both cookie and non-cookie-based authentication,
it is important that XSRF protection be used whenever the current
request is authenticated with a cookie.</p>
</div>
</div>
<span id="document-guide/running"></span><div class="section" id="running-and-deploying">
<h4>Running and deploying<a class="headerlink" href="#running-and-deploying" title="Permalink to this headline">¶</a></h4>
<p>Since Tornado supplies its own HTTPServer, running and deploying it is
a little different from other Python web frameworks.  Instead of
configuring a WSGI container to find your application, you write a
<code class="docutils literal"><span class="pre">main()</span></code> function that starts the server:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">make_app</span><span class="p">()</span>
    <span class="n">app</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">8888</span><span class="p">)</span>
    <span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>Configure your operating system or process manager to run this program to
start the server. Please note that it may be necessary to increase the number
of open files per process (to avoid &#8220;Too many open files&#8221;-Error).
To raise this limit (setting it to 50000 for example)  you can use the ulimit command,
modify /etc/security/limits.conf or setting <code class="docutils literal"><span class="pre">minfds</span></code> in your supervisord config.</p>
<div class="section" id="processes-and-ports">
<h5>Processes and ports<a class="headerlink" href="#processes-and-ports" title="Permalink to this headline">¶</a></h5>
<p>Due to the Python GIL (Global Interpreter Lock), it is necessary to run
multiple Python processes to take full advantage of multi-CPU machines.
Typically it is best to run one process per CPU.</p>
<p>Tornado includes a built-in multi-process mode to start several
processes at once.  This requires a slight alteration to the standard
main function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">make_app</span><span class="p">()</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">httpserver</span><span class="o">.</span><span class="n">HTTPServer</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="mi">8888</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c"># forks one process per cpu</span>
    <span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>This is the easiest way to start multiple processes and have them all
share the same port, although it has some limitations.  First, each
child process will have its own IOLoop, so it is important that
nothing touch the global IOLoop instance (even indirectly) before the
fork.  Second, it is difficult to do zero-downtime updates in this model.
Finally, since all the processes share the same port it is more difficult
to monitor them individually.</p>
<p>For more sophisticated deployments, it is recommended to start the processes
independently, and have each one listen on a different port.
The &#8220;process groups&#8221; feature of <a class="reference external" href="http://www.supervisord.org">supervisord</a>
is one good way to arrange this.  When each process uses a different port,
an external load balancer such as HAProxy or nginx is usually needed
to present a single address to outside visitors.</p>
</div>
<div class="section" id="running-behind-a-load-balancer">
<h5>Running behind a load balancer<a class="headerlink" href="#running-behind-a-load-balancer" title="Permalink to this headline">¶</a></h5>
<p>When running behind a load balancer like nginx, it is recommended to
pass <code class="docutils literal"><span class="pre">xheaders=True</span></code> to the <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> constructor. This will tell
Tornado to use headers like <code class="docutils literal"><span class="pre">X-Real-IP</span></code> to get the user&#8217;s IP address
instead of attributing all traffic to the balancer&#8217;s IP address.</p>
<p>This is a barebones nginx config file that is structurally similar to
the one we use at FriendFeed. It assumes nginx and the Tornado servers
are running on the same machine, and the four Tornado servers are
running on ports 8000 - 8003:</p>
<div class="highlight-python"><div class="highlight"><pre>user nginx;
worker_processes 1;

error_log /var/log/nginx/error.log;
pid /var/run/nginx.pid;

events {
    worker_connections 1024;
    use epoll;
}

http {
    # Enumerate all the Tornado servers here
    upstream frontends {
        server 127.0.0.1:8000;
        server 127.0.0.1:8001;
        server 127.0.0.1:8002;
        server 127.0.0.1:8003;
    }

    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    access_log /var/log/nginx/access.log;

    keepalive_timeout 65;
    proxy_read_timeout 200;
    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    gzip on;
    gzip_min_length 1000;
    gzip_proxied any;
    gzip_types text/plain text/html text/css text/xml
               application/x-javascript application/xml
               application/atom+xml text/javascript;

    # Only retry if there was a communication error, not a timeout
    # on the Tornado server (to avoid propagating &quot;queries of death&quot;
    # to all frontends)
    proxy_next_upstream error;

    server {
        listen 80;

        # Allow file uploads
        client_max_body_size 50M;

        location ^~ /static/ {
            root /var/www;
            if ($query_string) {
                expires max;
            }
        }
        location = /favicon.ico {
            rewrite (.*) /static/favicon.ico;
        }
        location = /robots.txt {
            rewrite (.*) /static/robots.txt;
        }

        location / {
            proxy_pass_header Server;
            proxy_set_header Host $http_host;
            proxy_redirect off;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Scheme $scheme;
            proxy_pass http://frontends;
        }
    }
}
</pre></div>
</div>
</div>
<div class="section" id="static-files-and-aggressive-file-caching">
<h5>Static files and aggressive file caching<a class="headerlink" href="#static-files-and-aggressive-file-caching" title="Permalink to this headline">¶</a></h5>
<p>You can serve static files from Tornado by specifying the
<code class="docutils literal"><span class="pre">static_path</span></code> setting in your application:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">settings</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&quot;static_path&quot;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">),</span> <span class="s">&quot;static&quot;</span><span class="p">),</span>
    <span class="s">&quot;cookie_secret&quot;</span><span class="p">:</span> <span class="s">&quot;__TODO:_GENERATE_YOUR_OWN_RANDOM_VALUE_HERE__&quot;</span><span class="p">,</span>
    <span class="s">&quot;login_url&quot;</span><span class="p">:</span> <span class="s">&quot;/login&quot;</span><span class="p">,</span>
    <span class="s">&quot;xsrf_cookies&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">application</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="s">r&quot;/&quot;</span><span class="p">,</span> <span class="n">MainHandler</span><span class="p">),</span>
    <span class="p">(</span><span class="s">r&quot;/login&quot;</span><span class="p">,</span> <span class="n">LoginHandler</span><span class="p">),</span>
    <span class="p">(</span><span class="s">r&quot;/(apple-touch-icon\.png)&quot;</span><span class="p">,</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">StaticFileHandler</span><span class="p">,</span>
     <span class="nb">dict</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s">&#39;static_path&#39;</span><span class="p">])),</span>
<span class="p">],</span> <span class="o">**</span><span class="n">settings</span><span class="p">)</span>
</pre></div>
</div>
<p>This setting will automatically make all requests that start with
<code class="docutils literal"><span class="pre">/static/</span></code> serve from that static directory, e.g.,
<code class="docutils literal"><span class="pre">http://localhost:8888/static/foo.png</span></code> will serve the file
<code class="docutils literal"><span class="pre">foo.png</span></code> from the specified static directory. We also automatically
serve <code class="docutils literal"><span class="pre">/robots.txt</span></code> and <code class="docutils literal"><span class="pre">/favicon.ico</span></code> from the static directory
(even though they don&#8217;t start with the <code class="docutils literal"><span class="pre">/static/</span></code> prefix).</p>
<p>In the above settings, we have explicitly configured Tornado to serve
<code class="docutils literal"><span class="pre">apple-touch-icon.png</span></code> from the root with the <a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a>,
though it is physically in the static file directory. (The capturing
group in that regular expression is necessary to tell
<a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> the requested filename; recall that capturing
groups are passed to handlers as method arguments.) You could do the
same thing to serve e.g. <code class="docutils literal"><span class="pre">sitemap.xml</span></code> from the site root. Of
course, you can also avoid faking a root <code class="docutils literal"><span class="pre">apple-touch-icon.png</span></code> by
using the appropriate <code class="docutils literal"><span class="pre">&lt;link</span> <span class="pre">/&gt;</span></code> tag in your HTML.</p>
<p>To improve performance, it is generally a good idea for browsers to
cache static resources aggressively so browsers won&#8217;t send unnecessary
<code class="docutils literal"><span class="pre">If-Modified-Since</span></code> or <code class="docutils literal"><span class="pre">Etag</span></code> requests that might block the
rendering of the page. Tornado supports this out of the box with <em>static
content versioning</em>.</p>
<p>To use this feature, use the <a class="reference internal" href="index.html#tornado.web.RequestHandler.static_url" title="tornado.web.RequestHandler.static_url"><code class="xref py py-obj docutils literal"><span class="pre">static_url</span></code></a> method in
your templates rather than typing the URL of the static file directly
in your HTML:</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;html&gt;
   &lt;head&gt;
      &lt;title&gt;FriendFeed - {{ _(&quot;Home&quot;) }}&lt;/title&gt;
   &lt;/head&gt;
   &lt;body&gt;
     &lt;div&gt;&lt;img src=&quot;{{ static_url(&quot;images/logo.png&quot;) }}&quot;/&gt;&lt;/div&gt;
   &lt;/body&gt;
 &lt;/html&gt;
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">static_url()</span></code> function will translate that relative path to a URI
that looks like <code class="docutils literal"><span class="pre">/static/images/logo.png?v=aae54</span></code>. The <code class="docutils literal"><span class="pre">v</span></code> argument
is a hash of the content in <code class="docutils literal"><span class="pre">logo.png</span></code>, and its presence makes the
Tornado server send cache headers to the user&#8217;s browser that will make
the browser cache the content indefinitely.</p>
<p>Since the <code class="docutils literal"><span class="pre">v</span></code> argument is based on the content of the file, if you
update a file and restart your server, it will start sending a new <code class="docutils literal"><span class="pre">v</span></code>
value, so the user&#8217;s browser will automatically fetch the new file. If
the file&#8217;s contents don&#8217;t change, the browser will continue to use a
locally cached copy without ever checking for updates on the server,
significantly improving rendering performance.</p>
<p>In production, you probably want to serve static files from a more
optimized static file server like <a class="reference external" href="http://nginx.net/">nginx</a>. You
can configure most any web server to recognize the version tags used
by <code class="docutils literal"><span class="pre">static_url()</span></code> and set caching headers accordingly.  Here is the
relevant portion of the nginx configuration we use at FriendFeed:</p>
<div class="highlight-python"><div class="highlight"><pre>location /static/ {
    root /var/friendfeed/static;
    if ($query_string) {
        expires max;
    }
 }
</pre></div>
</div>
</div>
<div class="section" id="debug-mode-and-automatic-reloading">
<span id="debug-mode"></span><h5>Debug mode and automatic reloading<a class="headerlink" href="#debug-mode-and-automatic-reloading" title="Permalink to this headline">¶</a></h5>
<p>If you pass <code class="docutils literal"><span class="pre">debug=True</span></code> to the <code class="docutils literal"><span class="pre">Application</span></code> constructor, the app
will be run in debug/development mode. In this mode, several features
intended for convenience while developing will be enabled (each of which
is also available as an individual flag; if both are specified the
individual flag takes precedence):</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">autoreload=True</span></code>: The app will watch for changes to its source
files and reload itself when anything changes. This reduces the need
to manually restart the server during development. However, certain
failures (such as syntax errors at import time) can still take the
server down in a way that debug mode cannot currently recover from.</li>
<li><code class="docutils literal"><span class="pre">compiled_template_cache=False</span></code>: Templates will not be cached.</li>
<li><code class="docutils literal"><span class="pre">static_hash_cache=False</span></code>: Static file hashes (used by the
<code class="docutils literal"><span class="pre">static_url</span></code> function) will not be cached</li>
<li><code class="docutils literal"><span class="pre">serve_traceback=True</span></code>: When an exception in a <a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a>
is not caught, an error page including a stack trace will be
generated.</li>
</ul>
<p>Autoreload mode is not compatible with the multi-process mode of <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a>.
You must not give <a class="reference internal" href="index.html#tornado.tcpserver.TCPServer.start" title="tornado.tcpserver.TCPServer.start"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer.start</span></code></a> an argument other than 1 (or
call <a class="reference internal" href="index.html#tornado.process.fork_processes" title="tornado.process.fork_processes"><code class="xref py py-obj docutils literal"><span class="pre">tornado.process.fork_processes</span></code></a>) if you are using autoreload mode.</p>
<p>The automatic reloading feature of debug mode is available as a
standalone module in <a class="reference internal" href="index.html#module-tornado.autoreload" title="tornado.autoreload"><code class="xref py py-obj docutils literal"><span class="pre">tornado.autoreload</span></code></a>.  The two can be used in
combination to provide extra robustness against syntax errors: set
<code class="docutils literal"><span class="pre">autoreload=True</span></code> within the app to detect changes while it is running,
and start it with <code class="docutils literal"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">tornado.autoreload</span> <span class="pre">myserver.py</span></code> to catch
any syntax errors or other errors at startup.</p>
<p>Reloading loses any Python interpreter command-line arguments (e.g. <code class="docutils literal"><span class="pre">-u</span></code>)
because it re-executes Python using <a class="reference external" href="https://docs.python.org/3.4/library/sys.html#sys.executable" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">sys.executable</span></code></a> and <a class="reference external" href="https://docs.python.org/3.4/library/sys.html#sys.argv" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">sys.argv</span></code></a>.
Additionally, modifying these variables will cause reloading to behave
incorrectly.</p>
<p>On some platforms (including Windows and Mac OSX prior to 10.6), the
process cannot be updated &#8220;in-place&#8221;, so when a code change is
detected the old server exits and a new one starts.  This has been
known to confuse some IDEs.</p>
</div>
<div class="section" id="wsgi-and-google-app-engine">
<h5>WSGI and Google App Engine<a class="headerlink" href="#wsgi-and-google-app-engine" title="Permalink to this headline">¶</a></h5>
<p>Tornado is normally intended to be run on its own, without a WSGI
container.  However, in some environments (such as Google App Engine),
only WSGI is allowed and applications cannot run their own servers.
In this case Tornado supports a limited mode of operation that does
not support asynchronous operation but allows a subset of Tornado&#8217;s
functionality in a WSGI-only environment.  The features that are
not allowed in WSGI mode include coroutines, the <code class="docutils literal"><span class="pre">&#64;asynchronous</span></code>
decorator, <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a>, the <code class="docutils literal"><span class="pre">auth</span></code> module, and WebSockets.</p>
<p>You can convert a Tornado <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> to a WSGI application
with <a class="reference internal" href="index.html#tornado.wsgi.WSGIAdapter" title="tornado.wsgi.WSGIAdapter"><code class="xref py py-obj docutils literal"><span class="pre">tornado.wsgi.WSGIAdapter</span></code></a>.  In this example, configure
your WSGI container to find the <code class="docutils literal"><span class="pre">application</span></code> object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">tornado.web</span>
<span class="kn">import</span> <span class="nn">tornado.wsgi</span>

<span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Hello, world&quot;</span><span class="p">)</span>

<span class="n">tornado_app</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="s">r&quot;/&quot;</span><span class="p">,</span> <span class="n">MainHandler</span><span class="p">),</span>
<span class="p">])</span>
<span class="n">application</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">wsgi</span><span class="o">.</span><span class="n">WSGIAdapter</span><span class="p">(</span><span class="n">tornado_app</span><span class="p">)</span>
</pre></div>
</div>
<p>See the <a class="reference external" href="https://github.com/tornadoweb/tornado/tree/stable/demos/appengine">appengine example application</a> for a
full-featured AppEngine app built on Tornado.</p>
</div>
</div>
</div>
</div>
<span id="document-webframework"></span><div class="section" id="web-framework">
<h3>Web framework<a class="headerlink" href="#web-framework" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
<span id="document-web"></span><div class="section" id="tornado-web-requesthandler-and-application-classes">
<h4><code class="docutils literal"><span class="pre">tornado.web</span></code> &#8212; <code class="docutils literal"><span class="pre">RequestHandler</span></code> and <code class="docutils literal"><span class="pre">Application</span></code> classes<a class="headerlink" href="#tornado-web-requesthandler-and-application-classes" title="Permalink to this headline">¶</a></h4>
<span class="target" id="module-tornado.web"></span><p><code class="docutils literal"><span class="pre">tornado.web</span></code> provides a simple web framework with asynchronous
features that allow it to scale to large numbers of open connections,
making it ideal for <a class="reference external" href="http://en.wikipedia.org/wiki/Push_technology#Long_polling">long polling</a>.</p>
<p>Here is a simple &#8220;Hello, world&#8221; example app:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">tornado.ioloop</span>
<span class="kn">import</span> <span class="nn">tornado.web</span>

<span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Hello, world&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">application</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
        <span class="p">(</span><span class="s">r&quot;/&quot;</span><span class="p">,</span> <span class="n">MainHandler</span><span class="p">),</span>
    <span class="p">])</span>
    <span class="n">application</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">8888</span><span class="p">)</span>
    <span class="n">tornado</span><span class="o">.</span><span class="n">ioloop</span><span class="o">.</span><span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="index.html#document-guide"><em>User&#8217;s guide</em></a> for additional information.</p>
<div class="section" id="thread-safety-notes">
<h5>Thread-safety notes<a class="headerlink" href="#thread-safety-notes" title="Permalink to this headline">¶</a></h5>
<p>In general, methods on <a class="reference internal" href="#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> and elsewhere in Tornado are
not thread-safe.  In particular, methods such as
<a class="reference internal" href="#tornado.web.RequestHandler.write" title="tornado.web.RequestHandler.write"><code class="xref py py-obj docutils literal"><span class="pre">write()</span></code></a>, <a class="reference internal" href="#tornado.web.RequestHandler.finish" title="tornado.web.RequestHandler.finish"><code class="xref py py-obj docutils literal"><span class="pre">finish()</span></code></a>, and
<a class="reference internal" href="#tornado.web.RequestHandler.flush" title="tornado.web.RequestHandler.flush"><code class="xref py py-obj docutils literal"><span class="pre">flush()</span></code></a> must only be called from the main thread.  If
you use multiple threads it is important to use <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_callback" title="tornado.ioloop.IOLoop.add_callback"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_callback</span></code></a>
to transfer control back to the main thread before finishing the
request.</p>
</div>
<div class="section" id="request-handlers">
<h5>Request handlers<a class="headerlink" href="#request-handlers" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.web.RequestHandler">
<em class="property">class </em><code class="descclassname">tornado.web.</code><code class="descname">RequestHandler</code><span class="sig-paren">(</span><em>application</em>, <em>request</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for HTTP request handlers.</p>
<p>Subclasses must define at least one of the methods defined in the
&#8220;Entry points&#8221; section below.</p>
</dd></dl>

<div class="section" id="entry-points">
<h6>Entry points<a class="headerlink" href="#entry-points" title="Permalink to this headline">¶</a></h6>
<dl class="method">
<dt id="tornado.web.RequestHandler.initialize">
<code class="descclassname">RequestHandler.</code><code class="descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook for subclass initialization.</p>
<p>A dictionary passed as the third argument of a url spec will be
supplied as keyword arguments to initialize().</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ProfileHandler</span><span class="p">(</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">database</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">database</span> <span class="o">=</span> <span class="n">database</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">username</span><span class="p">):</span>
        <span class="o">...</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="s">r&#39;/user/(.*)&#39;</span><span class="p">,</span> <span class="n">ProfileHandler</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">database</span><span class="o">=</span><span class="n">database</span><span class="p">)),</span>
    <span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.prepare">
<code class="descclassname">RequestHandler.</code><code class="descname">prepare</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.prepare"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.prepare" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the beginning of a request before  <a class="reference internal" href="#tornado.web.RequestHandler.get" title="tornado.web.RequestHandler.get"><code class="xref py py-obj docutils literal"><span class="pre">get</span></code></a>/<a class="reference internal" href="#tornado.web.RequestHandler.post" title="tornado.web.RequestHandler.post"><code class="xref py py-obj docutils literal"><span class="pre">post</span></code></a>/etc.</p>
<p>Override this method to perform common initialization regardless
of the request method.</p>
<p>Asynchronous support: Decorate this method with <a class="reference internal" href="index.html#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">gen.coroutine</span></code></a>
or <a class="reference internal" href="index.html#tornado.concurrent.return_future" title="tornado.concurrent.return_future"><code class="xref py py-obj docutils literal"><span class="pre">return_future</span></code></a> to make it asynchronous (the
<a class="reference internal" href="#tornado.web.asynchronous" title="tornado.web.asynchronous"><code class="xref py py-obj docutils literal"><span class="pre">asynchronous</span></code></a> decorator cannot be used on <a class="reference internal" href="#tornado.web.RequestHandler.prepare" title="tornado.web.RequestHandler.prepare"><code class="xref py py-obj docutils literal"><span class="pre">prepare</span></code></a>).
If this method returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> execution will not proceed
until the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> is done.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1: </span>Asynchronous support.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.on_finish">
<code class="descclassname">RequestHandler.</code><code class="descname">on_finish</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.on_finish"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.on_finish" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after the end of a request.</p>
<p>Override this method to perform cleanup, logging, etc.
This method is a counterpart to <a class="reference internal" href="#tornado.web.RequestHandler.prepare" title="tornado.web.RequestHandler.prepare"><code class="xref py py-obj docutils literal"><span class="pre">prepare</span></code></a>.  <code class="docutils literal"><span class="pre">on_finish</span></code> may
not produce any output, as it is called after the response
has been sent to the client.</p>
</dd></dl>

<p id="verbs">Implement any of the following methods (collectively known as the
HTTP verb methods) to handle the corresponding HTTP method.
These methods can be made asynchronous with one of the following
decorators: <a class="reference internal" href="index.html#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">gen.coroutine</span></code></a>, <a class="reference internal" href="index.html#tornado.concurrent.return_future" title="tornado.concurrent.return_future"><code class="xref py py-obj docutils literal"><span class="pre">return_future</span></code></a>, or <a class="reference internal" href="#tornado.web.asynchronous" title="tornado.web.asynchronous"><code class="xref py py-obj docutils literal"><span class="pre">asynchronous</span></code></a>.</p>
<p>To support a method not on this list, override the class variable
<code class="docutils literal"><span class="pre">SUPPORTED_METHODS</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">WebDAVHandler</span><span class="p">(</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="n">SUPPORTED_METHODS</span> <span class="o">=</span> <span class="n">RequestHandler</span><span class="o">.</span><span class="n">SUPPORTED_METHODS</span> <span class="o">+</span> <span class="p">(</span><span class="s">&#39;PROPFIND&#39;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="nf">propfind</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>
</div>
<dl class="method">
<dt id="tornado.web.RequestHandler.get">
<code class="descclassname">RequestHandler.</code><code class="descname">get</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.head">
<code class="descclassname">RequestHandler.</code><code class="descname">head</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.head"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.head" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.post">
<code class="descclassname">RequestHandler.</code><code class="descname">post</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.post"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.post" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.delete">
<code class="descclassname">RequestHandler.</code><code class="descname">delete</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.delete"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.delete" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.patch">
<code class="descclassname">RequestHandler.</code><code class="descname">patch</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.patch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.put">
<code class="descclassname">RequestHandler.</code><code class="descname">put</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.put"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.put" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.options">
<code class="descclassname">RequestHandler.</code><code class="descname">options</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.options"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.options" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="input">
<h6>Input<a class="headerlink" href="#input" title="Permalink to this headline">¶</a></h6>
<dl class="method">
<dt id="tornado.web.RequestHandler.get_argument">
<code class="descclassname">RequestHandler.</code><code class="descname">get_argument</code><span class="sig-paren">(</span><em>name</em>, <em>default=[]</em>, <em>strip=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get_argument"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get_argument" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of the argument with the given name.</p>
<p>If default is not provided, the argument is considered to be
required, and we raise a <a class="reference internal" href="#tornado.web.MissingArgumentError" title="tornado.web.MissingArgumentError"><code class="xref py py-obj docutils literal"><span class="pre">MissingArgumentError</span></code></a> if it is missing.</p>
<p>If the argument appears in the url more than once, we return the
last value.</p>
<p>The returned value is always unicode.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.get_arguments">
<code class="descclassname">RequestHandler.</code><code class="descname">get_arguments</code><span class="sig-paren">(</span><em>name</em>, <em>strip=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get_arguments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get_arguments" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the arguments with the given name.</p>
<p>If the argument is not present, returns an empty list.</p>
<p>The returned values are always unicode.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.get_query_argument">
<code class="descclassname">RequestHandler.</code><code class="descname">get_query_argument</code><span class="sig-paren">(</span><em>name</em>, <em>default=[]</em>, <em>strip=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get_query_argument"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get_query_argument" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of the argument with the given name
from the request query string.</p>
<p>If default is not provided, the argument is considered to be
required, and we raise a <a class="reference internal" href="#tornado.web.MissingArgumentError" title="tornado.web.MissingArgumentError"><code class="xref py py-obj docutils literal"><span class="pre">MissingArgumentError</span></code></a> if it is missing.</p>
<p>If the argument appears in the url more than once, we return the
last value.</p>
<p>The returned value is always unicode.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.get_query_arguments">
<code class="descclassname">RequestHandler.</code><code class="descname">get_query_arguments</code><span class="sig-paren">(</span><em>name</em>, <em>strip=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get_query_arguments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get_query_arguments" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the query arguments with the given name.</p>
<p>If the argument is not present, returns an empty list.</p>
<p>The returned values are always unicode.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.get_body_argument">
<code class="descclassname">RequestHandler.</code><code class="descname">get_body_argument</code><span class="sig-paren">(</span><em>name</em>, <em>default=[]</em>, <em>strip=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get_body_argument"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get_body_argument" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of the argument with the given name
from the request body.</p>
<p>If default is not provided, the argument is considered to be
required, and we raise a <a class="reference internal" href="#tornado.web.MissingArgumentError" title="tornado.web.MissingArgumentError"><code class="xref py py-obj docutils literal"><span class="pre">MissingArgumentError</span></code></a> if it is missing.</p>
<p>If the argument appears in the url more than once, we return the
last value.</p>
<p>The returned value is always unicode.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.get_body_arguments">
<code class="descclassname">RequestHandler.</code><code class="descname">get_body_arguments</code><span class="sig-paren">(</span><em>name</em>, <em>strip=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get_body_arguments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get_body_arguments" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of the body arguments with the given name.</p>
<p>If the argument is not present, returns an empty list.</p>
<p>The returned values are always unicode.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.decode_argument">
<code class="descclassname">RequestHandler.</code><code class="descname">decode_argument</code><span class="sig-paren">(</span><em>value</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.decode_argument"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.decode_argument" title="Permalink to this definition">¶</a></dt>
<dd><p>Decodes an argument from the request.</p>
<p>The argument has been percent-decoded and is now a byte string.
By default, this method decodes the argument as utf-8 and returns
a unicode string, but this may be overridden in subclasses.</p>
<p>This method is used as a filter for both <a class="reference internal" href="#tornado.web.RequestHandler.get_argument" title="tornado.web.RequestHandler.get_argument"><code class="xref py py-obj docutils literal"><span class="pre">get_argument()</span></code></a> and for
values extracted from the url and passed to <a class="reference internal" href="#tornado.web.RequestHandler.get" title="tornado.web.RequestHandler.get"><code class="xref py py-obj docutils literal"><span class="pre">get()</span></code></a>/<a class="reference internal" href="#tornado.web.RequestHandler.post" title="tornado.web.RequestHandler.post"><code class="xref py py-obj docutils literal"><span class="pre">post()</span></code></a>/etc.</p>
<p>The name of the argument is provided if known, but may be None
(e.g. for unnamed groups in the url regex).</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.web.RequestHandler.request">
<code class="descclassname">RequestHandler.</code><code class="descname">request</code><a class="headerlink" href="#tornado.web.RequestHandler.request" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest" title="tornado.httputil.HTTPServerRequest"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httputil.HTTPServerRequest</span></code></a> object containing additional
request parameters including e.g. headers and body data.</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.web.RequestHandler.path_args">
<code class="descclassname">RequestHandler.</code><code class="descname">path_args</code><a class="headerlink" href="#tornado.web.RequestHandler.path_args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="tornado.web.RequestHandler.path_kwargs">
<code class="descclassname">RequestHandler.</code><code class="descname">path_kwargs</code><a class="headerlink" href="#tornado.web.RequestHandler.path_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>The <code class="docutils literal"><span class="pre">path_args</span></code> and <code class="docutils literal"><span class="pre">path_kwargs</span></code> attributes contain the
positional and keyword arguments that are passed to the
<a class="reference internal" href="#verbs"><span>HTTP verb methods</span></a>.  These attributes are set
before those methods are called, so the values are available
during <a class="reference internal" href="#tornado.web.RequestHandler.prepare" title="tornado.web.RequestHandler.prepare"><code class="xref py py-obj docutils literal"><span class="pre">prepare</span></code></a>.</p>
</dd></dl>

</div>
<div class="section" id="output">
<h6>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h6>
<dl class="method">
<dt id="tornado.web.RequestHandler.set_status">
<code class="descclassname">RequestHandler.</code><code class="descname">set_status</code><span class="sig-paren">(</span><em>status_code</em>, <em>reason=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.set_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.set_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the status code for our response.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>status_code</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#int" title="(in Python v3.4)"><em>int</em></a>) &#8211; Response status code. If <code class="docutils literal"><span class="pre">reason</span></code> is <code class="docutils literal"><span class="pre">None</span></code>,
it must be present in <a class="reference external" href="https://docs.python.org/3.4/library/http.client.html#http.client.responses" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">httplib.responses</span></code></a>.</li>
<li><strong>reason</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; Human-readable reason phrase describing the status
code. If <code class="docutils literal"><span class="pre">None</span></code>, it will be filled in from
<a class="reference external" href="https://docs.python.org/3.4/library/http.client.html#http.client.responses" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">httplib.responses</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.set_header">
<code class="descclassname">RequestHandler.</code><code class="descname">set_header</code><span class="sig-paren">(</span><em>name</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.set_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.set_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the given response header name and value.</p>
<p>If a datetime is given, we automatically format it according to the
HTTP specification. If the value is not a string, we convert it to
a string. All header values are then encoded as UTF-8.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.add_header">
<code class="descclassname">RequestHandler.</code><code class="descname">add_header</code><span class="sig-paren">(</span><em>name</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.add_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.add_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the given response header and value.</p>
<p>Unlike <a class="reference internal" href="#tornado.web.RequestHandler.set_header" title="tornado.web.RequestHandler.set_header"><code class="xref py py-obj docutils literal"><span class="pre">set_header</span></code></a>, <a class="reference internal" href="#tornado.web.RequestHandler.add_header" title="tornado.web.RequestHandler.add_header"><code class="xref py py-obj docutils literal"><span class="pre">add_header</span></code></a> may be called multiple times
to return multiple values for the same header.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.clear_header">
<code class="descclassname">RequestHandler.</code><code class="descname">clear_header</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.clear_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.clear_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears an outgoing header, undoing a previous <a class="reference internal" href="#tornado.web.RequestHandler.set_header" title="tornado.web.RequestHandler.set_header"><code class="xref py py-obj docutils literal"><span class="pre">set_header</span></code></a> call.</p>
<p>Note that this method does not apply to multi-valued headers
set by <a class="reference internal" href="#tornado.web.RequestHandler.add_header" title="tornado.web.RequestHandler.add_header"><code class="xref py py-obj docutils literal"><span class="pre">add_header</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.set_default_headers">
<code class="descclassname">RequestHandler.</code><code class="descname">set_default_headers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.set_default_headers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.set_default_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Override this to set HTTP headers at the beginning of the request.</p>
<p>For example, this is the place to set a custom <code class="docutils literal"><span class="pre">Server</span></code> header.
Note that setting such headers in the normal flow of request
processing may not do what you want, since headers may be reset
during error handling.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.write">
<code class="descclassname">RequestHandler.</code><code class="descname">write</code><span class="sig-paren">(</span><em>chunk</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the given chunk to the output buffer.</p>
<p>To write the output to the network, use the flush() method below.</p>
<p>If the given chunk is a dictionary, we write it as JSON and set
the Content-Type of the response to be <code class="docutils literal"><span class="pre">application/json</span></code>.
(if you want to send JSON as a different <code class="docutils literal"><span class="pre">Content-Type</span></code>, call
set_header <em>after</em> calling write()).</p>
<p>Note that lists are not converted to JSON because of a potential
cross-site security vulnerability.  All JSON output should be
wrapped in a dictionary.  More details at
<a class="reference external" href="http://haacked.com/archive/2009/06/25/json-hijacking.aspx/">http://haacked.com/archive/2009/06/25/json-hijacking.aspx/</a> and
<a class="reference external" href="https://github.com/facebook/tornado/issues/1009">https://github.com/facebook/tornado/issues/1009</a></p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.flush">
<code class="descclassname">RequestHandler.</code><code class="descname">flush</code><span class="sig-paren">(</span><em>include_footers=False</em>, <em>callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.flush"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Flushes the current output buffer to the network.</p>
<p>The <code class="docutils literal"><span class="pre">callback</span></code> argument, if given, can be used for flow control:
it will be run when all flushed data has been written to the socket.
Note that only one flush callback can be outstanding at a time;
if another flush occurs before the previous flush&#8217;s callback
has been run, the previous callback will be discarded.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>Now returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> if no callback is given.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.finish">
<code class="descclassname">RequestHandler.</code><code class="descname">finish</code><span class="sig-paren">(</span><em>chunk=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.finish"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.finish" title="Permalink to this definition">¶</a></dt>
<dd><p>Finishes this response, ending the HTTP request.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.render">
<code class="descclassname">RequestHandler.</code><code class="descname">render</code><span class="sig-paren">(</span><em>template_name</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.render"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Renders the template with the given arguments as the response.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.render_string">
<code class="descclassname">RequestHandler.</code><code class="descname">render_string</code><span class="sig-paren">(</span><em>template_name</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.render_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.render_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the given template with the given arguments.</p>
<p>We return the generated byte string (in utf8). To generate and
write a template as a response, use render() above.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.get_template_namespace">
<code class="descclassname">RequestHandler.</code><code class="descname">get_template_namespace</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get_template_namespace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get_template_namespace" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary to be used as the default template namespace.</p>
<p>May be overridden by subclasses to add or modify values.</p>
<p>The results of this method will be combined with additional
defaults in the <a class="reference internal" href="index.html#module-tornado.template" title="tornado.template"><code class="xref py py-obj docutils literal"><span class="pre">tornado.template</span></code></a> module and keyword arguments
to <a class="reference internal" href="#tornado.web.RequestHandler.render" title="tornado.web.RequestHandler.render"><code class="xref py py-obj docutils literal"><span class="pre">render</span></code></a> or <a class="reference internal" href="#tornado.web.RequestHandler.render_string" title="tornado.web.RequestHandler.render_string"><code class="xref py py-obj docutils literal"><span class="pre">render_string</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.redirect">
<code class="descclassname">RequestHandler.</code><code class="descname">redirect</code><span class="sig-paren">(</span><em>url</em>, <em>permanent=False</em>, <em>status=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.redirect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.redirect" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends a redirect to the given (optionally relative) URL.</p>
<p>If the <code class="docutils literal"><span class="pre">status</span></code> argument is specified, that value is used as the
HTTP status code; otherwise either 301 (permanent) or 302
(temporary) is chosen based on the <code class="docutils literal"><span class="pre">permanent</span></code> argument.
The default is 302 (temporary).</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.send_error">
<code class="descclassname">RequestHandler.</code><code class="descname">send_error</code><span class="sig-paren">(</span><em>status_code=500</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.send_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.send_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends the given HTTP error code to the browser.</p>
<p>If <a class="reference internal" href="#tornado.web.RequestHandler.flush" title="tornado.web.RequestHandler.flush"><code class="xref py py-obj docutils literal"><span class="pre">flush()</span></code></a> has already been called, it is not possible to send
an error, so this method will simply terminate the response.
If output has been written but not yet flushed, it will be discarded
and replaced with the error page.</p>
<p>Override <a class="reference internal" href="#tornado.web.RequestHandler.write_error" title="tornado.web.RequestHandler.write_error"><code class="xref py py-obj docutils literal"><span class="pre">write_error()</span></code></a> to customize the error page that is returned.
Additional keyword arguments are passed through to <a class="reference internal" href="#tornado.web.RequestHandler.write_error" title="tornado.web.RequestHandler.write_error"><code class="xref py py-obj docutils literal"><span class="pre">write_error</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.write_error">
<code class="descclassname">RequestHandler.</code><code class="descname">write_error</code><span class="sig-paren">(</span><em>status_code</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.write_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.write_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to implement custom error pages.</p>
<p><code class="docutils literal"><span class="pre">write_error</span></code> may call <a class="reference internal" href="#tornado.web.RequestHandler.write" title="tornado.web.RequestHandler.write"><code class="xref py py-obj docutils literal"><span class="pre">write</span></code></a>, <a class="reference internal" href="#tornado.web.RequestHandler.render" title="tornado.web.RequestHandler.render"><code class="xref py py-obj docutils literal"><span class="pre">render</span></code></a>, <a class="reference internal" href="#tornado.web.RequestHandler.set_header" title="tornado.web.RequestHandler.set_header"><code class="xref py py-obj docutils literal"><span class="pre">set_header</span></code></a>, etc
to produce output as usual.</p>
<p>If this error was caused by an uncaught exception (including
HTTPError), an <code class="docutils literal"><span class="pre">exc_info</span></code> triple will be available as
<code class="docutils literal"><span class="pre">kwargs[&quot;exc_info&quot;]</span></code>.  Note that this exception may not be
the &#8220;current&#8221; exception for purposes of methods like
<code class="docutils literal"><span class="pre">sys.exc_info()</span></code> or <code class="docutils literal"><span class="pre">traceback.format_exc</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.clear">
<code class="descclassname">RequestHandler.</code><code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.clear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets all headers and content for this response.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.data_received">
<code class="descclassname">RequestHandler.</code><code class="descname">data_received</code><span class="sig-paren">(</span><em>chunk</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.data_received"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.data_received" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement this method to handle streamed request data.</p>
<p>Requires the <a class="reference internal" href="#tornado.web.stream_request_body" title="tornado.web.stream_request_body"><code class="xref py py-obj docutils literal"><span class="pre">stream_request_body</span></code></a> decorator.</p>
</dd></dl>

</div>
<div class="section" id="cookies">
<h6>Cookies<a class="headerlink" href="#cookies" title="Permalink to this headline">¶</a></h6>
<dl class="attribute">
<dt id="tornado.web.RequestHandler.cookies">
<code class="descclassname">RequestHandler.</code><code class="descname">cookies</code><a class="headerlink" href="#tornado.web.RequestHandler.cookies" title="Permalink to this definition">¶</a></dt>
<dd><p>An alias for
<a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest.cookies" title="tornado.httputil.HTTPServerRequest.cookies"><code class="xref py py-obj docutils literal"><span class="pre">self.request.cookies</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.get_cookie">
<code class="descclassname">RequestHandler.</code><code class="descname">get_cookie</code><span class="sig-paren">(</span><em>name</em>, <em>default=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get_cookie"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get_cookie" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the value of the cookie with the given name, else default.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.set_cookie">
<code class="descclassname">RequestHandler.</code><code class="descname">set_cookie</code><span class="sig-paren">(</span><em>name</em>, <em>value</em>, <em>domain=None</em>, <em>expires=None</em>, <em>path='/'</em>, <em>expires_days=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.set_cookie"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.set_cookie" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the given cookie name/value with the given options.</p>
<p>Additional keyword arguments are set on the Cookie.Morsel
directly.
See <a class="reference external" href="http://docs.python.org/library/cookie.html#morsel-objects">http://docs.python.org/library/cookie.html#morsel-objects</a>
for available attributes.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.clear_cookie">
<code class="descclassname">RequestHandler.</code><code class="descname">clear_cookie</code><span class="sig-paren">(</span><em>name</em>, <em>path='/'</em>, <em>domain=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.clear_cookie"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.clear_cookie" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes the cookie with the given name.</p>
<p>Due to limitations of the cookie protocol, you must pass the same
path and domain to clear a cookie as were used when that cookie
was set (but there is no way to find out on the server side
which values were used for a given cookie).</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.clear_all_cookies">
<code class="descclassname">RequestHandler.</code><code class="descname">clear_all_cookies</code><span class="sig-paren">(</span><em>path='/'</em>, <em>domain=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.clear_all_cookies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.clear_all_cookies" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes all the cookies the user sent with this request.</p>
<p>See <a class="reference internal" href="#tornado.web.RequestHandler.clear_cookie" title="tornado.web.RequestHandler.clear_cookie"><code class="xref py py-obj docutils literal"><span class="pre">clear_cookie</span></code></a> for more information on the path and domain
parameters.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.2: </span>Added the <code class="docutils literal"><span class="pre">path</span></code> and <code class="docutils literal"><span class="pre">domain</span></code> parameters.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.get_secure_cookie">
<code class="descclassname">RequestHandler.</code><code class="descname">get_secure_cookie</code><span class="sig-paren">(</span><em>name</em>, <em>value=None</em>, <em>max_age_days=31</em>, <em>min_version=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get_secure_cookie"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get_secure_cookie" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the given signed cookie if it validates, or None.</p>
<p>The decoded cookie value is returned as a byte string (unlike
<a class="reference internal" href="#tornado.web.RequestHandler.get_cookie" title="tornado.web.RequestHandler.get_cookie"><code class="xref py py-obj docutils literal"><span class="pre">get_cookie</span></code></a>).</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.2.1: </span>Added the <code class="docutils literal"><span class="pre">min_version</span></code> argument.  Introduced cookie version 2;
both versions 1 and 2 are accepted by default.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.get_secure_cookie_key_version">
<code class="descclassname">RequestHandler.</code><code class="descname">get_secure_cookie_key_version</code><span class="sig-paren">(</span><em>name</em>, <em>value=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get_secure_cookie_key_version"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get_secure_cookie_key_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the signing key version of the secure cookie.</p>
<p>The version is returned as int.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.set_secure_cookie">
<code class="descclassname">RequestHandler.</code><code class="descname">set_secure_cookie</code><span class="sig-paren">(</span><em>name</em>, <em>value</em>, <em>expires_days=30</em>, <em>version=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.set_secure_cookie"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.set_secure_cookie" title="Permalink to this definition">¶</a></dt>
<dd><p>Signs and timestamps a cookie so it cannot be forged.</p>
<p>You must specify the <code class="docutils literal"><span class="pre">cookie_secret</span></code> setting in your Application
to use this method. It should be a long, random sequence of bytes
to be used as the HMAC secret for the signature.</p>
<p>To read a cookie set with this method, use <a class="reference internal" href="#tornado.web.RequestHandler.get_secure_cookie" title="tornado.web.RequestHandler.get_secure_cookie"><code class="xref py py-obj docutils literal"><span class="pre">get_secure_cookie()</span></code></a>.</p>
<p>Note that the <code class="docutils literal"><span class="pre">expires_days</span></code> parameter sets the lifetime of the
cookie in the browser, but is independent of the <code class="docutils literal"><span class="pre">max_age_days</span></code>
parameter to <a class="reference internal" href="#tornado.web.RequestHandler.get_secure_cookie" title="tornado.web.RequestHandler.get_secure_cookie"><code class="xref py py-obj docutils literal"><span class="pre">get_secure_cookie</span></code></a>.</p>
<p>Secure cookies may contain arbitrary byte values, not just unicode
strings (unlike regular cookies)</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.2.1: </span>Added the <code class="docutils literal"><span class="pre">version</span></code> argument.  Introduced cookie version 2
and made it the default.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.create_signed_value">
<code class="descclassname">RequestHandler.</code><code class="descname">create_signed_value</code><span class="sig-paren">(</span><em>name</em>, <em>value</em>, <em>version=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.create_signed_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.create_signed_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Signs and timestamps a string so it cannot be forged.</p>
<p>Normally used via set_secure_cookie, but provided as a separate
method for non-cookie uses.  To decode a value not stored
as a cookie use the optional value argument to get_secure_cookie.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.2.1: </span>Added the <code class="docutils literal"><span class="pre">version</span></code> argument.  Introduced cookie version 2
and made it the default.</p>
</div>
</dd></dl>

<dl class="data">
<dt id="tornado.web.MIN_SUPPORTED_SIGNED_VALUE_VERSION">
<code class="descclassname">tornado.web.</code><code class="descname">MIN_SUPPORTED_SIGNED_VALUE_VERSION</code><em class="property"> = 1</em><a class="headerlink" href="#tornado.web.MIN_SUPPORTED_SIGNED_VALUE_VERSION" title="Permalink to this definition">¶</a></dt>
<dd><p>The oldest signed value version supported by this version of Tornado.</p>
<p>Signed values older than this version cannot be decoded.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2.1.</span></p>
</div>
</dd></dl>

<dl class="data">
<dt id="tornado.web.MAX_SUPPORTED_SIGNED_VALUE_VERSION">
<code class="descclassname">tornado.web.</code><code class="descname">MAX_SUPPORTED_SIGNED_VALUE_VERSION</code><em class="property"> = 2</em><a class="headerlink" href="#tornado.web.MAX_SUPPORTED_SIGNED_VALUE_VERSION" title="Permalink to this definition">¶</a></dt>
<dd><p>The newest signed value version supported by this version of Tornado.</p>
<p>Signed values newer than this version cannot be decoded.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2.1.</span></p>
</div>
</dd></dl>

<dl class="data">
<dt id="tornado.web.DEFAULT_SIGNED_VALUE_VERSION">
<code class="descclassname">tornado.web.</code><code class="descname">DEFAULT_SIGNED_VALUE_VERSION</code><em class="property"> = 2</em><a class="headerlink" href="#tornado.web.DEFAULT_SIGNED_VALUE_VERSION" title="Permalink to this definition">¶</a></dt>
<dd><p>The signed value version produced by <a class="reference internal" href="#tornado.web.RequestHandler.create_signed_value" title="tornado.web.RequestHandler.create_signed_value"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.create_signed_value</span></code></a>.</p>
<p>May be overridden by passing a <code class="docutils literal"><span class="pre">version</span></code> keyword argument.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2.1.</span></p>
</div>
</dd></dl>

<dl class="data">
<dt id="tornado.web.DEFAULT_SIGNED_VALUE_MIN_VERSION">
<code class="descclassname">tornado.web.</code><code class="descname">DEFAULT_SIGNED_VALUE_MIN_VERSION</code><em class="property"> = 1</em><a class="headerlink" href="#tornado.web.DEFAULT_SIGNED_VALUE_MIN_VERSION" title="Permalink to this definition">¶</a></dt>
<dd><p>The oldest signed value accepted by <a class="reference internal" href="#tornado.web.RequestHandler.get_secure_cookie" title="tornado.web.RequestHandler.get_secure_cookie"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_secure_cookie</span></code></a>.</p>
<p>May be overridden by passing a <code class="docutils literal"><span class="pre">min_version</span></code> keyword argument.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2.1.</span></p>
</div>
</dd></dl>

</div>
<div class="section" id="other">
<h6>Other<a class="headerlink" href="#other" title="Permalink to this headline">¶</a></h6>
<dl class="attribute">
<dt id="tornado.web.RequestHandler.application">
<code class="descclassname">RequestHandler.</code><code class="descname">application</code><a class="headerlink" href="#tornado.web.RequestHandler.application" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> object serving this request</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.check_etag_header">
<code class="descclassname">RequestHandler.</code><code class="descname">check_etag_header</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.check_etag_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.check_etag_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the <code class="docutils literal"><span class="pre">Etag</span></code> header against requests&#8217;s <code class="docutils literal"><span class="pre">If-None-Match</span></code>.</p>
<p>Returns <code class="docutils literal"><span class="pre">True</span></code> if the request&#8217;s Etag matches and a 304 should be
returned. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="bp">self</span><span class="o">.</span><span class="n">set_etag_header</span><span class="p">()</span>
<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_etag_header</span><span class="p">():</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="mi">304</span><span class="p">)</span>
    <span class="k">return</span>
</pre></div>
</div>
<p>This method is called automatically when the request is finished,
but may be called earlier for applications that override
<a class="reference internal" href="#tornado.web.RequestHandler.compute_etag" title="tornado.web.RequestHandler.compute_etag"><code class="xref py py-obj docutils literal"><span class="pre">compute_etag</span></code></a> and want to do an early check for <code class="docutils literal"><span class="pre">If-None-Match</span></code>
before completing the request.  The <code class="docutils literal"><span class="pre">Etag</span></code> header should be set
(perhaps with <a class="reference internal" href="#tornado.web.RequestHandler.set_etag_header" title="tornado.web.RequestHandler.set_etag_header"><code class="xref py py-obj docutils literal"><span class="pre">set_etag_header</span></code></a>) before calling this method.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.check_xsrf_cookie">
<code class="descclassname">RequestHandler.</code><code class="descname">check_xsrf_cookie</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.check_xsrf_cookie"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.check_xsrf_cookie" title="Permalink to this definition">¶</a></dt>
<dd><p>Verifies that the <code class="docutils literal"><span class="pre">_xsrf</span></code> cookie matches the <code class="docutils literal"><span class="pre">_xsrf</span></code> argument.</p>
<p>To prevent cross-site request forgery, we set an <code class="docutils literal"><span class="pre">_xsrf</span></code>
cookie and include the same value as a non-cookie
field with all <code class="docutils literal"><span class="pre">POST</span></code> requests. If the two do not match, we
reject the form submission as a potential forgery.</p>
<p>The <code class="docutils literal"><span class="pre">_xsrf</span></code> value may be set as either a form field named <code class="docutils literal"><span class="pre">_xsrf</span></code>
or in a custom HTTP header named <code class="docutils literal"><span class="pre">X-XSRFToken</span></code> or <code class="docutils literal"><span class="pre">X-CSRFToken</span></code>
(the latter is accepted for compatibility with Django).</p>
<p>See <a class="reference external" href="http://en.wikipedia.org/wiki/Cross-site_request_forgery">http://en.wikipedia.org/wiki/Cross-site_request_forgery</a></p>
<p>Prior to release 1.1.1, this check was ignored if the HTTP header
<code class="docutils literal"><span class="pre">X-Requested-With:</span> <span class="pre">XMLHTTPRequest</span></code> was present.  This exception
has been shown to be insecure and has been removed.  For more
information please see
<a class="reference external" href="http://www.djangoproject.com/weblog/2011/feb/08/security/">http://www.djangoproject.com/weblog/2011/feb/08/security/</a>
<a class="reference external" href="http://weblog.rubyonrails.org/2011/2/8/csrf-protection-bypass-in-ruby-on-rails">http://weblog.rubyonrails.org/2011/2/8/csrf-protection-bypass-in-ruby-on-rails</a></p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.2.2: </span>Added support for cookie version 2.  Both versions 1 and 2 are
supported.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.compute_etag">
<code class="descclassname">RequestHandler.</code><code class="descname">compute_etag</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.compute_etag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.compute_etag" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the etag header to be used for this request.</p>
<p>By default uses a hash of the content written so far.</p>
<p>May be overridden to provide custom etag implementations,
or may return None to disable tornado&#8217;s default etag support.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.create_template_loader">
<code class="descclassname">RequestHandler.</code><code class="descname">create_template_loader</code><span class="sig-paren">(</span><em>template_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.create_template_loader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.create_template_loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new template loader for the given path.</p>
<p>May be overridden by subclasses.  By default returns a
directory-based loader on the given path, using the
<code class="docutils literal"><span class="pre">autoescape</span></code> and <code class="docutils literal"><span class="pre">template_whitespace</span></code> application
settings.  If a <code class="docutils literal"><span class="pre">template_loader</span></code> application setting is
supplied, uses that instead.</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.web.RequestHandler.current_user">
<code class="descclassname">RequestHandler.</code><code class="descname">current_user</code><a class="headerlink" href="#tornado.web.RequestHandler.current_user" title="Permalink to this definition">¶</a></dt>
<dd><p>The authenticated user for this request.</p>
<p>This is set in one of two ways:</p>
<ul>
<li><p class="first">A subclass may override <a class="reference internal" href="#tornado.web.RequestHandler.get_current_user" title="tornado.web.RequestHandler.get_current_user"><code class="xref py py-obj docutils literal"><span class="pre">get_current_user()</span></code></a>, which will be called
automatically the first time <code class="docutils literal"><span class="pre">self.current_user</span></code> is accessed.
<a class="reference internal" href="#tornado.web.RequestHandler.get_current_user" title="tornado.web.RequestHandler.get_current_user"><code class="xref py py-obj docutils literal"><span class="pre">get_current_user()</span></code></a> will only be called once per request,
and is cached for future access:</p>
<div class="highlight-python"><div class="highlight"><pre>def get_current_user(self):
    user_cookie = self.get_secure_cookie(&quot;user&quot;)
        if user_cookie:
            return json.loads(user_cookie)
    return None
</pre></div>
</div>
</li>
<li><p class="first">It may be set as a normal variable, typically from an overridden
<a class="reference internal" href="#tornado.web.RequestHandler.prepare" title="tornado.web.RequestHandler.prepare"><code class="xref py py-obj docutils literal"><span class="pre">prepare()</span></code></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">user_id_cookie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_secure_cookie</span><span class="p">(</span><span class="s">&quot;user_id&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">user_id_cookie</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_user</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">load_user</span><span class="p">(</span><span class="n">user_id_cookie</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p>Note that <a class="reference internal" href="#tornado.web.RequestHandler.prepare" title="tornado.web.RequestHandler.prepare"><code class="xref py py-obj docutils literal"><span class="pre">prepare()</span></code></a> may be a coroutine while <a class="reference internal" href="#tornado.web.RequestHandler.get_current_user" title="tornado.web.RequestHandler.get_current_user"><code class="xref py py-obj docutils literal"><span class="pre">get_current_user()</span></code></a>
may not, so the latter form is necessary if loading the user requires
asynchronous operations.</p>
<p>The user object may any type of the application&#8217;s choosing.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.get_browser_locale">
<code class="descclassname">RequestHandler.</code><code class="descname">get_browser_locale</code><span class="sig-paren">(</span><em>default='en_US'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get_browser_locale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get_browser_locale" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the user&#8217;s locale from <code class="docutils literal"><span class="pre">Accept-Language</span></code> header.</p>
<p>See <a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.4">http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.4</a></p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.get_current_user">
<code class="descclassname">RequestHandler.</code><code class="descname">get_current_user</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get_current_user"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get_current_user" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to determine the current user from, e.g., a cookie.</p>
<p>This method may not be a coroutine.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.get_login_url">
<code class="descclassname">RequestHandler.</code><code class="descname">get_login_url</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get_login_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get_login_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to customize the login URL based on the request.</p>
<p>By default, we use the <code class="docutils literal"><span class="pre">login_url</span></code> application setting.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.get_status">
<code class="descclassname">RequestHandler.</code><code class="descname">get_status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the status code for our response.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.get_template_path">
<code class="descclassname">RequestHandler.</code><code class="descname">get_template_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get_template_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get_template_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to customize template path for each handler.</p>
<p>By default, we use the <code class="docutils literal"><span class="pre">template_path</span></code> application setting.
Return None to load templates relative to the calling file.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.get_user_locale">
<code class="descclassname">RequestHandler.</code><code class="descname">get_user_locale</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.get_user_locale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.get_user_locale" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to determine the locale from the authenticated user.</p>
<p>If None is returned, we fall back to <a class="reference internal" href="#tornado.web.RequestHandler.get_browser_locale" title="tornado.web.RequestHandler.get_browser_locale"><code class="xref py py-obj docutils literal"><span class="pre">get_browser_locale()</span></code></a>.</p>
<p>This method should return a <a class="reference internal" href="index.html#tornado.locale.Locale" title="tornado.locale.Locale"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locale.Locale</span></code></a> object,
most likely obtained via a call like <code class="docutils literal"><span class="pre">tornado.locale.get(&quot;en&quot;)</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.web.RequestHandler.locale">
<code class="descclassname">RequestHandler.</code><code class="descname">locale</code><a class="headerlink" href="#tornado.web.RequestHandler.locale" title="Permalink to this definition">¶</a></dt>
<dd><p>The locale for the current session.</p>
<p>Determined by either <a class="reference internal" href="#tornado.web.RequestHandler.get_user_locale" title="tornado.web.RequestHandler.get_user_locale"><code class="xref py py-obj docutils literal"><span class="pre">get_user_locale</span></code></a>, which you can override to
set the locale based on, e.g., a user preference stored in a
database, or <a class="reference internal" href="#tornado.web.RequestHandler.get_browser_locale" title="tornado.web.RequestHandler.get_browser_locale"><code class="xref py py-obj docutils literal"><span class="pre">get_browser_locale</span></code></a>, which uses the <code class="docutils literal"><span class="pre">Accept-Language</span></code>
header.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.log_exception">
<code class="descclassname">RequestHandler.</code><code class="descname">log_exception</code><span class="sig-paren">(</span><em>typ</em>, <em>value</em>, <em>tb</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.log_exception"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.log_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to customize logging of uncaught exceptions.</p>
<p>By default logs instances of <a class="reference internal" href="#tornado.web.HTTPError" title="tornado.web.HTTPError"><code class="xref py py-obj docutils literal"><span class="pre">HTTPError</span></code></a> as warnings without
stack traces (on the <code class="docutils literal"><span class="pre">tornado.general</span></code> logger), and all
other exceptions as errors with stack traces (on the
<code class="docutils literal"><span class="pre">tornado.application</span></code> logger).</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.on_connection_close">
<code class="descclassname">RequestHandler.</code><code class="descname">on_connection_close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.on_connection_close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.on_connection_close" title="Permalink to this definition">¶</a></dt>
<dd><p>Called in async handlers if the client closed the connection.</p>
<p>Override this to clean up resources associated with
long-lived connections.  Note that this method is called only if
the connection was closed during asynchronous processing; if you
need to do cleanup after every request override <a class="reference internal" href="#tornado.web.RequestHandler.on_finish" title="tornado.web.RequestHandler.on_finish"><code class="xref py py-obj docutils literal"><span class="pre">on_finish</span></code></a>
instead.</p>
<p>Proxies may keep a connection open for a time (perhaps
indefinitely) after the client has gone away, so this method
may not be called promptly after the end user closes their
connection.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.require_setting">
<code class="descclassname">RequestHandler.</code><code class="descname">require_setting</code><span class="sig-paren">(</span><em>name</em>, <em>feature='this feature'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.require_setting"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.require_setting" title="Permalink to this definition">¶</a></dt>
<dd><p>Raises an exception if the given app setting is not defined.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.reverse_url">
<code class="descclassname">RequestHandler.</code><code class="descname">reverse_url</code><span class="sig-paren">(</span><em>name</em>, <em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.reverse_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.reverse_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for <a class="reference internal" href="#tornado.web.Application.reverse_url" title="tornado.web.Application.reverse_url"><code class="xref py py-obj docutils literal"><span class="pre">Application.reverse_url</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.set_etag_header">
<code class="descclassname">RequestHandler.</code><code class="descname">set_etag_header</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.set_etag_header"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.set_etag_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the response&#8217;s Etag header using <code class="docutils literal"><span class="pre">self.compute_etag()</span></code>.</p>
<p>Note: no header will be set if <code class="docutils literal"><span class="pre">compute_etag()</span></code> returns <code class="docutils literal"><span class="pre">None</span></code>.</p>
<p>This method is called automatically when the request is finished.</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.web.RequestHandler.settings">
<code class="descclassname">RequestHandler.</code><code class="descname">settings</code><a class="headerlink" href="#tornado.web.RequestHandler.settings" title="Permalink to this definition">¶</a></dt>
<dd><p>An alias for <a class="reference internal" href="#tornado.web.Application.settings" title="tornado.web.Application.settings"><code class="xref py py-obj docutils literal"><span class="pre">self.application.settings</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.static_url">
<code class="descclassname">RequestHandler.</code><code class="descname">static_url</code><span class="sig-paren">(</span><em>path</em>, <em>include_host=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.static_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.static_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a static URL for the given relative static file path.</p>
<p>This method requires you set the <code class="docutils literal"><span class="pre">static_path</span></code> setting in your
application (which specifies the root directory of your static
files).</p>
<p>This method returns a versioned url (by default appending
<code class="docutils literal"><span class="pre">?v=&lt;signature&gt;</span></code>), which allows the static files to be
cached indefinitely.  This can be disabled by passing
<code class="docutils literal"><span class="pre">include_version=False</span></code> (in the default implementation;
other static file implementations are not required to support
this, but they may support other options).</p>
<p>By default this method returns URLs relative to the current
host, but if <code class="docutils literal"><span class="pre">include_host</span></code> is true the URL returned will be
absolute.  If this handler has an <code class="docutils literal"><span class="pre">include_host</span></code> attribute,
that value will be used as the default for all <a class="reference internal" href="#tornado.web.RequestHandler.static_url" title="tornado.web.RequestHandler.static_url"><code class="xref py py-obj docutils literal"><span class="pre">static_url</span></code></a>
calls that do not pass <code class="docutils literal"><span class="pre">include_host</span></code> as a keyword argument.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.RequestHandler.xsrf_form_html">
<code class="descclassname">RequestHandler.</code><code class="descname">xsrf_form_html</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RequestHandler.xsrf_form_html"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RequestHandler.xsrf_form_html" title="Permalink to this definition">¶</a></dt>
<dd><p>An HTML <code class="docutils literal"><span class="pre">&lt;input/&gt;</span></code> element to be included with all POST forms.</p>
<p>It defines the <code class="docutils literal"><span class="pre">_xsrf</span></code> input value, which we check on all POST
requests to prevent cross-site request forgery. If you have set
the <code class="docutils literal"><span class="pre">xsrf_cookies</span></code> application setting, you must include this
HTML within all of your HTML forms.</p>
<p>In a template, this method should be called with <code class="docutils literal"><span class="pre">{%</span> <span class="pre">module</span>
<span class="pre">xsrf_form_html()</span> <span class="pre">%}</span></code></p>
<p>See <a class="reference internal" href="#tornado.web.RequestHandler.check_xsrf_cookie" title="tornado.web.RequestHandler.check_xsrf_cookie"><code class="xref py py-obj docutils literal"><span class="pre">check_xsrf_cookie()</span></code></a> above for more information.</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.web.RequestHandler.xsrf_token">
<code class="descclassname">RequestHandler.</code><code class="descname">xsrf_token</code><a class="headerlink" href="#tornado.web.RequestHandler.xsrf_token" title="Permalink to this definition">¶</a></dt>
<dd><p>The XSRF-prevention token for the current user/session.</p>
<p>To prevent cross-site request forgery, we set an &#8216;_xsrf&#8217; cookie
and include the same &#8216;_xsrf&#8217; value as an argument with all POST
requests. If the two do not match, we reject the form submission
as a potential forgery.</p>
<p>See <a class="reference external" href="http://en.wikipedia.org/wiki/Cross-site_request_forgery">http://en.wikipedia.org/wiki/Cross-site_request_forgery</a></p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.2.2: </span>The xsrf token will now be have a random mask applied in every
request, which makes it safe to include the token in pages
that are compressed.  See <a class="reference external" href="http://breachattack.com">http://breachattack.com</a> for more
information on the issue fixed by this change.  Old (version 1)
cookies will be converted to version 2 when this method is called
unless the <code class="docutils literal"><span class="pre">xsrf_cookie_version</span></code> <a class="reference internal" href="#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> setting is
set to 1.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>The <code class="docutils literal"><span class="pre">xsrf_cookie_kwargs</span></code> <a class="reference internal" href="#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> setting may be
used to supply additional cookie options (which will be
passed directly to <a class="reference internal" href="#tornado.web.RequestHandler.set_cookie" title="tornado.web.RequestHandler.set_cookie"><code class="xref py py-obj docutils literal"><span class="pre">set_cookie</span></code></a>). For example,
<code class="docutils literal"><span class="pre">xsrf_cookie_kwargs=dict(httponly=True,</span> <span class="pre">secure=True)</span></code>
will set the <code class="docutils literal"><span class="pre">secure</span></code> and <code class="docutils literal"><span class="pre">httponly</span></code> flags on the
<code class="docutils literal"><span class="pre">_xsrf</span></code> cookie.</p>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="application-configuration">
<h5>Application configuration<a class="headerlink" href="#application-configuration" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.web.Application">
<em class="property">class </em><code class="descclassname">tornado.web.</code><code class="descname">Application</code><span class="sig-paren">(</span><em>handlers=None</em>, <em>default_host=''</em>, <em>transforms=None</em>, <em>**settings</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#Application"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.Application" title="Permalink to this definition">¶</a></dt>
<dd><p>A collection of request handlers that make up a web application.</p>
<p>Instances of this class are callable and can be passed directly to
HTTPServer to serve the application:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">application</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="s">r&quot;/&quot;</span><span class="p">,</span> <span class="n">MainPageHandler</span><span class="p">),</span>
<span class="p">])</span>
<span class="n">http_server</span> <span class="o">=</span> <span class="n">httpserver</span><span class="o">.</span><span class="n">HTTPServer</span><span class="p">(</span><span class="n">application</span><span class="p">)</span>
<span class="n">http_server</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">8080</span><span class="p">)</span>
<span class="n">ioloop</span><span class="o">.</span><span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>The constructor for this class takes in a list of <a class="reference internal" href="#tornado.web.URLSpec" title="tornado.web.URLSpec"><code class="xref py py-obj docutils literal"><span class="pre">URLSpec</span></code></a> objects
or (regexp, request_class) tuples. When we receive requests, we
iterate over the list in order and instantiate an instance of the
first request class whose regexp matches the request path.
The request class can be specified as either a class object or a
(fully-qualified) name.</p>
<p>Each tuple can contain additional elements, which correspond to the
arguments to the <a class="reference internal" href="#tornado.web.URLSpec" title="tornado.web.URLSpec"><code class="xref py py-obj docutils literal"><span class="pre">URLSpec</span></code></a> constructor.  (Prior to Tornado 3.2,
only tuples of two or three elements were allowed).</p>
<p>A dictionary may be passed as the third element of the tuple,
which will be used as keyword arguments to the handler&#8217;s
constructor and <a class="reference internal" href="#tornado.web.RequestHandler.initialize" title="tornado.web.RequestHandler.initialize"><code class="xref py py-obj docutils literal"><span class="pre">initialize</span></code></a> method.  This pattern
is used for the <a class="reference internal" href="#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> in this example (note that a
<a class="reference internal" href="#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> can be installed automatically with the
static_path setting described below):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">application</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="s">r&quot;/static/(.*)&quot;</span><span class="p">,</span> <span class="n">web</span><span class="o">.</span><span class="n">StaticFileHandler</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;path&quot;</span><span class="p">:</span> <span class="s">&quot;/var/www&quot;</span><span class="p">}),</span>
<span class="p">])</span>
</pre></div>
</div>
<p>We support virtual hosts with the <a class="reference internal" href="#tornado.web.Application.add_handlers" title="tornado.web.Application.add_handlers"><code class="xref py py-obj docutils literal"><span class="pre">add_handlers</span></code></a> method, which takes in
a host regular expression as the first argument:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">application</span><span class="o">.</span><span class="n">add_handlers</span><span class="p">(</span><span class="s">r&quot;www\.myhost\.com&quot;</span><span class="p">,</span> <span class="p">[</span>
    <span class="p">(</span><span class="s">r&quot;/article/([0-9]+)&quot;</span><span class="p">,</span> <span class="n">ArticleHandler</span><span class="p">),</span>
<span class="p">])</span>
</pre></div>
</div>
<p>You can serve static files by sending the <code class="docutils literal"><span class="pre">static_path</span></code> setting
as a keyword argument. We will serve those files from the
<code class="docutils literal"><span class="pre">/static/</span></code> URI (this is configurable with the
<code class="docutils literal"><span class="pre">static_url_prefix</span></code> setting), and we will serve <code class="docutils literal"><span class="pre">/favicon.ico</span></code>
and <code class="docutils literal"><span class="pre">/robots.txt</span></code> from the same directory.  A custom subclass of
<a class="reference internal" href="#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> can be specified with the
<code class="docutils literal"><span class="pre">static_handler_class</span></code> setting.</p>
<dl class="attribute">
<dt id="tornado.web.Application.settings">
<code class="descname">settings</code><a class="headerlink" href="#tornado.web.Application.settings" title="Permalink to this definition">¶</a></dt>
<dd><p>Additional keyword arguments passed to the constructor are
saved in the <a class="reference internal" href="#tornado.web.Application.settings" title="tornado.web.Application.settings"><code class="xref py py-obj docutils literal"><span class="pre">settings</span></code></a> dictionary, and are often referred to
in documentation as &#8220;application settings&#8221;.  Settings are
used to customize various aspects of Tornado (although in
some cases richer customization is possible by overriding
methods in a subclass of <a class="reference internal" href="#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a>).  Some
applications also like to use the <a class="reference internal" href="#tornado.web.Application.settings" title="tornado.web.Application.settings"><code class="xref py py-obj docutils literal"><span class="pre">settings</span></code></a> dictionary as a
way to make application-specific settings available to
handlers without using global variables.  Settings used in
Tornado are described below.</p>
<p>General settings:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">autoreload</span></code>: If <code class="docutils literal"><span class="pre">True</span></code>, the server process will restart
when any source files change, as described in <a class="reference internal" href="index.html#debug-mode"><span>Debug mode and automatic reloading</span></a>.
This option is new in Tornado 3.2; previously this functionality
was controlled by the <code class="docutils literal"><span class="pre">debug</span></code> setting.</li>
<li><code class="docutils literal"><span class="pre">debug</span></code>: Shorthand for several debug mode settings,
described in <a class="reference internal" href="index.html#debug-mode"><span>Debug mode and automatic reloading</span></a>.  Setting <code class="docutils literal"><span class="pre">debug=True</span></code> is
equivalent to <code class="docutils literal"><span class="pre">autoreload=True</span></code>, <code class="docutils literal"><span class="pre">compiled_template_cache=False</span></code>,
<code class="docutils literal"><span class="pre">static_hash_cache=False</span></code>, <code class="docutils literal"><span class="pre">serve_traceback=True</span></code>.</li>
<li><code class="docutils literal"><span class="pre">default_handler_class</span></code> and <code class="docutils literal"><span class="pre">default_handler_args</span></code>:
This handler will be used if no other match is found;
use this to implement custom 404 pages (new in Tornado 3.2).</li>
<li><code class="docutils literal"><span class="pre">compress_response</span></code>: If <code class="docutils literal"><span class="pre">True</span></code>, responses in textual formats
will be compressed automatically.  New in Tornado 4.0.</li>
<li><code class="docutils literal"><span class="pre">gzip</span></code>: Deprecated alias for <code class="docutils literal"><span class="pre">compress_response</span></code> since
Tornado 4.0.</li>
<li><code class="docutils literal"><span class="pre">log_function</span></code>: This function will be called at the end
of every request to log the result (with one argument, the
<a class="reference internal" href="#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> object).  The default implementation
writes to the <a class="reference external" href="https://docs.python.org/3.4/library/logging.html#module-logging" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">logging</span></code></a> module&#8217;s root logger.  May also be
customized by overriding <a class="reference internal" href="#tornado.web.Application.log_request" title="tornado.web.Application.log_request"><code class="xref py py-obj docutils literal"><span class="pre">Application.log_request</span></code></a>.</li>
<li><code class="docutils literal"><span class="pre">serve_traceback</span></code>: If true, the default error page
will include the traceback of the error.  This option is new in
Tornado 3.2; previously this functionality was controlled by
the <code class="docutils literal"><span class="pre">debug</span></code> setting.</li>
<li><code class="docutils literal"><span class="pre">ui_modules</span></code> and <code class="docutils literal"><span class="pre">ui_methods</span></code>: May be set to a mapping
of <a class="reference internal" href="#tornado.web.UIModule" title="tornado.web.UIModule"><code class="xref py py-obj docutils literal"><span class="pre">UIModule</span></code></a> or UI methods to be made available to templates.
May be set to a module, dictionary, or a list of modules
and/or dicts.  See <a class="reference internal" href="index.html#ui-modules"><span>UI modules</span></a> for more details.</li>
</ul>
<p>Authentication and security settings:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cookie_secret</span></code>: Used by <a class="reference internal" href="#tornado.web.RequestHandler.get_secure_cookie" title="tornado.web.RequestHandler.get_secure_cookie"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_secure_cookie</span></code></a>
and <a class="reference internal" href="#tornado.web.RequestHandler.set_secure_cookie" title="tornado.web.RequestHandler.set_secure_cookie"><code class="xref py py-obj docutils literal"><span class="pre">set_secure_cookie</span></code></a> to sign cookies.</li>
<li><code class="docutils literal"><span class="pre">key_version</span></code>: Used by requestHandler <a class="reference internal" href="#tornado.web.RequestHandler.set_secure_cookie" title="tornado.web.RequestHandler.set_secure_cookie"><code class="xref py py-obj docutils literal"><span class="pre">set_secure_cookie</span></code></a>
to sign cookies with a specific key when <code class="docutils literal"><span class="pre">cookie_secret</span></code>
is a key dictionary.</li>
<li><code class="docutils literal"><span class="pre">login_url</span></code>: The <a class="reference internal" href="#tornado.web.authenticated" title="tornado.web.authenticated"><code class="xref py py-obj docutils literal"><span class="pre">authenticated</span></code></a> decorator will redirect
to this url if the user is not logged in.  Can be further
customized by overriding <a class="reference internal" href="#tornado.web.RequestHandler.get_login_url" title="tornado.web.RequestHandler.get_login_url"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_login_url</span></code></a></li>
<li><code class="docutils literal"><span class="pre">xsrf_cookies</span></code>: If true, <a class="reference internal" href="index.html#xsrf"><span>Cross-site request forgery protection</span></a> will be enabled.</li>
<li><code class="docutils literal"><span class="pre">xsrf_cookie_version</span></code>: Controls the version of new XSRF
cookies produced by this server.  Should generally be left
at the default (which will always be the highest supported
version), but may be set to a lower value temporarily
during version transitions.  New in Tornado 3.2.2, which
introduced XSRF cookie version 2.</li>
<li><code class="docutils literal"><span class="pre">xsrf_cookie_kwargs</span></code>: May be set to a dictionary of
additional arguments to be passed to <a class="reference internal" href="#tornado.web.RequestHandler.set_cookie" title="tornado.web.RequestHandler.set_cookie"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.set_cookie</span></code></a>
for the XSRF cookie.</li>
<li><code class="docutils literal"><span class="pre">twitter_consumer_key</span></code>, <code class="docutils literal"><span class="pre">twitter_consumer_secret</span></code>,
<code class="docutils literal"><span class="pre">friendfeed_consumer_key</span></code>, <code class="docutils literal"><span class="pre">friendfeed_consumer_secret</span></code>,
<code class="docutils literal"><span class="pre">google_consumer_key</span></code>, <code class="docutils literal"><span class="pre">google_consumer_secret</span></code>,
<code class="docutils literal"><span class="pre">facebook_api_key</span></code>, <code class="docutils literal"><span class="pre">facebook_secret</span></code>:  Used in the
<a class="reference internal" href="index.html#module-tornado.auth" title="tornado.auth"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth</span></code></a> module to authenticate to various APIs.</li>
</ul>
<p>Template settings:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">autoescape</span></code>: Controls automatic escaping for templates.
May be set to <code class="docutils literal"><span class="pre">None</span></code> to disable escaping, or to the <em>name</em>
of a function that all output should be passed through.
Defaults to <code class="docutils literal"><span class="pre">&quot;xhtml_escape&quot;</span></code>.  Can be changed on a per-template
basis with the <code class="docutils literal"><span class="pre">{%</span> <span class="pre">autoescape</span> <span class="pre">%}</span></code> directive.</li>
<li><code class="docutils literal"><span class="pre">compiled_template_cache</span></code>: Default is <code class="docutils literal"><span class="pre">True</span></code>; if <code class="docutils literal"><span class="pre">False</span></code>
templates will be recompiled on every request.  This option
is new in Tornado 3.2; previously this functionality was controlled
by the <code class="docutils literal"><span class="pre">debug</span></code> setting.</li>
<li><code class="docutils literal"><span class="pre">template_path</span></code>: Directory containing template files.  Can be
further customized by overriding <a class="reference internal" href="#tornado.web.RequestHandler.get_template_path" title="tornado.web.RequestHandler.get_template_path"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_template_path</span></code></a></li>
<li><code class="docutils literal"><span class="pre">template_loader</span></code>: Assign to an instance of
<a class="reference internal" href="index.html#tornado.template.BaseLoader" title="tornado.template.BaseLoader"><code class="xref py py-obj docutils literal"><span class="pre">tornado.template.BaseLoader</span></code></a> to customize template loading.
If this setting is used the <code class="docutils literal"><span class="pre">template_path</span></code> and <code class="docutils literal"><span class="pre">autoescape</span></code>
settings are ignored.  Can be further customized by overriding
<a class="reference internal" href="#tornado.web.RequestHandler.create_template_loader" title="tornado.web.RequestHandler.create_template_loader"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.create_template_loader</span></code></a>.</li>
<li><code class="docutils literal"><span class="pre">template_whitespace</span></code>: Controls handling of whitespace in
templates; see <a class="reference internal" href="index.html#tornado.template.filter_whitespace" title="tornado.template.filter_whitespace"><code class="xref py py-obj docutils literal"><span class="pre">tornado.template.filter_whitespace</span></code></a> for allowed
values. New in Tornado 4.3.</li>
</ul>
<p>Static file settings:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">static_hash_cache</span></code>: Default is <code class="docutils literal"><span class="pre">True</span></code>; if <code class="docutils literal"><span class="pre">False</span></code>
static urls will be recomputed on every request.  This option
is new in Tornado 3.2; previously this functionality was controlled
by the <code class="docutils literal"><span class="pre">debug</span></code> setting.</li>
<li><code class="docutils literal"><span class="pre">static_path</span></code>: Directory from which static files will be
served.</li>
<li><code class="docutils literal"><span class="pre">static_url_prefix</span></code>:  Url prefix for static files,
defaults to <code class="docutils literal"><span class="pre">&quot;/static/&quot;</span></code>.</li>
<li><code class="docutils literal"><span class="pre">static_handler_class</span></code>, <code class="docutils literal"><span class="pre">static_handler_args</span></code>: May be set to
use a different handler for static files instead of the default
<a class="reference internal" href="#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.StaticFileHandler</span></code></a>.  <code class="docutils literal"><span class="pre">static_handler_args</span></code>, if set,
should be a dictionary of keyword arguments to be passed to the
handler&#8217;s <code class="docutils literal"><span class="pre">initialize</span></code> method.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="tornado.web.Application.listen">
<code class="descname">listen</code><span class="sig-paren">(</span><em>port</em>, <em>address=''</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#Application.listen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.Application.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts an HTTP server for this application on the given port.</p>
<p>This is a convenience alias for creating an <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a>
object and calling its listen method.  Keyword arguments not
supported by <a class="reference internal" href="index.html#tornado.tcpserver.TCPServer.listen" title="tornado.tcpserver.TCPServer.listen"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer.listen</span></code></a> are passed to the
<a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> constructor.  For advanced uses
(e.g. multi-process mode), do not use this method; create an
<a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> and call its
<a class="reference internal" href="index.html#tornado.tcpserver.TCPServer.bind" title="tornado.tcpserver.TCPServer.bind"><code class="xref py py-obj docutils literal"><span class="pre">TCPServer.bind</span></code></a>/<a class="reference internal" href="index.html#tornado.tcpserver.TCPServer.start" title="tornado.tcpserver.TCPServer.start"><code class="xref py py-obj docutils literal"><span class="pre">TCPServer.start</span></code></a> methods directly.</p>
<p>Note that after calling this method you still need to call
<code class="docutils literal"><span class="pre">IOLoop.current().start()</span></code> to start the server.</p>
<p>Returns the <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> object.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Now returns the <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> object.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.Application.add_handlers">
<code class="descname">add_handlers</code><span class="sig-paren">(</span><em>host_pattern</em>, <em>host_handlers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#Application.add_handlers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.Application.add_handlers" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends the given handlers to our handler list.</p>
<p>Host patterns are processed sequentially in the order they were
added. All matching patterns will be considered.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.Application.reverse_url">
<code class="descname">reverse_url</code><span class="sig-paren">(</span><em>name</em>, <em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#Application.reverse_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.Application.reverse_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a URL path for handler named <code class="docutils literal"><span class="pre">name</span></code></p>
<p>The handler must be added to the application as a named <a class="reference internal" href="#tornado.web.URLSpec" title="tornado.web.URLSpec"><code class="xref py py-obj docutils literal"><span class="pre">URLSpec</span></code></a>.</p>
<p>Args will be substituted for capturing groups in the <a class="reference internal" href="#tornado.web.URLSpec" title="tornado.web.URLSpec"><code class="xref py py-obj docutils literal"><span class="pre">URLSpec</span></code></a> regex.
They will be converted to strings if necessary, encoded as utf8,
and url-escaped.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.Application.log_request">
<code class="descname">log_request</code><span class="sig-paren">(</span><em>handler</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#Application.log_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.Application.log_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a completed HTTP request to the logs.</p>
<p>By default writes to the python root logger.  To change
this behavior either subclass Application and override this method,
or pass a function in the application settings dictionary as
<code class="docutils literal"><span class="pre">log_function</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.web.URLSpec">
<em class="property">class </em><code class="descclassname">tornado.web.</code><code class="descname">URLSpec</code><span class="sig-paren">(</span><em>pattern</em>, <em>handler</em>, <em>kwargs=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#URLSpec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.URLSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>Specifies mappings between URLs and handlers.</p>
<p>Parameters:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">pattern</span></code>: Regular expression to be matched.  Any groups
in the regex will be passed in to the handler&#8217;s get/post/etc
methods as arguments.</li>
<li><code class="docutils literal"><span class="pre">handler</span></code>: <a class="reference internal" href="#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> subclass to be invoked.</li>
<li><code class="docutils literal"><span class="pre">kwargs</span></code> (optional): A dictionary of additional arguments
to be passed to the handler&#8217;s constructor.</li>
<li><code class="docutils literal"><span class="pre">name</span></code> (optional): A name for this handler.  Used by
<a class="reference internal" href="#tornado.web.Application.reverse_url" title="tornado.web.Application.reverse_url"><code class="xref py py-obj docutils literal"><span class="pre">Application.reverse_url</span></code></a>.</li>
</ul>
<p>The <code class="docutils literal"><span class="pre">URLSpec</span></code> class is also available under the name <code class="docutils literal"><span class="pre">tornado.web.url</span></code>.</p>
</dd></dl>

</div>
<div class="section" id="decorators">
<h5>Decorators<a class="headerlink" href="#decorators" title="Permalink to this headline">¶</a></h5>
<dl class="function">
<dt id="tornado.web.asynchronous">
<code class="descclassname">tornado.web.</code><code class="descname">asynchronous</code><span class="sig-paren">(</span><em>method</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#asynchronous"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.asynchronous" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap request handler methods with this if they are asynchronous.</p>
<p>This decorator is for callback-style asynchronous methods; for
coroutines, use the <code class="docutils literal"><span class="pre">&#64;gen.coroutine</span></code> decorator without
<code class="docutils literal"><span class="pre">&#64;asynchronous</span></code>. (It is legal for legacy reasons to use the two
decorators together provided <code class="docutils literal"><span class="pre">&#64;asynchronous</span></code> is first, but
<code class="docutils literal"><span class="pre">&#64;asynchronous</span></code> will be ignored in this case)</p>
<p>This decorator should only be applied to the <a class="reference internal" href="#verbs"><span>HTTP verb
methods</span></a>; its behavior is undefined for any other method.
This decorator does not <em>make</em> a method asynchronous; it tells
the framework that the method <em>is</em> asynchronous.  For this decorator
to be useful the method must (at least sometimes) do something
asynchronous.</p>
<p>If this decorator is given, the response is not finished when the
method returns. It is up to the request handler to call
<a class="reference internal" href="#tornado.web.RequestHandler.finish" title="tornado.web.RequestHandler.finish"><code class="xref py py-obj docutils literal"><span class="pre">self.finish()</span></code></a> to finish the HTTP
request. Without this decorator, the request is automatically
finished when the <code class="docutils literal"><span class="pre">get()</span></code> or <code class="docutils literal"><span class="pre">post()</span></code> method returns. Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyRequestHandler</span><span class="p">(</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="nd">@asynchronous</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="n">http</span> <span class="o">=</span> <span class="n">httpclient</span><span class="o">.</span><span class="n">AsyncHTTPClient</span><span class="p">()</span>
       <span class="n">http</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s">&quot;http://friendfeed.com/&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_download</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_download</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Downloaded!&quot;</span><span class="p">)</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.1: </span>The ability to use <code class="docutils literal"><span class="pre">&#64;gen.coroutine</span></code> without <code class="docutils literal"><span class="pre">&#64;asynchronous</span></code>.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Returning anything but <code class="docutils literal"><span class="pre">None</span></code> or a
yieldable object from a method decorated with <code class="docutils literal"><span class="pre">&#64;asynchronous</span></code>
is an error. Such return values were previously ignored silently.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.web.authenticated">
<code class="descclassname">tornado.web.</code><code class="descname">authenticated</code><span class="sig-paren">(</span><em>method</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#authenticated"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.authenticated" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorate methods with this to require that the user be logged in.</p>
<p>If the user is not logged in, they will be redirected to the configured
<a class="reference internal" href="#tornado.web.RequestHandler.get_login_url" title="tornado.web.RequestHandler.get_login_url"><code class="xref py py-obj docutils literal"><span class="pre">login</span> <span class="pre">url</span></code></a>.</p>
<p>If you configure a login url with a query parameter, Tornado will
assume you know what you&#8217;re doing and use it as-is.  If not, it
will add a <a class="reference external" href="https://docs.python.org/3.4/library/functions.html#next" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">next</span></code></a> parameter so the login page knows where to send
you once you&#8217;re logged in.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.web.addslash">
<code class="descclassname">tornado.web.</code><code class="descname">addslash</code><span class="sig-paren">(</span><em>method</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#addslash"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.addslash" title="Permalink to this definition">¶</a></dt>
<dd><p>Use this decorator to add a missing trailing slash to the request path.</p>
<p>For example, a request to <code class="docutils literal"><span class="pre">/foo</span></code> would redirect to <code class="docutils literal"><span class="pre">/foo/</span></code> with this
decorator. Your request handler mapping should use a regular expression
like <code class="docutils literal"><span class="pre">r'/foo/?'</span></code> in conjunction with using the decorator.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.web.removeslash">
<code class="descclassname">tornado.web.</code><code class="descname">removeslash</code><span class="sig-paren">(</span><em>method</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#removeslash"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.removeslash" title="Permalink to this definition">¶</a></dt>
<dd><p>Use this decorator to remove trailing slashes from the request path.</p>
<p>For example, a request to <code class="docutils literal"><span class="pre">/foo/</span></code> would redirect to <code class="docutils literal"><span class="pre">/foo</span></code> with this
decorator. Your request handler mapping should use a regular expression
like <code class="docutils literal"><span class="pre">r'/foo/*'</span></code> in conjunction with using the decorator.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.web.stream_request_body">
<code class="descclassname">tornado.web.</code><code class="descname">stream_request_body</code><span class="sig-paren">(</span><em>cls</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#stream_request_body"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.stream_request_body" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply to <a class="reference internal" href="#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> subclasses to enable streaming body support.</p>
<p>This decorator implies the following changes:</p>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest.body" title="tornado.httputil.HTTPServerRequest.body"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerRequest.body</span></code></a> is undefined, and body arguments will not
be included in <a class="reference internal" href="#tornado.web.RequestHandler.get_argument" title="tornado.web.RequestHandler.get_argument"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_argument</span></code></a>.</li>
<li><a class="reference internal" href="#tornado.web.RequestHandler.prepare" title="tornado.web.RequestHandler.prepare"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.prepare</span></code></a> is called when the request headers have been
read instead of after the entire body has been read.</li>
<li>The subclass must define a method <code class="docutils literal"><span class="pre">data_received(self,</span> <span class="pre">data):</span></code>, which
will be called zero or more times as data is available.  Note that
if the request has an empty body, <code class="docutils literal"><span class="pre">data_received</span></code> may not be called.</li>
<li><code class="docutils literal"><span class="pre">prepare</span></code> and <code class="docutils literal"><span class="pre">data_received</span></code> may return Futures (such as via
<code class="docutils literal"><span class="pre">&#64;gen.coroutine</span></code>, in which case the next method will not be called
until those futures have completed.</li>
<li>The regular HTTP method (<code class="docutils literal"><span class="pre">post</span></code>, <code class="docutils literal"><span class="pre">put</span></code>, etc) will be called after
the entire body has been read.</li>
</ul>
<p>There is a subtle interaction between <code class="docutils literal"><span class="pre">data_received</span></code> and asynchronous
<code class="docutils literal"><span class="pre">prepare</span></code>: The first call to <code class="docutils literal"><span class="pre">data_received</span></code> may occur at any point
after the call to <code class="docutils literal"><span class="pre">prepare</span></code> has returned <em>or yielded</em>.</p>
</dd></dl>

</div>
<div class="section" id="everything-else">
<h5>Everything else<a class="headerlink" href="#everything-else" title="Permalink to this headline">¶</a></h5>
<dl class="exception">
<dt id="tornado.web.HTTPError">
<em class="property">exception </em><code class="descclassname">tornado.web.</code><code class="descname">HTTPError</code><span class="sig-paren">(</span><em>status_code=500</em>, <em>log_message=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#HTTPError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.HTTPError" title="Permalink to this definition">¶</a></dt>
<dd><p>An exception that will turn into an HTTP error response.</p>
<p>Raising an <a class="reference internal" href="#tornado.web.HTTPError" title="tornado.web.HTTPError"><code class="xref py py-obj docutils literal"><span class="pre">HTTPError</span></code></a> is a convenient alternative to calling
<a class="reference internal" href="#tornado.web.RequestHandler.send_error" title="tornado.web.RequestHandler.send_error"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.send_error</span></code></a> since it automatically ends the
current function.</p>
<p>To customize the response sent with an <a class="reference internal" href="#tornado.web.HTTPError" title="tornado.web.HTTPError"><code class="xref py py-obj docutils literal"><span class="pre">HTTPError</span></code></a>, override
<a class="reference internal" href="#tornado.web.RequestHandler.write_error" title="tornado.web.RequestHandler.write_error"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.write_error</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>status_code</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#int" title="(in Python v3.4)"><em>int</em></a>) &#8211; HTTP status code.  Must be listed in
<a class="reference external" href="https://docs.python.org/3.4/library/http.client.html#http.client.responses" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">httplib.responses</span></code></a> unless the <code class="docutils literal"><span class="pre">reason</span></code>
keyword argument is given.</li>
<li><strong>log_message</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; Message to be written to the log for this error
(will not be shown to the user unless the <a class="reference internal" href="#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> is in debug
mode).  May contain <code class="docutils literal"><span class="pre">%s</span></code>-style placeholders, which will be filled
in with remaining positional parameters.</li>
<li><strong>reason</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; Keyword-only argument.  The HTTP &#8220;reason&#8221; phrase
to pass in the status line along with <code class="docutils literal"><span class="pre">status_code</span></code>.  Normally
determined automatically from <code class="docutils literal"><span class="pre">status_code</span></code>, but can be used
to use a non-standard numeric code.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="exception">
<dt id="tornado.web.Finish">
<em class="property">exception </em><code class="descclassname">tornado.web.</code><code class="descname">Finish</code><a class="reference internal" href="_modules/tornado/web.html#Finish"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.Finish" title="Permalink to this definition">¶</a></dt>
<dd><p>An exception that ends the request without producing an error response.</p>
<p>When <a class="reference internal" href="#tornado.web.Finish" title="tornado.web.Finish"><code class="xref py py-obj docutils literal"><span class="pre">Finish</span></code></a> is raised in a <a class="reference internal" href="#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a>, the request will
end (calling <a class="reference internal" href="#tornado.web.RequestHandler.finish" title="tornado.web.RequestHandler.finish"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.finish</span></code></a> if it hasn&#8217;t already been
called), but the error-handling methods (including
<a class="reference internal" href="#tornado.web.RequestHandler.write_error" title="tornado.web.RequestHandler.write_error"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.write_error</span></code></a>) will not be called.</p>
<p>If <a class="reference internal" href="#tornado.web.Finish" title="tornado.web.Finish"><code class="xref py py-obj docutils literal"><span class="pre">Finish()</span></code></a> was created with no arguments, the pending response
will be sent as-is. If <a class="reference internal" href="#tornado.web.Finish" title="tornado.web.Finish"><code class="xref py py-obj docutils literal"><span class="pre">Finish()</span></code></a> was given an argument, that
argument will be passed to <a class="reference internal" href="#tornado.web.RequestHandler.finish" title="tornado.web.RequestHandler.finish"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.finish()</span></code></a>.</p>
<p>This can be a more convenient way to implement custom error pages
than overriding <code class="docutils literal"><span class="pre">write_error</span></code> (especially in library code):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_user</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_status</span><span class="p">(</span><span class="mi">401</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s">&#39;WWW-Authenticate&#39;</span><span class="p">,</span> <span class="s">&#39;Basic realm=&quot;something&quot;&#39;</span><span class="p">)</span>
    <span class="k">raise</span> <span class="n">Finish</span><span class="p">()</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Arguments passed to <code class="docutils literal"><span class="pre">Finish()</span></code> will be passed on to
<a class="reference internal" href="#tornado.web.RequestHandler.finish" title="tornado.web.RequestHandler.finish"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.finish</span></code></a>.</p>
</div>
</dd></dl>

<dl class="exception">
<dt id="tornado.web.MissingArgumentError">
<em class="property">exception </em><code class="descclassname">tornado.web.</code><code class="descname">MissingArgumentError</code><span class="sig-paren">(</span><em>arg_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#MissingArgumentError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.MissingArgumentError" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised by <a class="reference internal" href="#tornado.web.RequestHandler.get_argument" title="tornado.web.RequestHandler.get_argument"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_argument</span></code></a>.</p>
<p>This is a subclass of <a class="reference internal" href="#tornado.web.HTTPError" title="tornado.web.HTTPError"><code class="xref py py-obj docutils literal"><span class="pre">HTTPError</span></code></a>, so if it is uncaught a 400 response
code will be used instead of 500 (and a stack trace will not be logged).</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.web.UIModule">
<em class="property">class </em><code class="descclassname">tornado.web.</code><code class="descname">UIModule</code><span class="sig-paren">(</span><em>handler</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#UIModule"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.UIModule" title="Permalink to this definition">¶</a></dt>
<dd><p>A re-usable, modular UI unit on a page.</p>
<p>UI modules often execute additional queries, and they can include
additional CSS and JavaScript that will be included in the output
page, which is automatically inserted on page render.</p>
<p>Subclasses of UIModule must override the <a class="reference internal" href="#tornado.web.UIModule.render" title="tornado.web.UIModule.render"><code class="xref py py-obj docutils literal"><span class="pre">render</span></code></a> method.</p>
<dl class="method">
<dt id="tornado.web.UIModule.render">
<code class="descname">render</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#UIModule.render"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.UIModule.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Override in subclasses to return this module&#8217;s output.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.UIModule.embedded_javascript">
<code class="descname">embedded_javascript</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#UIModule.embedded_javascript"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.UIModule.embedded_javascript" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to return a JavaScript string
to be embedded in the page.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.UIModule.javascript_files">
<code class="descname">javascript_files</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#UIModule.javascript_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.UIModule.javascript_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to return a list of JavaScript files needed by this module.</p>
<p>If the return values are relative paths, they will be passed to
<a class="reference internal" href="#tornado.web.RequestHandler.static_url" title="tornado.web.RequestHandler.static_url"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.static_url</span></code></a>; otherwise they will be used as-is.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.UIModule.embedded_css">
<code class="descname">embedded_css</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#UIModule.embedded_css"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.UIModule.embedded_css" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to return a CSS string
that will be embedded in the page.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.UIModule.css_files">
<code class="descname">css_files</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#UIModule.css_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.UIModule.css_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to returns a list of CSS files required by this module.</p>
<p>If the return values are relative paths, they will be passed to
<a class="reference internal" href="#tornado.web.RequestHandler.static_url" title="tornado.web.RequestHandler.static_url"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.static_url</span></code></a>; otherwise they will be used as-is.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.UIModule.html_head">
<code class="descname">html_head</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#UIModule.html_head"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.UIModule.html_head" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to return an HTML string that will be put in the &lt;head/&gt;
element.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.UIModule.html_body">
<code class="descname">html_body</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#UIModule.html_body"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.UIModule.html_body" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to return an HTML string that will be put at the end of
the &lt;body/&gt; element.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.UIModule.render_string">
<code class="descname">render_string</code><span class="sig-paren">(</span><em>path</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#UIModule.render_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.UIModule.render_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Renders a template and returns it as a string.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.web.ErrorHandler">
<em class="property">class </em><code class="descclassname">tornado.web.</code><code class="descname">ErrorHandler</code><span class="sig-paren">(</span><em>application</em>, <em>request</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#ErrorHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.ErrorHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates an error response with <code class="docutils literal"><span class="pre">status_code</span></code> for all requests.</p>
</dd></dl>

<dl class="class">
<dt id="tornado.web.FallbackHandler">
<em class="property">class </em><code class="descclassname">tornado.web.</code><code class="descname">FallbackHandler</code><span class="sig-paren">(</span><em>application</em>, <em>request</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#FallbackHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.FallbackHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> that wraps another HTTP server callback.</p>
<p>The fallback is a callable object that accepts an
<a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest" title="tornado.httputil.HTTPServerRequest"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerRequest</span></code></a>, such as an <a class="reference internal" href="#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> or
<a class="reference internal" href="index.html#tornado.wsgi.WSGIContainer" title="tornado.wsgi.WSGIContainer"><code class="xref py py-obj docutils literal"><span class="pre">tornado.wsgi.WSGIContainer</span></code></a>.  This is most useful to use both
Tornado <code class="docutils literal"><span class="pre">RequestHandlers</span></code> and WSGI in the same server.  Typical
usage:</p>
<div class="highlight-python"><div class="highlight"><pre>wsgi_app = tornado.wsgi.WSGIContainer(
    django.core.handlers.wsgi.WSGIHandler())
application = tornado.web.Application([
    (r&quot;/foo&quot;, FooHandler),
    (r&quot;.*&quot;, FallbackHandler, dict(fallback=wsgi_app),
])
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.web.RedirectHandler">
<em class="property">class </em><code class="descclassname">tornado.web.</code><code class="descname">RedirectHandler</code><span class="sig-paren">(</span><em>application</em>, <em>request</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#RedirectHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.RedirectHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Redirects the client to the given URL for all GET requests.</p>
<p>You should provide the keyword argument <code class="docutils literal"><span class="pre">url</span></code> to the handler, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">application</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="s">r&quot;/oldpath&quot;</span><span class="p">,</span> <span class="n">web</span><span class="o">.</span><span class="n">RedirectHandler</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;url&quot;</span><span class="p">:</span> <span class="s">&quot;/newpath&quot;</span><span class="p">}),</span>
<span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.web.StaticFileHandler">
<em class="property">class </em><code class="descclassname">tornado.web.</code><code class="descname">StaticFileHandler</code><span class="sig-paren">(</span><em>application</em>, <em>request</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#StaticFileHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.StaticFileHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple handler that can serve static content from a directory.</p>
<p>A <a class="reference internal" href="#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> is configured automatically if you pass the
<code class="docutils literal"><span class="pre">static_path</span></code> keyword argument to <a class="reference internal" href="#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a>.  This handler
can be customized with the <code class="docutils literal"><span class="pre">static_url_prefix</span></code>, <code class="docutils literal"><span class="pre">static_handler_class</span></code>,
and <code class="docutils literal"><span class="pre">static_handler_args</span></code> settings.</p>
<p>To map an additional path to this handler for a static data directory
you would add a line to your application like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">application</span> <span class="o">=</span> <span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="s">r&quot;/content/(.*)&quot;</span><span class="p">,</span> <span class="n">web</span><span class="o">.</span><span class="n">StaticFileHandler</span><span class="p">,</span> <span class="p">{</span><span class="s">&quot;path&quot;</span><span class="p">:</span> <span class="s">&quot;/var/www&quot;</span><span class="p">}),</span>
<span class="p">])</span>
</pre></div>
</div>
<p>The handler constructor requires a <code class="docutils literal"><span class="pre">path</span></code> argument, which specifies the
local root directory of the content to be served.</p>
<p>Note that a capture group in the regex is required to parse the value for
the <code class="docutils literal"><span class="pre">path</span></code> argument to the get() method (different than the constructor
argument above); see <a class="reference internal" href="#tornado.web.URLSpec" title="tornado.web.URLSpec"><code class="xref py py-obj docutils literal"><span class="pre">URLSpec</span></code></a> for details.</p>
<p>To serve a file like <code class="docutils literal"><span class="pre">index.html</span></code> automatically when a directory is
requested, set <code class="docutils literal"><span class="pre">static_handler_args=dict(default_filename=&quot;index.html&quot;)</span></code>
in your application settings, or add <code class="docutils literal"><span class="pre">default_filename</span></code> as an initializer
argument for your <code class="docutils literal"><span class="pre">StaticFileHandler</span></code>.</p>
<p>To maximize the effectiveness of browser caching, this class supports
versioned urls (by default using the argument <code class="docutils literal"><span class="pre">?v=</span></code>).  If a version
is given, we instruct the browser to cache this file indefinitely.
<a class="reference internal" href="#tornado.web.StaticFileHandler.make_static_url" title="tornado.web.StaticFileHandler.make_static_url"><code class="xref py py-obj docutils literal"><span class="pre">make_static_url</span></code></a> (also available as <a class="reference internal" href="#tornado.web.RequestHandler.static_url" title="tornado.web.RequestHandler.static_url"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.static_url</span></code></a>) can
be used to construct a versioned url.</p>
<p>This handler is intended primarily for use in development and light-duty
file serving; for heavy traffic it will be more efficient to use
a dedicated static file server (such as nginx or Apache).  We support
the HTTP <code class="docutils literal"><span class="pre">Accept-Ranges</span></code> mechanism to return partial content (because
some browsers require this functionality to be present to seek in
HTML5 audio or video).</p>
<p><strong>Subclassing notes</strong></p>
<p>This class is designed to be extensible by subclassing, but because
of the way static urls are generated with class methods rather than
instance methods, the inheritance patterns are somewhat unusual.
Be sure to use the <code class="docutils literal"><span class="pre">&#64;classmethod</span></code> decorator when overriding a
class method.  Instance methods may use the attributes <code class="docutils literal"><span class="pre">self.path</span></code>
<code class="docutils literal"><span class="pre">self.absolute_path</span></code>, and <code class="docutils literal"><span class="pre">self.modified</span></code>.</p>
<p>Subclasses should only override methods discussed in this section;
overriding other methods is error-prone.  Overriding
<code class="docutils literal"><span class="pre">StaticFileHandler.get</span></code> is particularly problematic due to the
tight coupling with <code class="docutils literal"><span class="pre">compute_etag</span></code> and other methods.</p>
<p>To change the way static urls are generated (e.g. to match the behavior
of another server or CDN), override <a class="reference internal" href="#tornado.web.StaticFileHandler.make_static_url" title="tornado.web.StaticFileHandler.make_static_url"><code class="xref py py-obj docutils literal"><span class="pre">make_static_url</span></code></a>, <a class="reference internal" href="#tornado.web.StaticFileHandler.parse_url_path" title="tornado.web.StaticFileHandler.parse_url_path"><code class="xref py py-obj docutils literal"><span class="pre">parse_url_path</span></code></a>,
<a class="reference internal" href="#tornado.web.StaticFileHandler.get_cache_time" title="tornado.web.StaticFileHandler.get_cache_time"><code class="xref py py-obj docutils literal"><span class="pre">get_cache_time</span></code></a>, and/or <a class="reference internal" href="#tornado.web.StaticFileHandler.get_version" title="tornado.web.StaticFileHandler.get_version"><code class="xref py py-obj docutils literal"><span class="pre">get_version</span></code></a>.</p>
<p>To replace all interaction with the filesystem (e.g. to serve
static content from a database), override <a class="reference internal" href="#tornado.web.StaticFileHandler.get_content" title="tornado.web.StaticFileHandler.get_content"><code class="xref py py-obj docutils literal"><span class="pre">get_content</span></code></a>,
<a class="reference internal" href="#tornado.web.StaticFileHandler.get_content_size" title="tornado.web.StaticFileHandler.get_content_size"><code class="xref py py-obj docutils literal"><span class="pre">get_content_size</span></code></a>, <a class="reference internal" href="#tornado.web.StaticFileHandler.get_modified_time" title="tornado.web.StaticFileHandler.get_modified_time"><code class="xref py py-obj docutils literal"><span class="pre">get_modified_time</span></code></a>, <a class="reference internal" href="#tornado.web.StaticFileHandler.get_absolute_path" title="tornado.web.StaticFileHandler.get_absolute_path"><code class="xref py py-obj docutils literal"><span class="pre">get_absolute_path</span></code></a>, and
<a class="reference internal" href="#tornado.web.StaticFileHandler.validate_absolute_path" title="tornado.web.StaticFileHandler.validate_absolute_path"><code class="xref py py-obj docutils literal"><span class="pre">validate_absolute_path</span></code></a>.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.1: </span>Many of the methods for subclasses were added in Tornado 3.1.</p>
</div>
<dl class="method">
<dt id="tornado.web.StaticFileHandler.compute_etag">
<code class="descname">compute_etag</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#StaticFileHandler.compute_etag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.StaticFileHandler.compute_etag" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the <code class="docutils literal"><span class="pre">Etag</span></code> header based on static url version.</p>
<p>This allows efficient <code class="docutils literal"><span class="pre">If-None-Match</span></code> checks against cached
versions, and sends the correct <code class="docutils literal"><span class="pre">Etag</span></code> for a partial response
(i.e. the same <code class="docutils literal"><span class="pre">Etag</span></code> as the full file).</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.StaticFileHandler.set_headers">
<code class="descname">set_headers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#StaticFileHandler.set_headers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.StaticFileHandler.set_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the content and caching headers on the response.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.StaticFileHandler.should_return_304">
<code class="descname">should_return_304</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#StaticFileHandler.should_return_304"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.StaticFileHandler.should_return_304" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the headers indicate that we should return 304.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="tornado.web.StaticFileHandler.get_absolute_path">
<em class="property">classmethod </em><code class="descname">get_absolute_path</code><span class="sig-paren">(</span><em>root</em>, <em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#StaticFileHandler.get_absolute_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.StaticFileHandler.get_absolute_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the absolute location of <code class="docutils literal"><span class="pre">path</span></code> relative to <code class="docutils literal"><span class="pre">root</span></code>.</p>
<p><code class="docutils literal"><span class="pre">root</span></code> is the path configured for this <a class="reference internal" href="#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a>
(in most cases the <code class="docutils literal"><span class="pre">static_path</span></code> <a class="reference internal" href="#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> setting).</p>
<p>This class method may be overridden in subclasses.  By default
it returns a filesystem path, but other strings may be used
as long as they are unique and understood by the subclass&#8217;s
overridden <a class="reference internal" href="#tornado.web.StaticFileHandler.get_content" title="tornado.web.StaticFileHandler.get_content"><code class="xref py py-obj docutils literal"><span class="pre">get_content</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.StaticFileHandler.validate_absolute_path">
<code class="descname">validate_absolute_path</code><span class="sig-paren">(</span><em>root</em>, <em>absolute_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#StaticFileHandler.validate_absolute_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.StaticFileHandler.validate_absolute_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate and return the absolute path.</p>
<p><code class="docutils literal"><span class="pre">root</span></code> is the configured path for the <a class="reference internal" href="#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a>,
and <code class="docutils literal"><span class="pre">path</span></code> is the result of <a class="reference internal" href="#tornado.web.StaticFileHandler.get_absolute_path" title="tornado.web.StaticFileHandler.get_absolute_path"><code class="xref py py-obj docutils literal"><span class="pre">get_absolute_path</span></code></a></p>
<p>This is an instance method called during request processing,
so it may raise <a class="reference internal" href="#tornado.web.HTTPError" title="tornado.web.HTTPError"><code class="xref py py-obj docutils literal"><span class="pre">HTTPError</span></code></a> or use methods like
<a class="reference internal" href="#tornado.web.RequestHandler.redirect" title="tornado.web.RequestHandler.redirect"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.redirect</span></code></a> (return None after redirecting to
halt further processing).  This is where 404 errors for missing files
are generated.</p>
<p>This method may modify the path before returning it, but note that
any such modifications will not be understood by <a class="reference internal" href="#tornado.web.StaticFileHandler.make_static_url" title="tornado.web.StaticFileHandler.make_static_url"><code class="xref py py-obj docutils literal"><span class="pre">make_static_url</span></code></a>.</p>
<p>In instance methods, this method&#8217;s result is available as
<code class="docutils literal"><span class="pre">self.absolute_path</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="tornado.web.StaticFileHandler.get_content">
<em class="property">classmethod </em><code class="descname">get_content</code><span class="sig-paren">(</span><em>abspath</em>, <em>start=None</em>, <em>end=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#StaticFileHandler.get_content"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.StaticFileHandler.get_content" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the content of the requested resource which is located
at the given absolute path.</p>
<p>This class method may be overridden by subclasses.  Note that its
signature is different from other overridable class methods
(no <code class="docutils literal"><span class="pre">settings</span></code> argument); this is deliberate to ensure that
<code class="docutils literal"><span class="pre">abspath</span></code> is able to stand on its own as a cache key.</p>
<p>This method should either return a byte string or an iterator
of byte strings.  The latter is preferred for large files
as it helps reduce memory fragmentation.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="tornado.web.StaticFileHandler.get_content_version">
<em class="property">classmethod </em><code class="descname">get_content_version</code><span class="sig-paren">(</span><em>abspath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#StaticFileHandler.get_content_version"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.StaticFileHandler.get_content_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a version string for the resource at the given path.</p>
<p>This class method may be overridden by subclasses.  The
default implementation is a hash of the file&#8217;s contents.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.StaticFileHandler.get_content_size">
<code class="descname">get_content_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#StaticFileHandler.get_content_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.StaticFileHandler.get_content_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the total size of the resource at the given path.</p>
<p>This method may be overridden by subclasses.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>This method is now always called, instead of only when
partial results are requested.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.StaticFileHandler.get_modified_time">
<code class="descname">get_modified_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#StaticFileHandler.get_modified_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.StaticFileHandler.get_modified_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the time that <code class="docutils literal"><span class="pre">self.absolute_path</span></code> was last modified.</p>
<p>May be overridden in subclasses.  Should return a <a class="reference external" href="https://docs.python.org/3.4/library/datetime.html#datetime.datetime" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">datetime</span></code></a>
object or None.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.StaticFileHandler.get_content_type">
<code class="descname">get_content_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#StaticFileHandler.get_content_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.StaticFileHandler.get_content_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <code class="docutils literal"><span class="pre">Content-Type</span></code> header to be used for this request.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.web.StaticFileHandler.set_extra_headers">
<code class="descname">set_extra_headers</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#StaticFileHandler.set_extra_headers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.StaticFileHandler.set_extra_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>For subclass to add extra headers to the response</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.StaticFileHandler.get_cache_time">
<code class="descname">get_cache_time</code><span class="sig-paren">(</span><em>path</em>, <em>modified</em>, <em>mime_type</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#StaticFileHandler.get_cache_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.StaticFileHandler.get_cache_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to customize cache control behavior.</p>
<p>Return a positive number of seconds to make the result
cacheable for that amount of time or 0 to mark resource as
cacheable for an unspecified amount of time (subject to
browser heuristics).</p>
<p>By default returns cache expiry of 10 years for resources requested
with <code class="docutils literal"><span class="pre">v</span></code> argument.</p>
</dd></dl>

<dl class="classmethod">
<dt id="tornado.web.StaticFileHandler.make_static_url">
<em class="property">classmethod </em><code class="descname">make_static_url</code><span class="sig-paren">(</span><em>settings</em>, <em>path</em>, <em>include_version=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#StaticFileHandler.make_static_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.StaticFileHandler.make_static_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a versioned url for the given path.</p>
<p>This method may be overridden in subclasses (but note that it
is a class method rather than an instance method).  Subclasses
are only required to implement the signature
<code class="docutils literal"><span class="pre">make_static_url(cls,</span> <span class="pre">settings,</span> <span class="pre">path)</span></code>; other keyword
arguments may be passed through <a class="reference internal" href="#tornado.web.RequestHandler.static_url" title="tornado.web.RequestHandler.static_url"><code class="xref py py-obj docutils literal"><span class="pre">static_url</span></code></a>
but are not standard.</p>
<p><code class="docutils literal"><span class="pre">settings</span></code> is the <a class="reference internal" href="#tornado.web.Application.settings" title="tornado.web.Application.settings"><code class="xref py py-obj docutils literal"><span class="pre">Application.settings</span></code></a> dictionary.  <code class="docutils literal"><span class="pre">path</span></code>
is the static path being requested.  The url returned should be
relative to the current host.</p>
<p><code class="docutils literal"><span class="pre">include_version</span></code> determines whether the generated URL should
include the query string containing the version hash of the
file corresponding to the given <code class="docutils literal"><span class="pre">path</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.web.StaticFileHandler.parse_url_path">
<code class="descname">parse_url_path</code><span class="sig-paren">(</span><em>url_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#StaticFileHandler.parse_url_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.StaticFileHandler.parse_url_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a static URL path into a filesystem path.</p>
<p><code class="docutils literal"><span class="pre">url_path</span></code> is the path component of the URL with
<code class="docutils literal"><span class="pre">static_url_prefix</span></code> removed.  The return value should be
filesystem path relative to <code class="docutils literal"><span class="pre">static_path</span></code>.</p>
<p>This is the inverse of <a class="reference internal" href="#tornado.web.StaticFileHandler.make_static_url" title="tornado.web.StaticFileHandler.make_static_url"><code class="xref py py-obj docutils literal"><span class="pre">make_static_url</span></code></a>.</p>
</dd></dl>

<dl class="classmethod">
<dt id="tornado.web.StaticFileHandler.get_version">
<em class="property">classmethod </em><code class="descname">get_version</code><span class="sig-paren">(</span><em>settings</em>, <em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/web.html#StaticFileHandler.get_version"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.web.StaticFileHandler.get_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the version string to be used in static URLs.</p>
<p><code class="docutils literal"><span class="pre">settings</span></code> is the <a class="reference internal" href="#tornado.web.Application.settings" title="tornado.web.Application.settings"><code class="xref py py-obj docutils literal"><span class="pre">Application.settings</span></code></a> dictionary and <code class="docutils literal"><span class="pre">path</span></code>
is the relative location of the requested asset on the filesystem.
The returned value should be a string, or <code class="docutils literal"><span class="pre">None</span></code> if no version
could be determined.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.1: </span>This method was previously recommended for subclasses to override;
<a class="reference internal" href="#tornado.web.StaticFileHandler.get_content_version" title="tornado.web.StaticFileHandler.get_content_version"><code class="xref py py-obj docutils literal"><span class="pre">get_content_version</span></code></a> is now preferred as it allows the base
class to handle caching of the result.</p>
</div>
</dd></dl>

</dd></dl>

</div>
</div>
<span id="document-template"></span><div class="section" id="module-tornado.template">
<span id="tornado-template-flexible-output-generation"></span><h4><code class="docutils literal"><span class="pre">tornado.template</span></code> &#8212; Flexible output generation<a class="headerlink" href="#module-tornado.template" title="Permalink to this headline">¶</a></h4>
<p>A simple template system that compiles templates to Python code.</p>
<p>Basic usage looks like:</p>
<div class="highlight-python"><div class="highlight"><pre>t = template.Template(&quot;&lt;html&gt;{{ myvalue }}&lt;/html&gt;&quot;)
print t.generate(myvalue=&quot;XXX&quot;)
</pre></div>
</div>
<p><a class="reference internal" href="#tornado.template.Loader" title="tornado.template.Loader"><code class="xref py py-obj docutils literal"><span class="pre">Loader</span></code></a> is a class that loads templates from a root directory and caches
the compiled templates:</p>
<div class="highlight-python"><div class="highlight"><pre>loader = template.Loader(&quot;/home/btaylor&quot;)
print loader.load(&quot;test.html&quot;).generate(myvalue=&quot;XXX&quot;)
</pre></div>
</div>
<p>We compile all templates to raw Python. Error-reporting is currently... uh,
interesting. Syntax for the templates:</p>
<div class="highlight-python"><div class="highlight"><pre>### base.html
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;{% block title %}Default title{% end %}&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;ul&gt;
      {% for student in students %}
        {% block student %}
          &lt;li&gt;{{ escape(student.name) }}&lt;/li&gt;
        {% end %}
      {% end %}
    &lt;/ul&gt;
  &lt;/body&gt;
&lt;/html&gt;

### bold.html
{% extends &quot;base.html&quot; %}

{% block title %}A bolder title{% end %}

{% block student %}
  &lt;li&gt;&lt;span style=&quot;bold&quot;&gt;{{ escape(student.name) }}&lt;/span&gt;&lt;/li&gt;
{% end %}
</pre></div>
</div>
<p>Unlike most other template systems, we do not put any restrictions on the
expressions you can include in your statements. <code class="docutils literal"><span class="pre">if</span></code> and <code class="docutils literal"><span class="pre">for</span></code> blocks get
translated exactly into Python, so you can do complex expressions like:</p>
<div class="highlight-python"><div class="highlight"><pre>{% for student in [p for p in people if p.student and p.age &gt; 23] %}
  &lt;li&gt;{{ escape(student.name) }}&lt;/li&gt;
{% end %}
</pre></div>
</div>
<p>Translating directly to Python means you can apply functions to expressions
easily, like the <code class="docutils literal"><span class="pre">escape()</span></code> function in the examples above. You can pass
functions in to your template just like any other variable
(In a <a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a>, override <a class="reference internal" href="index.html#tornado.web.RequestHandler.get_template_namespace" title="tornado.web.RequestHandler.get_template_namespace"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_template_namespace</span></code></a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">### Python code</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
   <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="n">template</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">add</span><span class="o">=</span><span class="n">add</span><span class="p">)</span>

<span class="c">### The template</span>
<span class="p">{{</span> <span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">}}</span>
</pre></div>
</div>
<p>We provide the functions <a class="reference internal" href="index.html#tornado.escape.xhtml_escape" title="tornado.escape.xhtml_escape"><code class="xref py py-obj docutils literal"><span class="pre">escape()</span></code></a>, <a class="reference internal" href="index.html#tornado.escape.url_escape" title="tornado.escape.url_escape"><code class="xref py py-obj docutils literal"><span class="pre">url_escape()</span></code></a>,
<a class="reference internal" href="index.html#tornado.escape.json_encode" title="tornado.escape.json_encode"><code class="xref py py-obj docutils literal"><span class="pre">json_encode()</span></code></a>, and <a class="reference internal" href="index.html#tornado.escape.squeeze" title="tornado.escape.squeeze"><code class="xref py py-obj docutils literal"><span class="pre">squeeze()</span></code></a> to all templates by default.</p>
<p>Typical applications do not create <a class="reference internal" href="#tornado.template.Template" title="tornado.template.Template"><code class="xref py py-obj docutils literal"><span class="pre">Template</span></code></a> or <a class="reference internal" href="#tornado.template.Loader" title="tornado.template.Loader"><code class="xref py py-obj docutils literal"><span class="pre">Loader</span></code></a> instances by
hand, but instead use the <a class="reference internal" href="index.html#tornado.web.RequestHandler.render" title="tornado.web.RequestHandler.render"><code class="xref py py-obj docutils literal"><span class="pre">render</span></code></a> and
<a class="reference internal" href="index.html#tornado.web.RequestHandler.render_string" title="tornado.web.RequestHandler.render_string"><code class="xref py py-obj docutils literal"><span class="pre">render_string</span></code></a> methods of
<a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.RequestHandler</span></code></a>, which load templates automatically based
on the <code class="docutils literal"><span class="pre">template_path</span></code> <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> setting.</p>
<p>Variable names beginning with <code class="docutils literal"><span class="pre">_tt_</span></code> are reserved by the template
system and should not be used by application code.</p>
<div class="section" id="syntax-reference">
<h5>Syntax Reference<a class="headerlink" href="#syntax-reference" title="Permalink to this headline">¶</a></h5>
<p>Template expressions are surrounded by double curly braces: <code class="docutils literal"><span class="pre">{{</span> <span class="pre">...</span> <span class="pre">}}</span></code>.
The contents may be any python expression, which will be escaped according
to the current autoescape setting and inserted into the output.  Other
template directives use <code class="docutils literal"><span class="pre">{%</span> <span class="pre">%}</span></code>.  These tags may be escaped as <code class="docutils literal"><span class="pre">{{!</span></code>
and <code class="docutils literal"><span class="pre">{%!</span></code> if you need to include a literal <code class="docutils literal"><span class="pre">{{</span></code> or <code class="docutils literal"><span class="pre">{%</span></code> in the output.</p>
<p>To comment out a section so that it is omitted from the output, surround it
with <code class="docutils literal"><span class="pre">{#</span> <span class="pre">...</span> <span class="pre">#}</span></code>.</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">{%</span> <span class="pre">apply</span> <span class="pre">*function*</span> <span class="pre">%}...{%</span> <span class="pre">end</span> <span class="pre">%}</span></code></dt>
<dd><p class="first">Applies a function to the output of all template code between <code class="docutils literal"><span class="pre">apply</span></code>
and <code class="docutils literal"><span class="pre">end</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre>{% apply linkify %}{{name}} said: {{message}}{% end %}
</pre></div>
</div>
<p class="last">Note that as an implementation detail apply blocks are implemented
as nested functions and thus may interact strangely with variables
set via <code class="docutils literal"><span class="pre">{%</span> <span class="pre">set</span> <span class="pre">%}</span></code>, or the use of <code class="docutils literal"><span class="pre">{%</span> <span class="pre">break</span> <span class="pre">%}</span></code> or <code class="docutils literal"><span class="pre">{%</span> <span class="pre">continue</span> <span class="pre">%}</span></code>
within loops.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">{%</span> <span class="pre">autoescape</span> <span class="pre">*function*</span> <span class="pre">%}</span></code></dt>
<dd><p class="first">Sets the autoescape mode for the current file.  This does not affect
other files, even those referenced by <code class="docutils literal"><span class="pre">{%</span> <span class="pre">include</span> <span class="pre">%}</span></code>.  Note that
autoescaping can also be configured globally, at the <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a>
or <a class="reference internal" href="#tornado.template.Loader" title="tornado.template.Loader"><code class="xref py py-obj docutils literal"><span class="pre">Loader</span></code></a>.:</p>
<div class="last highlight-python"><div class="highlight"><pre>{% autoescape xhtml_escape %}
{% autoescape None %}
</pre></div>
</div>
</dd>
<dt><code class="docutils literal"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">*name*</span> <span class="pre">%}...{%</span> <span class="pre">end</span> <span class="pre">%}</span></code></dt>
<dd><p class="first">Indicates a named, replaceable block for use with <code class="docutils literal"><span class="pre">{%</span> <span class="pre">extends</span> <span class="pre">%}</span></code>.
Blocks in the parent template will be replaced with the contents of
the same-named block in a child template.:</p>
<div class="last highlight-python"><div class="highlight"><pre>&lt;!-- base.html --&gt;
&lt;title&gt;{% block title %}Default title{% end %}&lt;/title&gt;

&lt;!-- mypage.html --&gt;
{% extends &quot;base.html&quot; %}
{% block title %}My page title{% end %}
</pre></div>
</div>
</dd>
<dt><code class="docutils literal"><span class="pre">{%</span> <span class="pre">comment</span> <span class="pre">...</span> <span class="pre">%}</span></code></dt>
<dd>A comment which will be removed from the template output.  Note that
there is no <code class="docutils literal"><span class="pre">{%</span> <span class="pre">end</span> <span class="pre">%}</span></code> tag; the comment goes from the word <code class="docutils literal"><span class="pre">comment</span></code>
to the closing <code class="docutils literal"><span class="pre">%}</span></code> tag.</dd>
<dt><code class="docutils literal"><span class="pre">{%</span> <span class="pre">extends</span> <span class="pre">*filename*</span> <span class="pre">%}</span></code></dt>
<dd>Inherit from another template.  Templates that use <code class="docutils literal"><span class="pre">extends</span></code> should
contain one or more <code class="docutils literal"><span class="pre">block</span></code> tags to replace content from the parent
template.  Anything in the child template not contained in a <code class="docutils literal"><span class="pre">block</span></code>
tag will be ignored.  For an example, see the <code class="docutils literal"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">%}</span></code> tag.</dd>
<dt><code class="docutils literal"><span class="pre">{%</span> <span class="pre">for</span> <span class="pre">*var*</span> <span class="pre">in</span> <span class="pre">*expr*</span> <span class="pre">%}...{%</span> <span class="pre">end</span> <span class="pre">%}</span></code></dt>
<dd>Same as the python <code class="docutils literal"><span class="pre">for</span></code> statement.  <code class="docutils literal"><span class="pre">{%</span> <span class="pre">break</span> <span class="pre">%}</span></code> and
<code class="docutils literal"><span class="pre">{%</span> <span class="pre">continue</span> <span class="pre">%}</span></code> may be used inside the loop.</dd>
<dt><code class="docutils literal"><span class="pre">{%</span> <span class="pre">from</span> <span class="pre">*x*</span> <span class="pre">import</span> <span class="pre">*y*</span> <span class="pre">%}</span></code></dt>
<dd>Same as the python <code class="docutils literal"><span class="pre">import</span></code> statement.</dd>
<dt><code class="docutils literal"><span class="pre">{%</span> <span class="pre">if</span> <span class="pre">*condition*</span> <span class="pre">%}...{%</span> <span class="pre">elif</span> <span class="pre">*condition*</span> <span class="pre">%}...{%</span> <span class="pre">else</span> <span class="pre">%}...{%</span> <span class="pre">end</span> <span class="pre">%}</span></code></dt>
<dd>Conditional statement - outputs the first section whose condition is
true.  (The <code class="docutils literal"><span class="pre">elif</span></code> and <code class="docutils literal"><span class="pre">else</span></code> sections are optional)</dd>
<dt><code class="docutils literal"><span class="pre">{%</span> <span class="pre">import</span> <span class="pre">*module*</span> <span class="pre">%}</span></code></dt>
<dd>Same as the python <code class="docutils literal"><span class="pre">import</span></code> statement.</dd>
<dt><code class="docutils literal"><span class="pre">{%</span> <span class="pre">include</span> <span class="pre">*filename*</span> <span class="pre">%}</span></code></dt>
<dd>Includes another template file.  The included file can see all the local
variables as if it were copied directly to the point of the <code class="docutils literal"><span class="pre">include</span></code>
directive (the <code class="docutils literal"><span class="pre">{%</span> <span class="pre">autoescape</span> <span class="pre">%}</span></code> directive is an exception).
Alternately, <code class="docutils literal"><span class="pre">{%</span> <span class="pre">module</span> <span class="pre">Template(filename,</span> <span class="pre">**kwargs)</span> <span class="pre">%}</span></code> may be used
to include another template with an isolated namespace.</dd>
<dt><code class="docutils literal"><span class="pre">{%</span> <span class="pre">module</span> <span class="pre">*expr*</span> <span class="pre">%}</span></code></dt>
<dd><p class="first">Renders a <a class="reference internal" href="index.html#tornado.web.UIModule" title="tornado.web.UIModule"><code class="xref py py-obj docutils literal"><span class="pre">UIModule</span></code></a>.  The output of the <code class="docutils literal"><span class="pre">UIModule</span></code> is
not escaped:</p>
<div class="highlight-python"><div class="highlight"><pre>{% module Template(&quot;foo.html&quot;, arg=42) %}
</pre></div>
</div>
<p class="last"><code class="docutils literal"><span class="pre">UIModules</span></code> are a feature of the <a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.RequestHandler</span></code></a>
class (and specifically its <code class="docutils literal"><span class="pre">render</span></code> method) and will not work
when the template system is used on its own in other contexts.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">{%</span> <span class="pre">raw</span> <span class="pre">*expr*</span> <span class="pre">%}</span></code></dt>
<dd>Outputs the result of the given expression without autoescaping.</dd>
<dt><code class="docutils literal"><span class="pre">{%</span> <span class="pre">set</span> <span class="pre">*x*</span> <span class="pre">=</span> <span class="pre">*y*</span> <span class="pre">%}</span></code></dt>
<dd>Sets a local variable.</dd>
<dt><code class="docutils literal"><span class="pre">{%</span> <span class="pre">try</span> <span class="pre">%}...{%</span> <span class="pre">except</span> <span class="pre">%}...{%</span> <span class="pre">else</span> <span class="pre">%}...{%</span> <span class="pre">finally</span> <span class="pre">%}...{%</span> <span class="pre">end</span> <span class="pre">%}</span></code></dt>
<dd>Same as the python <code class="docutils literal"><span class="pre">try</span></code> statement.</dd>
<dt><code class="docutils literal"><span class="pre">{%</span> <span class="pre">while</span> <span class="pre">*condition*</span> <span class="pre">%}...</span> <span class="pre">{%</span> <span class="pre">end</span> <span class="pre">%}</span></code></dt>
<dd>Same as the python <code class="docutils literal"><span class="pre">while</span></code> statement.  <code class="docutils literal"><span class="pre">{%</span> <span class="pre">break</span> <span class="pre">%}</span></code> and
<code class="docutils literal"><span class="pre">{%</span> <span class="pre">continue</span> <span class="pre">%}</span></code> may be used inside the loop.</dd>
<dt><code class="docutils literal"><span class="pre">{%</span> <span class="pre">whitespace</span> <span class="pre">*mode*</span> <span class="pre">%}</span></code></dt>
<dd>Sets the whitespace mode for the remainder of the current file
(or until the next <code class="docutils literal"><span class="pre">{%</span> <span class="pre">whitespace</span> <span class="pre">%}</span></code> directive). See
<a class="reference internal" href="#tornado.template.filter_whitespace" title="tornado.template.filter_whitespace"><code class="xref py py-obj docutils literal"><span class="pre">filter_whitespace</span></code></a> for available options. New in Tornado 4.3.</dd>
</dl>
</div>
<div class="section" id="class-reference">
<h5>Class reference<a class="headerlink" href="#class-reference" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.template.Template">
<em class="property">class </em><code class="descclassname">tornado.template.</code><code class="descname">Template</code><span class="sig-paren">(</span><em>template_string</em>, <em>name=&quot;&lt;string&gt;&quot;</em>, <em>loader=None</em>, <em>compress_whitespace=None</em>, <em>autoescape=&quot;xhtml_escape&quot;</em>, <em>whitespace=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/template.html#Template"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.template.Template" title="Permalink to this definition">¶</a></dt>
<dd><p>A compiled template.</p>
<p>We compile into Python from the given template_string. You can generate
the template from variables with generate().</p>
<p>Construct a Template.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>template_string</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#str" title="(in Python v3.4)"><em>str</em></a>) &#8211; the contents of the template file.</li>
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#str" title="(in Python v3.4)"><em>str</em></a>) &#8211; the filename from which the template was loaded
(used for error message).</li>
<li><strong>loader</strong> (<a class="reference internal" href="index.html#tornado.template.BaseLoader" title="tornado.template.BaseLoader"><em>tornado.template.BaseLoader</em></a>) &#8211; the <a class="reference internal" href="#tornado.template.BaseLoader" title="tornado.template.BaseLoader"><code class="xref py py-obj docutils literal"><span class="pre">BaseLoader</span></code></a> responsible for this template,
used to resolve <code class="docutils literal"><span class="pre">{%</span> <span class="pre">include</span> <span class="pre">%}</span></code> and <code class="docutils literal"><span class="pre">{%</span> <span class="pre">extend</span> <span class="pre">%}</span></code>
directives.</li>
<li><strong>compress_whitespace</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#bool" title="(in Python v3.4)"><em>bool</em></a>) &#8211; Deprecated since Tornado 4.3.
Equivalent to <code class="docutils literal"><span class="pre">whitespace=&quot;single&quot;</span></code> if true and
<code class="docutils literal"><span class="pre">whitespace=&quot;all&quot;</span></code> if false.</li>
<li><strong>autoescape</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#str" title="(in Python v3.4)"><em>str</em></a>) &#8211; The name of a function in the template
namespace, or <code class="docutils literal"><span class="pre">None</span></code> to disable escaping by default.</li>
<li><strong>whitespace</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#str" title="(in Python v3.4)"><em>str</em></a>) &#8211; A string specifying treatment of whitespace;
see <a class="reference internal" href="#tornado.template.filter_whitespace" title="tornado.template.filter_whitespace"><code class="xref py py-obj docutils literal"><span class="pre">filter_whitespace</span></code></a> for options.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Added <code class="docutils literal"><span class="pre">whitespace</span></code> parameter; deprecated <code class="docutils literal"><span class="pre">compress_whitespace</span></code>.</p>
</div>
<dl class="method">
<dt id="tornado.template.Template.generate">
<code class="descname">generate</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/template.html#Template.generate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.template.Template.generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate this template with the given arguments.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.template.BaseLoader">
<em class="property">class </em><code class="descclassname">tornado.template.</code><code class="descname">BaseLoader</code><span class="sig-paren">(</span><em>autoescape='xhtml_escape'</em>, <em>namespace=None</em>, <em>whitespace=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/template.html#BaseLoader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.template.BaseLoader" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for template loaders.</p>
<p>You must use a template loader to use template constructs like
<code class="docutils literal"><span class="pre">{%</span> <span class="pre">extends</span> <span class="pre">%}</span></code> and <code class="docutils literal"><span class="pre">{%</span> <span class="pre">include</span> <span class="pre">%}</span></code>. The loader caches all
templates after they are loaded the first time.</p>
<p>Construct a template loader.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>autoescape</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#str" title="(in Python v3.4)"><em>str</em></a>) &#8211; The name of a function in the template
namespace, such as &#8220;xhtml_escape&#8221;, or <code class="docutils literal"><span class="pre">None</span></code> to disable
autoescaping by default.</li>
<li><strong>namespace</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#dict" title="(in Python v3.4)"><em>dict</em></a>) &#8211; A dictionary to be added to the default template
namespace, or <code class="docutils literal"><span class="pre">None</span></code>.</li>
<li><strong>whitespace</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#str" title="(in Python v3.4)"><em>str</em></a>) &#8211; A string specifying default behavior for
whitespace in templates; see <a class="reference internal" href="#tornado.template.filter_whitespace" title="tornado.template.filter_whitespace"><code class="xref py py-obj docutils literal"><span class="pre">filter_whitespace</span></code></a> for options.
Default is &#8220;single&#8221; for files ending in &#8221;.html&#8221; and &#8221;.js&#8221; and
&#8220;all&#8221; for other files.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Added <code class="docutils literal"><span class="pre">whitespace</span></code> parameter.</p>
</div>
<dl class="method">
<dt id="tornado.template.BaseLoader.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/template.html#BaseLoader.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.template.BaseLoader.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets the cache of compiled templates.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.template.BaseLoader.resolve_path">
<code class="descname">resolve_path</code><span class="sig-paren">(</span><em>name</em>, <em>parent_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/template.html#BaseLoader.resolve_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.template.BaseLoader.resolve_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a possibly-relative path to absolute (used internally).</p>
</dd></dl>

<dl class="method">
<dt id="tornado.template.BaseLoader.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>name</em>, <em>parent_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/template.html#BaseLoader.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.template.BaseLoader.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a template.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.template.Loader">
<em class="property">class </em><code class="descclassname">tornado.template.</code><code class="descname">Loader</code><span class="sig-paren">(</span><em>root_directory</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/template.html#Loader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.template.Loader" title="Permalink to this definition">¶</a></dt>
<dd><p>A template loader that loads from a single root directory.</p>
</dd></dl>

<dl class="class">
<dt id="tornado.template.DictLoader">
<em class="property">class </em><code class="descclassname">tornado.template.</code><code class="descname">DictLoader</code><span class="sig-paren">(</span><em>dict</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/template.html#DictLoader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.template.DictLoader" title="Permalink to this definition">¶</a></dt>
<dd><p>A template loader that loads from a dictionary.</p>
</dd></dl>

<dl class="exception">
<dt id="tornado.template.ParseError">
<em class="property">exception </em><code class="descclassname">tornado.template.</code><code class="descname">ParseError</code><span class="sig-paren">(</span><em>message</em>, <em>filename</em>, <em>lineno</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/template.html#ParseError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.template.ParseError" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised for template syntax errors.</p>
<p><code class="docutils literal"><span class="pre">ParseError</span></code> instances have <code class="docutils literal"><span class="pre">filename</span></code> and <code class="docutils literal"><span class="pre">lineno</span></code> attributes
indicating the position of the error.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Added <code class="docutils literal"><span class="pre">filename</span></code> and <code class="docutils literal"><span class="pre">lineno</span></code> attributes.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.template.filter_whitespace">
<code class="descclassname">tornado.template.</code><code class="descname">filter_whitespace</code><span class="sig-paren">(</span><em>mode</em>, <em>text</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/template.html#filter_whitespace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.template.filter_whitespace" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform whitespace in <code class="docutils literal"><span class="pre">text</span></code> according to <code class="docutils literal"><span class="pre">mode</span></code>.</p>
<p>Available modes are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">all</span></code>: Return all whitespace unmodified.</li>
<li><code class="docutils literal"><span class="pre">single</span></code>: Collapse consecutive whitespace with a single whitespace
character, preserving newlines.</li>
<li><code class="docutils literal"><span class="pre">oneline</span></code>: Collapse all runs of whitespace into a single space
character, removing all newlines in the process.</li>
</ul>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.3.</span></p>
</div>
</dd></dl>

</div>
</div>
<span id="document-escape"></span><div class="section" id="module-tornado.escape">
<span id="tornado-escape-escaping-and-string-manipulation"></span><h4><code class="docutils literal"><span class="pre">tornado.escape</span></code> &#8212; Escaping and string manipulation<a class="headerlink" href="#module-tornado.escape" title="Permalink to this headline">¶</a></h4>
<p>Escaping/unescaping methods for HTML, JSON, URLs, and others.</p>
<p>Also includes a few other miscellaneous string manipulation functions that
have crept in over time.</p>
<div class="section" id="escaping-functions">
<h5>Escaping functions<a class="headerlink" href="#escaping-functions" title="Permalink to this headline">¶</a></h5>
<dl class="function">
<dt id="tornado.escape.xhtml_escape">
<code class="descclassname">tornado.escape.</code><code class="descname">xhtml_escape</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/escape.html#xhtml_escape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.escape.xhtml_escape" title="Permalink to this definition">¶</a></dt>
<dd><p>Escapes a string so it is valid within HTML or XML.</p>
<p>Escapes the characters <code class="docutils literal"><span class="pre">&lt;</span></code>, <code class="docutils literal"><span class="pre">&gt;</span></code>, <code class="docutils literal"><span class="pre">&quot;</span></code>, <code class="docutils literal"><span class="pre">'</span></code>, and <code class="docutils literal"><span class="pre">&amp;</span></code>.
When used in attribute values the escaped strings must be enclosed
in quotes.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.2: </span>Added the single quote to the list of escaped characters.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.escape.xhtml_unescape">
<code class="descclassname">tornado.escape.</code><code class="descname">xhtml_unescape</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/escape.html#xhtml_unescape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.escape.xhtml_unescape" title="Permalink to this definition">¶</a></dt>
<dd><p>Un-escapes an XML-escaped string.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.escape.url_escape">
<code class="descclassname">tornado.escape.</code><code class="descname">url_escape</code><span class="sig-paren">(</span><em>value</em>, <em>plus=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/escape.html#url_escape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.escape.url_escape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a URL-encoded version of the given value.</p>
<p>If <code class="docutils literal"><span class="pre">plus</span></code> is true (the default), spaces will be represented
as &#8220;+&#8221; instead of &#8220;%20&#8221;.  This is appropriate for query strings
but not for the path component of a URL.  Note that this default
is the reverse of Python&#8217;s urllib module.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1: </span>The <code class="docutils literal"><span class="pre">plus</span></code> argument</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.escape.url_unescape">
<code class="descclassname">tornado.escape.</code><code class="descname">url_unescape</code><span class="sig-paren">(</span><em>value</em>, <em>encoding='utf-8'</em>, <em>plus=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/escape.html#url_unescape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.escape.url_unescape" title="Permalink to this definition">¶</a></dt>
<dd><p>Decodes the given value from a URL.</p>
<p>The argument may be either a byte or unicode string.</p>
<p>If encoding is None, the result will be a byte string.  Otherwise,
the result is a unicode string in the specified encoding.</p>
<p>If <code class="docutils literal"><span class="pre">plus</span></code> is true (the default), plus signs will be interpreted
as spaces (literal plus signs must be represented as &#8220;%2B&#8221;).  This
is appropriate for query strings and form-encoded values but not
for the path component of a URL.  Note that this default is the
reverse of Python&#8217;s urllib module.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1: </span>The <code class="docutils literal"><span class="pre">plus</span></code> argument</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.escape.json_encode">
<code class="descclassname">tornado.escape.</code><code class="descname">json_encode</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/escape.html#json_encode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.escape.json_encode" title="Permalink to this definition">¶</a></dt>
<dd><p>JSON-encodes the given Python object.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.escape.json_decode">
<code class="descclassname">tornado.escape.</code><code class="descname">json_decode</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/escape.html#json_decode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.escape.json_decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Python objects for the given JSON string.</p>
</dd></dl>

</div>
<div class="section" id="byte-unicode-conversions">
<h5>Byte/unicode conversions<a class="headerlink" href="#byte-unicode-conversions" title="Permalink to this headline">¶</a></h5>
<p>These functions are used extensively within Tornado itself,
but should not be directly needed by most applications.  Note that
much of the complexity of these functions comes from the fact that
Tornado supports both Python 2 and Python 3.</p>
<dl class="function">
<dt id="tornado.escape.utf8">
<code class="descclassname">tornado.escape.</code><code class="descname">utf8</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/escape.html#utf8"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.escape.utf8" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a string argument to a byte string.</p>
<p>If the argument is already a byte string or None, it is returned unchanged.
Otherwise it must be a unicode string and is encoded as utf8.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.escape.to_unicode">
<code class="descclassname">tornado.escape.</code><code class="descname">to_unicode</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/escape.html#to_unicode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.escape.to_unicode" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a string argument to a unicode string.</p>
<p>If the argument is already a unicode string or None, it is returned
unchanged.  Otherwise it must be a byte string and is decoded as utf8.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.escape.native_str">
<code class="descclassname">tornado.escape.</code><code class="descname">native_str</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#tornado.escape.native_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a byte or unicode string into type <a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#str" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>.  Equivalent to
<a class="reference internal" href="#tornado.escape.utf8" title="tornado.escape.utf8"><code class="xref py py-obj docutils literal"><span class="pre">utf8</span></code></a> on Python 2 and <a class="reference internal" href="#tornado.escape.to_unicode" title="tornado.escape.to_unicode"><code class="xref py py-obj docutils literal"><span class="pre">to_unicode</span></code></a> on Python 3.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.escape.to_basestring">
<code class="descclassname">tornado.escape.</code><code class="descname">to_basestring</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/escape.html#to_basestring"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.escape.to_basestring" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a string argument to a subclass of basestring.</p>
<p>In python2, byte and unicode strings are mostly interchangeable,
so functions that deal with a user-supplied argument in combination
with ascii string constants can use either and should return the type
the user supplied.  In python3, the two types are not interchangeable,
so this method is needed to convert byte strings to unicode.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.escape.recursive_unicode">
<code class="descclassname">tornado.escape.</code><code class="descname">recursive_unicode</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/escape.html#recursive_unicode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.escape.recursive_unicode" title="Permalink to this definition">¶</a></dt>
<dd><p>Walks a simple data structure, converting byte strings to unicode.</p>
<p>Supports lists, tuples, and dictionaries.</p>
</dd></dl>

</div>
<div class="section" id="miscellaneous-functions">
<h5>Miscellaneous functions<a class="headerlink" href="#miscellaneous-functions" title="Permalink to this headline">¶</a></h5>
<dl class="function">
<dt id="tornado.escape.linkify">
<code class="descclassname">tornado.escape.</code><code class="descname">linkify</code><span class="sig-paren">(</span><em>text, shorten=False, extra_params='', require_protocol=False, permitted_protocols=['http', 'https']</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/escape.html#linkify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.escape.linkify" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts plain text into HTML with links.</p>
<p>For example: <code class="docutils literal"><span class="pre">linkify(&quot;Hello</span> <span class="pre">http://tornadoweb.org!&quot;)</span></code> would return
<code class="docutils literal"><span class="pre">Hello</span> <span class="pre">&lt;a</span> <span class="pre">href=&quot;http://tornadoweb.org&quot;&gt;http://tornadoweb.org&lt;/a&gt;!</span></code></p>
<p>Parameters:</p>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">shorten</span></code>: Long urls will be shortened for display.</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">extra_params</span></code>: Extra text to include in the link tag, or a callable</dt>
<dd><p class="first">taking the link as an argument and returning the extra text
e.g. <code class="docutils literal"><span class="pre">linkify(text,</span> <span class="pre">extra_params='rel=&quot;nofollow&quot;</span> <span class="pre">class=&quot;external&quot;')</span></code>,
or:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">extra_params_cb</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;http://example.com&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&#39;class=&quot;internal&quot;&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&#39;class=&quot;external&quot; rel=&quot;nofollow&quot;&#39;</span>
<span class="n">linkify</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">extra_params</span><span class="o">=</span><span class="n">extra_params_cb</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">require_protocol</span></code>: Only linkify urls which include a protocol. If</dt>
<dd><p class="first last">this is False, urls such as www.facebook.com will also be linkified.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">permitted_protocols</span></code>: List (or set) of protocols which should be</dt>
<dd><p class="first last">linkified, e.g. <code class="docutils literal"><span class="pre">linkify(text,</span> <span class="pre">permitted_protocols=[&quot;http&quot;,</span> <span class="pre">&quot;ftp&quot;,</span>
<span class="pre">&quot;mailto&quot;])</span></code>. It is very unsafe to include protocols such as
<code class="docutils literal"><span class="pre">javascript</span></code>.</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="tornado.escape.squeeze">
<code class="descclassname">tornado.escape.</code><code class="descname">squeeze</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/escape.html#squeeze"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.escape.squeeze" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace all sequences of whitespace chars with a single space.</p>
</dd></dl>

</div>
</div>
<span id="document-locale"></span><div class="section" id="module-tornado.locale">
<span id="tornado-locale-internationalization-support"></span><h4><code class="docutils literal"><span class="pre">tornado.locale</span></code> &#8212; Internationalization support<a class="headerlink" href="#module-tornado.locale" title="Permalink to this headline">¶</a></h4>
<p>Translation methods for generating localized strings.</p>
<p>To load a locale and generate a translated string:</p>
<div class="highlight-python"><div class="highlight"><pre>user_locale = tornado.locale.get(&quot;es_LA&quot;)
print user_locale.translate(&quot;Sign out&quot;)
</pre></div>
</div>
<p><a class="reference internal" href="#tornado.locale.get" title="tornado.locale.get"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locale.get()</span></code></a> returns the closest matching locale, not necessarily the
specific locale you requested. You can support pluralization with
additional arguments to <a class="reference internal" href="#tornado.locale.Locale.translate" title="tornado.locale.Locale.translate"><code class="xref py py-obj docutils literal"><span class="pre">translate()</span></code></a>, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre>people = [...]
message = user_locale.translate(
    &quot;%(list)s is online&quot;, &quot;%(list)s are online&quot;, len(people))
print message % {&quot;list&quot;: user_locale.list(people)}
</pre></div>
</div>
<p>The first string is chosen if <code class="docutils literal"><span class="pre">len(people)</span> <span class="pre">==</span> <span class="pre">1</span></code>, otherwise the second
string is chosen.</p>
<p>Applications should call one of <a class="reference internal" href="#tornado.locale.load_translations" title="tornado.locale.load_translations"><code class="xref py py-obj docutils literal"><span class="pre">load_translations</span></code></a> (which uses a simple
CSV format) or <a class="reference internal" href="#tornado.locale.load_gettext_translations" title="tornado.locale.load_gettext_translations"><code class="xref py py-obj docutils literal"><span class="pre">load_gettext_translations</span></code></a> (which uses the <code class="docutils literal"><span class="pre">.mo</span></code> format
supported by <a class="reference external" href="https://docs.python.org/3.4/library/gettext.html#module-gettext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">gettext</span></code></a> and related tools).  If neither method is called,
the <a class="reference internal" href="#tornado.locale.Locale.translate" title="tornado.locale.Locale.translate"><code class="xref py py-obj docutils literal"><span class="pre">Locale.translate</span></code></a> method will simply return the original string.</p>
<dl class="function">
<dt id="tornado.locale.get">
<code class="descclassname">tornado.locale.</code><code class="descname">get</code><span class="sig-paren">(</span><em>*locale_codes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locale.html#get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locale.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the closest match for the given locale codes.</p>
<p>We iterate over all given locale codes in order. If we have a tight
or a loose match for the code (e.g., &#8220;en&#8221; for &#8220;en_US&#8221;), we return
the locale. Otherwise we move to the next code in the list.</p>
<p>By default we return <code class="docutils literal"><span class="pre">en_US</span></code> if no translations are found for any of
the specified locales. You can change the default locale with
<a class="reference internal" href="#tornado.locale.set_default_locale" title="tornado.locale.set_default_locale"><code class="xref py py-obj docutils literal"><span class="pre">set_default_locale()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.locale.set_default_locale">
<code class="descclassname">tornado.locale.</code><code class="descname">set_default_locale</code><span class="sig-paren">(</span><em>code</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locale.html#set_default_locale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locale.set_default_locale" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the default locale.</p>
<p>The default locale is assumed to be the language used for all strings
in the system. The translations loaded from disk are mappings from
the default locale to the destination locale. Consequently, you don&#8217;t
need to create a translation file for the default locale.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.locale.load_translations">
<code class="descclassname">tornado.locale.</code><code class="descname">load_translations</code><span class="sig-paren">(</span><em>directory</em>, <em>encoding=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locale.html#load_translations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locale.load_translations" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads translations from CSV files in a directory.</p>
<p>Translations are strings with optional Python-style named placeholders
(e.g., <code class="docutils literal"><span class="pre">My</span> <span class="pre">name</span> <span class="pre">is</span> <span class="pre">%(name)s</span></code>) and their associated translations.</p>
<p>The directory should have translation files of the form <code class="docutils literal"><span class="pre">LOCALE.csv</span></code>,
e.g. <code class="docutils literal"><span class="pre">es_GT.csv</span></code>. The CSV files should have two or three columns: string,
translation, and an optional plural indicator. Plural indicators should
be one of &#8220;plural&#8221; or &#8220;singular&#8221;. A given string can have both singular
and plural forms. For example <code class="docutils literal"><span class="pre">%(name)s</span> <span class="pre">liked</span> <span class="pre">this</span></code> may have a
different verb conjugation depending on whether %(name)s is one
name or a list of names. There should be two rows in the CSV file for
that string, one with plural indicator &#8220;singular&#8221;, and one &#8220;plural&#8221;.
For strings with no verbs that would change on translation, simply
use &#8220;unknown&#8221; or the empty string (or don&#8217;t include the column at all).</p>
<p>The file is read using the <a class="reference external" href="https://docs.python.org/3.4/library/csv.html#module-csv" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">csv</span></code></a> module in the default &#8220;excel&#8221; dialect.
In this format there should not be spaces after the commas.</p>
<p>If no <code class="docutils literal"><span class="pre">encoding</span></code> parameter is given, the encoding will be
detected automatically (among UTF-8 and UTF-16) if the file
contains a byte-order marker (BOM), defaulting to UTF-8 if no BOM
is present.</p>
<p>Example translation <code class="docutils literal"><span class="pre">es_LA.csv</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="s">&quot;I love you&quot;</span><span class="p">,</span><span class="s">&quot;Te amo&quot;</span>
<span class="s">&quot;</span><span class="si">%(name)s</span><span class="s"> liked this&quot;</span><span class="p">,</span><span class="s">&quot;A </span><span class="si">%(name)s</span><span class="s"> les gustó esto&quot;</span><span class="p">,</span><span class="s">&quot;plural&quot;</span>
<span class="s">&quot;</span><span class="si">%(name)s</span><span class="s"> liked this&quot;</span><span class="p">,</span><span class="s">&quot;A </span><span class="si">%(name)s</span><span class="s"> le gustó esto&quot;</span><span class="p">,</span><span class="s">&quot;singular&quot;</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Added <code class="docutils literal"><span class="pre">encoding</span></code> parameter. Added support for BOM-based encoding
detection, UTF-16, and UTF-8-with-BOM.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.locale.load_gettext_translations">
<code class="descclassname">tornado.locale.</code><code class="descname">load_gettext_translations</code><span class="sig-paren">(</span><em>directory</em>, <em>domain</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locale.html#load_gettext_translations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locale.load_gettext_translations" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads translations from <a class="reference external" href="https://docs.python.org/3.4/library/gettext.html#module-gettext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">gettext</span></code></a>&#8216;s locale tree</p>
<p>Locale tree is similar to system&#8217;s <code class="docutils literal"><span class="pre">/usr/share/locale</span></code>, like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="n">directory</span><span class="p">}</span><span class="o">/</span><span class="p">{</span><span class="n">lang</span><span class="p">}</span><span class="o">/</span><span class="n">LC_MESSAGES</span><span class="o">/</span><span class="p">{</span><span class="n">domain</span><span class="p">}</span><span class="o">.</span><span class="n">mo</span>
</pre></div>
</div>
<p>Three steps are required to have you app translated:</p>
<ol class="arabic">
<li><p class="first">Generate POT translation file:</p>
<div class="highlight-python"><div class="highlight"><pre>xgettext --language=Python --keyword=_:1,2 -d mydomain file1.py file2.html etc
</pre></div>
</div>
</li>
<li><p class="first">Merge against existing POT file:</p>
<div class="highlight-python"><div class="highlight"><pre>msgmerge old.po mydomain.po &gt; new.po
</pre></div>
</div>
</li>
<li><p class="first">Compile:</p>
<div class="highlight-python"><div class="highlight"><pre>msgfmt mydomain.po -o {directory}/pt_BR/LC_MESSAGES/mydomain.mo
</pre></div>
</div>
</li>
</ol>
</dd></dl>

<dl class="function">
<dt id="tornado.locale.get_supported_locales">
<code class="descclassname">tornado.locale.</code><code class="descname">get_supported_locales</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locale.html#get_supported_locales"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locale.get_supported_locales" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all the supported locale codes.</p>
</dd></dl>

<dl class="class">
<dt id="tornado.locale.Locale">
<em class="property">class </em><code class="descclassname">tornado.locale.</code><code class="descname">Locale</code><span class="sig-paren">(</span><em>code</em>, <em>translations</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locale.html#Locale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locale.Locale" title="Permalink to this definition">¶</a></dt>
<dd><p>Object representing a locale.</p>
<p>After calling one of <a class="reference internal" href="#tornado.locale.load_translations" title="tornado.locale.load_translations"><code class="xref py py-obj docutils literal"><span class="pre">load_translations</span></code></a> or <a class="reference internal" href="#tornado.locale.load_gettext_translations" title="tornado.locale.load_gettext_translations"><code class="xref py py-obj docutils literal"><span class="pre">load_gettext_translations</span></code></a>,
call <a class="reference internal" href="#tornado.locale.get" title="tornado.locale.get"><code class="xref py py-obj docutils literal"><span class="pre">get</span></code></a> or <a class="reference internal" href="#tornado.locale.Locale.get_closest" title="tornado.locale.Locale.get_closest"><code class="xref py py-obj docutils literal"><span class="pre">get_closest</span></code></a> to get a Locale object.</p>
<dl class="classmethod">
<dt id="tornado.locale.Locale.get_closest">
<em class="property">classmethod </em><code class="descname">get_closest</code><span class="sig-paren">(</span><em>*locale_codes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locale.html#Locale.get_closest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locale.Locale.get_closest" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the closest match for the given locale code.</p>
</dd></dl>

<dl class="classmethod">
<dt id="tornado.locale.Locale.get">
<em class="property">classmethod </em><code class="descname">get</code><span class="sig-paren">(</span><em>code</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locale.html#Locale.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locale.Locale.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Locale for the given locale code.</p>
<p>If it is not supported, we raise an exception.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.locale.Locale.translate">
<code class="descname">translate</code><span class="sig-paren">(</span><em>message</em>, <em>plural_message=None</em>, <em>count=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locale.html#Locale.translate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locale.Locale.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the translation for the given message for this locale.</p>
<p>If <code class="docutils literal"><span class="pre">plural_message</span></code> is given, you must also provide
<code class="docutils literal"><span class="pre">count</span></code>. We return <code class="docutils literal"><span class="pre">plural_message</span></code> when <code class="docutils literal"><span class="pre">count</span> <span class="pre">!=</span> <span class="pre">1</span></code>,
and we return the singular form for the given message when
<code class="docutils literal"><span class="pre">count</span> <span class="pre">==</span> <span class="pre">1</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.locale.Locale.format_date">
<code class="descname">format_date</code><span class="sig-paren">(</span><em>date</em>, <em>gmt_offset=0</em>, <em>relative=True</em>, <em>shorter=False</em>, <em>full_format=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locale.html#Locale.format_date"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locale.Locale.format_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Formats the given date (which should be GMT).</p>
<p>By default, we return a relative time (e.g., &#8220;2 minutes ago&#8221;). You
can return an absolute date string with <code class="docutils literal"><span class="pre">relative=False</span></code>.</p>
<p>You can force a full format date (&#8220;July 10, 1980&#8221;) with
<code class="docutils literal"><span class="pre">full_format=True</span></code>.</p>
<p>This method is primarily intended for dates in the past.
For dates in the future, we fall back to full format.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.locale.Locale.format_day">
<code class="descname">format_day</code><span class="sig-paren">(</span><em>date</em>, <em>gmt_offset=0</em>, <em>dow=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locale.html#Locale.format_day"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locale.Locale.format_day" title="Permalink to this definition">¶</a></dt>
<dd><p>Formats the given date as a day of week.</p>
<p>Example: &#8220;Monday, January 22&#8221;. You can remove the day of week with
<code class="docutils literal"><span class="pre">dow=False</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.locale.Locale.list">
<code class="descname">list</code><span class="sig-paren">(</span><em>parts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locale.html#Locale.list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locale.Locale.list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a comma-separated list for the given list of parts.</p>
<p>The format is, e.g., &#8220;A, B and C&#8221;, &#8220;A and B&#8221; or just &#8220;A&#8221; for lists
of size 1.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.locale.Locale.friendly_number">
<code class="descname">friendly_number</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locale.html#Locale.friendly_number"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locale.Locale.friendly_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a comma-separated number for the given integer.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.locale.CSVLocale">
<em class="property">class </em><code class="descclassname">tornado.locale.</code><code class="descname">CSVLocale</code><span class="sig-paren">(</span><em>code</em>, <em>translations</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locale.html#CSVLocale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locale.CSVLocale" title="Permalink to this definition">¶</a></dt>
<dd><p>Locale implementation using tornado&#8217;s CSV translation format.</p>
</dd></dl>

<dl class="class">
<dt id="tornado.locale.GettextLocale">
<em class="property">class </em><code class="descclassname">tornado.locale.</code><code class="descname">GettextLocale</code><span class="sig-paren">(</span><em>code</em>, <em>translations</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locale.html#GettextLocale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locale.GettextLocale" title="Permalink to this definition">¶</a></dt>
<dd><p>Locale implementation using the <a class="reference external" href="https://docs.python.org/3.4/library/gettext.html#module-gettext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">gettext</span></code></a> module.</p>
<dl class="method">
<dt id="tornado.locale.GettextLocale.pgettext">
<code class="descname">pgettext</code><span class="sig-paren">(</span><em>context</em>, <em>message</em>, <em>plural_message=None</em>, <em>count=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locale.html#GettextLocale.pgettext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locale.GettextLocale.pgettext" title="Permalink to this definition">¶</a></dt>
<dd><p>Allows to set context for translation, accepts plural forms.</p>
<p>Usage example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">pgettext</span><span class="p">(</span><span class="s">&quot;law&quot;</span><span class="p">,</span> <span class="s">&quot;right&quot;</span><span class="p">)</span>
<span class="n">pgettext</span><span class="p">(</span><span class="s">&quot;good&quot;</span><span class="p">,</span> <span class="s">&quot;right&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Plural message example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">pgettext</span><span class="p">(</span><span class="s">&quot;organization&quot;</span><span class="p">,</span> <span class="s">&quot;club&quot;</span><span class="p">,</span> <span class="s">&quot;clubs&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">clubs</span><span class="p">))</span>
<span class="n">pgettext</span><span class="p">(</span><span class="s">&quot;stick&quot;</span><span class="p">,</span> <span class="s">&quot;club&quot;</span><span class="p">,</span> <span class="s">&quot;clubs&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">clubs</span><span class="p">))</span>
</pre></div>
</div>
<p>To generate POT file with context, add following options to step 1
of <a class="reference internal" href="#tornado.locale.load_gettext_translations" title="tornado.locale.load_gettext_translations"><code class="xref py py-obj docutils literal"><span class="pre">load_gettext_translations</span></code></a> sequence:</p>
<div class="highlight-python"><div class="highlight"><pre>xgettext [basic options] --keyword=pgettext:1c,2 --keyword=pgettext:1c,2,3
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.2.</span></p>
</div>
</dd></dl>

</dd></dl>

</div>
<span id="document-websocket"></span><div class="section" id="tornado-websocket-bidirectional-communication-to-the-browser">
<h4><code class="docutils literal"><span class="pre">tornado.websocket</span></code> &#8212; Bidirectional communication to the browser<a class="headerlink" href="#tornado-websocket-bidirectional-communication-to-the-browser" title="Permalink to this headline">¶</a></h4>
<span class="target" id="module-tornado.websocket"></span><p>Implementation of the WebSocket protocol.</p>
<p><a class="reference external" href="http://dev.w3.org/html5/websockets/">WebSockets</a> allow for bidirectional
communication between the browser and server.</p>
<p>WebSockets are supported in the current versions of all major browsers,
although older versions that do not support WebSockets are still in use
(refer to <a class="reference external" href="http://caniuse.com/websockets">http://caniuse.com/websockets</a> for details).</p>
<p>This module implements the final version of the WebSocket protocol as
defined in <a class="reference external" href="http://tools.ietf.org/html/rfc6455">RFC 6455</a>.  Certain
browser versions (notably Safari 5.x) implemented an earlier draft of
the protocol (known as &#8220;draft 76&#8221;) and are not compatible with this module.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>Removed support for the draft 76 protocol version.</p>
</div>
<dl class="class">
<dt id="tornado.websocket.WebSocketHandler">
<em class="property">class </em><code class="descclassname">tornado.websocket.</code><code class="descname">WebSocketHandler</code><span class="sig-paren">(</span><em>application</em>, <em>request</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclass this class to create a basic WebSocket handler.</p>
<p>Override <a class="reference internal" href="#tornado.websocket.WebSocketHandler.on_message" title="tornado.websocket.WebSocketHandler.on_message"><code class="xref py py-obj docutils literal"><span class="pre">on_message</span></code></a> to handle incoming messages, and use
<a class="reference internal" href="#tornado.websocket.WebSocketHandler.write_message" title="tornado.websocket.WebSocketHandler.write_message"><code class="xref py py-obj docutils literal"><span class="pre">write_message</span></code></a> to send messages to the client. You can also
override <a class="reference internal" href="#tornado.websocket.WebSocketHandler.open" title="tornado.websocket.WebSocketHandler.open"><code class="xref py py-obj docutils literal"><span class="pre">open</span></code></a> and <a class="reference internal" href="#tornado.websocket.WebSocketHandler.on_close" title="tornado.websocket.WebSocketHandler.on_close"><code class="xref py py-obj docutils literal"><span class="pre">on_close</span></code></a> to handle opened and closed
connections.</p>
<p>See <a class="reference external" href="http://dev.w3.org/html5/websockets/">http://dev.w3.org/html5/websockets/</a> for details on the
JavaScript interface.  The protocol is specified at
<a class="reference external" href="http://tools.ietf.org/html/rfc6455">http://tools.ietf.org/html/rfc6455</a>.</p>
<p>Here is an example WebSocket handler that echos back all received messages
back to the client:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">EchoWebSocket</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">websocket</span><span class="o">.</span><span class="n">WebSocketHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;WebSocket opened&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_message</span><span class="p">(</span><span class="s">u&quot;You said: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;WebSocket closed&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>WebSockets are not standard HTTP connections. The &#8220;handshake&#8221; is
HTTP, but after the handshake, the protocol is
message-based. Consequently, most of the Tornado HTTP facilities
are not available in handlers of this type. The only communication
methods available to you are <a class="reference internal" href="#tornado.websocket.WebSocketHandler.write_message" title="tornado.websocket.WebSocketHandler.write_message"><code class="xref py py-obj docutils literal"><span class="pre">write_message()</span></code></a>, <a class="reference internal" href="#tornado.websocket.WebSocketHandler.ping" title="tornado.websocket.WebSocketHandler.ping"><code class="xref py py-obj docutils literal"><span class="pre">ping()</span></code></a>, and
<a class="reference internal" href="#tornado.websocket.WebSocketHandler.close" title="tornado.websocket.WebSocketHandler.close"><code class="xref py py-obj docutils literal"><span class="pre">close()</span></code></a>. Likewise, your request handler class should implement
<a class="reference internal" href="#tornado.websocket.WebSocketHandler.open" title="tornado.websocket.WebSocketHandler.open"><code class="xref py py-obj docutils literal"><span class="pre">open()</span></code></a> method rather than <code class="docutils literal"><span class="pre">get()</span></code> or <code class="docutils literal"><span class="pre">post()</span></code>.</p>
<p>If you map the handler above to <code class="docutils literal"><span class="pre">/websocket</span></code> in your application, you can
invoke it in JavaScript with:</p>
<div class="highlight-python"><div class="highlight"><pre>var ws = new WebSocket(&quot;ws://localhost:8888/websocket&quot;);
ws.onopen = function() {
   ws.send(&quot;Hello, world&quot;);
};
ws.onmessage = function (evt) {
   alert(evt.data);
};
</pre></div>
</div>
<p>This script pops up an alert box that says &#8220;You said: Hello, world&#8221;.</p>
<p>Web browsers allow any site to open a websocket connection to any other,
instead of using the same-origin policy that governs other network
access from javascript.  This can be surprising and is a potential
security hole, so since Tornado 4.0 <a class="reference internal" href="#tornado.websocket.WebSocketHandler" title="tornado.websocket.WebSocketHandler"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler</span></code></a> requires
applications that wish to receive cross-origin websockets to opt in
by overriding the <a class="reference internal" href="#tornado.websocket.WebSocketHandler.check_origin" title="tornado.websocket.WebSocketHandler.check_origin"><code class="xref py py-obj docutils literal"><span class="pre">check_origin</span></code></a> method (see that
method&#8217;s docs for details).  Failure to do so is the most likely
cause of 403 errors when making a websocket connection.</p>
<p>When using a secure websocket connection (<code class="docutils literal"><span class="pre">wss://</span></code>) with a self-signed
certificate, the connection from a browser may fail because it wants
to show the &#8220;accept this certificate&#8221; dialog but has nowhere to show it.
You must first visit a regular HTML page using the same certificate
to accept it before the websocket connection will succeed.</p>
</dd></dl>

<div class="section" id="event-handlers">
<h5>Event handlers<a class="headerlink" href="#event-handlers" title="Permalink to this headline">¶</a></h5>
<dl class="method">
<dt id="tornado.websocket.WebSocketHandler.open">
<code class="descclassname">WebSocketHandler.</code><code class="descname">open</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketHandler.open"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketHandler.open" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoked when a new WebSocket is opened.</p>
<p>The arguments to <a class="reference internal" href="#tornado.websocket.WebSocketHandler.open" title="tornado.websocket.WebSocketHandler.open"><code class="xref py py-obj docutils literal"><span class="pre">open</span></code></a> are extracted from the <a class="reference internal" href="index.html#tornado.web.URLSpec" title="tornado.web.URLSpec"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.URLSpec</span></code></a>
regular expression, just like the arguments to
<a class="reference internal" href="index.html#tornado.web.RequestHandler.get" title="tornado.web.RequestHandler.get"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.RequestHandler.get</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.websocket.WebSocketHandler.on_message">
<code class="descclassname">WebSocketHandler.</code><code class="descname">on_message</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketHandler.on_message"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketHandler.on_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Handle incoming messages on the WebSocket</p>
<p>This method must be overridden.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.websocket.WebSocketHandler.on_close">
<code class="descclassname">WebSocketHandler.</code><code class="descname">on_close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketHandler.on_close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketHandler.on_close" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoked when the WebSocket is closed.</p>
<p>If the connection was closed cleanly and a status code or reason
phrase was supplied, these values will be available as the attributes
<code class="docutils literal"><span class="pre">self.close_code</span></code> and <code class="docutils literal"><span class="pre">self.close_reason</span></code>.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>Added <code class="docutils literal"><span class="pre">close_code</span></code> and <code class="docutils literal"><span class="pre">close_reason</span></code> attributes.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.websocket.WebSocketHandler.select_subprotocol">
<code class="descclassname">WebSocketHandler.</code><code class="descname">select_subprotocol</code><span class="sig-paren">(</span><em>subprotocols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketHandler.select_subprotocol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketHandler.select_subprotocol" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoked when a new WebSocket requests specific subprotocols.</p>
<p><code class="docutils literal"><span class="pre">subprotocols</span></code> is a list of strings identifying the
subprotocols proposed by the client.  This method may be
overridden to return one of those strings to select it, or
<code class="docutils literal"><span class="pre">None</span></code> to not select a subprotocol.  Failure to select a
subprotocol does not automatically abort the connection,
although clients may close the connection if none of their
proposed subprotocols was selected.</p>
</dd></dl>

</div>
<div class="section" id="output">
<h5>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h5>
<dl class="method">
<dt id="tornado.websocket.WebSocketHandler.write_message">
<code class="descclassname">WebSocketHandler.</code><code class="descname">write_message</code><span class="sig-paren">(</span><em>message</em>, <em>binary=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketHandler.write_message"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketHandler.write_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends the given message to the client of this Web Socket.</p>
<p>The message may be either a string or a dict (which will be
encoded as json).  If the <code class="docutils literal"><span class="pre">binary</span></code> argument is false, the
message will be sent as utf8; in binary mode any byte string
is allowed.</p>
<p>If the connection is already closed, raises <a class="reference internal" href="#tornado.websocket.WebSocketClosedError" title="tornado.websocket.WebSocketClosedError"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketClosedError</span></code></a>.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.2: </span><a class="reference internal" href="#tornado.websocket.WebSocketClosedError" title="tornado.websocket.WebSocketClosedError"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketClosedError</span></code></a> was added (previously a closed connection
would raise an <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#AttributeError" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">AttributeError</span></code></a>)</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> which can be used for flow control.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.websocket.WebSocketHandler.close">
<code class="descclassname">WebSocketHandler.</code><code class="descname">close</code><span class="sig-paren">(</span><em>code=None</em>, <em>reason=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketHandler.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketHandler.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes this Web Socket.</p>
<p>Once the close handshake is successful the socket will be closed.</p>
<p><code class="docutils literal"><span class="pre">code</span></code> may be a numeric status code, taken from the values
defined in <a class="reference external" href="https://tools.ietf.org/html/rfc6455#section-7.4.1">RFC 6455 section 7.4.1</a>.
<code class="docutils literal"><span class="pre">reason</span></code> may be a textual message about why the connection is
closing.  These values are made available to the client, but are
not otherwise interpreted by the websocket protocol.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>Added the <code class="docutils literal"><span class="pre">code</span></code> and <code class="docutils literal"><span class="pre">reason</span></code> arguments.</p>
</div>
</dd></dl>

</div>
<div class="section" id="configuration">
<h5>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h5>
<dl class="method">
<dt id="tornado.websocket.WebSocketHandler.check_origin">
<code class="descclassname">WebSocketHandler.</code><code class="descname">check_origin</code><span class="sig-paren">(</span><em>origin</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketHandler.check_origin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketHandler.check_origin" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to enable support for allowing alternate origins.</p>
<p>The <code class="docutils literal"><span class="pre">origin</span></code> argument is the value of the <code class="docutils literal"><span class="pre">Origin</span></code> HTTP
header, the url responsible for initiating this request.  This
method is not called for clients that do not send this header;
such requests are always allowed (because all browsers that
implement WebSockets support this header, and non-browser
clients do not have the same cross-site security concerns).</p>
<p>Should return True to accept the request or False to reject it.
By default, rejects all requests with an origin on a host other
than this one.</p>
<p>This is a security protection against cross site scripting attacks on
browsers, since WebSockets are allowed to bypass the usual same-origin
policies and don&#8217;t use CORS headers.</p>
<p>To accept all cross-origin traffic (which was the default prior to
Tornado 4.0), simply override this method to always return true:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">check_origin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>
</div>
<p>To allow connections from any subdomain of your site, you might
do something like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">check_origin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">origin</span><span class="p">):</span>
    <span class="n">parsed_origin</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">origin</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parsed_origin</span><span class="o">.</span><span class="n">netloc</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&quot;.mydomain.com&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.websocket.WebSocketHandler.get_compression_options">
<code class="descclassname">WebSocketHandler.</code><code class="descname">get_compression_options</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketHandler.get_compression_options"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketHandler.get_compression_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to return compression options for the connection.</p>
<p>If this method returns None (the default), compression will
be disabled.  If it returns a dict (even an empty one), it
will be enabled.  The contents of the dict may be used to
control the memory and CPU usage of the compression,
but no such options are currently implemented.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.websocket.WebSocketHandler.set_nodelay">
<code class="descclassname">WebSocketHandler.</code><code class="descname">set_nodelay</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketHandler.set_nodelay"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketHandler.set_nodelay" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the no-delay flag for this stream.</p>
<p>By default, small messages may be delayed and/or combined to minimize
the number of packets sent.  This can sometimes cause 200-500ms delays
due to the interaction between Nagle&#8217;s algorithm and TCP delayed
ACKs.  To reduce this delay (at the expense of possibly increasing
bandwidth usage), call <code class="docutils literal"><span class="pre">self.set_nodelay(True)</span></code> once the websocket
connection is established.</p>
<p>See <a class="reference internal" href="index.html#tornado.iostream.BaseIOStream.set_nodelay" title="tornado.iostream.BaseIOStream.set_nodelay"><code class="xref py py-obj docutils literal"><span class="pre">BaseIOStream.set_nodelay</span></code></a> for additional details.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

</div>
<div class="section" id="other">
<h5>Other<a class="headerlink" href="#other" title="Permalink to this headline">¶</a></h5>
<dl class="method">
<dt id="tornado.websocket.WebSocketHandler.ping">
<code class="descclassname">WebSocketHandler.</code><code class="descname">ping</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketHandler.ping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketHandler.ping" title="Permalink to this definition">¶</a></dt>
<dd><p>Send ping frame to the remote end.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.websocket.WebSocketHandler.on_pong">
<code class="descclassname">WebSocketHandler.</code><code class="descname">on_pong</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketHandler.on_pong"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketHandler.on_pong" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoked when the response to a ping frame is received.</p>
</dd></dl>

<dl class="exception">
<dt id="tornado.websocket.WebSocketClosedError">
<em class="property">exception </em><code class="descclassname">tornado.websocket.</code><code class="descname">WebSocketClosedError</code><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketClosedError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketClosedError" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised by operations on a closed connection.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2.</span></p>
</div>
</dd></dl>

</div>
<div class="section" id="client-side-support">
<h5>Client-side support<a class="headerlink" href="#client-side-support" title="Permalink to this headline">¶</a></h5>
<dl class="function">
<dt id="tornado.websocket.websocket_connect">
<code class="descclassname">tornado.websocket.</code><code class="descname">websocket_connect</code><span class="sig-paren">(</span><em>url</em>, <em>io_loop=None</em>, <em>callback=None</em>, <em>connect_timeout=None</em>, <em>on_message_callback=None</em>, <em>compression_options=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#websocket_connect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.websocket_connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Client-side websocket support.</p>
<p>Takes a url and returns a Future whose result is a
<a class="reference internal" href="#tornado.websocket.WebSocketClientConnection" title="tornado.websocket.WebSocketClientConnection"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketClientConnection</span></code></a>.</p>
<p><code class="docutils literal"><span class="pre">compression_options</span></code> is interpreted in the same way as the
return value of <a class="reference internal" href="#tornado.websocket.WebSocketHandler.get_compression_options" title="tornado.websocket.WebSocketHandler.get_compression_options"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler.get_compression_options</span></code></a>.</p>
<p>The connection supports two styles of operation. In the coroutine
style, the application typically calls
<a class="reference internal" href="#tornado.websocket.WebSocketClientConnection.read_message" title="tornado.websocket.WebSocketClientConnection.read_message"><code class="xref py py-obj docutils literal"><span class="pre">read_message</span></code></a> in a loop:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">conn</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">websocket_connect</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">conn</span><span class="o">.</span><span class="n">read_message</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">msg</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="k">break</span>
    <span class="c"># Do something with msg</span>
</pre></div>
</div>
<p>In the callback style, pass an <code class="docutils literal"><span class="pre">on_message_callback</span></code> to
<code class="docutils literal"><span class="pre">websocket_connect</span></code>. In both styles, a message of <code class="docutils literal"><span class="pre">None</span></code>
indicates that the connection has been closed.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.2: </span>Also accepts <code class="docutils literal"><span class="pre">HTTPRequest</span></code> objects in place of urls.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>Added <code class="docutils literal"><span class="pre">compression_options</span></code> and <code class="docutils literal"><span class="pre">on_message_callback</span></code>.
The <code class="docutils literal"><span class="pre">io_loop</span></code> argument is deprecated.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.websocket.WebSocketClientConnection">
<em class="property">class </em><code class="descclassname">tornado.websocket.</code><code class="descname">WebSocketClientConnection</code><span class="sig-paren">(</span><em>io_loop</em>, <em>request</em>, <em>on_message_callback=None</em>, <em>compression_options=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketClientConnection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketClientConnection" title="Permalink to this definition">¶</a></dt>
<dd><p>WebSocket client connection.</p>
<p>This class should not be instantiated directly; use the
<a class="reference internal" href="#tornado.websocket.websocket_connect" title="tornado.websocket.websocket_connect"><code class="xref py py-obj docutils literal"><span class="pre">websocket_connect</span></code></a> function instead.</p>
<dl class="method">
<dt id="tornado.websocket.WebSocketClientConnection.close">
<code class="descname">close</code><span class="sig-paren">(</span><em>code=None</em>, <em>reason=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketClientConnection.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketClientConnection.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes the websocket connection.</p>
<p><code class="docutils literal"><span class="pre">code</span></code> and <code class="docutils literal"><span class="pre">reason</span></code> are documented under
<a class="reference internal" href="#tornado.websocket.WebSocketHandler.close" title="tornado.websocket.WebSocketHandler.close"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler.close</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>Added the <code class="docutils literal"><span class="pre">code</span></code> and <code class="docutils literal"><span class="pre">reason</span></code> arguments.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.websocket.WebSocketClientConnection.write_message">
<code class="descname">write_message</code><span class="sig-paren">(</span><em>message</em>, <em>binary=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketClientConnection.write_message"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketClientConnection.write_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends a message to the WebSocket server.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.websocket.WebSocketClientConnection.read_message">
<code class="descname">read_message</code><span class="sig-paren">(</span><em>callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/websocket.html#WebSocketClientConnection.read_message"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.websocket.WebSocketClientConnection.read_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a message from the WebSocket server.</p>
<p>If on_message_callback was specified at WebSocket
initialization, this function will never return messages</p>
<p>Returns a future whose result is the message, or None
if the connection is closed.  If a callback argument
is given it will be called with the future when it is
ready.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>
</div>
<span id="document-http"></span><div class="section" id="http-servers-and-clients">
<h3>HTTP servers and clients<a class="headerlink" href="#http-servers-and-clients" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
<span id="document-httpserver"></span><div class="section" id="module-tornado.httpserver">
<span id="tornado-httpserver-non-blocking-http-server"></span><h4><code class="docutils literal"><span class="pre">tornado.httpserver</span></code> &#8212; Non-blocking HTTP server<a class="headerlink" href="#module-tornado.httpserver" title="Permalink to this headline">¶</a></h4>
<p>A non-blocking, single-threaded HTTP server.</p>
<p>Typical applications have little direct interaction with the <a class="reference internal" href="#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a>
class except to start a server at the beginning of the process
(and even that is often done indirectly via <a class="reference internal" href="index.html#tornado.web.Application.listen" title="tornado.web.Application.listen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.Application.listen</span></code></a>).</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>The <code class="docutils literal"><span class="pre">HTTPRequest</span></code> class that used to live in this module has been moved
to <a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest" title="tornado.httputil.HTTPServerRequest"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httputil.HTTPServerRequest</span></code></a>.  The old name remains as an alias.</p>
</div>
<div class="section" id="http-server">
<h5>HTTP Server<a class="headerlink" href="#http-server" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.httpserver.HTTPServer">
<em class="property">class </em><code class="descclassname">tornado.httpserver.</code><code class="descname">HTTPServer</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httpserver.html#HTTPServer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httpserver.HTTPServer" title="Permalink to this definition">¶</a></dt>
<dd><p>A non-blocking, single-threaded HTTP server.</p>
<p>A server is defined by a subclass of <a class="reference internal" href="index.html#tornado.httputil.HTTPServerConnectionDelegate" title="tornado.httputil.HTTPServerConnectionDelegate"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerConnectionDelegate</span></code></a>,
or, for backwards compatibility, a callback that takes an
<a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest" title="tornado.httputil.HTTPServerRequest"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerRequest</span></code></a> as an argument. The delegate is usually a
<a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.Application</span></code></a>.</p>
<p><a class="reference internal" href="#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> supports keep-alive connections by default
(automatically for HTTP/1.1, or for HTTP/1.0 when the client
requests <code class="docutils literal"><span class="pre">Connection:</span> <span class="pre">keep-alive</span></code>).</p>
<p>If <code class="docutils literal"><span class="pre">xheaders</span></code> is <code class="docutils literal"><span class="pre">True</span></code>, we support the
<code class="docutils literal"><span class="pre">X-Real-Ip</span></code>/<code class="docutils literal"><span class="pre">X-Forwarded-For</span></code> and
<code class="docutils literal"><span class="pre">X-Scheme</span></code>/<code class="docutils literal"><span class="pre">X-Forwarded-Proto</span></code> headers, which override the
remote IP and URI scheme/protocol for all requests.  These headers
are useful when running Tornado behind a reverse proxy or load
balancer.  The <code class="docutils literal"><span class="pre">protocol</span></code> argument can also be set to <code class="docutils literal"><span class="pre">https</span></code>
if Tornado is run behind an SSL-decoding proxy that does not set one of
the supported <code class="docutils literal"><span class="pre">xheaders</span></code>.</p>
<p>To make this server serve SSL traffic, send the <code class="docutils literal"><span class="pre">ssl_options</span></code> keyword
argument with an <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.SSLContext</span></code></a> object. For compatibility with older
versions of Python <code class="docutils literal"><span class="pre">ssl_options</span></code> may also be a dictionary of keyword
arguments for the <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.wrap_socket" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.wrap_socket</span></code></a> method.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ssl_ctx</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">(</span><span class="n">ssl</span><span class="o">.</span><span class="n">Purpose</span><span class="o">.</span><span class="n">CLIENT_AUTH</span><span class="p">)</span>
<span class="n">ssl_ctx</span><span class="o">.</span><span class="n">load_cert_chain</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s">&quot;mydomain.crt&quot;</span><span class="p">),</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s">&quot;mydomain.key&quot;</span><span class="p">))</span>
<span class="n">HTTPServer</span><span class="p">(</span><span class="n">applicaton</span><span class="p">,</span> <span class="n">ssl_options</span><span class="o">=</span><span class="n">ssl_ctx</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> initialization follows one of three patterns (the
initialization methods are defined on <a class="reference internal" href="index.html#tornado.tcpserver.TCPServer" title="tornado.tcpserver.TCPServer"><code class="xref py py-obj docutils literal"><span class="pre">tornado.tcpserver.TCPServer</span></code></a>):</p>
<ol class="arabic">
<li><p class="first"><a class="reference internal" href="index.html#tornado.tcpserver.TCPServer.listen" title="tornado.tcpserver.TCPServer.listen"><code class="xref py py-obj docutils literal"><span class="pre">listen</span></code></a>: simple single-process:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">server</span> <span class="o">=</span> <span class="n">HTTPServer</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<span class="n">server</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">8888</span><span class="p">)</span>
<span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>In many cases, <a class="reference internal" href="index.html#tornado.web.Application.listen" title="tornado.web.Application.listen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.Application.listen</span></code></a> can be used to avoid
the need to explicitly create the <a class="reference internal" href="#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a>.</p>
</li>
<li><p class="first"><a class="reference internal" href="index.html#tornado.tcpserver.TCPServer.bind" title="tornado.tcpserver.TCPServer.bind"><code class="xref py py-obj docutils literal"><span class="pre">bind</span></code></a>/<a class="reference internal" href="index.html#tornado.tcpserver.TCPServer.start" title="tornado.tcpserver.TCPServer.start"><code class="xref py py-obj docutils literal"><span class="pre">start</span></code></a>:
simple multi-process:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">server</span> <span class="o">=</span> <span class="n">HTTPServer</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<span class="n">server</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="mi">8888</span><span class="p">)</span>
<span class="n">server</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c"># Forks multiple sub-processes</span>
<span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>When using this interface, an <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> must <em>not</em> be passed
to the <a class="reference internal" href="#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> constructor.  <a class="reference internal" href="index.html#tornado.tcpserver.TCPServer.start" title="tornado.tcpserver.TCPServer.start"><code class="xref py py-obj docutils literal"><span class="pre">start</span></code></a> will always start
the server on the default singleton <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>.</p>
</li>
<li><p class="first"><a class="reference internal" href="index.html#tornado.tcpserver.TCPServer.add_sockets" title="tornado.tcpserver.TCPServer.add_sockets"><code class="xref py py-obj docutils literal"><span class="pre">add_sockets</span></code></a>: advanced multi-process:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sockets</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">netutil</span><span class="o">.</span><span class="n">bind_sockets</span><span class="p">(</span><span class="mi">8888</span><span class="p">)</span>
<span class="n">tornado</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">fork_processes</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">HTTPServer</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<span class="n">server</span><span class="o">.</span><span class="n">add_sockets</span><span class="p">(</span><span class="n">sockets</span><span class="p">)</span>
<span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="index.html#tornado.tcpserver.TCPServer.add_sockets" title="tornado.tcpserver.TCPServer.add_sockets"><code class="xref py py-obj docutils literal"><span class="pre">add_sockets</span></code></a> interface is more complicated,
but it can be used with <a class="reference internal" href="index.html#tornado.process.fork_processes" title="tornado.process.fork_processes"><code class="xref py py-obj docutils literal"><span class="pre">tornado.process.fork_processes</span></code></a> to
give you more flexibility in when the fork happens.
<a class="reference internal" href="index.html#tornado.tcpserver.TCPServer.add_sockets" title="tornado.tcpserver.TCPServer.add_sockets"><code class="xref py py-obj docutils literal"><span class="pre">add_sockets</span></code></a> can also be used in single-process
servers if you want to create your listening sockets in some
way other than <a class="reference internal" href="index.html#tornado.netutil.bind_sockets" title="tornado.netutil.bind_sockets"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil.bind_sockets</span></code></a>.</p>
</li>
</ol>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>Added <code class="docutils literal"><span class="pre">decompress_request</span></code>, <code class="docutils literal"><span class="pre">chunk_size</span></code>, <code class="docutils literal"><span class="pre">max_header_size</span></code>,
<code class="docutils literal"><span class="pre">idle_connection_timeout</span></code>, <code class="docutils literal"><span class="pre">body_timeout</span></code>, <code class="docutils literal"><span class="pre">max_body_size</span></code>
arguments.  Added support for <a class="reference internal" href="index.html#tornado.httputil.HTTPServerConnectionDelegate" title="tornado.httputil.HTTPServerConnectionDelegate"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerConnectionDelegate</span></code></a>
instances as <code class="docutils literal"><span class="pre">request_callback</span></code>.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span><a class="reference internal" href="index.html#tornado.httputil.HTTPServerConnectionDelegate.start_request" title="tornado.httputil.HTTPServerConnectionDelegate.start_request"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerConnectionDelegate.start_request</span></code></a> is now called with
two arguments <code class="docutils literal"><span class="pre">(server_conn,</span> <span class="pre">request_conn)</span></code> (in accordance with the
documentation) instead of one <code class="docutils literal"><span class="pre">(request_conn)</span></code>.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.2: </span><a class="reference internal" href="#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> is now a subclass of <a class="reference internal" href="index.html#tornado.util.Configurable" title="tornado.util.Configurable"><code class="xref py py-obj docutils literal"><span class="pre">tornado.util.Configurable</span></code></a>.</p>
</div>
</dd></dl>

</div>
</div>
<span id="document-httpclient"></span><div class="section" id="module-tornado.httpclient">
<span id="tornado-httpclient-asynchronous-http-client"></span><h4><code class="docutils literal"><span class="pre">tornado.httpclient</span></code> &#8212; Asynchronous HTTP client<a class="headerlink" href="#module-tornado.httpclient" title="Permalink to this headline">¶</a></h4>
<p>Blocking and non-blocking HTTP client interfaces.</p>
<p>This module defines a common interface shared by two implementations,
<code class="docutils literal"><span class="pre">simple_httpclient</span></code> and <code class="docutils literal"><span class="pre">curl_httpclient</span></code>.  Applications may either
instantiate their chosen implementation class directly or use the
<a class="reference internal" href="#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> class from this module, which selects an implementation
that can be overridden with the <a class="reference internal" href="#tornado.httpclient.AsyncHTTPClient.configure" title="tornado.httpclient.AsyncHTTPClient.configure"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient.configure</span></code></a> method.</p>
<p>The default implementation is <code class="docutils literal"><span class="pre">simple_httpclient</span></code>, and this is expected
to be suitable for most users&#8217; needs.  However, some applications may wish
to switch to <code class="docutils literal"><span class="pre">curl_httpclient</span></code> for reasons such as the following:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">curl_httpclient</span></code> has some features not found in <code class="docutils literal"><span class="pre">simple_httpclient</span></code>,
including support for HTTP proxies and the ability to use a specified
network interface.</li>
<li><code class="docutils literal"><span class="pre">curl_httpclient</span></code> is more likely to be compatible with sites that are
not-quite-compliant with the HTTP spec, or sites that use little-exercised
features of HTTP.</li>
<li><code class="docutils literal"><span class="pre">curl_httpclient</span></code> is faster.</li>
<li><code class="docutils literal"><span class="pre">curl_httpclient</span></code> was the default prior to Tornado 2.0.</li>
</ul>
<p>Note that if you are using <code class="docutils literal"><span class="pre">curl_httpclient</span></code>, it is highly
recommended that you use a recent version of <code class="docutils literal"><span class="pre">libcurl</span></code> and
<code class="docutils literal"><span class="pre">pycurl</span></code>.  Currently the minimum supported version of libcurl is
7.21.1, and the minimum version of pycurl is 7.18.2.  It is highly
recommended that your <code class="docutils literal"><span class="pre">libcurl</span></code> installation is built with
asynchronous DNS resolver (threaded or c-ares), otherwise you may
encounter various problems with request timeouts (for more
information, see
<a class="reference external" href="http://curl.haxx.se/libcurl/c/curl_easy_setopt.html#CURLOPTCONNECTTIMEOUTMS">http://curl.haxx.se/libcurl/c/curl_easy_setopt.html#CURLOPTCONNECTTIMEOUTMS</a>
and comments in curl_httpclient.py).</p>
<p>To select <code class="docutils literal"><span class="pre">curl_httpclient</span></code>, call <a class="reference internal" href="#tornado.httpclient.AsyncHTTPClient.configure" title="tornado.httpclient.AsyncHTTPClient.configure"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient.configure</span></code></a> at startup:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">AsyncHTTPClient</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s">&quot;tornado.curl_httpclient.CurlAsyncHTTPClient&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="http-client-interfaces">
<h5>HTTP client interfaces<a class="headerlink" href="#http-client-interfaces" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.httpclient.HTTPClient">
<em class="property">class </em><code class="descclassname">tornado.httpclient.</code><code class="descname">HTTPClient</code><span class="sig-paren">(</span><em>async_client_class=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httpclient.html#HTTPClient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httpclient.HTTPClient" title="Permalink to this definition">¶</a></dt>
<dd><p>A blocking HTTP client.</p>
<p>This interface is provided for convenience and testing; most applications
that are running an IOLoop will want to use <a class="reference internal" href="#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> instead.
Typical usage looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre>http_client = httpclient.HTTPClient()
try:
    response = http_client.fetch(&quot;http://www.google.com/&quot;)
    print response.body
except httpclient.HTTPError as e:
    # HTTPError is raised for non-200 responses; the response
    # can be found in e.response.
    print(&quot;Error: &quot; + str(e))
except Exception as e:
    # Other errors are possible, such as IOError.
    print(&quot;Error: &quot; + str(e))
http_client.close()
</pre></div>
</div>
<dl class="method">
<dt id="tornado.httpclient.HTTPClient.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httpclient.html#HTTPClient.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httpclient.HTTPClient.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes the HTTPClient, freeing any resources used.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.httpclient.HTTPClient.fetch">
<code class="descname">fetch</code><span class="sig-paren">(</span><em>request</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httpclient.html#HTTPClient.fetch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httpclient.HTTPClient.fetch" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes a request, returning an <a class="reference internal" href="#tornado.httpclient.HTTPResponse" title="tornado.httpclient.HTTPResponse"><code class="xref py py-obj docutils literal"><span class="pre">HTTPResponse</span></code></a>.</p>
<p>The request may be either a string URL or an <a class="reference internal" href="#tornado.httpclient.HTTPRequest" title="tornado.httpclient.HTTPRequest"><code class="xref py py-obj docutils literal"><span class="pre">HTTPRequest</span></code></a> object.
If it is a string, we construct an <a class="reference internal" href="#tornado.httpclient.HTTPRequest" title="tornado.httpclient.HTTPRequest"><code class="xref py py-obj docutils literal"><span class="pre">HTTPRequest</span></code></a> using any additional
kwargs: <code class="docutils literal"><span class="pre">HTTPRequest(request,</span> <span class="pre">**kwargs)</span></code></p>
<p>If an error occurs during the fetch, we raise an <a class="reference internal" href="#tornado.httpclient.HTTPError" title="tornado.httpclient.HTTPError"><code class="xref py py-obj docutils literal"><span class="pre">HTTPError</span></code></a> unless
the <code class="docutils literal"><span class="pre">raise_error</span></code> keyword argument is set to False.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.httpclient.AsyncHTTPClient">
<em class="property">class </em><code class="descclassname">tornado.httpclient.</code><code class="descname">AsyncHTTPClient</code><a class="reference internal" href="_modules/tornado/httpclient.html#AsyncHTTPClient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httpclient.AsyncHTTPClient" title="Permalink to this definition">¶</a></dt>
<dd><p>An non-blocking HTTP client.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre>def handle_request(response):
    if response.error:
        print &quot;Error:&quot;, response.error
    else:
        print response.body

http_client = AsyncHTTPClient()
http_client.fetch(&quot;http://www.google.com/&quot;, handle_request)
</pre></div>
</div>
<p>The constructor for this class is magic in several respects: It
actually creates an instance of an implementation-specific
subclass, and instances are reused as a kind of pseudo-singleton
(one per <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>).  The keyword argument <code class="docutils literal"><span class="pre">force_instance=True</span></code>
can be used to suppress this singleton behavior.  Unless
<code class="docutils literal"><span class="pre">force_instance=True</span></code> is used, no arguments other than
<code class="docutils literal"><span class="pre">io_loop</span></code> should be passed to the <a class="reference internal" href="#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> constructor.
The implementation subclass as well as arguments to its
constructor can be set with the static method <a class="reference internal" href="#tornado.httpclient.AsyncHTTPClient.configure" title="tornado.httpclient.AsyncHTTPClient.configure"><code class="xref py py-obj docutils literal"><span class="pre">configure()</span></code></a></p>
<p>All <a class="reference internal" href="#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> implementations support a <code class="docutils literal"><span class="pre">defaults</span></code>
keyword argument, which can be used to set default values for
<a class="reference internal" href="#tornado.httpclient.HTTPRequest" title="tornado.httpclient.HTTPRequest"><code class="xref py py-obj docutils literal"><span class="pre">HTTPRequest</span></code></a> attributes.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">AsyncHTTPClient</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span>
    <span class="bp">None</span><span class="p">,</span> <span class="n">defaults</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">user_agent</span><span class="o">=</span><span class="s">&quot;MyUserAgent&quot;</span><span class="p">))</span>
<span class="c"># or with force_instance:</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">AsyncHTTPClient</span><span class="p">(</span><span class="n">force_instance</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">defaults</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">user_agent</span><span class="o">=</span><span class="s">&quot;MyUserAgent&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>The <code class="docutils literal"><span class="pre">io_loop</span></code> argument is deprecated.</p>
</div>
<dl class="method">
<dt id="tornado.httpclient.AsyncHTTPClient.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httpclient.html#AsyncHTTPClient.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httpclient.AsyncHTTPClient.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroys this HTTP client, freeing any file descriptors used.</p>
<p>This method is <strong>not needed in normal use</strong> due to the way
that <a class="reference internal" href="#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> objects are transparently reused.
<code class="docutils literal"><span class="pre">close()</span></code> is generally only necessary when either the
<a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> is also being closed, or the <code class="docutils literal"><span class="pre">force_instance=True</span></code>
argument was used when creating the <a class="reference internal" href="#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a>.</p>
<p>No other methods may be called on the <a class="reference internal" href="#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> after
<code class="docutils literal"><span class="pre">close()</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.httpclient.AsyncHTTPClient.fetch">
<code class="descname">fetch</code><span class="sig-paren">(</span><em>request</em>, <em>callback=None</em>, <em>raise_error=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httpclient.html#AsyncHTTPClient.fetch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httpclient.AsyncHTTPClient.fetch" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes a request, asynchronously returning an <a class="reference internal" href="#tornado.httpclient.HTTPResponse" title="tornado.httpclient.HTTPResponse"><code class="xref py py-obj docutils literal"><span class="pre">HTTPResponse</span></code></a>.</p>
<p>The request may be either a string URL or an <a class="reference internal" href="#tornado.httpclient.HTTPRequest" title="tornado.httpclient.HTTPRequest"><code class="xref py py-obj docutils literal"><span class="pre">HTTPRequest</span></code></a> object.
If it is a string, we construct an <a class="reference internal" href="#tornado.httpclient.HTTPRequest" title="tornado.httpclient.HTTPRequest"><code class="xref py py-obj docutils literal"><span class="pre">HTTPRequest</span></code></a> using any additional
kwargs: <code class="docutils literal"><span class="pre">HTTPRequest(request,</span> <span class="pre">**kwargs)</span></code></p>
<p>This method returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> whose result is an
<a class="reference internal" href="#tornado.httpclient.HTTPResponse" title="tornado.httpclient.HTTPResponse"><code class="xref py py-obj docutils literal"><span class="pre">HTTPResponse</span></code></a>.  By default, the <code class="docutils literal"><span class="pre">Future</span></code> will raise an <a class="reference internal" href="#tornado.httpclient.HTTPError" title="tornado.httpclient.HTTPError"><code class="xref py py-obj docutils literal"><span class="pre">HTTPError</span></code></a>
if the request returned a non-200 response code. Instead, if
<code class="docutils literal"><span class="pre">raise_error</span></code> is set to False, the response will always be
returned regardless of the response code.</p>
<p>If a <code class="docutils literal"><span class="pre">callback</span></code> is given, it will be invoked with the <a class="reference internal" href="#tornado.httpclient.HTTPResponse" title="tornado.httpclient.HTTPResponse"><code class="xref py py-obj docutils literal"><span class="pre">HTTPResponse</span></code></a>.
In the callback interface, <a class="reference internal" href="#tornado.httpclient.HTTPError" title="tornado.httpclient.HTTPError"><code class="xref py py-obj docutils literal"><span class="pre">HTTPError</span></code></a> is not automatically raised.
Instead, you must check the response&#8217;s <code class="docutils literal"><span class="pre">error</span></code> attribute or
call its <a class="reference internal" href="#tornado.httpclient.HTTPResponse.rethrow" title="tornado.httpclient.HTTPResponse.rethrow"><code class="xref py py-obj docutils literal"><span class="pre">rethrow</span></code></a> method.</p>
</dd></dl>

<dl class="classmethod">
<dt id="tornado.httpclient.AsyncHTTPClient.configure">
<em class="property">classmethod </em><code class="descname">configure</code><span class="sig-paren">(</span><em>impl</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httpclient.html#AsyncHTTPClient.configure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httpclient.AsyncHTTPClient.configure" title="Permalink to this definition">¶</a></dt>
<dd><p>Configures the <a class="reference internal" href="#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> subclass to use.</p>
<p><code class="docutils literal"><span class="pre">AsyncHTTPClient()</span></code> actually creates an instance of a subclass.
This method may be called with either a class object or the
fully-qualified name of such a class (or <code class="docutils literal"><span class="pre">None</span></code> to use the default,
<code class="docutils literal"><span class="pre">SimpleAsyncHTTPClient</span></code>)</p>
<p>If additional keyword arguments are given, they will be passed
to the constructor of each subclass instance created.  The
keyword argument <code class="docutils literal"><span class="pre">max_clients</span></code> determines the maximum number
of simultaneous <a class="reference internal" href="#tornado.httpclient.AsyncHTTPClient.fetch" title="tornado.httpclient.AsyncHTTPClient.fetch"><code class="xref py py-obj docutils literal"><span class="pre">fetch()</span></code></a> operations that can
execute in parallel on each <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>.  Additional arguments
may be supported depending on the implementation class in use.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">AsyncHTTPClient</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s">&quot;tornado.curl_httpclient.CurlAsyncHTTPClient&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="request-objects">
<h5>Request objects<a class="headerlink" href="#request-objects" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.httpclient.HTTPRequest">
<em class="property">class </em><code class="descclassname">tornado.httpclient.</code><code class="descname">HTTPRequest</code><span class="sig-paren">(</span><em>url</em>, <em>method='GET'</em>, <em>headers=None</em>, <em>body=None</em>, <em>auth_username=None</em>, <em>auth_password=None</em>, <em>auth_mode=None</em>, <em>connect_timeout=None</em>, <em>request_timeout=None</em>, <em>if_modified_since=None</em>, <em>follow_redirects=None</em>, <em>max_redirects=None</em>, <em>user_agent=None</em>, <em>use_gzip=None</em>, <em>network_interface=None</em>, <em>streaming_callback=None</em>, <em>header_callback=None</em>, <em>prepare_curl_callback=None</em>, <em>proxy_host=None</em>, <em>proxy_port=None</em>, <em>proxy_username=None</em>, <em>proxy_password=None</em>, <em>allow_nonstandard_methods=None</em>, <em>validate_cert=None</em>, <em>ca_certs=None</em>, <em>allow_ipv6=None</em>, <em>client_key=None</em>, <em>client_cert=None</em>, <em>body_producer=None</em>, <em>expect_100_continue=False</em>, <em>decompress_response=None</em>, <em>ssl_options=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httpclient.html#HTTPRequest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httpclient.HTTPRequest" title="Permalink to this definition">¶</a></dt>
<dd><p>HTTP client request object.</p>
<p>All parameters except <code class="docutils literal"><span class="pre">url</span></code> are optional.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>url</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; URL to fetch</li>
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; HTTP method, e.g. &#8220;GET&#8221; or &#8220;POST&#8221;</li>
<li><strong>headers</strong> (<a class="reference internal" href="index.html#tornado.httputil.HTTPHeaders" title="tornado.httputil.HTTPHeaders"><code class="xref py py-obj docutils literal"><span class="pre">HTTPHeaders</span></code></a> or <a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#dict" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">dict</span></code></a>) &#8211; Additional HTTP headers to pass on the request</li>
<li><strong>body</strong> &#8211; HTTP request body as a string (byte or unicode; if unicode
the utf-8 encoding will be used)</li>
<li><strong>body_producer</strong> &#8211; Callable used for lazy/asynchronous request bodies.
It is called with one argument, a <code class="docutils literal"><span class="pre">write</span></code> function, and should
return a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.  It should call the write function with new
data as it becomes available.  The write function returns a
<a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> which can be used for flow control.
Only one of <code class="docutils literal"><span class="pre">body</span></code> and <code class="docutils literal"><span class="pre">body_producer</span></code> may
be specified.  <code class="docutils literal"><span class="pre">body_producer</span></code> is not supported on
<code class="docutils literal"><span class="pre">curl_httpclient</span></code>.  When using <code class="docutils literal"><span class="pre">body_producer</span></code> it is recommended
to pass a <code class="docutils literal"><span class="pre">Content-Length</span></code> in the headers as otherwise chunked
encoding will be used, and many servers do not support chunked
encoding on requests.  New in Tornado 4.0</li>
<li><strong>auth_username</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; Username for HTTP authentication</li>
<li><strong>auth_password</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; Password for HTTP authentication</li>
<li><strong>auth_mode</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; Authentication mode; default is &#8220;basic&#8221;.
Allowed values are implementation-defined; <code class="docutils literal"><span class="pre">curl_httpclient</span></code>
supports &#8220;basic&#8221; and &#8220;digest&#8221;; <code class="docutils literal"><span class="pre">simple_httpclient</span></code> only supports
&#8220;basic&#8221;</li>
<li><strong>connect_timeout</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#float" title="(in Python v3.4)"><em>float</em></a>) &#8211; Timeout for initial connection in seconds</li>
<li><strong>request_timeout</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#float" title="(in Python v3.4)"><em>float</em></a>) &#8211; Timeout for entire request in seconds</li>
<li><strong>if_modified_since</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/datetime.html#module-datetime" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">datetime</span></code></a> or <a class="reference external" href="https://docs.python.org/3.4/library/functions.html#float" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">float</span></code></a>) &#8211; Timestamp for <code class="docutils literal"><span class="pre">If-Modified-Since</span></code> header</li>
<li><strong>follow_redirects</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#bool" title="(in Python v3.4)"><em>bool</em></a>) &#8211; Should redirects be followed automatically
or return the 3xx response?</li>
<li><strong>max_redirects</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#int" title="(in Python v3.4)"><em>int</em></a>) &#8211; Limit for <code class="docutils literal"><span class="pre">follow_redirects</span></code></li>
<li><strong>user_agent</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; String to send as <code class="docutils literal"><span class="pre">User-Agent</span></code> header</li>
<li><strong>decompress_response</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#bool" title="(in Python v3.4)"><em>bool</em></a>) &#8211; Request a compressed response from
the server and decompress it after downloading.  Default is True.
New in Tornado 4.0.</li>
<li><strong>use_gzip</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#bool" title="(in Python v3.4)"><em>bool</em></a>) &#8211; Deprecated alias for <code class="docutils literal"><span class="pre">decompress_response</span></code>
since Tornado 4.0.</li>
<li><strong>network_interface</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; Network interface to use for request.
<code class="docutils literal"><span class="pre">curl_httpclient</span></code> only; see note below.</li>
<li><strong>streaming_callback</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#callable" title="(in Python v3.4)"><em>callable</em></a>) &#8211; If set, <code class="docutils literal"><span class="pre">streaming_callback</span></code> will
be run with each chunk of data as it is received, and
<code class="docutils literal"><span class="pre">HTTPResponse.body</span></code> and <code class="docutils literal"><span class="pre">HTTPResponse.buffer</span></code> will be empty in
the final response.</li>
<li><strong>header_callback</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#callable" title="(in Python v3.4)"><em>callable</em></a>) &#8211; If set, <code class="docutils literal"><span class="pre">header_callback</span></code> will
be run with each header line as it is received (including the
first line, e.g. <code class="docutils literal"><span class="pre">HTTP/1.0</span> <span class="pre">200</span> <span class="pre">OK\r\n</span></code>, and a final line
containing only <code class="docutils literal"><span class="pre">\r\n</span></code>.  All lines include the trailing newline
characters).  <code class="docutils literal"><span class="pre">HTTPResponse.headers</span></code> will be empty in the final
response.  This is most useful in conjunction with
<code class="docutils literal"><span class="pre">streaming_callback</span></code>, because it&#8217;s the only way to get access to
header data while the request is in progress.</li>
<li><strong>prepare_curl_callback</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#callable" title="(in Python v3.4)"><em>callable</em></a>) &#8211; If set, will be called with
a <code class="docutils literal"><span class="pre">pycurl.Curl</span></code> object to allow the application to make additional
<code class="docutils literal"><span class="pre">setopt</span></code> calls.</li>
<li><strong>proxy_host</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; HTTP proxy hostname.  To use proxies,
<code class="docutils literal"><span class="pre">proxy_host</span></code> and <code class="docutils literal"><span class="pre">proxy_port</span></code> must be set; <code class="docutils literal"><span class="pre">proxy_username</span></code> and
<code class="docutils literal"><span class="pre">proxy_pass</span></code> are optional.  Proxies are currently only supported
with <code class="docutils literal"><span class="pre">curl_httpclient</span></code>.</li>
<li><strong>proxy_port</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#int" title="(in Python v3.4)"><em>int</em></a>) &#8211; HTTP proxy port</li>
<li><strong>proxy_username</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; HTTP proxy username</li>
<li><strong>proxy_password</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; HTTP proxy password</li>
<li><strong>allow_nonstandard_methods</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#bool" title="(in Python v3.4)"><em>bool</em></a>) &#8211; Allow unknown values for <code class="docutils literal"><span class="pre">method</span></code>
argument?</li>
<li><strong>validate_cert</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#bool" title="(in Python v3.4)"><em>bool</em></a>) &#8211; For HTTPS requests, validate the server&#8217;s
certificate?</li>
<li><strong>ca_certs</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; filename of CA certificates in PEM format,
or None to use defaults.  See note below when used with
<code class="docutils literal"><span class="pre">curl_httpclient</span></code>.</li>
<li><strong>client_key</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; Filename for client SSL key, if any.  See
note below when used with <code class="docutils literal"><span class="pre">curl_httpclient</span></code>.</li>
<li><strong>client_cert</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; Filename for client SSL certificate, if any.
See note below when used with <code class="docutils literal"><span class="pre">curl_httpclient</span></code>.</li>
<li><strong>ssl_options</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><em>ssl.SSLContext</em></a>) &#8211; <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.SSLContext</span></code></a> object for use in
<code class="docutils literal"><span class="pre">simple_httpclient</span></code> (unsupported by <code class="docutils literal"><span class="pre">curl_httpclient</span></code>).
Overrides <code class="docutils literal"><span class="pre">validate_cert</span></code>, <code class="docutils literal"><span class="pre">ca_certs</span></code>, <code class="docutils literal"><span class="pre">client_key</span></code>,
and <code class="docutils literal"><span class="pre">client_cert</span></code>.</li>
<li><strong>allow_ipv6</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#bool" title="(in Python v3.4)"><em>bool</em></a>) &#8211; Use IPv6 when available?  Default is true.</li>
<li><strong>expect_100_continue</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#bool" title="(in Python v3.4)"><em>bool</em></a>) &#8211; If true, send the
<code class="docutils literal"><span class="pre">Expect:</span> <span class="pre">100-continue</span></code> header and wait for a continue response
before sending the request body.  Only supported with
simple_httpclient.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When using <code class="docutils literal"><span class="pre">curl_httpclient</span></code> certain options may be
inherited by subsequent fetches because <code class="docutils literal"><span class="pre">pycurl</span></code> does
not allow them to be cleanly reset.  This applies to the
<code class="docutils literal"><span class="pre">ca_certs</span></code>, <code class="docutils literal"><span class="pre">client_key</span></code>, <code class="docutils literal"><span class="pre">client_cert</span></code>, and
<code class="docutils literal"><span class="pre">network_interface</span></code> arguments.  If you use these
options, you should pass them on every request (you don&#8217;t
have to always use the same values, but it&#8217;s not possible
to mix requests that specify these options with ones that
use the defaults).</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1: </span>The <code class="docutils literal"><span class="pre">auth_mode</span></code> argument.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0: </span>The <code class="docutils literal"><span class="pre">body_producer</span></code> and <code class="docutils literal"><span class="pre">expect_100_continue</span></code> arguments.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.2: </span>The <code class="docutils literal"><span class="pre">ssl_options</span></code> argument.</p>
</div>
</dd></dl>

</div>
<div class="section" id="response-objects">
<h5>Response objects<a class="headerlink" href="#response-objects" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.httpclient.HTTPResponse">
<em class="property">class </em><code class="descclassname">tornado.httpclient.</code><code class="descname">HTTPResponse</code><span class="sig-paren">(</span><em>request</em>, <em>code</em>, <em>headers=None</em>, <em>buffer=None</em>, <em>effective_url=None</em>, <em>error=None</em>, <em>request_time=None</em>, <em>time_info=None</em>, <em>reason=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httpclient.html#HTTPResponse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httpclient.HTTPResponse" title="Permalink to this definition">¶</a></dt>
<dd><p>HTTP Response object.</p>
<p>Attributes:</p>
<ul class="simple">
<li>request: HTTPRequest object</li>
<li>code: numeric HTTP status code, e.g. 200 or 404</li>
<li>reason: human-readable reason phrase describing the status code</li>
<li>headers: <a class="reference internal" href="index.html#tornado.httputil.HTTPHeaders" title="tornado.httputil.HTTPHeaders"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httputil.HTTPHeaders</span></code></a> object</li>
<li>effective_url: final location of the resource after following any
redirects</li>
<li>buffer: <code class="docutils literal"><span class="pre">cStringIO</span></code> object for response body</li>
<li>body: response body as string (created on demand from <code class="docutils literal"><span class="pre">self.buffer</span></code>)</li>
<li>error: Exception object, if any</li>
<li>request_time: seconds from request start to finish</li>
<li>time_info: dictionary of diagnostic timing information from the request.
Available data are subject to change, but currently uses timings
available from <a class="reference external" href="http://curl.haxx.se/libcurl/c/curl_easy_getinfo.html">http://curl.haxx.se/libcurl/c/curl_easy_getinfo.html</a>,
plus <code class="docutils literal"><span class="pre">queue</span></code>, which is the delay (if any) introduced by waiting for
a slot under <a class="reference internal" href="#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a>&#8216;s <code class="docutils literal"><span class="pre">max_clients</span></code> setting.</li>
</ul>
<dl class="method">
<dt id="tornado.httpclient.HTTPResponse.rethrow">
<code class="descname">rethrow</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httpclient.html#HTTPResponse.rethrow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httpclient.HTTPResponse.rethrow" title="Permalink to this definition">¶</a></dt>
<dd><p>If there was an error on the request, raise an <a class="reference internal" href="#tornado.httpclient.HTTPError" title="tornado.httpclient.HTTPError"><code class="xref py py-obj docutils literal"><span class="pre">HTTPError</span></code></a>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="exceptions">
<h5>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h5>
<dl class="exception">
<dt id="tornado.httpclient.HTTPError">
<em class="property">exception </em><code class="descclassname">tornado.httpclient.</code><code class="descname">HTTPError</code><span class="sig-paren">(</span><em>code</em>, <em>message=None</em>, <em>response=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httpclient.html#HTTPError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httpclient.HTTPError" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception thrown for an unsuccessful HTTP request.</p>
<p>Attributes:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">code</span></code> - HTTP error integer error code, e.g. 404.  Error code 599 is
used when no HTTP response was received, e.g. for a timeout.</li>
<li><code class="docutils literal"><span class="pre">response</span></code> - <a class="reference internal" href="#tornado.httpclient.HTTPResponse" title="tornado.httpclient.HTTPResponse"><code class="xref py py-obj docutils literal"><span class="pre">HTTPResponse</span></code></a> object, if any.</li>
</ul>
<p>Note that if <code class="docutils literal"><span class="pre">follow_redirects</span></code> is False, redirects become HTTPErrors,
and you can look at <code class="docutils literal"><span class="pre">error.response.headers['Location']</span></code> to see the
destination of the redirect.</p>
</dd></dl>

</div>
<div class="section" id="command-line-interface">
<h5>Command-line interface<a class="headerlink" href="#command-line-interface" title="Permalink to this headline">¶</a></h5>
<p>This module provides a simple command-line interface to fetch a url
using Tornado&#8217;s HTTP client.  Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre># Fetch the url and print its body
python -m tornado.httpclient http://www.google.com

# Just print the headers
python -m tornado.httpclient --print_headers --print_body=false http://www.google.com
</pre></div>
</div>
</div>
<div class="section" id="module-tornado.simple_httpclient">
<span id="implementations"></span><h5>Implementations<a class="headerlink" href="#module-tornado.simple_httpclient" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.simple_httpclient.SimpleAsyncHTTPClient">
<em class="property">class </em><code class="descclassname">tornado.simple_httpclient.</code><code class="descname">SimpleAsyncHTTPClient</code><a class="reference internal" href="_modules/tornado/simple_httpclient.html#SimpleAsyncHTTPClient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.simple_httpclient.SimpleAsyncHTTPClient" title="Permalink to this definition">¶</a></dt>
<dd><p>Non-blocking HTTP client with no external dependencies.</p>
<p>This class implements an HTTP 1.1 client on top of Tornado&#8217;s IOStreams.
Some features found in the curl-based AsyncHTTPClient are not yet
supported.  In particular, proxies are not supported, connections
are not reused, and callers cannot select the network interface to be
used.</p>
<dl class="method">
<dt id="tornado.simple_httpclient.SimpleAsyncHTTPClient.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>io_loop</em>, <em>max_clients=10</em>, <em>hostname_mapping=None</em>, <em>max_buffer_size=104857600</em>, <em>resolver=None</em>, <em>defaults=None</em>, <em>max_header_size=None</em>, <em>max_body_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/simple_httpclient.html#SimpleAsyncHTTPClient.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.simple_httpclient.SimpleAsyncHTTPClient.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a AsyncHTTPClient.</p>
<p>Only a single AsyncHTTPClient instance exists per IOLoop
in order to provide limitations on the number of pending connections.
<code class="docutils literal"><span class="pre">force_instance=True</span></code> may be used to suppress this behavior.</p>
<p>Note that because of this implicit reuse, unless <code class="docutils literal"><span class="pre">force_instance</span></code>
is used, only the first call to the constructor actually uses
its arguments. It is recommended to use the <code class="docutils literal"><span class="pre">configure</span></code> method
instead of the constructor to ensure that arguments take effect.</p>
<p><code class="docutils literal"><span class="pre">max_clients</span></code> is the number of concurrent requests that can be
in progress; when this limit is reached additional requests will be
queued. Note that time spent waiting in this queue still counts
against the <code class="docutils literal"><span class="pre">request_timeout</span></code>.</p>
<p><code class="docutils literal"><span class="pre">hostname_mapping</span></code> is a dictionary mapping hostnames to IP addresses.
It can be used to make local DNS changes when modifying system-wide
settings like <code class="docutils literal"><span class="pre">/etc/hosts</span></code> is not possible or desirable (e.g. in
unittests).</p>
<p><code class="docutils literal"><span class="pre">max_buffer_size</span></code> (default 100MB) is the number of bytes
that can be read into memory at once. <code class="docutils literal"><span class="pre">max_body_size</span></code>
(defaults to <code class="docutils literal"><span class="pre">max_buffer_size</span></code>) is the largest response body
that the client will accept.  Without a
<code class="docutils literal"><span class="pre">streaming_callback</span></code>, the smaller of these two limits
applies; with a <code class="docutils literal"><span class="pre">streaming_callback</span></code> only <code class="docutils literal"><span class="pre">max_body_size</span></code>
does.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.2: </span>Added the <code class="docutils literal"><span class="pre">max_body_size</span></code> argument.</p>
</div>
</dd></dl>

</dd></dl>

<span class="target" id="module-tornado.curl_httpclient"></span><dl class="class">
<dt id="tornado.curl_httpclient.CurlAsyncHTTPClient">
<em class="property">class </em><code class="descclassname">tornado.curl_httpclient.</code><code class="descname">CurlAsyncHTTPClient</code><span class="sig-paren">(</span><em>io_loop</em>, <em>max_clients=10</em>, <em>defaults=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tornado.curl_httpclient.CurlAsyncHTTPClient" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">libcurl</span></code>-based HTTP client.</p>
</dd></dl>

</div>
</div>
<span id="document-httputil"></span><div class="section" id="tornado-httputil-manipulate-http-headers-and-urls">
<h4><code class="docutils literal"><span class="pre">tornado.httputil</span></code> &#8212; Manipulate HTTP headers and URLs<a class="headerlink" href="#tornado-httputil-manipulate-http-headers-and-urls" title="Permalink to this headline">¶</a></h4>
<span class="target" id="module-tornado.httputil"></span><p>HTTP utility code shared by clients and servers.</p>
<p>This module also defines the <a class="reference internal" href="#tornado.httputil.HTTPServerRequest" title="tornado.httputil.HTTPServerRequest"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerRequest</span></code></a> class which is exposed
via <a class="reference internal" href="index.html#tornado.web.RequestHandler.request" title="tornado.web.RequestHandler.request"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.RequestHandler.request</span></code></a>.</p>
<dl class="class">
<dt id="tornado.httputil.HTTPHeaders">
<em class="property">class </em><code class="descclassname">tornado.httputil.</code><code class="descname">HTTPHeaders</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPHeaders"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPHeaders" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary that maintains <code class="docutils literal"><span class="pre">Http-Header-Case</span></code> for all keys.</p>
<p>Supports multiple values per key via a pair of new methods,
<a class="reference internal" href="#tornado.httputil.HTTPHeaders.add" title="tornado.httputil.HTTPHeaders.add"><code class="xref py py-obj docutils literal"><span class="pre">add()</span></code></a> and <a class="reference internal" href="#tornado.httputil.HTTPHeaders.get_list" title="tornado.httputil.HTTPHeaders.get_list"><code class="xref py py-obj docutils literal"><span class="pre">get_list()</span></code></a>.  The regular dictionary interface
returns a single value per key, with multiple values joined by a
comma.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">HTTPHeaders</span><span class="p">({</span><span class="s">&quot;content-type&quot;</span><span class="p">:</span> <span class="s">&quot;text/html&quot;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="go">[&#39;Content-Type&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="p">[</span><span class="s">&quot;Content-Type&quot;</span><span class="p">]</span>
<span class="go">&#39;text/html&#39;</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;Set-Cookie&quot;</span><span class="p">,</span> <span class="s">&quot;A=B&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;Set-Cookie&quot;</span><span class="p">,</span> <span class="s">&quot;C=D&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="p">[</span><span class="s">&quot;set-cookie&quot;</span><span class="p">]</span>
<span class="go">&#39;A=B,C=D&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">get_list</span><span class="p">(</span><span class="s">&quot;set-cookie&quot;</span><span class="p">)</span>
<span class="go">[&#39;A=B&#39;, &#39;C=D&#39;]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">get_all</span><span class="p">()):</span>
<span class="gp">... </span>   <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">Content-Type: text/html</span>
<span class="go">Set-Cookie: A=B</span>
<span class="go">Set-Cookie: C=D</span>
</pre></div>
</div>
<dl class="method">
<dt id="tornado.httputil.HTTPHeaders.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>name</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPHeaders.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPHeaders.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new value for the given key.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.httputil.HTTPHeaders.get_list">
<code class="descname">get_list</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPHeaders.get_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPHeaders.get_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all values for the given header as a list.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.httputil.HTTPHeaders.get_all">
<code class="descname">get_all</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPHeaders.get_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPHeaders.get_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterable of all (name, value) pairs.</p>
<p>If a header has multiple values, multiple pairs will be
returned with the same name.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.httputil.HTTPHeaders.parse_line">
<code class="descname">parse_line</code><span class="sig-paren">(</span><em>line</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPHeaders.parse_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPHeaders.parse_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the dictionary with a single header line.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">HTTPHeaders</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">parse_line</span><span class="p">(</span><span class="s">&quot;Content-Type: text/html&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;content-type&#39;</span><span class="p">)</span>
<span class="go">&#39;text/html&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="tornado.httputil.HTTPHeaders.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>headers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPHeaders.parse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPHeaders.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary from HTTP header text.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">HTTPHeaders</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s">&quot;Content-Type: text/html</span><span class="se">\r\n</span><span class="s">Content-Length: 42</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[(&#39;Content-Length&#39;, &#39;42&#39;), (&#39;Content-Type&#39;, &#39;text/html&#39;)]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.httputil.HTTPServerRequest">
<em class="property">class </em><code class="descclassname">tornado.httputil.</code><code class="descname">HTTPServerRequest</code><span class="sig-paren">(</span><em>method=None</em>, <em>uri=None</em>, <em>version='HTTP/1.0'</em>, <em>headers=None</em>, <em>body=None</em>, <em>host=None</em>, <em>files=None</em>, <em>connection=None</em>, <em>start_line=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPServerRequest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPServerRequest" title="Permalink to this definition">¶</a></dt>
<dd><p>A single HTTP request.</p>
<p>All attributes are type <a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#str" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a> unless otherwise noted.</p>
<dl class="attribute">
<dt id="tornado.httputil.HTTPServerRequest.method">
<code class="descname">method</code><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.method" title="Permalink to this definition">¶</a></dt>
<dd><p>HTTP request method, e.g. &#8220;GET&#8221; or &#8220;POST&#8221;</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.HTTPServerRequest.uri">
<code class="descname">uri</code><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.uri" title="Permalink to this definition">¶</a></dt>
<dd><p>The requested uri.</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.HTTPServerRequest.path">
<code class="descname">path</code><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.path" title="Permalink to this definition">¶</a></dt>
<dd><p>The path portion of <a class="reference internal" href="#tornado.httputil.HTTPServerRequest.uri" title="tornado.httputil.HTTPServerRequest.uri"><code class="xref py py-obj docutils literal"><span class="pre">uri</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.HTTPServerRequest.query">
<code class="descname">query</code><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.query" title="Permalink to this definition">¶</a></dt>
<dd><p>The query portion of <a class="reference internal" href="#tornado.httputil.HTTPServerRequest.uri" title="tornado.httputil.HTTPServerRequest.uri"><code class="xref py py-obj docutils literal"><span class="pre">uri</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.HTTPServerRequest.version">
<code class="descname">version</code><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.version" title="Permalink to this definition">¶</a></dt>
<dd><p>HTTP version specified in request, e.g. &#8220;HTTP/1.1&#8221;</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.HTTPServerRequest.headers">
<code class="descname">headers</code><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.headers" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#tornado.httputil.HTTPHeaders" title="tornado.httputil.HTTPHeaders"><code class="xref py py-obj docutils literal"><span class="pre">HTTPHeaders</span></code></a> dictionary-like object for request headers.  Acts like
a case-insensitive dictionary with additional methods for repeated
headers.</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.HTTPServerRequest.body">
<code class="descname">body</code><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.body" title="Permalink to this definition">¶</a></dt>
<dd><p>Request body, if present, as a byte string.</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.HTTPServerRequest.remote_ip">
<code class="descname">remote_ip</code><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.remote_ip" title="Permalink to this definition">¶</a></dt>
<dd><p>Client&#8217;s IP address as a string.  If <code class="docutils literal"><span class="pre">HTTPServer.xheaders</span></code> is set,
will pass along the real IP address provided by a load balancer
in the <code class="docutils literal"><span class="pre">X-Real-Ip</span></code> or <code class="docutils literal"><span class="pre">X-Forwarded-For</span></code> header.</p>
</dd></dl>

<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.1: </span>The list format of <code class="docutils literal"><span class="pre">X-Forwarded-For</span></code> is now supported.</p>
</div>
<dl class="attribute">
<dt id="tornado.httputil.HTTPServerRequest.protocol">
<code class="descname">protocol</code><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.protocol" title="Permalink to this definition">¶</a></dt>
<dd><p>The protocol used, either &#8220;http&#8221; or &#8220;https&#8221;.  If <code class="docutils literal"><span class="pre">HTTPServer.xheaders</span></code>
is set, will pass along the protocol used by a load balancer if
reported via an <code class="docutils literal"><span class="pre">X-Scheme</span></code> header.</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.HTTPServerRequest.host">
<code class="descname">host</code><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.host" title="Permalink to this definition">¶</a></dt>
<dd><p>The requested hostname, usually taken from the <code class="docutils literal"><span class="pre">Host</span></code> header.</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.HTTPServerRequest.arguments">
<code class="descname">arguments</code><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.arguments" title="Permalink to this definition">¶</a></dt>
<dd><p>GET/POST arguments are available in the arguments property, which
maps arguments names to lists of values (to support multiple values
for individual names). Names are of type <a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#str" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>, while arguments
are byte strings.  Note that this is different from
<a class="reference internal" href="index.html#tornado.web.RequestHandler.get_argument" title="tornado.web.RequestHandler.get_argument"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_argument</span></code></a>, which returns argument values as
unicode strings.</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.HTTPServerRequest.query_arguments">
<code class="descname">query_arguments</code><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.query_arguments" title="Permalink to this definition">¶</a></dt>
<dd><p>Same format as <code class="docutils literal"><span class="pre">arguments</span></code>, but contains only arguments extracted
from the query string.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.HTTPServerRequest.body_arguments">
<code class="descname">body_arguments</code><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.body_arguments" title="Permalink to this definition">¶</a></dt>
<dd><p>Same format as <code class="docutils literal"><span class="pre">arguments</span></code>, but contains only arguments extracted
from the request body.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2.</span></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.HTTPServerRequest.files">
<code class="descname">files</code><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.files" title="Permalink to this definition">¶</a></dt>
<dd><p>File uploads are available in the files property, which maps file
names to lists of <a class="reference internal" href="#tornado.httputil.HTTPFile" title="tornado.httputil.HTTPFile"><code class="xref py py-obj docutils literal"><span class="pre">HTTPFile</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.HTTPServerRequest.connection">
<code class="descname">connection</code><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.connection" title="Permalink to this definition">¶</a></dt>
<dd><p>An HTTP request is attached to a single HTTP connection, which can
be accessed through the &#8220;connection&#8221; attribute. Since connections
are typically kept open in HTTP/1.1, multiple requests can be handled
sequentially on a single connection.</p>
</dd></dl>

<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>Moved from <code class="docutils literal"><span class="pre">tornado.httpserver.HTTPRequest</span></code>.</p>
</div>
<dl class="method">
<dt id="tornado.httputil.HTTPServerRequest.supports_http_1_1">
<code class="descname">supports_http_1_1</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPServerRequest.supports_http_1_1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.supports_http_1_1" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if this request supports HTTP/1.1 semantics.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 4.0: </span>Applications are less likely to need this information with the
introduction of <a class="reference internal" href="#tornado.httputil.HTTPConnection" title="tornado.httputil.HTTPConnection"><code class="xref py py-obj docutils literal"><span class="pre">HTTPConnection</span></code></a>.  If you still need it, access
the <code class="docutils literal"><span class="pre">version</span></code> attribute directly.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.HTTPServerRequest.cookies">
<code class="descname">cookies</code><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.cookies" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of Cookie.Morsel objects.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.httputil.HTTPServerRequest.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>chunk</em>, <em>callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPServerRequest.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the given chunk to the response stream.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 4.0: </span>Use <code class="docutils literal"><span class="pre">request.connection</span></code> and the <a class="reference internal" href="#tornado.httputil.HTTPConnection" title="tornado.httputil.HTTPConnection"><code class="xref py py-obj docutils literal"><span class="pre">HTTPConnection</span></code></a> methods
to write the response.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.httputil.HTTPServerRequest.finish">
<code class="descname">finish</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPServerRequest.finish"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.finish" title="Permalink to this definition">¶</a></dt>
<dd><p>Finishes this HTTP request on the open connection.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 4.0: </span>Use <code class="docutils literal"><span class="pre">request.connection</span></code> and the <a class="reference internal" href="#tornado.httputil.HTTPConnection" title="tornado.httputil.HTTPConnection"><code class="xref py py-obj docutils literal"><span class="pre">HTTPConnection</span></code></a> methods
to write the response.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.httputil.HTTPServerRequest.full_url">
<code class="descname">full_url</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPServerRequest.full_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.full_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstructs the full URL for this request.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.httputil.HTTPServerRequest.request_time">
<code class="descname">request_time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPServerRequest.request_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.request_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the amount of time it took for this request to execute.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.httputil.HTTPServerRequest.get_ssl_certificate">
<code class="descname">get_ssl_certificate</code><span class="sig-paren">(</span><em>binary_form=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPServerRequest.get_ssl_certificate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPServerRequest.get_ssl_certificate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the client&#8217;s SSL certificate, if any.</p>
<p>To use client certificates, the HTTPServer&#8217;s
<a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext.verify_mode" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.SSLContext.verify_mode</span></code></a> field must be set, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ssl_ctx</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">(</span><span class="n">ssl</span><span class="o">.</span><span class="n">Purpose</span><span class="o">.</span><span class="n">CLIENT_AUTH</span><span class="p">)</span>
<span class="n">ssl_ctx</span><span class="o">.</span><span class="n">load_cert_chain</span><span class="p">(</span><span class="s">&quot;foo.crt&quot;</span><span class="p">,</span> <span class="s">&quot;foo.key&quot;</span><span class="p">)</span>
<span class="n">ssl_ctx</span><span class="o">.</span><span class="n">load_verify_locations</span><span class="p">(</span><span class="s">&quot;cacerts.pem&quot;</span><span class="p">)</span>
<span class="n">ssl_ctx</span><span class="o">.</span><span class="n">verify_mode</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">CERT_REQUIRED</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">HTTPServer</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">ssl_options</span><span class="o">=</span><span class="n">ssl_ctx</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, the return value is a dictionary (or None, if no
client certificate is present).  If <code class="docutils literal"><span class="pre">binary_form</span></code> is true, a
DER-encoded form of the certificate is returned instead.  See
SSLSocket.getpeercert() in the standard library for more
details.
<a class="reference external" href="http://docs.python.org/library/ssl.html#sslsocket-objects">http://docs.python.org/library/ssl.html#sslsocket-objects</a></p>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="tornado.httputil.HTTPInputError">
<em class="property">exception </em><code class="descclassname">tornado.httputil.</code><code class="descname">HTTPInputError</code><a class="reference internal" href="_modules/tornado/httputil.html#HTTPInputError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPInputError" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception class for malformed HTTP requests or responses
from remote sources.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
</dd></dl>

<dl class="exception">
<dt id="tornado.httputil.HTTPOutputError">
<em class="property">exception </em><code class="descclassname">tornado.httputil.</code><code class="descname">HTTPOutputError</code><a class="reference internal" href="_modules/tornado/httputil.html#HTTPOutputError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPOutputError" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception class for errors in HTTP output.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.httputil.HTTPServerConnectionDelegate">
<em class="property">class </em><code class="descclassname">tornado.httputil.</code><code class="descname">HTTPServerConnectionDelegate</code><a class="reference internal" href="_modules/tornado/httputil.html#HTTPServerConnectionDelegate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPServerConnectionDelegate" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement this interface to handle requests from <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
<dl class="method">
<dt id="tornado.httputil.HTTPServerConnectionDelegate.start_request">
<code class="descname">start_request</code><span class="sig-paren">(</span><em>server_conn</em>, <em>request_conn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPServerConnectionDelegate.start_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPServerConnectionDelegate.start_request" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called by the server when a new request has started.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>server_conn</strong> &#8211; is an opaque object representing the long-lived
(e.g. tcp-level) connection.</li>
<li><strong>request_conn</strong> &#8211; is a <a class="reference internal" href="#tornado.httputil.HTTPConnection" title="tornado.httputil.HTTPConnection"><code class="xref py py-obj docutils literal"><span class="pre">HTTPConnection</span></code></a> object for a single
request/response exchange.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>This method should return a <a class="reference internal" href="#tornado.httputil.HTTPMessageDelegate" title="tornado.httputil.HTTPMessageDelegate"><code class="xref py py-obj docutils literal"><span class="pre">HTTPMessageDelegate</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.httputil.HTTPServerConnectionDelegate.on_close">
<code class="descname">on_close</code><span class="sig-paren">(</span><em>server_conn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPServerConnectionDelegate.on_close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPServerConnectionDelegate.on_close" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called when a connection has been closed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>server_conn</strong> &#8211; is a server connection that has previously been
passed to <code class="docutils literal"><span class="pre">start_request</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.httputil.HTTPMessageDelegate">
<em class="property">class </em><code class="descclassname">tornado.httputil.</code><code class="descname">HTTPMessageDelegate</code><a class="reference internal" href="_modules/tornado/httputil.html#HTTPMessageDelegate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPMessageDelegate" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement this interface to handle an HTTP request or response.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
<dl class="method">
<dt id="tornado.httputil.HTTPMessageDelegate.headers_received">
<code class="descname">headers_received</code><span class="sig-paren">(</span><em>start_line</em>, <em>headers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPMessageDelegate.headers_received"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPMessageDelegate.headers_received" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when the HTTP headers have been received and parsed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>start_line</strong> &#8211; a <a class="reference internal" href="#tornado.httputil.RequestStartLine" title="tornado.httputil.RequestStartLine"><code class="xref py py-obj docutils literal"><span class="pre">RequestStartLine</span></code></a> or <a class="reference internal" href="#tornado.httputil.ResponseStartLine" title="tornado.httputil.ResponseStartLine"><code class="xref py py-obj docutils literal"><span class="pre">ResponseStartLine</span></code></a>
depending on whether this is a client or server message.</li>
<li><strong>headers</strong> &#8211; a <a class="reference internal" href="#tornado.httputil.HTTPHeaders" title="tornado.httputil.HTTPHeaders"><code class="xref py py-obj docutils literal"><span class="pre">HTTPHeaders</span></code></a> instance.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Some <a class="reference internal" href="#tornado.httputil.HTTPConnection" title="tornado.httputil.HTTPConnection"><code class="xref py py-obj docutils literal"><span class="pre">HTTPConnection</span></code></a> methods can only be called during
<code class="docutils literal"><span class="pre">headers_received</span></code>.</p>
<p>May return a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>; if it does the body will not be read
until it is done.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.httputil.HTTPMessageDelegate.data_received">
<code class="descname">data_received</code><span class="sig-paren">(</span><em>chunk</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPMessageDelegate.data_received"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPMessageDelegate.data_received" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when a chunk of data has been received.</p>
<p>May return a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> for flow control.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.httputil.HTTPMessageDelegate.finish">
<code class="descname">finish</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPMessageDelegate.finish"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPMessageDelegate.finish" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after the last chunk of data has been received.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.httputil.HTTPMessageDelegate.on_connection_close">
<code class="descname">on_connection_close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPMessageDelegate.on_connection_close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPMessageDelegate.on_connection_close" title="Permalink to this definition">¶</a></dt>
<dd><p>Called if the connection is closed without finishing the request.</p>
<p>If <code class="docutils literal"><span class="pre">headers_received</span></code> is called, either <code class="docutils literal"><span class="pre">finish</span></code> or
<code class="docutils literal"><span class="pre">on_connection_close</span></code> will be called, but not both.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.httputil.HTTPConnection">
<em class="property">class </em><code class="descclassname">tornado.httputil.</code><code class="descname">HTTPConnection</code><a class="reference internal" href="_modules/tornado/httputil.html#HTTPConnection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPConnection" title="Permalink to this definition">¶</a></dt>
<dd><p>Applications use this interface to write their responses.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
<dl class="method">
<dt id="tornado.httputil.HTTPConnection.write_headers">
<code class="descname">write_headers</code><span class="sig-paren">(</span><em>start_line</em>, <em>headers</em>, <em>chunk=None</em>, <em>callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPConnection.write_headers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPConnection.write_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Write an HTTP header block.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>start_line</strong> &#8211; a <a class="reference internal" href="#tornado.httputil.RequestStartLine" title="tornado.httputil.RequestStartLine"><code class="xref py py-obj docutils literal"><span class="pre">RequestStartLine</span></code></a> or <a class="reference internal" href="#tornado.httputil.ResponseStartLine" title="tornado.httputil.ResponseStartLine"><code class="xref py py-obj docutils literal"><span class="pre">ResponseStartLine</span></code></a>.</li>
<li><strong>headers</strong> &#8211; a <a class="reference internal" href="#tornado.httputil.HTTPHeaders" title="tornado.httputil.HTTPHeaders"><code class="xref py py-obj docutils literal"><span class="pre">HTTPHeaders</span></code></a> instance.</li>
<li><strong>chunk</strong> &#8211; the first (optional) chunk of data.  This is an optimization
so that small responses can be written in the same call as their
headers.</li>
<li><strong>callback</strong> &#8211; a callback to be run when the write is complete.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal"><span class="pre">version</span></code> field of <code class="docutils literal"><span class="pre">start_line</span></code> is ignored.</p>
<p>Returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> if no callback is given.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.httputil.HTTPConnection.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>chunk</em>, <em>callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPConnection.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPConnection.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a chunk of body data.</p>
<p>The callback will be run when the write is complete.  If no callback
is given, returns a Future.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.httputil.HTTPConnection.finish">
<code class="descname">finish</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#HTTPConnection.finish"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPConnection.finish" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicates that the last body data has been written.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tornado.httputil.url_concat">
<code class="descclassname">tornado.httputil.</code><code class="descname">url_concat</code><span class="sig-paren">(</span><em>url</em>, <em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#url_concat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.url_concat" title="Permalink to this definition">¶</a></dt>
<dd><p>Concatenate url and arguments regardless of whether
url has existing query parameters.</p>
<p><code class="docutils literal"><span class="pre">args</span></code> may be either a dictionary or a list of key-value pairs
(the latter allows for multiple values with the same key.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">url_concat</span><span class="p">(</span><span class="s">&quot;http://example.com/foo&quot;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="s">&quot;d&quot;</span><span class="p">))</span>
<span class="go">&#39;http://example.com/foo?c=d&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url_concat</span><span class="p">(</span><span class="s">&quot;http://example.com/foo?a=b&quot;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="s">&quot;d&quot;</span><span class="p">))</span>
<span class="go">&#39;http://example.com/foo?a=b&amp;c=d&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">url_concat</span><span class="p">(</span><span class="s">&quot;http://example.com/foo?a=b&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;d&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="s">&quot;d2&quot;</span><span class="p">)])</span>
<span class="go">&#39;http://example.com/foo?a=b&amp;c=d&amp;c=d2&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.httputil.HTTPFile">
<em class="property">class </em><code class="descclassname">tornado.httputil.</code><code class="descname">HTTPFile</code><a class="reference internal" href="_modules/tornado/httputil.html#HTTPFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.HTTPFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a file uploaded via a form.</p>
<p>For backwards compatibility, its instance attributes are also
accessible as dictionary keys.</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">filename</span></code></li>
<li><code class="docutils literal"><span class="pre">body</span></code></li>
<li><code class="docutils literal"><span class="pre">content_type</span></code></li>
</ul>
</dd></dl>

<dl class="function">
<dt id="tornado.httputil.parse_body_arguments">
<code class="descclassname">tornado.httputil.</code><code class="descname">parse_body_arguments</code><span class="sig-paren">(</span><em>content_type</em>, <em>body</em>, <em>arguments</em>, <em>files</em>, <em>headers=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#parse_body_arguments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.parse_body_arguments" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses a form request body.</p>
<p>Supports <code class="docutils literal"><span class="pre">application/x-www-form-urlencoded</span></code> and
<code class="docutils literal"><span class="pre">multipart/form-data</span></code>.  The <code class="docutils literal"><span class="pre">content_type</span></code> parameter should be
a string and <code class="docutils literal"><span class="pre">body</span></code> should be a byte string.  The <code class="docutils literal"><span class="pre">arguments</span></code>
and <code class="docutils literal"><span class="pre">files</span></code> parameters are dictionaries that will be updated
with the parsed contents.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.httputil.parse_multipart_form_data">
<code class="descclassname">tornado.httputil.</code><code class="descname">parse_multipart_form_data</code><span class="sig-paren">(</span><em>boundary</em>, <em>data</em>, <em>arguments</em>, <em>files</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#parse_multipart_form_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.parse_multipart_form_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses a <code class="docutils literal"><span class="pre">multipart/form-data</span></code> body.</p>
<p>The <code class="docutils literal"><span class="pre">boundary</span></code> and <code class="docutils literal"><span class="pre">data</span></code> parameters are both byte strings.
The dictionaries given in the arguments and files parameters
will be updated with the contents of the body.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.httputil.format_timestamp">
<code class="descclassname">tornado.httputil.</code><code class="descname">format_timestamp</code><span class="sig-paren">(</span><em>ts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#format_timestamp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.format_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Formats a timestamp in the format used by HTTP.</p>
<p>The argument may be a numeric timestamp as returned by <a class="reference external" href="https://docs.python.org/3.4/library/time.html#time.time" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">time.time</span></code></a>,
a time tuple as returned by <a class="reference external" href="https://docs.python.org/3.4/library/time.html#time.gmtime" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">time.gmtime</span></code></a>, or a <a class="reference external" href="https://docs.python.org/3.4/library/datetime.html#datetime.datetime" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">datetime.datetime</span></code></a>
object.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">format_timestamp</span><span class="p">(</span><span class="mi">1359312200</span><span class="p">)</span>
<span class="go">&#39;Sun, 27 Jan 2013 18:43:20 GMT&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.httputil.RequestStartLine">
<em class="property">class </em><code class="descclassname">tornado.httputil.</code><code class="descname">RequestStartLine</code><a class="headerlink" href="#tornado.httputil.RequestStartLine" title="Permalink to this definition">¶</a></dt>
<dd><p>RequestStartLine(method, path, version)</p>
<dl class="attribute">
<dt id="tornado.httputil.RequestStartLine.method">
<code class="descname">method</code><a class="headerlink" href="#tornado.httputil.RequestStartLine.method" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.RequestStartLine.path">
<code class="descname">path</code><a class="headerlink" href="#tornado.httputil.RequestStartLine.path" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.RequestStartLine.version">
<code class="descname">version</code><a class="headerlink" href="#tornado.httputil.RequestStartLine.version" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tornado.httputil.parse_request_start_line">
<code class="descclassname">tornado.httputil.</code><code class="descname">parse_request_start_line</code><span class="sig-paren">(</span><em>line</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#parse_request_start_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.parse_request_start_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a (method, path, version) tuple for an HTTP 1.x request line.</p>
<p>The response is a <a class="reference external" href="https://docs.python.org/3.4/library/collections.html#collections.namedtuple" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">collections.namedtuple</span></code></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">parse_request_start_line</span><span class="p">(</span><span class="s">&quot;GET /foo HTTP/1.1&quot;</span><span class="p">)</span>
<span class="go">RequestStartLine(method=&#39;GET&#39;, path=&#39;/foo&#39;, version=&#39;HTTP/1.1&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.httputil.ResponseStartLine">
<em class="property">class </em><code class="descclassname">tornado.httputil.</code><code class="descname">ResponseStartLine</code><a class="headerlink" href="#tornado.httputil.ResponseStartLine" title="Permalink to this definition">¶</a></dt>
<dd><p>ResponseStartLine(version, code, reason)</p>
<dl class="attribute">
<dt id="tornado.httputil.ResponseStartLine.code">
<code class="descname">code</code><a class="headerlink" href="#tornado.httputil.ResponseStartLine.code" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.ResponseStartLine.reason">
<code class="descname">reason</code><a class="headerlink" href="#tornado.httputil.ResponseStartLine.reason" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.httputil.ResponseStartLine.version">
<code class="descname">version</code><a class="headerlink" href="#tornado.httputil.ResponseStartLine.version" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tornado.httputil.parse_response_start_line">
<code class="descclassname">tornado.httputil.</code><code class="descname">parse_response_start_line</code><span class="sig-paren">(</span><em>line</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#parse_response_start_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.parse_response_start_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a (version, code, reason) tuple for an HTTP 1.x response line.</p>
<p>The response is a <a class="reference external" href="https://docs.python.org/3.4/library/collections.html#collections.namedtuple" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">collections.namedtuple</span></code></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">parse_response_start_line</span><span class="p">(</span><span class="s">&quot;HTTP/1.1 200 OK&quot;</span><span class="p">)</span>
<span class="go">ResponseStartLine(version=&#39;HTTP/1.1&#39;, code=200, reason=&#39;OK&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.httputil.split_host_and_port">
<code class="descclassname">tornado.httputil.</code><code class="descname">split_host_and_port</code><span class="sig-paren">(</span><em>netloc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/httputil.html#split_host_and_port"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.httputil.split_host_and_port" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">(host,</span> <span class="pre">port)</span></code> tuple from <code class="docutils literal"><span class="pre">netloc</span></code>.</p>
<p>Returned <code class="docutils literal"><span class="pre">port</span></code> will be <code class="docutils literal"><span class="pre">None</span></code> if not present.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.1.</span></p>
</div>
</dd></dl>

</div>
<span id="document-http1connection"></span><div class="section" id="module-tornado.http1connection">
<span id="tornado-http1connection-http-1-x-client-server-implementation"></span><h4><code class="docutils literal"><span class="pre">tornado.http1connection</span></code> &#8211; HTTP/1.x client/server implementation<a class="headerlink" href="#module-tornado.http1connection" title="Permalink to this headline">¶</a></h4>
<p>Client and server implementations of HTTP/1.x.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
<dl class="class">
<dt id="tornado.http1connection.HTTP1ConnectionParameters">
<em class="property">class </em><code class="descclassname">tornado.http1connection.</code><code class="descname">HTTP1ConnectionParameters</code><span class="sig-paren">(</span><em>no_keep_alive=False</em>, <em>chunk_size=None</em>, <em>max_header_size=None</em>, <em>header_timeout=None</em>, <em>max_body_size=None</em>, <em>body_timeout=None</em>, <em>decompress=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/http1connection.html#HTTP1ConnectionParameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.http1connection.HTTP1ConnectionParameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters for <a class="reference internal" href="#tornado.http1connection.HTTP1Connection" title="tornado.http1connection.HTTP1Connection"><code class="xref py py-obj docutils literal"><span class="pre">HTTP1Connection</span></code></a> and <a class="reference internal" href="#tornado.http1connection.HTTP1ServerConnection" title="tornado.http1connection.HTTP1ServerConnection"><code class="xref py py-obj docutils literal"><span class="pre">HTTP1ServerConnection</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>no_keep_alive</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#bool" title="(in Python v3.4)"><em>bool</em></a>) &#8211; If true, always close the connection after
one request.</li>
<li><strong>chunk_size</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#int" title="(in Python v3.4)"><em>int</em></a>) &#8211; how much data to read into memory at once</li>
<li><strong>max_header_size</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#int" title="(in Python v3.4)"><em>int</em></a>) &#8211; maximum amount of data for HTTP headers</li>
<li><strong>header_timeout</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#float" title="(in Python v3.4)"><em>float</em></a>) &#8211; how long to wait for all headers (seconds)</li>
<li><strong>max_body_size</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#int" title="(in Python v3.4)"><em>int</em></a>) &#8211; maximum amount of data for body</li>
<li><strong>body_timeout</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#float" title="(in Python v3.4)"><em>float</em></a>) &#8211; how long to wait while reading body (seconds)</li>
<li><strong>decompress</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#bool" title="(in Python v3.4)"><em>bool</em></a>) &#8211; if true, decode incoming
<code class="docutils literal"><span class="pre">Content-Encoding:</span> <span class="pre">gzip</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tornado.http1connection.HTTP1Connection">
<em class="property">class </em><code class="descclassname">tornado.http1connection.</code><code class="descname">HTTP1Connection</code><span class="sig-paren">(</span><em>stream</em>, <em>is_client</em>, <em>params=None</em>, <em>context=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/http1connection.html#HTTP1Connection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.http1connection.HTTP1Connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the HTTP/1.x protocol.</p>
<p>This class can be on its own for clients, or via <a class="reference internal" href="#tornado.http1connection.HTTP1ServerConnection" title="tornado.http1connection.HTTP1ServerConnection"><code class="xref py py-obj docutils literal"><span class="pre">HTTP1ServerConnection</span></code></a>
for servers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>stream</strong> &#8211; an <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a></li>
<li><strong>is_client</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#bool" title="(in Python v3.4)"><em>bool</em></a>) &#8211; client or server</li>
<li><strong>params</strong> &#8211; a <a class="reference internal" href="#tornado.http1connection.HTTP1ConnectionParameters" title="tornado.http1connection.HTTP1ConnectionParameters"><code class="xref py py-obj docutils literal"><span class="pre">HTTP1ConnectionParameters</span></code></a> instance or <code class="docutils literal"><span class="pre">None</span></code></li>
<li><strong>context</strong> &#8211; an opaque application-defined object that can be accessed
as <code class="docutils literal"><span class="pre">connection.context</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tornado.http1connection.HTTP1Connection.read_response">
<code class="descname">read_response</code><span class="sig-paren">(</span><em>delegate</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/http1connection.html#HTTP1Connection.read_response"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.http1connection.HTTP1Connection.read_response" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a single HTTP response.</p>
<p>Typical client-mode usage is to write a request using <a class="reference internal" href="#tornado.http1connection.HTTP1Connection.write_headers" title="tornado.http1connection.HTTP1Connection.write_headers"><code class="xref py py-obj docutils literal"><span class="pre">write_headers</span></code></a>,
<a class="reference internal" href="#tornado.http1connection.HTTP1Connection.write" title="tornado.http1connection.HTTP1Connection.write"><code class="xref py py-obj docutils literal"><span class="pre">write</span></code></a>, and <a class="reference internal" href="#tornado.http1connection.HTTP1Connection.finish" title="tornado.http1connection.HTTP1Connection.finish"><code class="xref py py-obj docutils literal"><span class="pre">finish</span></code></a>, and then call <code class="docutils literal"><span class="pre">read_response</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>delegate</strong> &#8211; a <a class="reference internal" href="index.html#tornado.httputil.HTTPMessageDelegate" title="tornado.httputil.HTTPMessageDelegate"><code class="xref py py-obj docutils literal"><span class="pre">HTTPMessageDelegate</span></code></a></td>
</tr>
</tbody>
</table>
<p>Returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> that resolves to None after the full response has
been read.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.http1connection.HTTP1Connection.set_close_callback">
<code class="descname">set_close_callback</code><span class="sig-paren">(</span><em>callback</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/http1connection.html#HTTP1Connection.set_close_callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.http1connection.HTTP1Connection.set_close_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a callback that will be run when the connection is closed.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 4.0: </span>Use <a class="reference internal" href="index.html#tornado.httputil.HTTPMessageDelegate.on_connection_close" title="tornado.httputil.HTTPMessageDelegate.on_connection_close"><code class="xref py py-obj docutils literal"><span class="pre">HTTPMessageDelegate.on_connection_close</span></code></a> instead.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.http1connection.HTTP1Connection.detach">
<code class="descname">detach</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/http1connection.html#HTTP1Connection.detach"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.http1connection.HTTP1Connection.detach" title="Permalink to this definition">¶</a></dt>
<dd><p>Take control of the underlying stream.</p>
<p>Returns the underlying <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> object and stops all further
HTTP processing.  May only be called during
<a class="reference internal" href="index.html#tornado.httputil.HTTPMessageDelegate.headers_received" title="tornado.httputil.HTTPMessageDelegate.headers_received"><code class="xref py py-obj docutils literal"><span class="pre">HTTPMessageDelegate.headers_received</span></code></a>.  Intended for implementing
protocols like websockets that tunnel over an HTTP handshake.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.http1connection.HTTP1Connection.set_body_timeout">
<code class="descname">set_body_timeout</code><span class="sig-paren">(</span><em>timeout</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/http1connection.html#HTTP1Connection.set_body_timeout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.http1connection.HTTP1Connection.set_body_timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the body timeout for a single request.</p>
<p>Overrides the value from <a class="reference internal" href="#tornado.http1connection.HTTP1ConnectionParameters" title="tornado.http1connection.HTTP1ConnectionParameters"><code class="xref py py-obj docutils literal"><span class="pre">HTTP1ConnectionParameters</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.http1connection.HTTP1Connection.set_max_body_size">
<code class="descname">set_max_body_size</code><span class="sig-paren">(</span><em>max_body_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/http1connection.html#HTTP1Connection.set_max_body_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.http1connection.HTTP1Connection.set_max_body_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the body size limit for a single request.</p>
<p>Overrides the value from <a class="reference internal" href="#tornado.http1connection.HTTP1ConnectionParameters" title="tornado.http1connection.HTTP1ConnectionParameters"><code class="xref py py-obj docutils literal"><span class="pre">HTTP1ConnectionParameters</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.http1connection.HTTP1Connection.write_headers">
<code class="descname">write_headers</code><span class="sig-paren">(</span><em>start_line</em>, <em>headers</em>, <em>chunk=None</em>, <em>callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/http1connection.html#HTTP1Connection.write_headers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.http1connection.HTTP1Connection.write_headers" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements <a class="reference internal" href="index.html#tornado.httputil.HTTPConnection.write_headers" title="tornado.httputil.HTTPConnection.write_headers"><code class="xref py py-obj docutils literal"><span class="pre">HTTPConnection.write_headers</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.http1connection.HTTP1Connection.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>chunk</em>, <em>callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/http1connection.html#HTTP1Connection.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.http1connection.HTTP1Connection.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements <a class="reference internal" href="index.html#tornado.httputil.HTTPConnection.write" title="tornado.httputil.HTTPConnection.write"><code class="xref py py-obj docutils literal"><span class="pre">HTTPConnection.write</span></code></a>.</p>
<p>For backwards compatibility is is allowed but deprecated to
skip <a class="reference internal" href="#tornado.http1connection.HTTP1Connection.write_headers" title="tornado.http1connection.HTTP1Connection.write_headers"><code class="xref py py-obj docutils literal"><span class="pre">write_headers</span></code></a> and instead call <a class="reference internal" href="#tornado.http1connection.HTTP1Connection.write" title="tornado.http1connection.HTTP1Connection.write"><code class="xref py py-obj docutils literal"><span class="pre">write()</span></code></a> with a
pre-encoded header block.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.http1connection.HTTP1Connection.finish">
<code class="descname">finish</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/http1connection.html#HTTP1Connection.finish"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.http1connection.HTTP1Connection.finish" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements <a class="reference internal" href="index.html#tornado.httputil.HTTPConnection.finish" title="tornado.httputil.HTTPConnection.finish"><code class="xref py py-obj docutils literal"><span class="pre">HTTPConnection.finish</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.http1connection.HTTP1ServerConnection">
<em class="property">class </em><code class="descclassname">tornado.http1connection.</code><code class="descname">HTTP1ServerConnection</code><span class="sig-paren">(</span><em>stream</em>, <em>params=None</em>, <em>context=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/http1connection.html#HTTP1ServerConnection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.http1connection.HTTP1ServerConnection" title="Permalink to this definition">¶</a></dt>
<dd><p>An HTTP/1.x server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>stream</strong> &#8211; an <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a></li>
<li><strong>params</strong> &#8211; a <a class="reference internal" href="#tornado.http1connection.HTTP1ConnectionParameters" title="tornado.http1connection.HTTP1ConnectionParameters"><code class="xref py py-obj docutils literal"><span class="pre">HTTP1ConnectionParameters</span></code></a> or None</li>
<li><strong>context</strong> &#8211; an opaque application-defined object that is accessible
as <code class="docutils literal"><span class="pre">connection.context</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="tornado.http1connection.HTTP1ServerConnection.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/http1connection.html#HTTP1ServerConnection.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.http1connection.HTTP1ServerConnection.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes the connection.</p>
<p>Returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> that resolves after the serving loop has exited.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.http1connection.HTTP1ServerConnection.start_serving">
<code class="descname">start_serving</code><span class="sig-paren">(</span><em>delegate</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/http1connection.html#HTTP1ServerConnection.start_serving"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.http1connection.HTTP1ServerConnection.start_serving" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts serving requests on this connection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>delegate</strong> &#8211; a <a class="reference internal" href="index.html#tornado.httputil.HTTPServerConnectionDelegate" title="tornado.httputil.HTTPServerConnectionDelegate"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerConnectionDelegate</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
</div>
<span id="document-networking"></span><div class="section" id="asynchronous-networking">
<h3>Asynchronous networking<a class="headerlink" href="#asynchronous-networking" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
<span id="document-ioloop"></span><div class="section" id="module-tornado.ioloop">
<span id="tornado-ioloop-main-event-loop"></span><h4><code class="docutils literal"><span class="pre">tornado.ioloop</span></code> &#8212; Main event loop<a class="headerlink" href="#module-tornado.ioloop" title="Permalink to this headline">¶</a></h4>
<p>An I/O event loop for non-blocking sockets.</p>
<p>Typical applications will use a single <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> object, in the
<a class="reference internal" href="#tornado.ioloop.IOLoop.instance" title="tornado.ioloop.IOLoop.instance"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.instance</span></code></a> singleton.  The <a class="reference internal" href="#tornado.ioloop.IOLoop.start" title="tornado.ioloop.IOLoop.start"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.start</span></code></a> method should usually
be called at the end of the <code class="docutils literal"><span class="pre">main()</span></code> function.  Atypical applications may
use more than one <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>, such as one <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> per thread, or per <a class="reference external" href="https://docs.python.org/3.4/library/unittest.html#module-unittest" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">unittest</span></code></a>
case.</p>
<p>In addition to I/O events, the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> can also schedule time-based events.
<a class="reference internal" href="#tornado.ioloop.IOLoop.add_timeout" title="tornado.ioloop.IOLoop.add_timeout"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_timeout</span></code></a> is a non-blocking alternative to <a class="reference external" href="https://docs.python.org/3.4/library/time.html#time.sleep" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">time.sleep</span></code></a>.</p>
<div class="section" id="ioloop-objects">
<h5>IOLoop objects<a class="headerlink" href="#ioloop-objects" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.ioloop.IOLoop">
<em class="property">class </em><code class="descclassname">tornado.ioloop.</code><code class="descname">IOLoop</code><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop" title="Permalink to this definition">¶</a></dt>
<dd><p>A level-triggered I/O loop.</p>
<p>We use <code class="docutils literal"><span class="pre">epoll</span></code> (Linux) or <code class="docutils literal"><span class="pre">kqueue</span></code> (BSD and Mac OS X) if they
are available, or else we fall back on select(). If you are
implementing a system that needs to handle thousands of
simultaneous connections, you should use a system that supports
either <code class="docutils literal"><span class="pre">epoll</span></code> or <code class="docutils literal"><span class="pre">kqueue</span></code>.</p>
<p>Example usage for a simple TCP server:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">errno</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">tornado.ioloop</span>
<span class="kn">import</span> <span class="nn">socket</span>

<span class="k">def</span> <span class="nf">connection_ready</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">fd</span><span class="p">,</span> <span class="n">events</span><span class="p">):</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">connection</span><span class="p">,</span> <span class="n">address</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">errno</span><span class="o">.</span><span class="n">EWOULDBLOCK</span><span class="p">,</span> <span class="n">errno</span><span class="o">.</span><span class="n">EAGAIN</span><span class="p">):</span>
                <span class="k">raise</span>
            <span class="k">return</span>
        <span class="n">connection</span><span class="o">.</span><span class="n">setblocking</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">handle_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">address</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">sock</span><span class="o">.</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">SOL_SOCKET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SO_REUSEADDR</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">sock</span><span class="o">.</span><span class="n">setblocking</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sock</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
    <span class="n">sock</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>

    <span class="n">io_loop</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">ioloop</span><span class="o">.</span><span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span>
    <span class="n">callback</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">connection_ready</span><span class="p">,</span> <span class="n">sock</span><span class="p">)</span>
    <span class="n">io_loop</span><span class="o">.</span><span class="n">add_handler</span><span class="p">(</span><span class="n">sock</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="n">callback</span><span class="p">,</span> <span class="n">io_loop</span><span class="o">.</span><span class="n">READ</span><span class="p">)</span>
    <span class="n">io_loop</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>By default, a newly-constructed <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> becomes the thread&#8217;s current
<a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>, unless there already is a current <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>. This behavior
can be controlled with the <code class="docutils literal"><span class="pre">make_current</span></code> argument to the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>
constructor: if <code class="docutils literal"><span class="pre">make_current=True</span></code>, the new <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> will always
try to become current and it raises an error if there is already a
current instance. If <code class="docutils literal"><span class="pre">make_current=False</span></code>, the new <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> will
not try to become current.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.2: </span>Added the <code class="docutils literal"><span class="pre">make_current</span></code> keyword argument to the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>
constructor.</p>
</div>
</dd></dl>

<div class="section" id="running-an-ioloop">
<h6>Running an IOLoop<a class="headerlink" href="#running-an-ioloop" title="Permalink to this headline">¶</a></h6>
<dl class="staticmethod">
<dt id="tornado.ioloop.IOLoop.current">
<em class="property">static </em><code class="descclassname">IOLoop.</code><code class="descname">current</code><span class="sig-paren">(</span><em>instance=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.current"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.current" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the current thread&#8217;s <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>.</p>
<p>If an <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> is currently running or has been marked as
current by <a class="reference internal" href="#tornado.ioloop.IOLoop.make_current" title="tornado.ioloop.IOLoop.make_current"><code class="xref py py-obj docutils literal"><span class="pre">make_current</span></code></a>, returns that instance.  If there is
no current <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>, returns <a class="reference internal" href="#tornado.ioloop.IOLoop.instance" title="tornado.ioloop.IOLoop.instance"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.instance()</span></code></a> (i.e. the
main thread&#8217;s <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>, creating one if necessary) if <code class="docutils literal"><span class="pre">instance</span></code>
is true.</p>
<p>In general you should use <a class="reference internal" href="#tornado.ioloop.IOLoop.current" title="tornado.ioloop.IOLoop.current"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.current</span></code></a> as the default when
constructing an asynchronous object, and use <a class="reference internal" href="#tornado.ioloop.IOLoop.instance" title="tornado.ioloop.IOLoop.instance"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.instance</span></code></a>
when you mean to communicate to the main thread from a different
one.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>Added <code class="docutils literal"><span class="pre">instance</span></code> argument to control the fallback to
<a class="reference internal" href="#tornado.ioloop.IOLoop.instance" title="tornado.ioloop.IOLoop.instance"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.instance()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.make_current">
<code class="descclassname">IOLoop.</code><code class="descname">make_current</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.make_current"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.make_current" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes this the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> for the current thread.</p>
<p>An <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> automatically becomes current for its thread
when it is started, but it is sometimes useful to call
<a class="reference internal" href="#tornado.ioloop.IOLoop.make_current" title="tornado.ioloop.IOLoop.make_current"><code class="xref py py-obj docutils literal"><span class="pre">make_current</span></code></a> explicitly before starting the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>,
so that code run at startup time can find the right
instance.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>An <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> created while there is no current <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>
will automatically become current.</p>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="tornado.ioloop.IOLoop.instance">
<em class="property">static </em><code class="descclassname">IOLoop.</code><code class="descname">instance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.instance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.instance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a global <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> instance.</p>
<p>Most applications have a single, global <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> running on the
main thread.  Use this method to get this instance from
another thread.  In most other cases, it is better to use <a class="reference internal" href="#tornado.ioloop.IOLoop.current" title="tornado.ioloop.IOLoop.current"><code class="xref py py-obj docutils literal"><span class="pre">current()</span></code></a>
to get the current thread&#8217;s <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="tornado.ioloop.IOLoop.initialized">
<em class="property">static </em><code class="descclassname">IOLoop.</code><code class="descname">initialized</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.initialized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.initialized" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if the singleton instance has been created.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.install">
<code class="descclassname">IOLoop.</code><code class="descname">install</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.install"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.install" title="Permalink to this definition">¶</a></dt>
<dd><p>Installs this <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> object as the singleton instance.</p>
<p>This is normally not necessary as <a class="reference internal" href="#tornado.ioloop.IOLoop.instance" title="tornado.ioloop.IOLoop.instance"><code class="xref py py-obj docutils literal"><span class="pre">instance()</span></code></a> will create
an <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> on demand, but you may want to call <a class="reference internal" href="#tornado.ioloop.IOLoop.install" title="tornado.ioloop.IOLoop.install"><code class="xref py py-obj docutils literal"><span class="pre">install</span></code></a> to use
a custom subclass of <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="tornado.ioloop.IOLoop.clear_instance">
<em class="property">static </em><code class="descclassname">IOLoop.</code><code class="descname">clear_instance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.clear_instance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.clear_instance" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the global <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> instance.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.start">
<code class="descclassname">IOLoop.</code><code class="descname">start</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts the I/O loop.</p>
<p>The loop will run until one of the callbacks calls <a class="reference internal" href="#tornado.ioloop.IOLoop.stop" title="tornado.ioloop.IOLoop.stop"><code class="xref py py-obj docutils literal"><span class="pre">stop()</span></code></a>, which
will make the loop stop after the current event iteration completes.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.stop">
<code class="descclassname">IOLoop.</code><code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop the I/O loop.</p>
<p>If the event loop is not currently running, the next call to <a class="reference internal" href="#tornado.ioloop.IOLoop.start" title="tornado.ioloop.IOLoop.start"><code class="xref py py-obj docutils literal"><span class="pre">start()</span></code></a>
will return immediately.</p>
<p>To use asynchronous methods from otherwise-synchronous code (such as
unit tests), you can start and stop the event loop like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ioloop</span> <span class="o">=</span> <span class="n">IOLoop</span><span class="p">()</span>
<span class="n">async_method</span><span class="p">(</span><span class="n">ioloop</span><span class="o">=</span><span class="n">ioloop</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">ioloop</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span>
<span class="n">ioloop</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">ioloop.start()</span></code> will return after <code class="docutils literal"><span class="pre">async_method</span></code> has run
its callback, whether that callback was invoked before or
after <code class="docutils literal"><span class="pre">ioloop.start</span></code>.</p>
<p>Note that even after <a class="reference internal" href="#tornado.ioloop.IOLoop.stop" title="tornado.ioloop.IOLoop.stop"><code class="xref py py-obj docutils literal"><span class="pre">stop</span></code></a> has been called, the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> is not
completely stopped until <a class="reference internal" href="#tornado.ioloop.IOLoop.start" title="tornado.ioloop.IOLoop.start"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.start</span></code></a> has also returned.
Some work that was scheduled before the call to <a class="reference internal" href="#tornado.ioloop.IOLoop.stop" title="tornado.ioloop.IOLoop.stop"><code class="xref py py-obj docutils literal"><span class="pre">stop</span></code></a> may still
be run before the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> shuts down.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.run_sync">
<code class="descclassname">IOLoop.</code><code class="descname">run_sync</code><span class="sig-paren">(</span><em>func</em>, <em>timeout=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.run_sync"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.run_sync" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>, runs the given function, and stops the loop.</p>
<p>The function must return either a yieldable object or
<code class="docutils literal"><span class="pre">None</span></code>. If the function returns a yieldable object, the
<a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> will run until the yieldable is resolved (and
<a class="reference internal" href="#tornado.ioloop.IOLoop.run_sync" title="tornado.ioloop.IOLoop.run_sync"><code class="xref py py-obj docutils literal"><span class="pre">run_sync()</span></code></a> will return the yieldable&#8217;s result). If it raises
an exception, the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> will stop and the exception will be
re-raised to the caller.</p>
<p>The keyword-only argument <code class="docutils literal"><span class="pre">timeout</span></code> may be used to set
a maximum duration for the function.  If the timeout expires,
a <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#TimeoutError" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">TimeoutError</span></code></a> is raised.</p>
<p>This method is useful in conjunction with <a class="reference internal" href="index.html#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.coroutine</span></code></a>
to allow asynchronous calls in a <code class="docutils literal"><span class="pre">main()</span></code> function:</p>
<div class="highlight-python"><div class="highlight"><pre>@gen.coroutine
def main():
    # do stuff...

if __name__ == &#39;__main__&#39;:
    IOLoop.current().run_sync(main)
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Returning a non-<code class="docutils literal"><span class="pre">None</span></code>, non-yieldable value is now an error.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.close">
<code class="descclassname">IOLoop.</code><code class="descname">close</code><span class="sig-paren">(</span><em>all_fds=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>, freeing any resources used.</p>
<p>If <code class="docutils literal"><span class="pre">all_fds</span></code> is true, all file descriptors registered on the
IOLoop will be closed (not just the ones created by the
<a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> itself).</p>
<p>Many applications will only use a single <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> that runs for the
entire lifetime of the process.  In that case closing the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>
is not necessary since everything will be cleaned up when the
process exits.  <a class="reference internal" href="#tornado.ioloop.IOLoop.close" title="tornado.ioloop.IOLoop.close"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.close</span></code></a> is provided mainly for scenarios
such as unit tests, which create and destroy a large number of
<code class="docutils literal"><span class="pre">IOLoops</span></code>.</p>
<p>An <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> must be completely stopped before it can be closed.  This
means that <a class="reference internal" href="#tornado.ioloop.IOLoop.stop" title="tornado.ioloop.IOLoop.stop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.stop()</span></code></a> must be called <em>and</em> <a class="reference internal" href="#tornado.ioloop.IOLoop.start" title="tornado.ioloop.IOLoop.start"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.start()</span></code></a> must
be allowed to return before attempting to call <a class="reference internal" href="#tornado.ioloop.IOLoop.close" title="tornado.ioloop.IOLoop.close"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.close()</span></code></a>.
Therefore the call to <a class="reference internal" href="#tornado.ioloop.IOLoop.close" title="tornado.ioloop.IOLoop.close"><code class="xref py py-obj docutils literal"><span class="pre">close</span></code></a> will usually appear just after
the call to <a class="reference internal" href="#tornado.ioloop.IOLoop.start" title="tornado.ioloop.IOLoop.start"><code class="xref py py-obj docutils literal"><span class="pre">start</span></code></a> rather than near the call to <a class="reference internal" href="#tornado.ioloop.IOLoop.stop" title="tornado.ioloop.IOLoop.stop"><code class="xref py py-obj docutils literal"><span class="pre">stop</span></code></a>.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.1: </span>If the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> implementation supports non-integer objects
for &#8220;file descriptors&#8221;, those objects will have their
<code class="docutils literal"><span class="pre">close</span></code> method when <code class="docutils literal"><span class="pre">all_fds</span></code> is true.</p>
</div>
</dd></dl>

</div>
<div class="section" id="i-o-events">
<h6>I/O events<a class="headerlink" href="#i-o-events" title="Permalink to this headline">¶</a></h6>
<dl class="method">
<dt id="tornado.ioloop.IOLoop.add_handler">
<code class="descclassname">IOLoop.</code><code class="descname">add_handler</code><span class="sig-paren">(</span><em>fd</em>, <em>handler</em>, <em>events</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.add_handler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.add_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers the given handler to receive the given events for <code class="docutils literal"><span class="pre">fd</span></code>.</p>
<p>The <code class="docutils literal"><span class="pre">fd</span></code> argument may either be an integer file descriptor or
a file-like object with a <code class="docutils literal"><span class="pre">fileno()</span></code> method (and optionally a
<code class="docutils literal"><span class="pre">close()</span></code> method, which may be called when the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> is shut
down).</p>
<p>The <code class="docutils literal"><span class="pre">events</span></code> argument is a bitwise or of the constants
<code class="docutils literal"><span class="pre">IOLoop.READ</span></code>, <code class="docutils literal"><span class="pre">IOLoop.WRITE</span></code>, and <code class="docutils literal"><span class="pre">IOLoop.ERROR</span></code>.</p>
<p>When an event occurs, <code class="docutils literal"><span class="pre">handler(fd,</span> <span class="pre">events)</span></code> will be run.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>Added the ability to pass file-like objects in addition to
raw file descriptors.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.update_handler">
<code class="descclassname">IOLoop.</code><code class="descname">update_handler</code><span class="sig-paren">(</span><em>fd</em>, <em>events</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.update_handler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.update_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the events we listen for <code class="docutils literal"><span class="pre">fd</span></code>.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>Added the ability to pass file-like objects in addition to
raw file descriptors.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.remove_handler">
<code class="descclassname">IOLoop.</code><code class="descname">remove_handler</code><span class="sig-paren">(</span><em>fd</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.remove_handler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.remove_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop listening for events on <code class="docutils literal"><span class="pre">fd</span></code>.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>Added the ability to pass file-like objects in addition to
raw file descriptors.</p>
</div>
</dd></dl>

</div>
<div class="section" id="callbacks-and-timeouts">
<h6>Callbacks and timeouts<a class="headerlink" href="#callbacks-and-timeouts" title="Permalink to this headline">¶</a></h6>
<dl class="method">
<dt id="tornado.ioloop.IOLoop.add_callback">
<code class="descclassname">IOLoop.</code><code class="descname">add_callback</code><span class="sig-paren">(</span><em>callback</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.add_callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.add_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls the given callback on the next I/O loop iteration.</p>
<p>It is safe to call this method from any thread at any time,
except from a signal handler.  Note that this is the <strong>only</strong>
method in <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> that makes this thread-safety guarantee; all
other interaction with the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> must be done from that
<a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>&#8216;s thread.  <a class="reference internal" href="#tornado.ioloop.IOLoop.add_callback" title="tornado.ioloop.IOLoop.add_callback"><code class="xref py py-obj docutils literal"><span class="pre">add_callback()</span></code></a> may be used to transfer
control from other threads to the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>&#8216;s thread.</p>
<p>To add a callback from a signal handler, see
<a class="reference internal" href="#tornado.ioloop.IOLoop.add_callback_from_signal" title="tornado.ioloop.IOLoop.add_callback_from_signal"><code class="xref py py-obj docutils literal"><span class="pre">add_callback_from_signal</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.add_callback_from_signal">
<code class="descclassname">IOLoop.</code><code class="descname">add_callback_from_signal</code><span class="sig-paren">(</span><em>callback</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.add_callback_from_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.add_callback_from_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls the given callback on the next I/O loop iteration.</p>
<p>Safe for use from a Python signal handler; should not be used
otherwise.</p>
<p>Callbacks added with this method will be run without any
<a class="reference internal" href="index.html#module-tornado.stack_context" title="tornado.stack_context"><code class="xref py py-obj docutils literal"><span class="pre">stack_context</span></code></a>, to avoid picking up the context of the function
that was interrupted by the signal.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.add_future">
<code class="descclassname">IOLoop.</code><code class="descname">add_future</code><span class="sig-paren">(</span><em>future</em>, <em>callback</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.add_future"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.add_future" title="Permalink to this definition">¶</a></dt>
<dd><p>Schedules a callback on the <code class="docutils literal"><span class="pre">IOLoop</span></code> when the given
<a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> is finished.</p>
<p>The callback is invoked with one argument, the
<a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.add_timeout">
<code class="descclassname">IOLoop.</code><code class="descname">add_timeout</code><span class="sig-paren">(</span><em>deadline</em>, <em>callback</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.add_timeout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.add_timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the <code class="docutils literal"><span class="pre">callback</span></code> at the time <code class="docutils literal"><span class="pre">deadline</span></code> from the I/O loop.</p>
<p>Returns an opaque handle that may be passed to
<a class="reference internal" href="#tornado.ioloop.IOLoop.remove_timeout" title="tornado.ioloop.IOLoop.remove_timeout"><code class="xref py py-obj docutils literal"><span class="pre">remove_timeout</span></code></a> to cancel.</p>
<p><code class="docutils literal"><span class="pre">deadline</span></code> may be a number denoting a time (on the same
scale as <a class="reference internal" href="#tornado.ioloop.IOLoop.time" title="tornado.ioloop.IOLoop.time"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.time</span></code></a>, normally <a class="reference external" href="https://docs.python.org/3.4/library/time.html#time.time" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">time.time</span></code></a>), or a
<a class="reference external" href="https://docs.python.org/3.4/library/datetime.html#datetime.timedelta" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">datetime.timedelta</span></code></a> object for a deadline relative to the
current time.  Since Tornado 4.0, <a class="reference internal" href="#tornado.ioloop.IOLoop.call_later" title="tornado.ioloop.IOLoop.call_later"><code class="xref py py-obj docutils literal"><span class="pre">call_later</span></code></a> is a more
convenient alternative for the relative case since it does not
require a timedelta object.</p>
<p>Note that it is not safe to call <a class="reference internal" href="#tornado.ioloop.IOLoop.add_timeout" title="tornado.ioloop.IOLoop.add_timeout"><code class="xref py py-obj docutils literal"><span class="pre">add_timeout</span></code></a> from other threads.
Instead, you must use <a class="reference internal" href="#tornado.ioloop.IOLoop.add_callback" title="tornado.ioloop.IOLoop.add_callback"><code class="xref py py-obj docutils literal"><span class="pre">add_callback</span></code></a> to transfer control to the
<a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>&#8216;s thread, and then call <a class="reference internal" href="#tornado.ioloop.IOLoop.add_timeout" title="tornado.ioloop.IOLoop.add_timeout"><code class="xref py py-obj docutils literal"><span class="pre">add_timeout</span></code></a> from there.</p>
<p>Subclasses of IOLoop must implement either <a class="reference internal" href="#tornado.ioloop.IOLoop.add_timeout" title="tornado.ioloop.IOLoop.add_timeout"><code class="xref py py-obj docutils literal"><span class="pre">add_timeout</span></code></a> or
<a class="reference internal" href="#tornado.ioloop.IOLoop.call_at" title="tornado.ioloop.IOLoop.call_at"><code class="xref py py-obj docutils literal"><span class="pre">call_at</span></code></a>; the default implementations of each will call
the other.  <a class="reference internal" href="#tornado.ioloop.IOLoop.call_at" title="tornado.ioloop.IOLoop.call_at"><code class="xref py py-obj docutils literal"><span class="pre">call_at</span></code></a> is usually easier to implement, but
subclasses that wish to maintain compatibility with Tornado
versions prior to 4.0 must use <a class="reference internal" href="#tornado.ioloop.IOLoop.add_timeout" title="tornado.ioloop.IOLoop.add_timeout"><code class="xref py py-obj docutils literal"><span class="pre">add_timeout</span></code></a> instead.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>Now passes through <code class="docutils literal"><span class="pre">*args</span></code> and <code class="docutils literal"><span class="pre">**kwargs</span></code> to the callback.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.call_at">
<code class="descclassname">IOLoop.</code><code class="descname">call_at</code><span class="sig-paren">(</span><em>when</em>, <em>callback</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.call_at"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.call_at" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the <code class="docutils literal"><span class="pre">callback</span></code> at the absolute time designated by <code class="docutils literal"><span class="pre">when</span></code>.</p>
<p><code class="docutils literal"><span class="pre">when</span></code> must be a number using the same reference point as
<a class="reference internal" href="#tornado.ioloop.IOLoop.time" title="tornado.ioloop.IOLoop.time"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.time</span></code></a>.</p>
<p>Returns an opaque handle that may be passed to <a class="reference internal" href="#tornado.ioloop.IOLoop.remove_timeout" title="tornado.ioloop.IOLoop.remove_timeout"><code class="xref py py-obj docutils literal"><span class="pre">remove_timeout</span></code></a>
to cancel.  Note that unlike the <a class="reference external" href="https://docs.python.org/3.4/library/asyncio.html#module-asyncio" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">asyncio</span></code></a> method of the same
name, the returned object does not have a <code class="docutils literal"><span class="pre">cancel()</span></code> method.</p>
<p>See <a class="reference internal" href="#tornado.ioloop.IOLoop.add_timeout" title="tornado.ioloop.IOLoop.add_timeout"><code class="xref py py-obj docutils literal"><span class="pre">add_timeout</span></code></a> for comments on thread-safety and subclassing.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.call_later">
<code class="descclassname">IOLoop.</code><code class="descname">call_later</code><span class="sig-paren">(</span><em>delay</em>, <em>callback</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.call_later"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.call_later" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the <code class="docutils literal"><span class="pre">callback</span></code> after <code class="docutils literal"><span class="pre">delay</span></code> seconds have passed.</p>
<p>Returns an opaque handle that may be passed to <a class="reference internal" href="#tornado.ioloop.IOLoop.remove_timeout" title="tornado.ioloop.IOLoop.remove_timeout"><code class="xref py py-obj docutils literal"><span class="pre">remove_timeout</span></code></a>
to cancel.  Note that unlike the <a class="reference external" href="https://docs.python.org/3.4/library/asyncio.html#module-asyncio" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">asyncio</span></code></a> method of the same
name, the returned object does not have a <code class="docutils literal"><span class="pre">cancel()</span></code> method.</p>
<p>See <a class="reference internal" href="#tornado.ioloop.IOLoop.add_timeout" title="tornado.ioloop.IOLoop.add_timeout"><code class="xref py py-obj docutils literal"><span class="pre">add_timeout</span></code></a> for comments on thread-safety and subclassing.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.remove_timeout">
<code class="descclassname">IOLoop.</code><code class="descname">remove_timeout</code><span class="sig-paren">(</span><em>timeout</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.remove_timeout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.remove_timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Cancels a pending timeout.</p>
<p>The argument is a handle as returned by <a class="reference internal" href="#tornado.ioloop.IOLoop.add_timeout" title="tornado.ioloop.IOLoop.add_timeout"><code class="xref py py-obj docutils literal"><span class="pre">add_timeout</span></code></a>.  It is
safe to call <a class="reference internal" href="#tornado.ioloop.IOLoop.remove_timeout" title="tornado.ioloop.IOLoop.remove_timeout"><code class="xref py py-obj docutils literal"><span class="pre">remove_timeout</span></code></a> even if the callback has already
been run.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.spawn_callback">
<code class="descclassname">IOLoop.</code><code class="descname">spawn_callback</code><span class="sig-paren">(</span><em>callback</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.spawn_callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.spawn_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls the given callback on the next IOLoop iteration.</p>
<p>Unlike all other callback-related methods on IOLoop,
<code class="docutils literal"><span class="pre">spawn_callback</span></code> does not associate the callback with its caller&#8217;s
<code class="docutils literal"><span class="pre">stack_context</span></code>, so it is suitable for fire-and-forget callbacks
that should not interfere with the caller.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.time">
<code class="descclassname">IOLoop.</code><code class="descname">time</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.time" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the current time according to the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>&#8216;s clock.</p>
<p>The return value is a floating-point number relative to an
unspecified time in the past.</p>
<p>By default, the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>&#8216;s time function is <a class="reference external" href="https://docs.python.org/3.4/library/time.html#time.time" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">time.time</span></code></a>.  However,
it may be configured to use e.g. <a class="reference external" href="https://docs.python.org/3.4/library/time.html#time.monotonic" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">time.monotonic</span></code></a> instead.
Calls to <a class="reference internal" href="#tornado.ioloop.IOLoop.add_timeout" title="tornado.ioloop.IOLoop.add_timeout"><code class="xref py py-obj docutils literal"><span class="pre">add_timeout</span></code></a> that pass a number instead of a
<a class="reference external" href="https://docs.python.org/3.4/library/datetime.html#datetime.timedelta" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">datetime.timedelta</span></code></a> should use this function to compute the
appropriate time, so they can work no matter what time function
is chosen.</p>
</dd></dl>

<dl class="class">
<dt id="tornado.ioloop.PeriodicCallback">
<em class="property">class </em><code class="descclassname">tornado.ioloop.</code><code class="descname">PeriodicCallback</code><span class="sig-paren">(</span><em>callback</em>, <em>callback_time</em>, <em>io_loop=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#PeriodicCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.PeriodicCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Schedules the given callback to be called periodically.</p>
<p>The callback is called every <code class="docutils literal"><span class="pre">callback_time</span></code> milliseconds.
Note that the timeout is given in milliseconds, while most other
time-related functions in Tornado use seconds.</p>
<p>If the callback runs for longer than <code class="docutils literal"><span class="pre">callback_time</span></code> milliseconds,
subsequent invocations will be skipped to get back on schedule.</p>
<p><a class="reference internal" href="#tornado.ioloop.PeriodicCallback.start" title="tornado.ioloop.PeriodicCallback.start"><code class="xref py py-obj docutils literal"><span class="pre">start</span></code></a> must be called after the <a class="reference internal" href="#tornado.ioloop.PeriodicCallback" title="tornado.ioloop.PeriodicCallback"><code class="xref py py-obj docutils literal"><span class="pre">PeriodicCallback</span></code></a> is created.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>The <code class="docutils literal"><span class="pre">io_loop</span></code> argument is deprecated.</p>
</div>
<dl class="method">
<dt id="tornado.ioloop.PeriodicCallback.start">
<code class="descname">start</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#PeriodicCallback.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.PeriodicCallback.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts the timer.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.PeriodicCallback.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#PeriodicCallback.stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.PeriodicCallback.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stops the timer.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.PeriodicCallback.is_running">
<code class="descname">is_running</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#PeriodicCallback.is_running"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.PeriodicCallback.is_running" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this <a class="reference internal" href="#tornado.ioloop.PeriodicCallback" title="tornado.ioloop.PeriodicCallback"><code class="xref py py-obj docutils literal"><span class="pre">PeriodicCallback</span></code></a> has been started.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.1.</span></p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="debugging-and-error-handling">
<h6>Debugging and error handling<a class="headerlink" href="#debugging-and-error-handling" title="Permalink to this headline">¶</a></h6>
<dl class="method">
<dt id="tornado.ioloop.IOLoop.handle_callback_exception">
<code class="descclassname">IOLoop.</code><code class="descname">handle_callback_exception</code><span class="sig-paren">(</span><em>callback</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.handle_callback_exception"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.handle_callback_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is called whenever a callback run by the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>
throws an exception.</p>
<p>By default simply logs the exception as an error.  Subclasses
may override this method to customize reporting of exceptions.</p>
<p>The exception itself is not passed explicitly, but is available
in <a class="reference external" href="https://docs.python.org/3.4/library/sys.html#sys.exc_info" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">sys.exc_info</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.set_blocking_signal_threshold">
<code class="descclassname">IOLoop.</code><code class="descname">set_blocking_signal_threshold</code><span class="sig-paren">(</span><em>seconds</em>, <em>action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.set_blocking_signal_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.set_blocking_signal_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends a signal if the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> is blocked for more than
<code class="docutils literal"><span class="pre">s</span></code> seconds.</p>
<p>Pass <code class="docutils literal"><span class="pre">seconds=None</span></code> to disable.  Requires Python 2.6 on a unixy
platform.</p>
<p>The action parameter is a Python signal handler.  Read the
documentation for the <a class="reference external" href="https://docs.python.org/3.4/library/signal.html#module-signal" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">signal</span></code></a> module for more information.
If <code class="docutils literal"><span class="pre">action</span></code> is None, the process will be killed if it is
blocked for too long.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.set_blocking_log_threshold">
<code class="descclassname">IOLoop.</code><code class="descname">set_blocking_log_threshold</code><span class="sig-paren">(</span><em>seconds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.set_blocking_log_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.set_blocking_log_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs a stack trace if the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> is blocked for more than
<code class="docutils literal"><span class="pre">s</span></code> seconds.</p>
<p>Equivalent to <code class="docutils literal"><span class="pre">set_blocking_signal_threshold(seconds,</span>
<span class="pre">self.log_stack)</span></code></p>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.log_stack">
<code class="descclassname">IOLoop.</code><code class="descname">log_stack</code><span class="sig-paren">(</span><em>signal</em>, <em>frame</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.log_stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.log_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Signal handler to log the stack trace of the current thread.</p>
<p>For use with <a class="reference internal" href="#tornado.ioloop.IOLoop.set_blocking_signal_threshold" title="tornado.ioloop.IOLoop.set_blocking_signal_threshold"><code class="xref py py-obj docutils literal"><span class="pre">set_blocking_signal_threshold</span></code></a>.</p>
</dd></dl>

</div>
<div class="section" id="methods-for-subclasses">
<h6>Methods for subclasses<a class="headerlink" href="#methods-for-subclasses" title="Permalink to this headline">¶</a></h6>
<dl class="method">
<dt id="tornado.ioloop.IOLoop.initialize">
<code class="descclassname">IOLoop.</code><code class="descname">initialize</code><span class="sig-paren">(</span><em>make_current=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.initialize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.close_fd">
<code class="descclassname">IOLoop.</code><code class="descname">close_fd</code><span class="sig-paren">(</span><em>fd</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.close_fd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.close_fd" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility method to close an <code class="docutils literal"><span class="pre">fd</span></code>.</p>
<p>If <code class="docutils literal"><span class="pre">fd</span></code> is a file-like object, we close it directly; otherwise
we use <a class="reference external" href="https://docs.python.org/3.4/library/os.html#os.close" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">os.close</span></code></a>.</p>
<p>This method is provided for use by <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> subclasses (in
implementations of <code class="docutils literal"><span class="pre">IOLoop.close(all_fds=True)</span></code> and should
not generally be used by application code.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.ioloop.IOLoop.split_fd">
<code class="descclassname">IOLoop.</code><code class="descname">split_fd</code><span class="sig-paren">(</span><em>fd</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/ioloop.html#IOLoop.split_fd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.ioloop.IOLoop.split_fd" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an (fd, obj) pair from an <code class="docutils literal"><span class="pre">fd</span></code> parameter.</p>
<p>We accept both raw file descriptors and file-like objects as
input to <a class="reference internal" href="#tornado.ioloop.IOLoop.add_handler" title="tornado.ioloop.IOLoop.add_handler"><code class="xref py py-obj docutils literal"><span class="pre">add_handler</span></code></a> and related methods.  When a file-like
object is passed, we must retain the object itself so we can
close it correctly when the <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> shuts down, but the
poller interfaces favor file descriptors (they will accept
file-like objects and call <code class="docutils literal"><span class="pre">fileno()</span></code> for you, but they
always return the descriptor itself).</p>
<p>This method is provided for use by <a class="reference internal" href="#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> subclasses and should
not generally be used by application code.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
</dd></dl>

</div>
</div>
</div>
<span id="document-iostream"></span><div class="section" id="module-tornado.iostream">
<span id="tornado-iostream-convenient-wrappers-for-non-blocking-sockets"></span><h4><code class="docutils literal"><span class="pre">tornado.iostream</span></code> &#8212; Convenient wrappers for non-blocking sockets<a class="headerlink" href="#module-tornado.iostream" title="Permalink to this headline">¶</a></h4>
<p>Utility classes to write to and read from non-blocking files and sockets.</p>
<p>Contents:</p>
<ul class="simple">
<li><a class="reference internal" href="#tornado.iostream.BaseIOStream" title="tornado.iostream.BaseIOStream"><code class="xref py py-obj docutils literal"><span class="pre">BaseIOStream</span></code></a>: Generic interface for reading and writing.</li>
<li><a class="reference internal" href="#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a>: Implementation of BaseIOStream using non-blocking sockets.</li>
<li><a class="reference internal" href="#tornado.iostream.SSLIOStream" title="tornado.iostream.SSLIOStream"><code class="xref py py-obj docutils literal"><span class="pre">SSLIOStream</span></code></a>: SSL-aware version of IOStream.</li>
<li><a class="reference internal" href="#tornado.iostream.PipeIOStream" title="tornado.iostream.PipeIOStream"><code class="xref py py-obj docutils literal"><span class="pre">PipeIOStream</span></code></a>: Pipe-based IOStream implementation.</li>
</ul>
<div class="section" id="base-class">
<h5>Base class<a class="headerlink" href="#base-class" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.iostream.BaseIOStream">
<em class="property">class </em><code class="descclassname">tornado.iostream.</code><code class="descname">BaseIOStream</code><span class="sig-paren">(</span><em>io_loop=None</em>, <em>max_buffer_size=None</em>, <em>read_chunk_size=None</em>, <em>max_write_buffer_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream" title="Permalink to this definition">¶</a></dt>
<dd><p>A utility class to write to and read from a non-blocking file or socket.</p>
<p>We support a non-blocking <code class="docutils literal"><span class="pre">write()</span></code> and a family of <code class="docutils literal"><span class="pre">read_*()</span></code> methods.
All of the methods take an optional <code class="docutils literal"><span class="pre">callback</span></code> argument and return a
<a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> only if no callback is given.  When the operation completes,
the callback will be run or the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> will resolve with the data
read (or <code class="docutils literal"><span class="pre">None</span></code> for <code class="docutils literal"><span class="pre">write()</span></code>).  All outstanding <code class="docutils literal"><span class="pre">Futures</span></code> will
resolve with a <a class="reference internal" href="#tornado.iostream.StreamClosedError" title="tornado.iostream.StreamClosedError"><code class="xref py py-obj docutils literal"><span class="pre">StreamClosedError</span></code></a> when the stream is closed; users
of the callback interface will be notified via
<a class="reference internal" href="#tornado.iostream.BaseIOStream.set_close_callback" title="tornado.iostream.BaseIOStream.set_close_callback"><code class="xref py py-obj docutils literal"><span class="pre">BaseIOStream.set_close_callback</span></code></a> instead.</p>
<p>When a stream is closed due to an error, the IOStream&#8217;s <code class="docutils literal"><span class="pre">error</span></code>
attribute contains the exception object.</p>
<p>Subclasses must implement <a class="reference internal" href="#tornado.iostream.BaseIOStream.fileno" title="tornado.iostream.BaseIOStream.fileno"><code class="xref py py-obj docutils literal"><span class="pre">fileno</span></code></a>, <a class="reference internal" href="#tornado.iostream.BaseIOStream.close_fd" title="tornado.iostream.BaseIOStream.close_fd"><code class="xref py py-obj docutils literal"><span class="pre">close_fd</span></code></a>, <a class="reference internal" href="#tornado.iostream.BaseIOStream.write_to_fd" title="tornado.iostream.BaseIOStream.write_to_fd"><code class="xref py py-obj docutils literal"><span class="pre">write_to_fd</span></code></a>,
<a class="reference internal" href="#tornado.iostream.BaseIOStream.read_from_fd" title="tornado.iostream.BaseIOStream.read_from_fd"><code class="xref py py-obj docutils literal"><span class="pre">read_from_fd</span></code></a>, and optionally <a class="reference internal" href="#tornado.iostream.BaseIOStream.get_fd_error" title="tornado.iostream.BaseIOStream.get_fd_error"><code class="xref py py-obj docutils literal"><span class="pre">get_fd_error</span></code></a>.</p>
<p><a class="reference internal" href="#tornado.iostream.BaseIOStream" title="tornado.iostream.BaseIOStream"><code class="xref py py-obj docutils literal"><span class="pre">BaseIOStream</span></code></a> constructor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>io_loop</strong> &#8211; The <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> to use; defaults to <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.current" title="tornado.ioloop.IOLoop.current"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.current</span></code></a>.
Deprecated since Tornado 4.1.</li>
<li><strong>max_buffer_size</strong> &#8211; Maximum amount of incoming data to buffer;
defaults to 100MB.</li>
<li><strong>read_chunk_size</strong> &#8211; Amount of data to read at one time from the
underlying transport; defaults to 64KB.</li>
<li><strong>max_write_buffer_size</strong> &#8211; Amount of outgoing data to buffer;
defaults to unlimited.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>Add the <code class="docutils literal"><span class="pre">max_write_buffer_size</span></code> parameter.  Changed default
<code class="docutils literal"><span class="pre">read_chunk_size</span></code> to 64KB.</p>
</div>
</dd></dl>

<div class="section" id="main-interface">
<h6>Main interface<a class="headerlink" href="#main-interface" title="Permalink to this headline">¶</a></h6>
<dl class="method">
<dt id="tornado.iostream.BaseIOStream.write">
<code class="descclassname">BaseIOStream.</code><code class="descname">write</code><span class="sig-paren">(</span><em>data</em>, <em>callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously write the given data to this stream.</p>
<p>If <code class="docutils literal"><span class="pre">callback</span></code> is given, we call it when all of the buffered write
data has been successfully written to the stream. If there was
previously buffered write data and an old write callback, that
callback is simply overwritten with this new callback.</p>
<p>If no <code class="docutils literal"><span class="pre">callback</span></code> is given, this method returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> that
resolves (with a result of <code class="docutils literal"><span class="pre">None</span></code>) when the write has been
completed.  If <a class="reference internal" href="#tornado.iostream.BaseIOStream.write" title="tornado.iostream.BaseIOStream.write"><code class="xref py py-obj docutils literal"><span class="pre">write</span></code></a> is called again before that <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> has
resolved, the previous future will be orphaned and will never resolve.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>Now returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> if no callback is given.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.iostream.BaseIOStream.read_bytes">
<code class="descclassname">BaseIOStream.</code><code class="descname">read_bytes</code><span class="sig-paren">(</span><em>num_bytes</em>, <em>callback=None</em>, <em>streaming_callback=None</em>, <em>partial=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream.read_bytes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream.read_bytes" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously read a number of bytes.</p>
<p>If a <code class="docutils literal"><span class="pre">streaming_callback</span></code> is given, it will be called with chunks
of data as they become available, and the final result will be empty.
Otherwise, the result is all the data that was read.
If a callback is given, it will be run with the data as an argument;
if not, this method returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.</p>
<p>If <code class="docutils literal"><span class="pre">partial</span></code> is true, the callback is run as soon as we have
any bytes to return (but never more than <code class="docutils literal"><span class="pre">num_bytes</span></code>)</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>Added the <code class="docutils literal"><span class="pre">partial</span></code> argument.  The callback argument is now
optional and a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> will be returned if it is omitted.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.iostream.BaseIOStream.read_until">
<code class="descclassname">BaseIOStream.</code><code class="descname">read_until</code><span class="sig-paren">(</span><em>delimiter</em>, <em>callback=None</em>, <em>max_bytes=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream.read_until"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream.read_until" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously read until we have found the given delimiter.</p>
<p>The result includes all the data read including the delimiter.
If a callback is given, it will be run with the data as an argument;
if not, this method returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.</p>
<p>If <code class="docutils literal"><span class="pre">max_bytes</span></code> is not None, the connection will be closed
if more than <code class="docutils literal"><span class="pre">max_bytes</span></code> bytes have been read and the delimiter
is not found.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>Added the <code class="docutils literal"><span class="pre">max_bytes</span></code> argument.  The <code class="docutils literal"><span class="pre">callback</span></code> argument is
now optional and a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> will be returned if it is omitted.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.iostream.BaseIOStream.read_until_regex">
<code class="descclassname">BaseIOStream.</code><code class="descname">read_until_regex</code><span class="sig-paren">(</span><em>regex</em>, <em>callback=None</em>, <em>max_bytes=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream.read_until_regex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream.read_until_regex" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously read until we have matched the given regex.</p>
<p>The result includes the data that matches the regex and anything
that came before it.  If a callback is given, it will be run
with the data as an argument; if not, this method returns a
<a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.</p>
<p>If <code class="docutils literal"><span class="pre">max_bytes</span></code> is not None, the connection will be closed
if more than <code class="docutils literal"><span class="pre">max_bytes</span></code> bytes have been read and the regex is
not satisfied.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>Added the <code class="docutils literal"><span class="pre">max_bytes</span></code> argument.  The <code class="docutils literal"><span class="pre">callback</span></code> argument is
now optional and a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> will be returned if it is omitted.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.iostream.BaseIOStream.read_until_close">
<code class="descclassname">BaseIOStream.</code><code class="descname">read_until_close</code><span class="sig-paren">(</span><em>callback=None</em>, <em>streaming_callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream.read_until_close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream.read_until_close" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously reads all data from the socket until it is closed.</p>
<p>If a <code class="docutils literal"><span class="pre">streaming_callback</span></code> is given, it will be called with chunks
of data as they become available, and the final result will be empty.
Otherwise, the result is all the data that was read.
If a callback is given, it will be run with the data as an argument;
if not, this method returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.</p>
<p>Note that if a <code class="docutils literal"><span class="pre">streaming_callback</span></code> is used, data will be
read from the socket as quickly as it becomes available; there
is no way to apply backpressure or cancel the reads. If flow
control or cancellation are desired, use a loop with
<a class="reference internal" href="#tornado.iostream.BaseIOStream.read_bytes" title="tornado.iostream.BaseIOStream.read_bytes"><code class="xref py py-obj docutils literal"><span class="pre">read_bytes(partial=True)</span></code></a> instead.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>The callback argument is now optional and a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> will
be returned if it is omitted.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.iostream.BaseIOStream.close">
<code class="descclassname">BaseIOStream.</code><code class="descname">close</code><span class="sig-paren">(</span><em>exc_info=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close this stream.</p>
<p>If <code class="docutils literal"><span class="pre">exc_info</span></code> is true, set the <code class="docutils literal"><span class="pre">error</span></code> attribute to the current
exception from <a class="reference external" href="https://docs.python.org/3.4/library/sys.html#sys.exc_info" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">sys.exc_info</span></code></a> (or if <code class="docutils literal"><span class="pre">exc_info</span></code> is a tuple,
use that instead of <a class="reference external" href="https://docs.python.org/3.4/library/sys.html#sys.exc_info" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">sys.exc_info</span></code></a>).</p>
</dd></dl>

<dl class="method">
<dt id="tornado.iostream.BaseIOStream.set_close_callback">
<code class="descclassname">BaseIOStream.</code><code class="descname">set_close_callback</code><span class="sig-paren">(</span><em>callback</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream.set_close_callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream.set_close_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Call the given callback when the stream is closed.</p>
<p>This is not necessary for applications that use the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>
interface; all outstanding <code class="docutils literal"><span class="pre">Futures</span></code> will resolve with a
<a class="reference internal" href="#tornado.iostream.StreamClosedError" title="tornado.iostream.StreamClosedError"><code class="xref py py-obj docutils literal"><span class="pre">StreamClosedError</span></code></a> when the stream is closed.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.iostream.BaseIOStream.closed">
<code class="descclassname">BaseIOStream.</code><code class="descname">closed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream.closed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream.closed" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if the stream has been closed.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.iostream.BaseIOStream.reading">
<code class="descclassname">BaseIOStream.</code><code class="descname">reading</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream.reading"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream.reading" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if we are currently reading from the stream.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.iostream.BaseIOStream.writing">
<code class="descclassname">BaseIOStream.</code><code class="descname">writing</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream.writing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream.writing" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if we are currently writing to the stream.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.iostream.BaseIOStream.set_nodelay">
<code class="descclassname">BaseIOStream.</code><code class="descname">set_nodelay</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream.set_nodelay"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream.set_nodelay" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the no-delay flag for this stream.</p>
<p>By default, data written to TCP streams may be held for a time
to make the most efficient use of bandwidth (according to
Nagle&#8217;s algorithm).  The no-delay flag requests that data be
written as soon as possible, even if doing so would consume
additional bandwidth.</p>
<p>This flag is currently defined only for TCP-based <code class="docutils literal"><span class="pre">IOStreams</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

</div>
<div class="section" id="methods-for-subclasses">
<h6>Methods for subclasses<a class="headerlink" href="#methods-for-subclasses" title="Permalink to this headline">¶</a></h6>
<dl class="method">
<dt id="tornado.iostream.BaseIOStream.fileno">
<code class="descclassname">BaseIOStream.</code><code class="descname">fileno</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream.fileno"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream.fileno" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the file descriptor for this stream.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.iostream.BaseIOStream.close_fd">
<code class="descclassname">BaseIOStream.</code><code class="descname">close_fd</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream.close_fd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream.close_fd" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes the file underlying this stream.</p>
<p><code class="docutils literal"><span class="pre">close_fd</span></code> is called by <a class="reference internal" href="#tornado.iostream.BaseIOStream" title="tornado.iostream.BaseIOStream"><code class="xref py py-obj docutils literal"><span class="pre">BaseIOStream</span></code></a> and should not be called
elsewhere; other users should call <a class="reference internal" href="#tornado.iostream.BaseIOStream.close" title="tornado.iostream.BaseIOStream.close"><code class="xref py py-obj docutils literal"><span class="pre">close</span></code></a> instead.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.iostream.BaseIOStream.write_to_fd">
<code class="descclassname">BaseIOStream.</code><code class="descname">write_to_fd</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream.write_to_fd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream.write_to_fd" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to write <code class="docutils literal"><span class="pre">data</span></code> to the underlying file.</p>
<p>Returns the number of bytes written.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.iostream.BaseIOStream.read_from_fd">
<code class="descclassname">BaseIOStream.</code><code class="descname">read_from_fd</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream.read_from_fd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream.read_from_fd" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempts to read from the underlying file.</p>
<p>Returns <code class="docutils literal"><span class="pre">None</span></code> if there was nothing to read (the socket
returned <a class="reference external" href="https://docs.python.org/3.4/library/errno.html#errno.EWOULDBLOCK" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">EWOULDBLOCK</span></code></a> or equivalent), otherwise
returns the data.  When possible, should return no more than
<code class="docutils literal"><span class="pre">self.read_chunk_size</span></code> bytes at a time.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.iostream.BaseIOStream.get_fd_error">
<code class="descclassname">BaseIOStream.</code><code class="descname">get_fd_error</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#BaseIOStream.get_fd_error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.BaseIOStream.get_fd_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns information about any error on the underlying file.</p>
<p>This method is called after the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> has signaled an error on the
file descriptor, and should return an Exception (such as <a class="reference external" href="https://docs.python.org/3.4/library/socket.html#socket.error" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">socket.error</span></code></a>
with additional information, or None if no such information is
available.</p>
</dd></dl>

</div>
</div>
<div class="section" id="implementations">
<h5>Implementations<a class="headerlink" href="#implementations" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.iostream.IOStream">
<em class="property">class </em><code class="descclassname">tornado.iostream.</code><code class="descname">IOStream</code><span class="sig-paren">(</span><em>socket</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#IOStream"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.IOStream" title="Permalink to this definition">¶</a></dt>
<dd><p>Socket-based <a class="reference internal" href="#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> implementation.</p>
<p>This class supports the read and write methods from <a class="reference internal" href="#tornado.iostream.BaseIOStream" title="tornado.iostream.BaseIOStream"><code class="xref py py-obj docutils literal"><span class="pre">BaseIOStream</span></code></a>
plus a <a class="reference internal" href="#tornado.iostream.IOStream.connect" title="tornado.iostream.IOStream.connect"><code class="xref py py-obj docutils literal"><span class="pre">connect</span></code></a> method.</p>
<p>The <code class="docutils literal"><span class="pre">socket</span></code> parameter may either be connected or unconnected.
For server operations the socket is the result of calling
<a class="reference external" href="https://docs.python.org/3.4/library/socket.html#socket.socket.accept" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">socket.accept</span></code></a>.  For client operations the
socket is created with <a class="reference external" href="https://docs.python.org/3.4/library/socket.html#socket.socket" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">socket.socket</span></code></a>, and may either be
connected before passing it to the <a class="reference internal" href="#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> or connected with
<a class="reference internal" href="#tornado.iostream.IOStream.connect" title="tornado.iostream.IOStream.connect"><code class="xref py py-obj docutils literal"><span class="pre">IOStream.connect</span></code></a>.</p>
<p>A very simple (and broken) HTTP client using this class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">tornado.ioloop</span>
<span class="kn">import</span> <span class="nn">tornado.iostream</span>
<span class="kn">import</span> <span class="nn">socket</span>

<span class="k">def</span> <span class="nf">send_request</span><span class="p">():</span>
    <span class="n">stream</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;GET / HTTP/1.0</span><span class="se">\r\n</span><span class="s">Host: friendfeed.com</span><span class="se">\r\n\r\n</span><span class="s">&quot;</span><span class="p">)</span>
    <span class="n">stream</span><span class="o">.</span><span class="n">read_until</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;</span><span class="se">\r\n\r\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">on_headers</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">on_headers</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">):</span>
       <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">b</span><span class="s">&quot;:&quot;</span><span class="p">)</span>
       <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
           <span class="n">headers</span><span class="p">[</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">stream</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">headers</span><span class="p">[</span><span class="n">b</span><span class="s">&quot;Content-Length&quot;</span><span class="p">]),</span> <span class="n">on_body</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">on_body</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">tornado</span><span class="o">.</span><span class="n">ioloop</span><span class="o">.</span><span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">stream</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">iostream</span><span class="o">.</span><span class="n">IOStream</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">stream</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s">&quot;friendfeed.com&quot;</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="n">send_request</span><span class="p">)</span>
    <span class="n">tornado</span><span class="o">.</span><span class="n">ioloop</span><span class="o">.</span><span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="tornado.iostream.IOStream.connect">
<code class="descname">connect</code><span class="sig-paren">(</span><em>address</em>, <em>callback=None</em>, <em>server_hostname=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#IOStream.connect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.IOStream.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Connects the socket to a remote address without blocking.</p>
<p>May only be called if the socket passed to the constructor was
not previously connected.  The address parameter is in the
same format as for <a class="reference external" href="https://docs.python.org/3.4/library/socket.html#socket.socket.connect" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">socket.connect</span></code></a> for
the type of socket passed to the IOStream constructor,
e.g. an <code class="docutils literal"><span class="pre">(ip,</span> <span class="pre">port)</span></code> tuple.  Hostnames are accepted here,
but will be resolved synchronously and block the IOLoop.
If you have a hostname instead of an IP address, the <a class="reference internal" href="index.html#tornado.tcpclient.TCPClient" title="tornado.tcpclient.TCPClient"><code class="xref py py-obj docutils literal"><span class="pre">TCPClient</span></code></a>
class is recommended instead of calling this method directly.
<a class="reference internal" href="index.html#tornado.tcpclient.TCPClient" title="tornado.tcpclient.TCPClient"><code class="xref py py-obj docutils literal"><span class="pre">TCPClient</span></code></a> will do asynchronous DNS resolution and handle
both IPv4 and IPv6.</p>
<p>If <code class="docutils literal"><span class="pre">callback</span></code> is specified, it will be called with no
arguments when the connection is completed; if not this method
returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> (whose result after a successful
connection will be the stream itself).</p>
<p>In SSL mode, the <code class="docutils literal"><span class="pre">server_hostname</span></code> parameter will be used
for certificate validation (unless disabled in the
<code class="docutils literal"><span class="pre">ssl_options</span></code>) and SNI (if supported; requires Python
2.7.9+).</p>
<p>Note that it is safe to call <a class="reference internal" href="#tornado.iostream.BaseIOStream.write" title="tornado.iostream.BaseIOStream.write"><code class="xref py py-obj docutils literal"><span class="pre">IOStream.write</span></code></a> while the connection is pending, in
which case the data will be written as soon as the connection
is ready.  Calling <a class="reference internal" href="#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> read methods before the socket is
connected works on some platforms but is non-portable.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>If no callback is given, returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.2: </span>SSL certificates are validated by default; pass
<code class="docutils literal"><span class="pre">ssl_options=dict(cert_reqs=ssl.CERT_NONE)</span></code> or a
suitably-configured <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.SSLContext</span></code></a> to the
<a class="reference internal" href="#tornado.iostream.SSLIOStream" title="tornado.iostream.SSLIOStream"><code class="xref py py-obj docutils literal"><span class="pre">SSLIOStream</span></code></a> constructor to disable.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.iostream.IOStream.start_tls">
<code class="descname">start_tls</code><span class="sig-paren">(</span><em>server_side</em>, <em>ssl_options=None</em>, <em>server_hostname=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#IOStream.start_tls"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.IOStream.start_tls" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert this <a class="reference internal" href="#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> to an <a class="reference internal" href="#tornado.iostream.SSLIOStream" title="tornado.iostream.SSLIOStream"><code class="xref py py-obj docutils literal"><span class="pre">SSLIOStream</span></code></a>.</p>
<p>This enables protocols that begin in clear-text mode and
switch to SSL after some initial negotiation (such as the
<code class="docutils literal"><span class="pre">STARTTLS</span></code> extension to SMTP and IMAP).</p>
<p>This method cannot be used if there are outstanding reads
or writes on the stream, or if there is any data in the
IOStream&#8217;s buffer (data in the operating system&#8217;s socket
buffer is allowed).  This means it must generally be used
immediately after reading or writing the last clear-text
data.  It can also be used immediately after connecting,
before any reads or writes.</p>
<p>The <code class="docutils literal"><span class="pre">ssl_options</span></code> argument may be either an <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.SSLContext</span></code></a>
object or a dictionary of keyword arguments for the
<a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.wrap_socket" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.wrap_socket</span></code></a> function.  The <code class="docutils literal"><span class="pre">server_hostname</span></code> argument
will be used for certificate validation unless disabled
in the <code class="docutils literal"><span class="pre">ssl_options</span></code>.</p>
<p>This method returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> whose result is the new
<a class="reference internal" href="#tornado.iostream.SSLIOStream" title="tornado.iostream.SSLIOStream"><code class="xref py py-obj docutils literal"><span class="pre">SSLIOStream</span></code></a>.  After this method has been called,
any other operation on the original stream is undefined.</p>
<p>If a close callback is defined on this stream, it will be
transferred to the new stream.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.2: </span>SSL certificates are validated by default; pass
<code class="docutils literal"><span class="pre">ssl_options=dict(cert_reqs=ssl.CERT_NONE)</span></code> or a
suitably-configured <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.SSLContext</span></code></a> to disable.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.iostream.SSLIOStream">
<em class="property">class </em><code class="descclassname">tornado.iostream.</code><code class="descname">SSLIOStream</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#SSLIOStream"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.SSLIOStream" title="Permalink to this definition">¶</a></dt>
<dd><p>A utility class to write to and read from a non-blocking SSL socket.</p>
<p>If the socket passed to the constructor is already connected,
it should be wrapped with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ssl</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">sock</span><span class="p">,</span> <span class="n">do_handshake_on_connect</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>before constructing the <a class="reference internal" href="#tornado.iostream.SSLIOStream" title="tornado.iostream.SSLIOStream"><code class="xref py py-obj docutils literal"><span class="pre">SSLIOStream</span></code></a>.  Unconnected sockets will be
wrapped when <a class="reference internal" href="#tornado.iostream.IOStream.connect" title="tornado.iostream.IOStream.connect"><code class="xref py py-obj docutils literal"><span class="pre">IOStream.connect</span></code></a> is finished.</p>
<p>The <code class="docutils literal"><span class="pre">ssl_options</span></code> keyword argument may either be an
<a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.SSLContext</span></code></a> object or a dictionary of keywords arguments
for <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.wrap_socket" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.wrap_socket</span></code></a></p>
<dl class="method">
<dt id="tornado.iostream.SSLIOStream.wait_for_handshake">
<code class="descname">wait_for_handshake</code><span class="sig-paren">(</span><em>callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#SSLIOStream.wait_for_handshake"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.SSLIOStream.wait_for_handshake" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait for the initial SSL handshake to complete.</p>
<p>If a <code class="docutils literal"><span class="pre">callback</span></code> is given, it will be called with no
arguments once the handshake is complete; otherwise this
method returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> which will resolve to the
stream itself after the handshake is complete.</p>
<p>Once the handshake is complete, information such as
the peer&#8217;s certificate and NPN/ALPN selections may be
accessed on <code class="docutils literal"><span class="pre">self.socket</span></code>.</p>
<p>This method is intended for use on server-side streams
or after using <a class="reference internal" href="#tornado.iostream.IOStream.start_tls" title="tornado.iostream.IOStream.start_tls"><code class="xref py py-obj docutils literal"><span class="pre">IOStream.start_tls</span></code></a>; it should not be used
with <a class="reference internal" href="#tornado.iostream.IOStream.connect" title="tornado.iostream.IOStream.connect"><code class="xref py py-obj docutils literal"><span class="pre">IOStream.connect</span></code></a> (which already waits for the
handshake to complete). It may only be called once per stream.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.2.</span></p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.iostream.PipeIOStream">
<em class="property">class </em><code class="descclassname">tornado.iostream.</code><code class="descname">PipeIOStream</code><span class="sig-paren">(</span><em>fd</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#PipeIOStream"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.PipeIOStream" title="Permalink to this definition">¶</a></dt>
<dd><p>Pipe-based <a class="reference internal" href="#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> implementation.</p>
<p>The constructor takes an integer file descriptor (such as one returned
by <a class="reference external" href="https://docs.python.org/3.4/library/os.html#os.pipe" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">os.pipe</span></code></a>) rather than an open file object.  Pipes are generally
one-way, so a <a class="reference internal" href="#tornado.iostream.PipeIOStream" title="tornado.iostream.PipeIOStream"><code class="xref py py-obj docutils literal"><span class="pre">PipeIOStream</span></code></a> can be used for reading or writing but not
both.</p>
</dd></dl>

</div>
<div class="section" id="exceptions">
<h5>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h5>
<dl class="exception">
<dt id="tornado.iostream.StreamBufferFullError">
<em class="property">exception </em><code class="descclassname">tornado.iostream.</code><code class="descname">StreamBufferFullError</code><a class="reference internal" href="_modules/tornado/iostream.html#StreamBufferFullError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.StreamBufferFullError" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised by <a class="reference internal" href="#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> methods when the buffer is full.</p>
</dd></dl>

<dl class="exception">
<dt id="tornado.iostream.StreamClosedError">
<em class="property">exception </em><code class="descclassname">tornado.iostream.</code><code class="descname">StreamClosedError</code><span class="sig-paren">(</span><em>real_error=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/iostream.html#StreamClosedError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.StreamClosedError" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised by <a class="reference internal" href="#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> methods when the stream is closed.</p>
<p>Note that the close callback is scheduled to run <em>after</em> other
callbacks on the stream (to allow for buffered data to be processed),
so you may see this error before you see the close callback.</p>
<p>The <code class="docutils literal"><span class="pre">real_error</span></code> attribute contains the underlying error that caused
the stream to close (if any).</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Added the <code class="docutils literal"><span class="pre">real_error</span></code> attribute.</p>
</div>
</dd></dl>

<dl class="exception">
<dt id="tornado.iostream.UnsatisfiableReadError">
<em class="property">exception </em><code class="descclassname">tornado.iostream.</code><code class="descname">UnsatisfiableReadError</code><a class="reference internal" href="_modules/tornado/iostream.html#UnsatisfiableReadError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.iostream.UnsatisfiableReadError" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised when a read cannot be satisfied.</p>
<p>Raised by <code class="docutils literal"><span class="pre">read_until</span></code> and <code class="docutils literal"><span class="pre">read_until_regex</span></code> with a <code class="docutils literal"><span class="pre">max_bytes</span></code>
argument.</p>
</dd></dl>

</div>
</div>
<span id="document-netutil"></span><div class="section" id="module-tornado.netutil">
<span id="tornado-netutil-miscellaneous-network-utilities"></span><h4><code class="docutils literal"><span class="pre">tornado.netutil</span></code> &#8212; Miscellaneous network utilities<a class="headerlink" href="#module-tornado.netutil" title="Permalink to this headline">¶</a></h4>
<p>Miscellaneous network utility code.</p>
<dl class="function">
<dt id="tornado.netutil.bind_sockets">
<code class="descclassname">tornado.netutil.</code><code class="descname">bind_sockets</code><span class="sig-paren">(</span><em>port</em>, <em>address=None</em>, <em>family=&lt;AddressFamily.AF_UNSPEC: 0&gt;</em>, <em>backlog=128</em>, <em>flags=None</em>, <em>reuse_port=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/netutil.html#bind_sockets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.netutil.bind_sockets" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates listening sockets bound to the given port and address.</p>
<p>Returns a list of socket objects (multiple sockets are returned if
the given address maps to multiple IP addresses, which is most common
for mixed IPv4 and IPv6 use).</p>
<p>Address may be either an IP address or hostname.  If it&#8217;s a hostname,
the server will listen on all IP addresses associated with the
name.  Address may be an empty string or None to listen on all
available interfaces.  Family may be set to either <a class="reference external" href="https://docs.python.org/3.4/library/socket.html#socket.AF_INET" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">socket.AF_INET</span></code></a>
or <a class="reference external" href="https://docs.python.org/3.4/library/socket.html#socket.AF_INET6" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">socket.AF_INET6</span></code></a> to restrict to IPv4 or IPv6 addresses, otherwise
both will be used if available.</p>
<p>The <code class="docutils literal"><span class="pre">backlog</span></code> argument has the same meaning as for
<a class="reference external" href="https://docs.python.org/3.4/library/socket.html#socket.socket.listen" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">socket.listen()</span></code></a>.</p>
<p><code class="docutils literal"><span class="pre">flags</span></code> is a bitmask of AI_* flags to <a class="reference external" href="https://docs.python.org/3.4/library/socket.html#socket.getaddrinfo" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">getaddrinfo</span></code></a>, like
<code class="docutils literal"><span class="pre">socket.AI_PASSIVE</span> <span class="pre">|</span> <span class="pre">socket.AI_NUMERICHOST</span></code>.</p>
<p><code class="docutils literal"><span class="pre">resuse_port</span></code> option sets <code class="docutils literal"><span class="pre">SO_REUSEPORT</span></code> option for every socket
in the list. If your platform doesn&#8217;t support this option ValueError will
be raised.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.netutil.bind_unix_socket">
<code class="descclassname">tornado.netutil.</code><code class="descname">bind_unix_socket</code><span class="sig-paren">(</span><em>file</em>, <em>mode=384</em>, <em>backlog=128</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/netutil.html#bind_unix_socket"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.netutil.bind_unix_socket" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a listening unix socket.</p>
<p>If a socket with the given name already exists, it will be deleted.
If any other file with that name exists, an exception will be
raised.</p>
<p>Returns a socket object (not a list of socket objects like
<a class="reference internal" href="#tornado.netutil.bind_sockets" title="tornado.netutil.bind_sockets"><code class="xref py py-obj docutils literal"><span class="pre">bind_sockets</span></code></a>)</p>
</dd></dl>

<dl class="function">
<dt id="tornado.netutil.add_accept_handler">
<code class="descclassname">tornado.netutil.</code><code class="descname">add_accept_handler</code><span class="sig-paren">(</span><em>sock</em>, <em>callback</em>, <em>io_loop=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/netutil.html#add_accept_handler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.netutil.add_accept_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds an <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> event handler to accept new connections on <code class="docutils literal"><span class="pre">sock</span></code>.</p>
<p>When a connection is accepted, <code class="docutils literal"><span class="pre">callback(connection,</span> <span class="pre">address)</span></code> will
be run (<code class="docutils literal"><span class="pre">connection</span></code> is a socket object, and <code class="docutils literal"><span class="pre">address</span></code> is the
address of the other end of the connection).  Note that this signature
is different from the <code class="docutils literal"><span class="pre">callback(fd,</span> <span class="pre">events)</span></code> signature used for
<a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> handlers.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>The <code class="docutils literal"><span class="pre">io_loop</span></code> argument is deprecated.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.netutil.is_valid_ip">
<code class="descclassname">tornado.netutil.</code><code class="descname">is_valid_ip</code><span class="sig-paren">(</span><em>ip</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/netutil.html#is_valid_ip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.netutil.is_valid_ip" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if the given string is a well-formed IP address.</p>
<p>Supports IPv4 and IPv6.</p>
</dd></dl>

<dl class="class">
<dt id="tornado.netutil.Resolver">
<em class="property">class </em><code class="descclassname">tornado.netutil.</code><code class="descname">Resolver</code><a class="reference internal" href="_modules/tornado/netutil.html#Resolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.netutil.Resolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Configurable asynchronous DNS resolver interface.</p>
<p>By default, a blocking implementation is used (which simply calls
<a class="reference external" href="https://docs.python.org/3.4/library/socket.html#socket.getaddrinfo" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">socket.getaddrinfo</span></code></a>).  An alternative implementation can be
chosen with the <a class="reference internal" href="index.html#tornado.util.Configurable.configure" title="tornado.util.Configurable.configure"><code class="xref py py-obj docutils literal"><span class="pre">Resolver.configure</span></code></a>
class method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Resolver</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s">&#39;tornado.netutil.ThreadedResolver&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The implementations of this interface included with Tornado are</p>
<ul class="simple">
<li><a class="reference internal" href="#tornado.netutil.BlockingResolver" title="tornado.netutil.BlockingResolver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil.BlockingResolver</span></code></a></li>
<li><a class="reference internal" href="#tornado.netutil.ThreadedResolver" title="tornado.netutil.ThreadedResolver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil.ThreadedResolver</span></code></a></li>
<li><a class="reference internal" href="#tornado.netutil.OverrideResolver" title="tornado.netutil.OverrideResolver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil.OverrideResolver</span></code></a></li>
<li><a class="reference internal" href="index.html#tornado.platform.twisted.TwistedResolver" title="tornado.platform.twisted.TwistedResolver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.twisted.TwistedResolver</span></code></a></li>
<li><a class="reference internal" href="index.html#tornado.platform.caresresolver.CaresResolver" title="tornado.platform.caresresolver.CaresResolver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.caresresolver.CaresResolver</span></code></a></li>
</ul>
<dl class="method">
<dt id="tornado.netutil.Resolver.resolve">
<code class="descname">resolve</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>family=&lt;AddressFamily.AF_UNSPEC: 0&gt;</em>, <em>callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/netutil.html#Resolver.resolve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.netutil.Resolver.resolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolves an address.</p>
<p>The <code class="docutils literal"><span class="pre">host</span></code> argument is a string which may be a hostname or a
literal IP address.</p>
<p>Returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> whose result is a list of (family,
address) pairs, where address is a tuple suitable to pass to
<a class="reference external" href="https://docs.python.org/3.4/library/socket.html#socket.socket.connect" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">socket.connect</span></code></a> (i.e. a <code class="docutils literal"><span class="pre">(host,</span>
<span class="pre">port)</span></code> pair for IPv4; additional fields may be present for
IPv6). If a <code class="docutils literal"><span class="pre">callback</span></code> is passed, it will be run with the
result as an argument when it is complete.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.netutil.Resolver.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/netutil.html#Resolver.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.netutil.Resolver.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes the <a class="reference internal" href="#tornado.netutil.Resolver" title="tornado.netutil.Resolver"><code class="xref py py-obj docutils literal"><span class="pre">Resolver</span></code></a>, freeing any resources used.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.netutil.ExecutorResolver">
<em class="property">class </em><code class="descclassname">tornado.netutil.</code><code class="descname">ExecutorResolver</code><a class="reference internal" href="_modules/tornado/netutil.html#ExecutorResolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.netutil.ExecutorResolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolver implementation using a <a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#concurrent.futures.Executor" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures.Executor</span></code></a>.</p>
<p>Use this instead of <a class="reference internal" href="#tornado.netutil.ThreadedResolver" title="tornado.netutil.ThreadedResolver"><code class="xref py py-obj docutils literal"><span class="pre">ThreadedResolver</span></code></a> when you require additional
control over the executor being used.</p>
<p>The executor will be shut down when the resolver is closed unless
<code class="docutils literal"><span class="pre">close_resolver=False</span></code>; use this if you want to reuse the same
executor elsewhere.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>The <code class="docutils literal"><span class="pre">io_loop</span></code> argument is deprecated.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.netutil.BlockingResolver">
<em class="property">class </em><code class="descclassname">tornado.netutil.</code><code class="descname">BlockingResolver</code><a class="reference internal" href="_modules/tornado/netutil.html#BlockingResolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.netutil.BlockingResolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Default <a class="reference internal" href="#tornado.netutil.Resolver" title="tornado.netutil.Resolver"><code class="xref py py-obj docutils literal"><span class="pre">Resolver</span></code></a> implementation, using <a class="reference external" href="https://docs.python.org/3.4/library/socket.html#socket.getaddrinfo" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">socket.getaddrinfo</span></code></a>.</p>
<p>The <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> will be blocked during the resolution, although the
callback will not be run until the next <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> iteration.</p>
</dd></dl>

<dl class="class">
<dt id="tornado.netutil.ThreadedResolver">
<em class="property">class </em><code class="descclassname">tornado.netutil.</code><code class="descname">ThreadedResolver</code><a class="reference internal" href="_modules/tornado/netutil.html#ThreadedResolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.netutil.ThreadedResolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Multithreaded non-blocking <a class="reference internal" href="#tornado.netutil.Resolver" title="tornado.netutil.Resolver"><code class="xref py py-obj docutils literal"><span class="pre">Resolver</span></code></a> implementation.</p>
<p>Requires the <a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#module-concurrent.futures" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures</span></code></a> package to be installed
(available in the standard library since Python 3.2,
installable with <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">futures</span></code> in older versions).</p>
<p>The thread pool size can be configured with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Resolver</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s">&#39;tornado.netutil.ThreadedResolver&#39;</span><span class="p">,</span>
                   <span class="n">num_threads</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.1: </span>All <code class="docutils literal"><span class="pre">ThreadedResolvers</span></code> share a single thread pool, whose
size is set by the first one to be created.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.netutil.OverrideResolver">
<em class="property">class </em><code class="descclassname">tornado.netutil.</code><code class="descname">OverrideResolver</code><a class="reference internal" href="_modules/tornado/netutil.html#OverrideResolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.netutil.OverrideResolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Wraps a resolver with a mapping of overrides.</p>
<p>This can be used to make local DNS changes (e.g. for testing)
without modifying system-wide settings.</p>
<p>The mapping can contain either host strings or host-port pairs.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.netutil.ssl_options_to_context">
<code class="descclassname">tornado.netutil.</code><code class="descname">ssl_options_to_context</code><span class="sig-paren">(</span><em>ssl_options</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/netutil.html#ssl_options_to_context"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.netutil.ssl_options_to_context" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to convert an <code class="docutils literal"><span class="pre">ssl_options</span></code> dictionary to an
<a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">SSLContext</span></code></a> object.</p>
<p>The <code class="docutils literal"><span class="pre">ssl_options</span></code> dictionary contains keywords to be passed to
<a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.wrap_socket" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.wrap_socket</span></code></a>.  In Python 2.7.9+, <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.SSLContext</span></code></a> objects can
be used instead.  This function converts the dict form to its
<a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">SSLContext</span></code></a> equivalent, and may be used when a component which
accepts both forms needs to upgrade to the <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">SSLContext</span></code></a> version
to use features like SNI or NPN.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.netutil.ssl_wrap_socket">
<code class="descclassname">tornado.netutil.</code><code class="descname">ssl_wrap_socket</code><span class="sig-paren">(</span><em>socket</em>, <em>ssl_options</em>, <em>server_hostname=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/netutil.html#ssl_wrap_socket"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.netutil.ssl_wrap_socket" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an <code class="docutils literal"><span class="pre">ssl.SSLSocket</span></code> wrapping the given socket.</p>
<p><code class="docutils literal"><span class="pre">ssl_options</span></code> may be either an <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.SSLContext</span></code></a> object or a
dictionary (as accepted by <a class="reference internal" href="#tornado.netutil.ssl_options_to_context" title="tornado.netutil.ssl_options_to_context"><code class="xref py py-obj docutils literal"><span class="pre">ssl_options_to_context</span></code></a>).  Additional
keyword arguments are passed to <code class="docutils literal"><span class="pre">wrap_socket</span></code> (either the
<a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">SSLContext</span></code></a> method or the <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#module-ssl" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl</span></code></a> module function as
appropriate).</p>
</dd></dl>

</div>
<span id="document-tcpclient"></span><div class="section" id="module-tornado.tcpclient">
<span id="tornado-tcpclient-iostream-connection-factory"></span><h4><code class="docutils literal"><span class="pre">tornado.tcpclient</span></code> &#8212; <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> connection factory<a class="headerlink" href="#module-tornado.tcpclient" title="Permalink to this headline">¶</a></h4>
<p>A non-blocking TCP connection factory.</p>
<dl class="class">
<dt id="tornado.tcpclient.TCPClient">
<em class="property">class </em><code class="descclassname">tornado.tcpclient.</code><code class="descname">TCPClient</code><span class="sig-paren">(</span><em>resolver=None</em>, <em>io_loop=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/tcpclient.html#TCPClient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.tcpclient.TCPClient" title="Permalink to this definition">¶</a></dt>
<dd><p>A non-blocking TCP connection factory.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>The <code class="docutils literal"><span class="pre">io_loop</span></code> argument is deprecated.</p>
</div>
<dl class="method">
<dt id="tornado.tcpclient.TCPClient.connect">
<code class="descname">connect</code><span class="sig-paren">(</span><em>host</em>, <em>port</em>, <em>af=&lt;AddressFamily.AF_UNSPEC: 0&gt;</em>, <em>ssl_options=None</em>, <em>max_buffer_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/tcpclient.html#TCPClient.connect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.tcpclient.TCPClient.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to the given host and port.</p>
<p>Asynchronously returns an <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> (or <a class="reference internal" href="index.html#tornado.iostream.SSLIOStream" title="tornado.iostream.SSLIOStream"><code class="xref py py-obj docutils literal"><span class="pre">SSLIOStream</span></code></a> if
<code class="docutils literal"><span class="pre">ssl_options</span></code> is not None).</p>
</dd></dl>

</dd></dl>

</div>
<span id="document-tcpserver"></span><div class="section" id="module-tornado.tcpserver">
<span id="tornado-tcpserver-basic-iostream-based-tcp-server"></span><h4><code class="docutils literal"><span class="pre">tornado.tcpserver</span></code> &#8212; Basic <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a>-based TCP server<a class="headerlink" href="#module-tornado.tcpserver" title="Permalink to this headline">¶</a></h4>
<p>A non-blocking, single-threaded TCP server.</p>
<dl class="class">
<dt id="tornado.tcpserver.TCPServer">
<em class="property">class </em><code class="descclassname">tornado.tcpserver.</code><code class="descname">TCPServer</code><span class="sig-paren">(</span><em>io_loop=None</em>, <em>ssl_options=None</em>, <em>max_buffer_size=None</em>, <em>read_chunk_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/tcpserver.html#TCPServer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.tcpserver.TCPServer" title="Permalink to this definition">¶</a></dt>
<dd><p>A non-blocking, single-threaded TCP server.</p>
<p>To use <a class="reference internal" href="#tornado.tcpserver.TCPServer" title="tornado.tcpserver.TCPServer"><code class="xref py py-obj docutils literal"><span class="pre">TCPServer</span></code></a>, define a subclass which overrides the <a class="reference internal" href="#tornado.tcpserver.TCPServer.handle_stream" title="tornado.tcpserver.TCPServer.handle_stream"><code class="xref py py-obj docutils literal"><span class="pre">handle_stream</span></code></a>
method.</p>
<p>To make this server serve SSL traffic, send the <code class="docutils literal"><span class="pre">ssl_options</span></code> keyword
argument with an <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.SSLContext</span></code></a> object. For compatibility with older
versions of Python <code class="docutils literal"><span class="pre">ssl_options</span></code> may also be a dictionary of keyword
arguments for the <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.wrap_socket" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.wrap_socket</span></code></a> method.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ssl_ctx</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">create_default_context</span><span class="p">(</span><span class="n">ssl</span><span class="o">.</span><span class="n">Purpose</span><span class="o">.</span><span class="n">CLIENT_AUTH</span><span class="p">)</span>
<span class="n">ssl_ctx</span><span class="o">.</span><span class="n">load_cert_chain</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s">&quot;mydomain.crt&quot;</span><span class="p">),</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s">&quot;mydomain.key&quot;</span><span class="p">))</span>
<span class="n">TCPServer</span><span class="p">(</span><span class="n">ssl_options</span><span class="o">=</span><span class="n">ssl_ctx</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="#tornado.tcpserver.TCPServer" title="tornado.tcpserver.TCPServer"><code class="xref py py-obj docutils literal"><span class="pre">TCPServer</span></code></a> initialization follows one of three patterns:</p>
<ol class="arabic">
<li><p class="first"><a class="reference internal" href="#tornado.tcpserver.TCPServer.listen" title="tornado.tcpserver.TCPServer.listen"><code class="xref py py-obj docutils literal"><span class="pre">listen</span></code></a>: simple single-process:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">server</span> <span class="o">=</span> <span class="n">TCPServer</span><span class="p">()</span>
<span class="n">server</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">8888</span><span class="p">)</span>
<span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><a class="reference internal" href="#tornado.tcpserver.TCPServer.bind" title="tornado.tcpserver.TCPServer.bind"><code class="xref py py-obj docutils literal"><span class="pre">bind</span></code></a>/<a class="reference internal" href="#tornado.tcpserver.TCPServer.start" title="tornado.tcpserver.TCPServer.start"><code class="xref py py-obj docutils literal"><span class="pre">start</span></code></a>: simple multi-process:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">server</span> <span class="o">=</span> <span class="n">TCPServer</span><span class="p">()</span>
<span class="n">server</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="mi">8888</span><span class="p">)</span>
<span class="n">server</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c"># Forks multiple sub-processes</span>
<span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>When using this interface, an <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> must <em>not</em> be passed
to the <a class="reference internal" href="#tornado.tcpserver.TCPServer" title="tornado.tcpserver.TCPServer"><code class="xref py py-obj docutils literal"><span class="pre">TCPServer</span></code></a> constructor.  <a class="reference internal" href="#tornado.tcpserver.TCPServer.start" title="tornado.tcpserver.TCPServer.start"><code class="xref py py-obj docutils literal"><span class="pre">start</span></code></a> will always start
the server on the default singleton <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>.</p>
</li>
<li><p class="first"><a class="reference internal" href="#tornado.tcpserver.TCPServer.add_sockets" title="tornado.tcpserver.TCPServer.add_sockets"><code class="xref py py-obj docutils literal"><span class="pre">add_sockets</span></code></a>: advanced multi-process:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">sockets</span> <span class="o">=</span> <span class="n">bind_sockets</span><span class="p">(</span><span class="mi">8888</span><span class="p">)</span>
<span class="n">tornado</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">fork_processes</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">TCPServer</span><span class="p">()</span>
<span class="n">server</span><span class="o">.</span><span class="n">add_sockets</span><span class="p">(</span><span class="n">sockets</span><span class="p">)</span>
<span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="#tornado.tcpserver.TCPServer.add_sockets" title="tornado.tcpserver.TCPServer.add_sockets"><code class="xref py py-obj docutils literal"><span class="pre">add_sockets</span></code></a> interface is more complicated, but it can be
used with <a class="reference internal" href="index.html#tornado.process.fork_processes" title="tornado.process.fork_processes"><code class="xref py py-obj docutils literal"><span class="pre">tornado.process.fork_processes</span></code></a> to give you more
flexibility in when the fork happens.  <a class="reference internal" href="#tornado.tcpserver.TCPServer.add_sockets" title="tornado.tcpserver.TCPServer.add_sockets"><code class="xref py py-obj docutils literal"><span class="pre">add_sockets</span></code></a> can
also be used in single-process servers if you want to create
your listening sockets in some way other than
<a class="reference internal" href="index.html#tornado.netutil.bind_sockets" title="tornado.netutil.bind_sockets"><code class="xref py py-obj docutils literal"><span class="pre">bind_sockets</span></code></a>.</p>
</li>
</ol>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1: </span>The <code class="docutils literal"><span class="pre">max_buffer_size</span></code> argument.</p>
</div>
<dl class="method">
<dt id="tornado.tcpserver.TCPServer.listen">
<code class="descname">listen</code><span class="sig-paren">(</span><em>port</em>, <em>address=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/tcpserver.html#TCPServer.listen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.tcpserver.TCPServer.listen" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts accepting connections on the given port.</p>
<p>This method may be called more than once to listen on multiple ports.
<a class="reference internal" href="#tornado.tcpserver.TCPServer.listen" title="tornado.tcpserver.TCPServer.listen"><code class="xref py py-obj docutils literal"><span class="pre">listen</span></code></a> takes effect immediately; it is not necessary to call
<a class="reference internal" href="#tornado.tcpserver.TCPServer.start" title="tornado.tcpserver.TCPServer.start"><code class="xref py py-obj docutils literal"><span class="pre">TCPServer.start</span></code></a> afterwards.  It is, however, necessary to start
the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.tcpserver.TCPServer.add_sockets">
<code class="descname">add_sockets</code><span class="sig-paren">(</span><em>sockets</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/tcpserver.html#TCPServer.add_sockets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.tcpserver.TCPServer.add_sockets" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes this server start accepting connections on the given sockets.</p>
<p>The <code class="docutils literal"><span class="pre">sockets</span></code> parameter is a list of socket objects such as
those returned by <a class="reference internal" href="index.html#tornado.netutil.bind_sockets" title="tornado.netutil.bind_sockets"><code class="xref py py-obj docutils literal"><span class="pre">bind_sockets</span></code></a>.
<a class="reference internal" href="#tornado.tcpserver.TCPServer.add_sockets" title="tornado.tcpserver.TCPServer.add_sockets"><code class="xref py py-obj docutils literal"><span class="pre">add_sockets</span></code></a> is typically used in combination with that
method and <a class="reference internal" href="index.html#tornado.process.fork_processes" title="tornado.process.fork_processes"><code class="xref py py-obj docutils literal"><span class="pre">tornado.process.fork_processes</span></code></a> to provide greater
control over the initialization of a multi-process server.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.tcpserver.TCPServer.add_socket">
<code class="descname">add_socket</code><span class="sig-paren">(</span><em>socket</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/tcpserver.html#TCPServer.add_socket"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.tcpserver.TCPServer.add_socket" title="Permalink to this definition">¶</a></dt>
<dd><p>Singular version of <a class="reference internal" href="#tornado.tcpserver.TCPServer.add_sockets" title="tornado.tcpserver.TCPServer.add_sockets"><code class="xref py py-obj docutils literal"><span class="pre">add_sockets</span></code></a>.  Takes a single socket object.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.tcpserver.TCPServer.bind">
<code class="descname">bind</code><span class="sig-paren">(</span><em>port</em>, <em>address=None</em>, <em>family=&lt;AddressFamily.AF_UNSPEC: 0&gt;</em>, <em>backlog=128</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/tcpserver.html#TCPServer.bind"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.tcpserver.TCPServer.bind" title="Permalink to this definition">¶</a></dt>
<dd><p>Binds this server to the given port on the given address.</p>
<p>To start the server, call <a class="reference internal" href="#tornado.tcpserver.TCPServer.start" title="tornado.tcpserver.TCPServer.start"><code class="xref py py-obj docutils literal"><span class="pre">start</span></code></a>. If you want to run this server
in a single process, you can call <a class="reference internal" href="#tornado.tcpserver.TCPServer.listen" title="tornado.tcpserver.TCPServer.listen"><code class="xref py py-obj docutils literal"><span class="pre">listen</span></code></a> as a shortcut to the
sequence of <a class="reference internal" href="#tornado.tcpserver.TCPServer.bind" title="tornado.tcpserver.TCPServer.bind"><code class="xref py py-obj docutils literal"><span class="pre">bind</span></code></a> and <a class="reference internal" href="#tornado.tcpserver.TCPServer.start" title="tornado.tcpserver.TCPServer.start"><code class="xref py py-obj docutils literal"><span class="pre">start</span></code></a> calls.</p>
<p>Address may be either an IP address or hostname.  If it&#8217;s a hostname,
the server will listen on all IP addresses associated with the
name.  Address may be an empty string or None to listen on all
available interfaces.  Family may be set to either <a class="reference external" href="https://docs.python.org/3.4/library/socket.html#socket.AF_INET" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">socket.AF_INET</span></code></a>
or <a class="reference external" href="https://docs.python.org/3.4/library/socket.html#socket.AF_INET6" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">socket.AF_INET6</span></code></a> to restrict to IPv4 or IPv6 addresses, otherwise
both will be used if available.</p>
<p>The <code class="docutils literal"><span class="pre">backlog</span></code> argument has the same meaning as for
<a class="reference external" href="https://docs.python.org/3.4/library/socket.html#socket.socket.listen" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">socket.listen</span></code></a>.</p>
<p>This method may be called multiple times prior to <a class="reference internal" href="#tornado.tcpserver.TCPServer.start" title="tornado.tcpserver.TCPServer.start"><code class="xref py py-obj docutils literal"><span class="pre">start</span></code></a> to listen
on multiple ports or interfaces.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.tcpserver.TCPServer.start">
<code class="descname">start</code><span class="sig-paren">(</span><em>num_processes=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/tcpserver.html#TCPServer.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.tcpserver.TCPServer.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts this server in the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>.</p>
<p>By default, we run the server in this process and do not fork any
additional child process.</p>
<p>If num_processes is <code class="docutils literal"><span class="pre">None</span></code> or &lt;= 0, we detect the number of cores
available on this machine and fork that number of child
processes. If num_processes is given and &gt; 1, we fork that
specific number of sub-processes.</p>
<p>Since we use processes and not threads, there is no shared memory
between any server code.</p>
<p>Note that multiple processes are not compatible with the autoreload
module (or the <code class="docutils literal"><span class="pre">autoreload=True</span></code> option to <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.Application</span></code></a>
which defaults to True when <code class="docutils literal"><span class="pre">debug=True</span></code>).
When using multiple processes, no IOLoops can be created or
referenced until after the call to <code class="docutils literal"><span class="pre">TCPServer.start(n)</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.tcpserver.TCPServer.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/tcpserver.html#TCPServer.stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.tcpserver.TCPServer.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stops listening for new connections.</p>
<p>Requests currently in progress may still continue after the
server is stopped.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.tcpserver.TCPServer.handle_stream">
<code class="descname">handle_stream</code><span class="sig-paren">(</span><em>stream</em>, <em>address</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/tcpserver.html#TCPServer.handle_stream"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.tcpserver.TCPServer.handle_stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Override to handle a new <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> from an incoming connection.</p>
<p>This method may be a coroutine; if so any exceptions it raises
asynchronously will be logged. Accepting of incoming connections
will not be blocked by this coroutine.</p>
<p>If this <a class="reference internal" href="#tornado.tcpserver.TCPServer" title="tornado.tcpserver.TCPServer"><code class="xref py py-obj docutils literal"><span class="pre">TCPServer</span></code></a> is configured for SSL, <code class="docutils literal"><span class="pre">handle_stream</span></code>
may be called before the SSL handshake has completed. Use
<a class="reference internal" href="index.html#tornado.iostream.SSLIOStream.wait_for_handshake" title="tornado.iostream.SSLIOStream.wait_for_handshake"><code class="xref py py-obj docutils literal"><span class="pre">SSLIOStream.wait_for_handshake</span></code></a> if you need to verify the client&#8217;s
certificate or use NPN/ALPN.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.2: </span>Added the option for this method to be a coroutine.</p>
</div>
</dd></dl>

</dd></dl>

</div>
</div>
</div>
<span id="document-coroutine"></span><div class="section" id="coroutines-and-concurrency">
<h3>Coroutines and concurrency<a class="headerlink" href="#coroutines-and-concurrency" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
<span id="document-gen"></span><div class="section" id="tornado-gen-simplify-asynchronous-code">
<h4><code class="docutils literal"><span class="pre">tornado.gen</span></code> &#8212; Simplify asynchronous code<a class="headerlink" href="#tornado-gen-simplify-asynchronous-code" title="Permalink to this headline">¶</a></h4>
<span class="target" id="module-tornado.gen"></span><p><code class="docutils literal"><span class="pre">tornado.gen</span></code> is a generator-based interface to make it easier to
work in an asynchronous environment.  Code using the <code class="docutils literal"><span class="pre">gen</span></code> module
is technically asynchronous, but it is written as a single generator
instead of a collection of separate functions.</p>
<p>For example, the following asynchronous handler:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">AsyncHandler</span><span class="p">(</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="nd">@asynchronous</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">http_client</span> <span class="o">=</span> <span class="n">AsyncHTTPClient</span><span class="p">()</span>
        <span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s">&quot;http://example.com&quot;</span><span class="p">,</span>
                          <span class="n">callback</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_fetch</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
        <span class="n">do_something_with_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s">&quot;template.html&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>could be written with <code class="docutils literal"><span class="pre">gen</span></code> as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">GenAsyncHandler</span><span class="p">(</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="nd">@gen.coroutine</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">http_client</span> <span class="o">=</span> <span class="n">AsyncHTTPClient</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s">&quot;http://example.com&quot;</span><span class="p">)</span>
        <span class="n">do_something_with_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s">&quot;template.html&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Most asynchronous functions in Tornado return a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>;
yielding this object returns its <a class="reference internal" href="index.html#tornado.concurrent.Future.result" title="tornado.concurrent.Future.result"><code class="xref py py-obj docutils literal"><span class="pre">result</span></code></a>.</p>
<p>You can also yield a list or dict of <code class="docutils literal"><span class="pre">Futures</span></code>, which will be
started at the same time and run in parallel; a list or dict of results will
be returned when they are all finished:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">http_client</span> <span class="o">=</span> <span class="n">AsyncHTTPClient</span><span class="p">()</span>
    <span class="n">response1</span><span class="p">,</span> <span class="n">response2</span> <span class="o">=</span> <span class="k">yield</span> <span class="p">[</span><span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">url1</span><span class="p">),</span>
                                  <span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">url2</span><span class="p">)]</span>
    <span class="n">response_dict</span> <span class="o">=</span> <span class="k">yield</span> <span class="nb">dict</span><span class="p">(</span><span class="n">response3</span><span class="o">=</span><span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">url3</span><span class="p">),</span>
                               <span class="n">response4</span><span class="o">=</span><span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">url4</span><span class="p">))</span>
    <span class="n">response3</span> <span class="o">=</span> <span class="n">response_dict</span><span class="p">[</span><span class="s">&#39;response3&#39;</span><span class="p">]</span>
    <span class="n">response4</span> <span class="o">=</span> <span class="n">response_dict</span><span class="p">[</span><span class="s">&#39;response4&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>If the <a class="reference external" href="https://docs.python.org/3.4/library/functools.html#functools.singledispatch" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">singledispatch</span></code></a> library is available (standard in
Python 3.4, available via the <a class="reference external" href="https://pypi.python.org/pypi/singledispatch">singledispatch</a> package on older
versions), additional types of objects may be yielded. Tornado includes
support for <code class="docutils literal"><span class="pre">asyncio.Future</span></code> and Twisted&#8217;s <code class="docutils literal"><span class="pre">Deferred</span></code> class when
<code class="docutils literal"><span class="pre">tornado.platform.asyncio</span></code> and <code class="docutils literal"><span class="pre">tornado.platform.twisted</span></code> are imported.
See the <a class="reference internal" href="#tornado.gen.convert_yielded" title="tornado.gen.convert_yielded"><code class="xref py py-obj docutils literal"><span class="pre">convert_yielded</span></code></a> function to extend this mechanism.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.2: </span>Dict support added.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>Support added for yielding <code class="docutils literal"><span class="pre">asyncio</span></code> Futures and Twisted Deferreds
via <code class="docutils literal"><span class="pre">singledispatch</span></code>.</p>
</div>
<div class="section" id="decorators">
<h5>Decorators<a class="headerlink" href="#decorators" title="Permalink to this headline">¶</a></h5>
<dl class="function">
<dt id="tornado.gen.coroutine">
<code class="descclassname">tornado.gen.</code><code class="descname">coroutine</code><span class="sig-paren">(</span><em>func</em>, <em>replace_callback=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#coroutine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.coroutine" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator for asynchronous generators.</p>
<p>Any generator that yields objects from this module must be wrapped
in either this decorator or <a class="reference internal" href="#tornado.gen.engine" title="tornado.gen.engine"><code class="xref py py-obj docutils literal"><span class="pre">engine</span></code></a>.</p>
<p>Coroutines may &#8220;return&#8221; by raising the special exception
<a class="reference internal" href="#tornado.gen.Return" title="tornado.gen.Return"><code class="xref py py-obj docutils literal"><span class="pre">Return(value)</span></code></a>.  In Python 3.3+, it is also possible for
the function to simply use the <code class="docutils literal"><span class="pre">return</span> <span class="pre">value</span></code> statement (prior to
Python 3.3 generators were not allowed to also return values).
In all versions of Python a coroutine that simply wishes to exit
early may use the <code class="docutils literal"><span class="pre">return</span></code> statement without a value.</p>
<p>Functions with this decorator return a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.  Additionally,
they may be called with a <code class="docutils literal"><span class="pre">callback</span></code> keyword argument, which
will be invoked with the future&#8217;s result when it resolves.  If the
coroutine fails, the callback will not be run and an exception
will be raised into the surrounding <a class="reference internal" href="index.html#tornado.stack_context.StackContext" title="tornado.stack_context.StackContext"><code class="xref py py-obj docutils literal"><span class="pre">StackContext</span></code></a>.  The
<code class="docutils literal"><span class="pre">callback</span></code> argument is not visible inside the decorated
function; it is handled by the decorator itself.</p>
<p>From the caller&#8217;s perspective, <code class="docutils literal"><span class="pre">&#64;gen.coroutine</span></code> is similar to
the combination of <code class="docutils literal"><span class="pre">&#64;return_future</span></code> and <code class="docutils literal"><span class="pre">&#64;gen.engine</span></code>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When exceptions occur inside a coroutine, the exception
information will be stored in the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> object. You must
examine the result of the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> object, or the exception
may go unnoticed by your code. This means yielding the function
if called from another coroutine, using something like
<a class="reference internal" href="index.html#tornado.ioloop.IOLoop.run_sync" title="tornado.ioloop.IOLoop.run_sync"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.run_sync</span></code></a> for top-level calls, or passing the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>
to <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_future" title="tornado.ioloop.IOLoop.add_future"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_future</span></code></a>.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.gen.engine">
<code class="descclassname">tornado.gen.</code><code class="descname">engine</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#engine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.engine" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback-oriented decorator for asynchronous generators.</p>
<p>This is an older interface; for new code that does not need to be
compatible with versions of Tornado older than 3.0 the
<a class="reference internal" href="#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">coroutine</span></code></a> decorator is recommended instead.</p>
<p>This decorator is similar to <a class="reference internal" href="#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">coroutine</span></code></a>, except it does not
return a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> and the <code class="docutils literal"><span class="pre">callback</span></code> argument is not treated
specially.</p>
<p>In most cases, functions decorated with <a class="reference internal" href="#tornado.gen.engine" title="tornado.gen.engine"><code class="xref py py-obj docutils literal"><span class="pre">engine</span></code></a> should take
a <code class="docutils literal"><span class="pre">callback</span></code> argument and invoke it with their result when
they are finished.  One notable exception is the
<a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> <a class="reference internal" href="index.html#verbs"><span>HTTP verb methods</span></a>,
which use <code class="docutils literal"><span class="pre">self.finish()</span></code> in place of a callback argument.</p>
</dd></dl>

</div>
<div class="section" id="utility-functions">
<h5>Utility functions<a class="headerlink" href="#utility-functions" title="Permalink to this headline">¶</a></h5>
<dl class="exception">
<dt id="tornado.gen.Return">
<em class="property">exception </em><code class="descclassname">tornado.gen.</code><code class="descname">Return</code><span class="sig-paren">(</span><em>value=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#Return"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.Return" title="Permalink to this definition">¶</a></dt>
<dd><p>Special exception to return a value from a <a class="reference internal" href="#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">coroutine</span></code></a>.</p>
<p>If this exception is raised, its value argument is used as the
result of the coroutine:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">fetch_json</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">AsyncHTTPClient</span><span class="p">()</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">raise</span> <span class="n">gen</span><span class="o">.</span><span class="n">Return</span><span class="p">(</span><span class="n">json_decode</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="p">))</span>
</pre></div>
</div>
<p>In Python 3.3, this exception is no longer necessary: the <code class="docutils literal"><span class="pre">return</span></code>
statement can be used directly to return a value (previously
<code class="docutils literal"><span class="pre">yield</span></code> and <code class="docutils literal"><span class="pre">return</span></code> with a value could not be combined in the
same function).</p>
<p>By analogy with the return statement, the value argument is optional,
but it is never necessary to <code class="docutils literal"><span class="pre">raise</span> <span class="pre">gen.Return()</span></code>.  The <code class="docutils literal"><span class="pre">return</span></code>
statement can be used with no arguments instead.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.gen.with_timeout">
<code class="descclassname">tornado.gen.</code><code class="descname">with_timeout</code><span class="sig-paren">(</span><em>timeout</em>, <em>future</em>, <em>io_loop=None</em>, <em>quiet_exceptions=()</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#with_timeout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.with_timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Wraps a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> in a timeout.</p>
<p>Raises <a class="reference internal" href="#tornado.gen.TimeoutError" title="tornado.gen.TimeoutError"><code class="xref py py-obj docutils literal"><span class="pre">TimeoutError</span></code></a> if the input future does not complete before
<code class="docutils literal"><span class="pre">timeout</span></code>, which may be specified in any form allowed by
<a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_timeout" title="tornado.ioloop.IOLoop.add_timeout"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_timeout</span></code></a> (i.e. a <a class="reference external" href="https://docs.python.org/3.4/library/datetime.html#datetime.timedelta" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">datetime.timedelta</span></code></a> or an absolute time
relative to <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.time" title="tornado.ioloop.IOLoop.time"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.time</span></code></a>)</p>
<p>If the wrapped <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> fails after it has timed out, the exception
will be logged unless it is of a type contained in <code class="docutils literal"><span class="pre">quiet_exceptions</span></code>
(which may be an exception type or a sequence of types).</p>
<p>Currently only supports Futures, not other <a class="reference internal" href="#tornado.gen.YieldPoint" title="tornado.gen.YieldPoint"><code class="xref py py-obj docutils literal"><span class="pre">YieldPoint</span></code></a> classes.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>Added the <code class="docutils literal"><span class="pre">quiet_exceptions</span></code> argument and the logging of unhandled
exceptions.</p>
</div>
</dd></dl>

<dl class="exception">
<dt id="tornado.gen.TimeoutError">
<em class="property">exception </em><code class="descclassname">tornado.gen.</code><code class="descname">TimeoutError</code><a class="reference internal" href="_modules/tornado/gen.html#TimeoutError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.TimeoutError" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised by <code class="docutils literal"><span class="pre">with_timeout</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.gen.sleep">
<code class="descclassname">tornado.gen.</code><code class="descname">sleep</code><span class="sig-paren">(</span><em>duration</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#sleep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.sleep" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> that resolves after the given number of seconds.</p>
<p>When used with <code class="docutils literal"><span class="pre">yield</span></code> in a coroutine, this is a non-blocking
analogue to <a class="reference external" href="https://docs.python.org/3.4/library/time.html#time.sleep" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">time.sleep</span></code></a> (which should not be used in coroutines
because it is blocking):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">yield</span> <span class="n">gen</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that calling this function on its own does nothing; you must
wait on the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> it returns (usually by yielding it).</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.1.</span></p>
</div>
</dd></dl>

<dl class="data">
<dt id="tornado.gen.moment">
<code class="descclassname">tornado.gen.</code><code class="descname">moment</code><a class="headerlink" href="#tornado.gen.moment" title="Permalink to this definition">¶</a></dt>
<dd><p>A special object which may be yielded to allow the IOLoop to run for
one iteration.</p>
<p>This is not needed in normal use but it can be helpful in long-running
coroutines that are likely to yield Futures that are ready instantly.</p>
<p>Usage: <code class="docutils literal"><span class="pre">yield</span> <span class="pre">gen.moment</span></code></p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.gen.WaitIterator">
<em class="property">class </em><code class="descclassname">tornado.gen.</code><code class="descname">WaitIterator</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#WaitIterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.WaitIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides an iterator to yield the results of futures as they finish.</p>
<p>Yielding a set of futures like this:</p>
<p><code class="docutils literal"><span class="pre">results</span> <span class="pre">=</span> <span class="pre">yield</span> <span class="pre">[future1,</span> <span class="pre">future2]</span></code></p>
<p>pauses the coroutine until both <code class="docutils literal"><span class="pre">future1</span></code> and <code class="docutils literal"><span class="pre">future2</span></code>
return, and then restarts the coroutine with the results of both
futures. If either future is an exception, the expression will
raise that exception and all the results will be lost.</p>
<p>If you need to get the result of each future as soon as possible,
or if you need the result of some futures even if others produce
errors, you can use <code class="docutils literal"><span class="pre">WaitIterator</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">wait_iterator</span> <span class="o">=</span> <span class="n">gen</span><span class="o">.</span><span class="n">WaitIterator</span><span class="p">(</span><span class="n">future1</span><span class="p">,</span> <span class="n">future2</span><span class="p">)</span>
<span class="k">while</span> <span class="ow">not</span> <span class="n">wait_iterator</span><span class="o">.</span><span class="n">done</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">wait_iterator</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Error {} from {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">wait_iterator</span><span class="o">.</span><span class="n">current_future</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Result {} received from {} at {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">result</span><span class="p">,</span> <span class="n">wait_iterator</span><span class="o">.</span><span class="n">current_future</span><span class="p">,</span>
            <span class="n">wait_iterator</span><span class="o">.</span><span class="n">current_index</span><span class="p">))</span>
</pre></div>
</div>
<p>Because results are returned as soon as they are available the
output from the iterator <em>will not be in the same order as the
input arguments</em>. If you need to know which future produced the
current result, you can use the attributes
<code class="docutils literal"><span class="pre">WaitIterator.current_future</span></code>, or <code class="docutils literal"><span class="pre">WaitIterator.current_index</span></code>
to get the index of the future from the input list. (if keyword
arguments were used in the construction of the <a class="reference internal" href="#tornado.gen.WaitIterator" title="tornado.gen.WaitIterator"><code class="xref py py-obj docutils literal"><span class="pre">WaitIterator</span></code></a>,
<code class="docutils literal"><span class="pre">current_index</span></code> will use the corresponding keyword).</p>
<p>On Python 3.5, <a class="reference internal" href="#tornado.gen.WaitIterator" title="tornado.gen.WaitIterator"><code class="xref py py-obj docutils literal"><span class="pre">WaitIterator</span></code></a> implements the async iterator
protocol, so it can be used with the <code class="docutils literal"><span class="pre">async</span> <span class="pre">for</span></code> statement (note
that in this version the entire iteration is aborted if any value
raises an exception, while the previous example can continue past
individual errors):</p>
<div class="highlight-python"><div class="highlight"><pre>async for result in gen.WaitIterator(future1, future2):
    print(&quot;Result {} received from {} at {}&quot;.format(
        result, wait_iterator.current_future,
        wait_iterator.current_index))
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.1.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Added <code class="docutils literal"><span class="pre">async</span> <span class="pre">for</span></code> support in Python 3.5.</p>
</div>
<dl class="method">
<dt id="tornado.gen.WaitIterator.done">
<code class="descname">done</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#WaitIterator.done"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.WaitIterator.done" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if this iterator has no more results.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.gen.WaitIterator.next">
<code class="descname">next</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#WaitIterator.next"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.WaitIterator.next" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> that will yield the next available result.</p>
<p>Note that this <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> will not be the same object as any of
the inputs.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tornado.gen.multi">
<code class="descclassname">tornado.gen.</code><code class="descname">multi</code><span class="sig-paren">(</span><em>children</em>, <em>quiet_exceptions=()</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#multi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.multi" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs multiple asynchronous operations in parallel.</p>
<p><code class="docutils literal"><span class="pre">children</span></code> may either be a list or a dict whose values are
yieldable objects. <code class="docutils literal"><span class="pre">multi()</span></code> returns a new yieldable
object that resolves to a parallel structure containing their
results. If <code class="docutils literal"><span class="pre">children</span></code> is a list, the result is a list of
results in the same order; if it is a dict, the result is a dict
with the same keys.</p>
<p>That is, <code class="docutils literal"><span class="pre">results</span> <span class="pre">=</span> <span class="pre">yield</span> <span class="pre">multi(list_of_futures)</span></code> is equivalent
to:</p>
<div class="highlight-python"><div class="highlight"><pre>results = []
for future in list_of_futures:
    results.append(yield future)
</pre></div>
</div>
<p>If any children raise exceptions, <code class="docutils literal"><span class="pre">multi()</span></code> will raise the first
one. All others will be logged, unless they are of types
contained in the <code class="docutils literal"><span class="pre">quiet_exceptions</span></code> argument.</p>
<p>If any of the inputs are <a class="reference internal" href="#tornado.gen.YieldPoint" title="tornado.gen.YieldPoint"><code class="xref py py-obj docutils literal"><span class="pre">YieldPoints</span></code></a>, the returned
yieldable object is a <a class="reference internal" href="#tornado.gen.YieldPoint" title="tornado.gen.YieldPoint"><code class="xref py py-obj docutils literal"><span class="pre">YieldPoint</span></code></a>. Otherwise, returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.
This means that the result of <a class="reference internal" href="#tornado.gen.multi" title="tornado.gen.multi"><code class="xref py py-obj docutils literal"><span class="pre">multi</span></code></a> can be used in a native
coroutine if and only if all of its children can be.</p>
<p>In a <code class="docutils literal"><span class="pre">yield</span></code>-based coroutine, it is not normally necessary to
call this function directly, since the coroutine runner will
do it automatically when a list or dict is yielded. However,
it is necessary in <code class="docutils literal"><span class="pre">await</span></code>-based coroutines, or to pass
the <code class="docutils literal"><span class="pre">quiet_exceptions</span></code> argument.</p>
<p>This function is available under the names <code class="docutils literal"><span class="pre">multi()</span></code> and <code class="docutils literal"><span class="pre">Multi()</span></code>
for historical reasons.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.2: </span>If multiple yieldables fail, any exceptions after the first
(which is raised) will be logged. Added the <code class="docutils literal"><span class="pre">quiet_exceptions</span></code>
argument to suppress this logging for selected exception types.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Replaced the class <code class="docutils literal"><span class="pre">Multi</span></code> and the function <code class="docutils literal"><span class="pre">multi_future</span></code>
with a unified function <code class="docutils literal"><span class="pre">multi</span></code>. Added support for yieldables
other than <a class="reference internal" href="#tornado.gen.YieldPoint" title="tornado.gen.YieldPoint"><code class="xref py py-obj docutils literal"><span class="pre">YieldPoint</span></code></a> and <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.gen.multi_future">
<code class="descclassname">tornado.gen.</code><code class="descname">multi_future</code><span class="sig-paren">(</span><em>children</em>, <em>quiet_exceptions=()</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#multi_future"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.multi_future" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait for multiple asynchronous futures in parallel.</p>
<p>This function is similar to <a class="reference internal" href="#tornado.gen.multi" title="tornado.gen.multi"><code class="xref py py-obj docutils literal"><span class="pre">multi</span></code></a>, but does not support
<a class="reference internal" href="#tornado.gen.YieldPoint" title="tornado.gen.YieldPoint"><code class="xref py py-obj docutils literal"><span class="pre">YieldPoints</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.2: </span>If multiple <code class="docutils literal"><span class="pre">Futures</span></code> fail, any exceptions after the first (which is
raised) will be logged. Added the <code class="docutils literal"><span class="pre">quiet_exceptions</span></code>
argument to suppress this logging for selected exception types.</p>
</div>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 4.3: </span>Use <a class="reference internal" href="#tornado.gen.multi" title="tornado.gen.multi"><code class="xref py py-obj docutils literal"><span class="pre">multi</span></code></a> instead.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.gen.Task">
<code class="descclassname">tornado.gen.</code><code class="descname">Task</code><span class="sig-paren">(</span><em>func</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#Task"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.Task" title="Permalink to this definition">¶</a></dt>
<dd><p>Adapts a callback-based asynchronous function for use in coroutines.</p>
<p>Takes a function (and optional additional arguments) and runs it with
those arguments plus a <code class="docutils literal"><span class="pre">callback</span></code> keyword argument.  The argument passed
to the callback is returned as the result of the yield expression.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span><code class="docutils literal"><span class="pre">gen.Task</span></code> is now a function that returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>, instead of
a subclass of <a class="reference internal" href="#tornado.gen.YieldPoint" title="tornado.gen.YieldPoint"><code class="xref py py-obj docutils literal"><span class="pre">YieldPoint</span></code></a>.  It still behaves the same way when
yielded.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.gen.Arguments">
<em class="property">class </em><code class="descclassname">tornado.gen.</code><code class="descname">Arguments</code><a class="headerlink" href="#tornado.gen.Arguments" title="Permalink to this definition">¶</a></dt>
<dd><p>The result of a <a class="reference internal" href="#tornado.gen.Task" title="tornado.gen.Task"><code class="xref py py-obj docutils literal"><span class="pre">Task</span></code></a> or <a class="reference internal" href="#tornado.gen.Wait" title="tornado.gen.Wait"><code class="xref py py-obj docutils literal"><span class="pre">Wait</span></code></a> whose callback had more than one
argument (or keyword arguments).</p>
<p>The <a class="reference internal" href="#tornado.gen.Arguments" title="tornado.gen.Arguments"><code class="xref py py-obj docutils literal"><span class="pre">Arguments</span></code></a> object is a <a class="reference external" href="https://docs.python.org/3.4/library/collections.html#collections.namedtuple" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">collections.namedtuple</span></code></a> and can be
used either as a tuple <code class="docutils literal"><span class="pre">(args,</span> <span class="pre">kwargs)</span></code> or an object with attributes
<code class="docutils literal"><span class="pre">args</span></code> and <code class="docutils literal"><span class="pre">kwargs</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.gen.convert_yielded">
<code class="descclassname">tornado.gen.</code><code class="descname">convert_yielded</code><span class="sig-paren">(</span><em>yielded</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#convert_yielded"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.convert_yielded" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a yielded object into a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.</p>
<p>The default implementation accepts lists, dictionaries, and Futures.</p>
<p>If the <a class="reference external" href="https://docs.python.org/3.4/library/functools.html#functools.singledispatch" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">singledispatch</span></code></a> library is available, this function
may be extended to support additional types. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@convert_yielded.register</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Future</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_</span><span class="p">(</span><span class="n">asyncio_future</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">tornado</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">asyncio</span><span class="o">.</span><span class="n">to_tornado_future</span><span class="p">(</span><span class="n">asyncio_future</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.1.</span></p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.gen.maybe_future">
<code class="descclassname">tornado.gen.</code><code class="descname">maybe_future</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#maybe_future"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.maybe_future" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts <code class="docutils literal"><span class="pre">x</span></code> into a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.</p>
<p>If <code class="docutils literal"><span class="pre">x</span></code> is already a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>, it is simply returned; otherwise
it is wrapped in a new <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.  This is suitable for use as
<code class="docutils literal"><span class="pre">result</span> <span class="pre">=</span> <span class="pre">yield</span> <span class="pre">gen.maybe_future(f())</span></code> when you don&#8217;t know whether
<code class="docutils literal"><span class="pre">f()</span></code> returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> or not.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 4.3: </span>This function only handles <code class="docutils literal"><span class="pre">Futures</span></code>, not other yieldable objects.
Instead of <a class="reference internal" href="#tornado.gen.maybe_future" title="tornado.gen.maybe_future"><code class="xref py py-obj docutils literal"><span class="pre">maybe_future</span></code></a>, check for the non-future result types
you expect (often just <code class="docutils literal"><span class="pre">None</span></code>), and <code class="docutils literal"><span class="pre">yield</span></code> anything unknown.</p>
</div>
</dd></dl>

</div>
<div class="section" id="legacy-interface">
<h5>Legacy interface<a class="headerlink" href="#legacy-interface" title="Permalink to this headline">¶</a></h5>
<p>Before support for <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Futures</span></code></a> was introduced in Tornado 3.0,
coroutines used subclasses of <a class="reference internal" href="#tornado.gen.YieldPoint" title="tornado.gen.YieldPoint"><code class="xref py py-obj docutils literal"><span class="pre">YieldPoint</span></code></a> in their <code class="docutils literal"><span class="pre">yield</span></code> expressions.
These classes are still supported but should generally not be used
except for compatibility with older interfaces. None of these classes
are compatible with native (<code class="docutils literal"><span class="pre">await</span></code>-based) coroutines.</p>
<dl class="class">
<dt id="tornado.gen.YieldPoint">
<em class="property">class </em><code class="descclassname">tornado.gen.</code><code class="descname">YieldPoint</code><a class="reference internal" href="_modules/tornado/gen.html#YieldPoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.YieldPoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for objects that may be yielded from the generator.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 4.0: </span>Use <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Futures</span></code></a> instead.</p>
</div>
<dl class="method">
<dt id="tornado.gen.YieldPoint.start">
<code class="descname">start</code><span class="sig-paren">(</span><em>runner</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#YieldPoint.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.YieldPoint.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the runner after the generator has yielded.</p>
<p>No other methods will be called on this object before <code class="docutils literal"><span class="pre">start</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.gen.YieldPoint.is_ready">
<code class="descname">is_ready</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#YieldPoint.is_ready"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.YieldPoint.is_ready" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the runner to determine whether to resume the generator.</p>
<p>Returns a boolean; may be called more than once.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.gen.YieldPoint.get_result">
<code class="descname">get_result</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#YieldPoint.get_result"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.YieldPoint.get_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value to use as the result of the yield expression.</p>
<p>This method will only be called once, and only after <a class="reference internal" href="#tornado.gen.YieldPoint.is_ready" title="tornado.gen.YieldPoint.is_ready"><code class="xref py py-obj docutils literal"><span class="pre">is_ready</span></code></a>
has returned true.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.gen.Callback">
<em class="property">class </em><code class="descclassname">tornado.gen.</code><code class="descname">Callback</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#Callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.Callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a callable object that will allow a matching <a class="reference internal" href="#tornado.gen.Wait" title="tornado.gen.Wait"><code class="xref py py-obj docutils literal"><span class="pre">Wait</span></code></a> to proceed.</p>
<p>The key may be any value suitable for use as a dictionary key, and is
used to match <code class="docutils literal"><span class="pre">Callbacks</span></code> to their corresponding <code class="docutils literal"><span class="pre">Waits</span></code>.  The key
must be unique among outstanding callbacks within a single run of the
generator function, but may be reused across different runs of the same
function (so constants generally work fine).</p>
<p>The callback may be called with zero or one arguments; if an argument
is given it will be returned by <a class="reference internal" href="#tornado.gen.Wait" title="tornado.gen.Wait"><code class="xref py py-obj docutils literal"><span class="pre">Wait</span></code></a>.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 4.0: </span>Use <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Futures</span></code></a> instead.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.gen.Wait">
<em class="property">class </em><code class="descclassname">tornado.gen.</code><code class="descname">Wait</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#Wait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.Wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the argument passed to the result of a previous <a class="reference internal" href="#tornado.gen.Callback" title="tornado.gen.Callback"><code class="xref py py-obj docutils literal"><span class="pre">Callback</span></code></a>.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 4.0: </span>Use <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Futures</span></code></a> instead.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.gen.WaitAll">
<em class="property">class </em><code class="descclassname">tornado.gen.</code><code class="descname">WaitAll</code><span class="sig-paren">(</span><em>keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#WaitAll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.WaitAll" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the results of multiple previous <a class="reference internal" href="#tornado.gen.Callback" title="tornado.gen.Callback"><code class="xref py py-obj docutils literal"><span class="pre">Callbacks</span></code></a>.</p>
<p>The argument is a sequence of <a class="reference internal" href="#tornado.gen.Callback" title="tornado.gen.Callback"><code class="xref py py-obj docutils literal"><span class="pre">Callback</span></code></a> keys, and the result is
a list of results in the same order.</p>
<p><a class="reference internal" href="#tornado.gen.WaitAll" title="tornado.gen.WaitAll"><code class="xref py py-obj docutils literal"><span class="pre">WaitAll</span></code></a> is equivalent to yielding a list of <a class="reference internal" href="#tornado.gen.Wait" title="tornado.gen.Wait"><code class="xref py py-obj docutils literal"><span class="pre">Wait</span></code></a> objects.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 4.0: </span>Use <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Futures</span></code></a> instead.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.gen.MultiYieldPoint">
<em class="property">class </em><code class="descclassname">tornado.gen.</code><code class="descname">MultiYieldPoint</code><span class="sig-paren">(</span><em>children</em>, <em>quiet_exceptions=()</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/gen.html#MultiYieldPoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.gen.MultiYieldPoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs multiple asynchronous operations in parallel.</p>
<p>This class is similar to <a class="reference internal" href="#tornado.gen.multi" title="tornado.gen.multi"><code class="xref py py-obj docutils literal"><span class="pre">multi</span></code></a>, but it always creates a stack
context even when no children require it. It is not compatible with
native coroutines.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.2: </span>If multiple <code class="docutils literal"><span class="pre">YieldPoints</span></code> fail, any exceptions after the first
(which is raised) will be logged. Added the <code class="docutils literal"><span class="pre">quiet_exceptions</span></code>
argument to suppress this logging for selected exception types.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Renamed from <code class="docutils literal"><span class="pre">Multi</span></code> to <code class="docutils literal"><span class="pre">MultiYieldPoint</span></code>. The name <code class="docutils literal"><span class="pre">Multi</span></code>
remains as an alias for the equivalent <a class="reference internal" href="#tornado.gen.multi" title="tornado.gen.multi"><code class="xref py py-obj docutils literal"><span class="pre">multi</span></code></a> function.</p>
</div>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 4.3: </span>Use <a class="reference internal" href="#tornado.gen.multi" title="tornado.gen.multi"><code class="xref py py-obj docutils literal"><span class="pre">multi</span></code></a> instead.</p>
</div>
</dd></dl>

</div>
</div>
<span id="document-concurrent"></span><div class="section" id="tornado-concurrent-work-with-threads-and-futures">
<h4><code class="docutils literal"><span class="pre">tornado.concurrent</span></code> &#8212; Work with threads and futures<a class="headerlink" href="#tornado-concurrent-work-with-threads-and-futures" title="Permalink to this headline">¶</a></h4>
<span class="target" id="module-tornado.concurrent"></span><p>Utilities for working with threads and <code class="docutils literal"><span class="pre">Futures</span></code>.</p>
<p><code class="docutils literal"><span class="pre">Futures</span></code> are a pattern for concurrent programming introduced in
Python 3.2 in the <a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#module-concurrent.futures" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures</span></code></a> package. This package defines
a mostly-compatible <a class="reference internal" href="#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> class designed for use from coroutines,
as well as some utility functions for interacting with the
<a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#module-concurrent.futures" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures</span></code></a> package.</p>
<dl class="class">
<dt id="tornado.concurrent.Future">
<em class="property">class </em><code class="descclassname">tornado.concurrent.</code><code class="descname">Future</code><a class="reference internal" href="_modules/tornado/concurrent.html#Future"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.concurrent.Future" title="Permalink to this definition">¶</a></dt>
<dd><p>Placeholder for an asynchronous result.</p>
<p>A <code class="docutils literal"><span class="pre">Future</span></code> encapsulates the result of an asynchronous
operation.  In synchronous applications <code class="docutils literal"><span class="pre">Futures</span></code> are used
to wait for the result from a thread or process pool; in
Tornado they are normally used with <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_future" title="tornado.ioloop.IOLoop.add_future"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_future</span></code></a> or by
yielding them in a <a class="reference internal" href="index.html#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">gen.coroutine</span></code></a>.</p>
<p><a class="reference internal" href="#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">tornado.concurrent.Future</span></code></a> is similar to
<a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#concurrent.futures.Future" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures.Future</span></code></a>, but not thread-safe (and therefore
faster for use with single-threaded event loops).</p>
<p>In addition to <code class="docutils literal"><span class="pre">exception</span></code> and <code class="docutils literal"><span class="pre">set_exception</span></code>, methods <code class="docutils literal"><span class="pre">exc_info</span></code>
and <code class="docutils literal"><span class="pre">set_exc_info</span></code> are supported to capture tracebacks in Python 2.
The traceback is automatically available in Python 3, but in the
Python 2 futures backport this information is discarded.
This functionality was previously available in a separate class
<code class="docutils literal"><span class="pre">TracebackFuture</span></code>, which is now a deprecated alias for this class.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span><a class="reference internal" href="#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">tornado.concurrent.Future</span></code></a> is always a thread-unsafe <code class="docutils literal"><span class="pre">Future</span></code>
with support for the <code class="docutils literal"><span class="pre">exc_info</span></code> methods.  Previously it would
be an alias for the thread-safe <a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#concurrent.futures.Future" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures.Future</span></code></a>
if that package was available and fall back to the thread-unsafe
implementation if it was not.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>If a <a class="reference internal" href="#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> contains an error but that error is never observed
(by calling <code class="docutils literal"><span class="pre">result()</span></code>, <code class="docutils literal"><span class="pre">exception()</span></code>, or <code class="docutils literal"><span class="pre">exc_info()</span></code>),
a stack trace will be logged when the <a class="reference internal" href="#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> is garbage collected.
This normally indicates an error in the application, but in cases
where it results in undesired logging it may be necessary to
suppress the logging by ensuring that the exception is observed:
<code class="docutils literal"><span class="pre">f.add_done_callback(lambda</span> <span class="pre">f:</span> <span class="pre">f.exception())</span></code>.</p>
</div>
</dd></dl>

<div class="section" id="consumer-methods">
<h5>Consumer methods<a class="headerlink" href="#consumer-methods" title="Permalink to this headline">¶</a></h5>
<dl class="method">
<dt id="tornado.concurrent.Future.result">
<code class="descclassname">Future.</code><code class="descname">result</code><span class="sig-paren">(</span><em>timeout=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/concurrent.html#Future.result"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.concurrent.Future.result" title="Permalink to this definition">¶</a></dt>
<dd><p>If the operation succeeded, return its result.  If it failed,
re-raise its exception.</p>
<p>This method takes a <code class="docutils literal"><span class="pre">timeout</span></code> argument for compatibility with
<a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#concurrent.futures.Future" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures.Future</span></code></a> but it is an error to call it
before the <a class="reference internal" href="#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> is done, so the <code class="docutils literal"><span class="pre">timeout</span></code> is never used.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.concurrent.Future.exception">
<code class="descclassname">Future.</code><code class="descname">exception</code><span class="sig-paren">(</span><em>timeout=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/concurrent.html#Future.exception"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.concurrent.Future.exception" title="Permalink to this definition">¶</a></dt>
<dd><p>If the operation raised an exception, return the <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#Exception" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">Exception</span></code></a>
object.  Otherwise returns None.</p>
<p>This method takes a <code class="docutils literal"><span class="pre">timeout</span></code> argument for compatibility with
<a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#concurrent.futures.Future" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures.Future</span></code></a> but it is an error to call it
before the <a class="reference internal" href="#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> is done, so the <code class="docutils literal"><span class="pre">timeout</span></code> is never used.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.concurrent.Future.exc_info">
<code class="descclassname">Future.</code><code class="descname">exc_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/concurrent.html#Future.exc_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.concurrent.Future.exc_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple in the same format as <a class="reference external" href="https://docs.python.org/3.4/library/sys.html#sys.exc_info" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">sys.exc_info</span></code></a> or None.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.concurrent.Future.add_done_callback">
<code class="descclassname">Future.</code><code class="descname">add_done_callback</code><span class="sig-paren">(</span><em>fn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/concurrent.html#Future.add_done_callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.concurrent.Future.add_done_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Attaches the given callback to the <a class="reference internal" href="#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.</p>
<p>It will be invoked with the <a class="reference internal" href="#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> as its argument when the Future
has finished running and its result is available.  In Tornado
consider using <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_future" title="tornado.ioloop.IOLoop.add_future"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_future</span></code></a> instead of calling
<a class="reference internal" href="#tornado.concurrent.Future.add_done_callback" title="tornado.concurrent.Future.add_done_callback"><code class="xref py py-obj docutils literal"><span class="pre">add_done_callback</span></code></a> directly.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.concurrent.Future.done">
<code class="descclassname">Future.</code><code class="descname">done</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/concurrent.html#Future.done"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.concurrent.Future.done" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the future has finished running.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.concurrent.Future.running">
<code class="descclassname">Future.</code><code class="descname">running</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/concurrent.html#Future.running"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.concurrent.Future.running" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if this operation is currently running.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.concurrent.Future.cancel">
<code class="descclassname">Future.</code><code class="descname">cancel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/concurrent.html#Future.cancel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.concurrent.Future.cancel" title="Permalink to this definition">¶</a></dt>
<dd><p>Cancel the operation, if possible.</p>
<p>Tornado <code class="docutils literal"><span class="pre">Futures</span></code> do not support cancellation, so this method always
returns False.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.concurrent.Future.cancelled">
<code class="descclassname">Future.</code><code class="descname">cancelled</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/concurrent.html#Future.cancelled"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.concurrent.Future.cancelled" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if the operation has been cancelled.</p>
<p>Tornado <code class="docutils literal"><span class="pre">Futures</span></code> do not support cancellation, so this method
always returns False.</p>
</dd></dl>

</div>
<div class="section" id="producer-methods">
<h5>Producer methods<a class="headerlink" href="#producer-methods" title="Permalink to this headline">¶</a></h5>
<dl class="method">
<dt id="tornado.concurrent.Future.set_result">
<code class="descclassname">Future.</code><code class="descname">set_result</code><span class="sig-paren">(</span><em>result</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/concurrent.html#Future.set_result"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.concurrent.Future.set_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the result of a <code class="docutils literal"><span class="pre">Future</span></code>.</p>
<p>It is undefined to call any of the <code class="docutils literal"><span class="pre">set</span></code> methods more than once
on the same object.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.concurrent.Future.set_exception">
<code class="descclassname">Future.</code><code class="descname">set_exception</code><span class="sig-paren">(</span><em>exception</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/concurrent.html#Future.set_exception"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.concurrent.Future.set_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the exception of a <code class="docutils literal"><span class="pre">Future.</span></code></p>
</dd></dl>

<dl class="method">
<dt id="tornado.concurrent.Future.set_exc_info">
<code class="descclassname">Future.</code><code class="descname">set_exc_info</code><span class="sig-paren">(</span><em>exc_info</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/concurrent.html#Future.set_exc_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.concurrent.Future.set_exc_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the exception information of a <code class="docutils literal"><span class="pre">Future.</span></code></p>
<p>Preserves tracebacks on Python 2.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.concurrent.run_on_executor">
<code class="descclassname">tornado.concurrent.</code><code class="descname">run_on_executor</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/concurrent.html#run_on_executor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.concurrent.run_on_executor" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator to run a synchronous method asynchronously on an executor.</p>
<p>The decorated method may be called with a <code class="docutils literal"><span class="pre">callback</span></code> keyword
argument and returns a future.</p>
<p>The <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> and executor to be used are determined by the <code class="docutils literal"><span class="pre">io_loop</span></code>
and <code class="docutils literal"><span class="pre">executor</span></code> attributes of <code class="docutils literal"><span class="pre">self</span></code>. To use different attributes,
pass keyword arguments to the decorator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@run_on_executor</span><span class="p">(</span><span class="n">executor</span><span class="o">=</span><span class="s">&#39;_thread_pool&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.2: </span>Added keyword arguments to use alternative attributes.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.concurrent.return_future">
<code class="descclassname">tornado.concurrent.</code><code class="descname">return_future</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/concurrent.html#return_future"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.concurrent.return_future" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator to make a function that returns via callback return a
<a class="reference internal" href="#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.</p>
<p>The wrapped function should take a <code class="docutils literal"><span class="pre">callback</span></code> keyword argument
and invoke it with one argument when it has finished.  To signal failure,
the function can simply raise an exception (which will be
captured by the <a class="reference internal" href="index.html#tornado.stack_context.StackContext" title="tornado.stack_context.StackContext"><code class="xref py py-obj docutils literal"><span class="pre">StackContext</span></code></a> and passed along to the <code class="docutils literal"><span class="pre">Future</span></code>).</p>
<p>From the caller&#8217;s perspective, the callback argument is optional.
If one is given, it will be invoked when the function is complete
with <a class="reference internal" href="#tornado.concurrent.Future.result" title="tornado.concurrent.Future.result"><code class="xref py py-obj docutils literal"><span class="pre">Future.result()</span></code></a> as an argument.  If the function fails, the
callback will not be run and an exception will be raised into the
surrounding <a class="reference internal" href="index.html#tornado.stack_context.StackContext" title="tornado.stack_context.StackContext"><code class="xref py py-obj docutils literal"><span class="pre">StackContext</span></code></a>.</p>
<p>If no callback is given, the caller should use the <code class="docutils literal"><span class="pre">Future</span></code> to
wait for the function to complete (perhaps by yielding it in a
<a class="reference internal" href="index.html#tornado.gen.engine" title="tornado.gen.engine"><code class="xref py py-obj docutils literal"><span class="pre">gen.engine</span></code></a> function, or passing it to <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_future" title="tornado.ioloop.IOLoop.add_future"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_future</span></code></a>).</p>
<p>Usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@return_future</span>
<span class="k">def</span> <span class="nf">future_func</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
    <span class="c"># Do stuff (possibly asynchronous)</span>
    <span class="n">callback</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

<span class="nd">@gen.engine</span>
<span class="k">def</span> <span class="nf">caller</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
    <span class="k">yield</span> <span class="n">future_func</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">)</span>
    <span class="n">callback</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal"><span class="pre">&#64;return_future</span></code> and <code class="docutils literal"><span class="pre">&#64;gen.engine</span></code> can be applied to the
same function, provided <code class="docutils literal"><span class="pre">&#64;return_future</span></code> appears first.  However,
consider using <code class="docutils literal"><span class="pre">&#64;gen.coroutine</span></code> instead of this combination.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.concurrent.chain_future">
<code class="descclassname">tornado.concurrent.</code><code class="descname">chain_future</code><span class="sig-paren">(</span><em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/concurrent.html#chain_future"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.concurrent.chain_future" title="Permalink to this definition">¶</a></dt>
<dd><p>Chain two futures together so that when one completes, so does the other.</p>
<p>The result (success or failure) of <code class="docutils literal"><span class="pre">a</span></code> will be copied to <code class="docutils literal"><span class="pre">b</span></code>, unless
<code class="docutils literal"><span class="pre">b</span></code> has already been completed or cancelled by the time <code class="docutils literal"><span class="pre">a</span></code> finishes.</p>
</dd></dl>

</div>
</div>
<span id="document-locks"></span><div class="section" id="tornado-locks-synchronization-primitives">
<h4><code class="docutils literal"><span class="pre">tornado.locks</span></code> &#8211; Synchronization primitives<a class="headerlink" href="#tornado-locks-synchronization-primitives" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.2.</span></p>
</div>
<p>Coordinate coroutines with synchronization primitives analogous to those the
standard library provides to threads.</p>
<p><em>(Note that these primitives are not actually thread-safe and cannot be used in
place of those from the standard library&#8211;they are meant to coordinate Tornado
coroutines in a single-threaded app, not to protect shared objects in a
multithreaded app.)</em></p>
<span class="target" id="module-tornado.locks"></span><div class="section" id="condition">
<h5>Condition<a class="headerlink" href="#condition" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.locks.Condition">
<em class="property">class </em><code class="descclassname">tornado.locks.</code><code class="descname">Condition</code><a class="reference internal" href="_modules/tornado/locks.html#Condition"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.Condition" title="Permalink to this definition">¶</a></dt>
<dd><p>A condition allows one or more coroutines to wait until notified.</p>
<p>Like a standard <a class="reference external" href="https://docs.python.org/3.4/library/threading.html#threading.Condition" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">threading.Condition</span></code></a>, but does not need an underlying lock
that is acquired and released.</p>
<p>With a <a class="reference internal" href="#tornado.locks.Condition" title="tornado.locks.Condition"><code class="xref py py-obj docutils literal"><span class="pre">Condition</span></code></a>, coroutines can wait to be notified by other coroutines:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado</span> <span class="kn">import</span> <span class="n">gen</span>
<span class="kn">from</span> <span class="nn">tornado.ioloop</span> <span class="kn">import</span> <span class="n">IOLoop</span>
<span class="kn">from</span> <span class="nn">tornado.locks</span> <span class="kn">import</span> <span class="n">Condition</span>

<span class="n">condition</span> <span class="o">=</span> <span class="n">Condition</span><span class="p">()</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">waiter</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;I&#39;ll wait right here&quot;</span><span class="p">)</span>
    <span class="k">yield</span> <span class="n">condition</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>  <span class="c"># Yield a Future.</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;I&#39;m done waiting&quot;</span><span class="p">)</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">notifier</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;About to notify&quot;</span><span class="p">)</span>
    <span class="n">condition</span><span class="o">.</span><span class="n">notify</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Done notifying&quot;</span><span class="p">)</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">runner</span><span class="p">():</span>
    <span class="c"># Yield two Futures; wait for waiter() and notifier() to finish.</span>
    <span class="k">yield</span> <span class="p">[</span><span class="n">waiter</span><span class="p">(),</span> <span class="n">notifier</span><span class="p">()]</span>

<span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">run_sync</span><span class="p">(</span><span class="n">runner</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>I&#39;ll wait right here
About to notify
Done notifying
I&#39;m done waiting
</pre></div>
</div>
<p><a class="reference internal" href="#tornado.locks.Condition.wait" title="tornado.locks.Condition.wait"><code class="xref py py-obj docutils literal"><span class="pre">wait</span></code></a> takes an optional <code class="docutils literal"><span class="pre">timeout</span></code> argument, which is either an absolute
timestamp:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">io_loop</span> <span class="o">=</span> <span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span>

<span class="c"># Wait up to 1 second for a notification.</span>
<span class="k">yield</span> <span class="n">condition</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">io_loop</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>...or a <a class="reference external" href="https://docs.python.org/3.4/library/datetime.html#datetime.timedelta" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">datetime.timedelta</span></code></a> for a timeout relative to the current time:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Wait up to 1 second.</span>
<span class="k">yield</span> <span class="n">condition</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>The method raises <a class="reference internal" href="index.html#tornado.gen.TimeoutError" title="tornado.gen.TimeoutError"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.TimeoutError</span></code></a> if there&#8217;s no notification
before the deadline.</p>
<dl class="method">
<dt id="tornado.locks.Condition.wait">
<code class="descname">wait</code><span class="sig-paren">(</span><em>timeout=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locks.html#Condition.wait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.Condition.wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait for <a class="reference internal" href="#tornado.locks.Condition.notify" title="tornado.locks.Condition.notify"><code class="xref py py-obj docutils literal"><span class="pre">notify</span></code></a>.</p>
<p>Returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> that resolves <code class="docutils literal"><span class="pre">True</span></code> if the condition is notified,
or <code class="docutils literal"><span class="pre">False</span></code> after a timeout.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.locks.Condition.notify">
<code class="descname">notify</code><span class="sig-paren">(</span><em>n=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locks.html#Condition.notify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.Condition.notify" title="Permalink to this definition">¶</a></dt>
<dd><p>Wake <code class="docutils literal"><span class="pre">n</span></code> waiters.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.locks.Condition.notify_all">
<code class="descname">notify_all</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locks.html#Condition.notify_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.Condition.notify_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Wake all waiters.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="event">
<h5>Event<a class="headerlink" href="#event" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.locks.Event">
<em class="property">class </em><code class="descclassname">tornado.locks.</code><code class="descname">Event</code><a class="reference internal" href="_modules/tornado/locks.html#Event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.Event" title="Permalink to this definition">¶</a></dt>
<dd><p>An event blocks coroutines until its internal flag is set to True.</p>
<p>Similar to <a class="reference external" href="https://docs.python.org/3.4/library/threading.html#threading.Event" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">threading.Event</span></code></a>.</p>
<p>A coroutine can wait for an event to be set. Once it is set, calls to
<code class="docutils literal"><span class="pre">yield</span> <span class="pre">event.wait()</span></code> will not block unless the event has been cleared:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado</span> <span class="kn">import</span> <span class="n">gen</span>
<span class="kn">from</span> <span class="nn">tornado.ioloop</span> <span class="kn">import</span> <span class="n">IOLoop</span>
<span class="kn">from</span> <span class="nn">tornado.locks</span> <span class="kn">import</span> <span class="n">Event</span>

<span class="n">event</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">waiter</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Waiting for event&quot;</span><span class="p">)</span>
    <span class="k">yield</span> <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Not waiting this time&quot;</span><span class="p">)</span>
    <span class="k">yield</span> <span class="n">event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Done&quot;</span><span class="p">)</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">setter</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;About to set the event&quot;</span><span class="p">)</span>
    <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">runner</span><span class="p">():</span>
    <span class="k">yield</span> <span class="p">[</span><span class="n">waiter</span><span class="p">(),</span> <span class="n">setter</span><span class="p">()]</span>

<span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">run_sync</span><span class="p">(</span><span class="n">runner</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>Waiting for event
About to set the event
Not waiting this time
Done
</pre></div>
</div>
<dl class="method">
<dt id="tornado.locks.Event.is_set">
<code class="descname">is_set</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locks.html#Event.is_set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.Event.is_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal"><span class="pre">True</span></code> if the internal flag is true.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.locks.Event.set">
<code class="descname">set</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locks.html#Event.set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.Event.set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the internal flag to <code class="docutils literal"><span class="pre">True</span></code>. All waiters are awakened.</p>
<p>Calling <a class="reference internal" href="#tornado.locks.Event.wait" title="tornado.locks.Event.wait"><code class="xref py py-obj docutils literal"><span class="pre">wait</span></code></a> once the flag is set will not block.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.locks.Event.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locks.html#Event.clear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.Event.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the internal flag to <code class="docutils literal"><span class="pre">False</span></code>.</p>
<p>Calls to <a class="reference internal" href="#tornado.locks.Event.wait" title="tornado.locks.Event.wait"><code class="xref py py-obj docutils literal"><span class="pre">wait</span></code></a> will block until <a class="reference internal" href="#tornado.locks.Event.set" title="tornado.locks.Event.set"><code class="xref py py-obj docutils literal"><span class="pre">set</span></code></a> is called.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.locks.Event.wait">
<code class="descname">wait</code><span class="sig-paren">(</span><em>timeout=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locks.html#Event.wait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.Event.wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Block until the internal flag is true.</p>
<p>Returns a Future, which raises <a class="reference internal" href="index.html#tornado.gen.TimeoutError" title="tornado.gen.TimeoutError"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.TimeoutError</span></code></a> after a
timeout.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="semaphore">
<h5>Semaphore<a class="headerlink" href="#semaphore" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.locks.Semaphore">
<em class="property">class </em><code class="descclassname">tornado.locks.</code><code class="descname">Semaphore</code><span class="sig-paren">(</span><em>value=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locks.html#Semaphore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.Semaphore" title="Permalink to this definition">¶</a></dt>
<dd><p>A lock that can be acquired a fixed number of times before blocking.</p>
<p>A Semaphore manages a counter representing the number of <a class="reference internal" href="#tornado.locks.Semaphore.release" title="tornado.locks.Semaphore.release"><code class="xref py py-obj docutils literal"><span class="pre">release</span></code></a> calls
minus the number of <a class="reference internal" href="#tornado.locks.Semaphore.acquire" title="tornado.locks.Semaphore.acquire"><code class="xref py py-obj docutils literal"><span class="pre">acquire</span></code></a> calls, plus an initial value. The <a class="reference internal" href="#tornado.locks.Semaphore.acquire" title="tornado.locks.Semaphore.acquire"><code class="xref py py-obj docutils literal"><span class="pre">acquire</span></code></a>
method blocks if necessary until it can return without making the counter
negative.</p>
<p>Semaphores limit access to a shared resource. To allow access for two
workers at a time:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado</span> <span class="kn">import</span> <span class="n">gen</span>
<span class="kn">from</span> <span class="nn">tornado.ioloop</span> <span class="kn">import</span> <span class="n">IOLoop</span>
<span class="kn">from</span> <span class="nn">tornado.locks</span> <span class="kn">import</span> <span class="n">Semaphore</span>

<span class="n">sem</span> <span class="o">=</span> <span class="n">Semaphore</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">worker</span><span class="p">(</span><span class="n">worker_id</span><span class="p">):</span>
    <span class="k">yield</span> <span class="n">sem</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Worker </span><span class="si">%d</span><span class="s"> is working&quot;</span> <span class="o">%</span> <span class="n">worker_id</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">use_some_resource</span><span class="p">()</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Worker </span><span class="si">%d</span><span class="s"> is done&quot;</span> <span class="o">%</span> <span class="n">worker_id</span><span class="p">)</span>
        <span class="n">sem</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">runner</span><span class="p">():</span>
    <span class="c"># Join all workers.</span>
    <span class="k">yield</span> <span class="p">[</span><span class="n">worker</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>

<span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">run_sync</span><span class="p">(</span><span class="n">runner</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>Worker 0 is working
Worker 1 is working
Worker 0 is done
Worker 2 is working
Worker 1 is done
Worker 2 is done
</pre></div>
</div>
<p>Workers 0 and 1 are allowed to run concurrently, but worker 2 waits until
the semaphore has been released once, by worker 0.</p>
<p><a class="reference internal" href="#tornado.locks.Semaphore.acquire" title="tornado.locks.Semaphore.acquire"><code class="xref py py-obj docutils literal"><span class="pre">acquire</span></code></a> is a context manager, so <code class="docutils literal"><span class="pre">worker</span></code> could be written as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">worker</span><span class="p">(</span><span class="n">worker_id</span><span class="p">):</span>
    <span class="k">with</span> <span class="p">(</span><span class="k">yield</span> <span class="n">sem</span><span class="o">.</span><span class="n">acquire</span><span class="p">()):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Worker </span><span class="si">%d</span><span class="s"> is working&quot;</span> <span class="o">%</span> <span class="n">worker_id</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">use_some_resource</span><span class="p">()</span>

    <span class="c"># Now the semaphore has been released.</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Worker </span><span class="si">%d</span><span class="s"> is done&quot;</span> <span class="o">%</span> <span class="n">worker_id</span><span class="p">)</span>
</pre></div>
</div>
<p>In Python 3.5, the semaphore itself can be used as an async context
manager:</p>
<div class="highlight-python"><div class="highlight"><pre>async def worker(worker_id):
    async with sem:
        print(&quot;Worker %d is working&quot; % worker_id)
        await use_some_resource()

    # Now the semaphore has been released.
    print(&quot;Worker %d is done&quot; % worker_id)
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Added <code class="docutils literal"><span class="pre">async</span> <span class="pre">with</span></code> support in Python 3.5.</p>
</div>
<dl class="method">
<dt id="tornado.locks.Semaphore.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locks.html#Semaphore.release"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.Semaphore.release" title="Permalink to this definition">¶</a></dt>
<dd><p>Increment the counter and wake one waiter.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.locks.Semaphore.acquire">
<code class="descname">acquire</code><span class="sig-paren">(</span><em>timeout=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locks.html#Semaphore.acquire"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.Semaphore.acquire" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrement the counter. Returns a Future.</p>
<p>Block if the counter is zero and wait for a <a class="reference internal" href="#tornado.locks.Semaphore.release" title="tornado.locks.Semaphore.release"><code class="xref py py-obj docutils literal"><span class="pre">release</span></code></a>. The Future
raises <a class="reference internal" href="index.html#tornado.gen.TimeoutError" title="tornado.gen.TimeoutError"><code class="xref py py-obj docutils literal"><span class="pre">TimeoutError</span></code></a> after the deadline.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="boundedsemaphore">
<h5>BoundedSemaphore<a class="headerlink" href="#boundedsemaphore" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.locks.BoundedSemaphore">
<em class="property">class </em><code class="descclassname">tornado.locks.</code><code class="descname">BoundedSemaphore</code><span class="sig-paren">(</span><em>value=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locks.html#BoundedSemaphore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.BoundedSemaphore" title="Permalink to this definition">¶</a></dt>
<dd><p>A semaphore that prevents release() being called too many times.</p>
<p>If <a class="reference internal" href="#tornado.locks.BoundedSemaphore.release" title="tornado.locks.BoundedSemaphore.release"><code class="xref py py-obj docutils literal"><span class="pre">release</span></code></a> would increment the semaphore&#8217;s value past the initial
value, it raises <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#ValueError" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ValueError</span></code></a>. Semaphores are mostly used to guard
resources with limited capacity, so a semaphore released too many times
is a sign of a bug.</p>
<dl class="method">
<dt id="tornado.locks.BoundedSemaphore.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locks.html#BoundedSemaphore.release"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.BoundedSemaphore.release" title="Permalink to this definition">¶</a></dt>
<dd><p>Increment the counter and wake one waiter.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.locks.BoundedSemaphore.acquire">
<code class="descname">acquire</code><span class="sig-paren">(</span><em>timeout=None</em><span class="sig-paren">)</span><a class="headerlink" href="#tornado.locks.BoundedSemaphore.acquire" title="Permalink to this definition">¶</a></dt>
<dd><p>Decrement the counter. Returns a Future.</p>
<p>Block if the counter is zero and wait for a <a class="reference internal" href="#tornado.locks.BoundedSemaphore.release" title="tornado.locks.BoundedSemaphore.release"><code class="xref py py-obj docutils literal"><span class="pre">release</span></code></a>. The Future
raises <a class="reference internal" href="index.html#tornado.gen.TimeoutError" title="tornado.gen.TimeoutError"><code class="xref py py-obj docutils literal"><span class="pre">TimeoutError</span></code></a> after the deadline.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="lock">
<h5>Lock<a class="headerlink" href="#lock" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.locks.Lock">
<em class="property">class </em><code class="descclassname">tornado.locks.</code><code class="descname">Lock</code><a class="reference internal" href="_modules/tornado/locks.html#Lock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.Lock" title="Permalink to this definition">¶</a></dt>
<dd><p>A lock for coroutines.</p>
<p>A Lock begins unlocked, and <a class="reference internal" href="#tornado.locks.Lock.acquire" title="tornado.locks.Lock.acquire"><code class="xref py py-obj docutils literal"><span class="pre">acquire</span></code></a> locks it immediately. While it is
locked, a coroutine that yields <a class="reference internal" href="#tornado.locks.Lock.acquire" title="tornado.locks.Lock.acquire"><code class="xref py py-obj docutils literal"><span class="pre">acquire</span></code></a> waits until another coroutine
calls <a class="reference internal" href="#tornado.locks.Lock.release" title="tornado.locks.Lock.release"><code class="xref py py-obj docutils literal"><span class="pre">release</span></code></a>.</p>
<p>Releasing an unlocked lock raises <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#RuntimeError" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">RuntimeError</span></code></a>.</p>
<p><a class="reference internal" href="#tornado.locks.Lock.acquire" title="tornado.locks.Lock.acquire"><code class="xref py py-obj docutils literal"><span class="pre">acquire</span></code></a> supports the context manager protocol in all Python versions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">tornado</span> <span class="kn">import</span> <span class="n">gen</span><span class="p">,</span> <span class="n">locks</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lock</span> <span class="o">=</span> <span class="n">locks</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@gen.coroutine</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">f</span><span class="p">():</span>
<span class="gp">... </span>   <span class="k">with</span> <span class="p">(</span><span class="k">yield</span> <span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()):</span>
<span class="gp">... </span>       <span class="c"># Do something holding the lock.</span>
<span class="gp">... </span>       <span class="k">pass</span>
<span class="gp">...</span>
<span class="gp">... </span>   <span class="c"># Now the lock is released.</span>
</pre></div>
</div>
<p>In Python 3.5, <a class="reference internal" href="#tornado.locks.Lock" title="tornado.locks.Lock"><code class="xref py py-obj docutils literal"><span class="pre">Lock</span></code></a> also supports the async context manager
protocol. Note that in this case there is no <a class="reference internal" href="#tornado.locks.Lock.acquire" title="tornado.locks.Lock.acquire"><code class="xref py py-obj docutils literal"><span class="pre">acquire</span></code></a>, because
<code class="docutils literal"><span class="pre">async</span> <span class="pre">with</span></code> includes both the <code class="docutils literal"><span class="pre">yield</span></code> and the <code class="docutils literal"><span class="pre">acquire</span></code>
(just as it does with <a class="reference external" href="https://docs.python.org/3.4/library/threading.html#threading.Lock" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">threading.Lock</span></code></a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">async</span> <span class="k">def</span> <span class="nf">f</span><span class="p">():</span>  
<span class="gp">... </span>   <span class="n">async</span> <span class="k">with</span> <span class="n">lock</span><span class="p">:</span>
<span class="gp">... </span>       <span class="c"># Do something holding the lock.</span>
<span class="gp">... </span>       <span class="k">pass</span>
<span class="gp">...</span>
<span class="gp">... </span>   <span class="c"># Now the lock is released.</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.5: </span>Added <code class="docutils literal"><span class="pre">async</span> <span class="pre">with</span></code> support in Python 3.5.</p>
</div>
<dl class="method">
<dt id="tornado.locks.Lock.acquire">
<code class="descname">acquire</code><span class="sig-paren">(</span><em>timeout=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locks.html#Lock.acquire"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.Lock.acquire" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to lock. Returns a Future.</p>
<p>Returns a Future, which raises <a class="reference internal" href="index.html#tornado.gen.TimeoutError" title="tornado.gen.TimeoutError"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.TimeoutError</span></code></a> after a
timeout.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.locks.Lock.release">
<code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/locks.html#Lock.release"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.locks.Lock.release" title="Permalink to this definition">¶</a></dt>
<dd><p>Unlock.</p>
<p>The first coroutine in line waiting for <a class="reference internal" href="#tornado.locks.Lock.acquire" title="tornado.locks.Lock.acquire"><code class="xref py py-obj docutils literal"><span class="pre">acquire</span></code></a> gets the lock.</p>
<p>If not locked, raise a <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#RuntimeError" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">RuntimeError</span></code></a>.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<span id="document-queues"></span><div class="section" id="tornado-queues-queues-for-coroutines">
<h4><code class="docutils literal"><span class="pre">tornado.queues</span></code> &#8211; Queues for coroutines<a class="headerlink" href="#tornado-queues-queues-for-coroutines" title="Permalink to this headline">¶</a></h4>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.2.</span></p>
</div>
<span class="target" id="module-tornado.queues"></span><div class="section" id="classes">
<h5>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h5>
<div class="section" id="queue">
<h6>Queue<a class="headerlink" href="#queue" title="Permalink to this headline">¶</a></h6>
<dl class="class">
<dt id="tornado.queues.Queue">
<em class="property">class </em><code class="descclassname">tornado.queues.</code><code class="descname">Queue</code><span class="sig-paren">(</span><em>maxsize=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/queues.html#Queue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.queues.Queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Coordinate producer and consumer coroutines.</p>
<p>If maxsize is 0 (the default) the queue size is unbounded.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado</span> <span class="kn">import</span> <span class="n">gen</span>
<span class="kn">from</span> <span class="nn">tornado.ioloop</span> <span class="kn">import</span> <span class="n">IOLoop</span>
<span class="kn">from</span> <span class="nn">tornado.queues</span> <span class="kn">import</span> <span class="n">Queue</span>

<span class="n">q</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">consumer</span><span class="p">():</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">item</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">q</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Doing work on </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">item</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">gen</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">q</span><span class="o">.</span><span class="n">task_done</span><span class="p">()</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">producer</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">q</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Put </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">item</span><span class="p">)</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c"># Start consumer without waiting (since it never finishes).</span>
    <span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">spawn_callback</span><span class="p">(</span><span class="n">consumer</span><span class="p">)</span>
    <span class="k">yield</span> <span class="n">producer</span><span class="p">()</span>     <span class="c"># Wait for producer to put all tasks.</span>
    <span class="k">yield</span> <span class="n">q</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>       <span class="c"># Wait for consumer to finish all tasks.</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Done&#39;</span><span class="p">)</span>

<span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">run_sync</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>Put 0
Put 1
Doing work on 0
Put 2
Doing work on 1
Put 3
Doing work on 2
Put 4
Doing work on 3
Doing work on 4
Done
</pre></div>
</div>
<p>In Python 3.5, <a class="reference internal" href="#tornado.queues.Queue" title="tornado.queues.Queue"><code class="xref py py-obj docutils literal"><span class="pre">Queue</span></code></a> implements the async iterator protocol, so
<code class="docutils literal"><span class="pre">consumer()</span></code> could be rewritten as:</p>
<div class="highlight-python"><div class="highlight"><pre>async def consumer():
    async for item in q:
        try:
            print(&#39;Doing work on %s&#39; % item)
            yield gen.sleep(0.01)
        finally:
            q.task_done()
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Added <code class="docutils literal"><span class="pre">async</span> <span class="pre">for</span></code> support in Python 3.5.</p>
</div>
<dl class="attribute">
<dt id="tornado.queues.Queue.maxsize">
<code class="descname">maxsize</code><a class="headerlink" href="#tornado.queues.Queue.maxsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of items allowed in the queue.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.queues.Queue.qsize">
<code class="descname">qsize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/queues.html#Queue.qsize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.queues.Queue.qsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of items in the queue.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.queues.Queue.put">
<code class="descname">put</code><span class="sig-paren">(</span><em>item</em>, <em>timeout=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/queues.html#Queue.put"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.queues.Queue.put" title="Permalink to this definition">¶</a></dt>
<dd><p>Put an item into the queue, perhaps waiting until there is room.</p>
<p>Returns a Future, which raises <a class="reference internal" href="index.html#tornado.gen.TimeoutError" title="tornado.gen.TimeoutError"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.TimeoutError</span></code></a> after a
timeout.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.queues.Queue.put_nowait">
<code class="descname">put_nowait</code><span class="sig-paren">(</span><em>item</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/queues.html#Queue.put_nowait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.queues.Queue.put_nowait" title="Permalink to this definition">¶</a></dt>
<dd><p>Put an item into the queue without blocking.</p>
<p>If no free slot is immediately available, raise <a class="reference internal" href="#tornado.queues.QueueFull" title="tornado.queues.QueueFull"><code class="xref py py-obj docutils literal"><span class="pre">QueueFull</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.queues.Queue.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>timeout=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/queues.html#Queue.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.queues.Queue.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove and return an item from the queue.</p>
<p>Returns a Future which resolves once an item is available, or raises
<a class="reference internal" href="index.html#tornado.gen.TimeoutError" title="tornado.gen.TimeoutError"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.TimeoutError</span></code></a> after a timeout.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.queues.Queue.get_nowait">
<code class="descname">get_nowait</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/queues.html#Queue.get_nowait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.queues.Queue.get_nowait" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove and return an item from the queue without blocking.</p>
<p>Return an item if one is immediately available, else raise
<a class="reference internal" href="#tornado.queues.QueueEmpty" title="tornado.queues.QueueEmpty"><code class="xref py py-obj docutils literal"><span class="pre">QueueEmpty</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.queues.Queue.task_done">
<code class="descname">task_done</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/queues.html#Queue.task_done"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.queues.Queue.task_done" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicate that a formerly enqueued task is complete.</p>
<p>Used by queue consumers. For each <a class="reference internal" href="#tornado.queues.Queue.get" title="tornado.queues.Queue.get"><code class="xref py py-obj docutils literal"><span class="pre">get</span></code></a> used to fetch a task, a
subsequent call to <a class="reference internal" href="#tornado.queues.Queue.task_done" title="tornado.queues.Queue.task_done"><code class="xref py py-obj docutils literal"><span class="pre">task_done</span></code></a> tells the queue that the processing
on the task is complete.</p>
<p>If a <a class="reference internal" href="#tornado.queues.Queue.join" title="tornado.queues.Queue.join"><code class="xref py py-obj docutils literal"><span class="pre">join</span></code></a> is blocking, it resumes when all items have been
processed; that is, when every <a class="reference internal" href="#tornado.queues.Queue.put" title="tornado.queues.Queue.put"><code class="xref py py-obj docutils literal"><span class="pre">put</span></code></a> is matched by a <a class="reference internal" href="#tornado.queues.Queue.task_done" title="tornado.queues.Queue.task_done"><code class="xref py py-obj docutils literal"><span class="pre">task_done</span></code></a>.</p>
<p>Raises <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#ValueError" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ValueError</span></code></a> if called more times than <a class="reference internal" href="#tornado.queues.Queue.put" title="tornado.queues.Queue.put"><code class="xref py py-obj docutils literal"><span class="pre">put</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.queues.Queue.join">
<code class="descname">join</code><span class="sig-paren">(</span><em>timeout=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/queues.html#Queue.join"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.queues.Queue.join" title="Permalink to this definition">¶</a></dt>
<dd><p>Block until all items in the queue are processed.</p>
<p>Returns a Future, which raises <a class="reference internal" href="index.html#tornado.gen.TimeoutError" title="tornado.gen.TimeoutError"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.TimeoutError</span></code></a> after a
timeout.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="priorityqueue">
<h6>PriorityQueue<a class="headerlink" href="#priorityqueue" title="Permalink to this headline">¶</a></h6>
<dl class="class">
<dt id="tornado.queues.PriorityQueue">
<em class="property">class </em><code class="descclassname">tornado.queues.</code><code class="descname">PriorityQueue</code><span class="sig-paren">(</span><em>maxsize=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/queues.html#PriorityQueue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.queues.PriorityQueue" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#tornado.queues.Queue" title="tornado.queues.Queue"><code class="xref py py-obj docutils literal"><span class="pre">Queue</span></code></a> that retrieves entries in priority order, lowest first.</p>
<p>Entries are typically tuples like <code class="docutils literal"><span class="pre">(priority</span> <span class="pre">number,</span> <span class="pre">data)</span></code>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado.queues</span> <span class="kn">import</span> <span class="n">PriorityQueue</span>

<span class="n">q</span> <span class="o">=</span> <span class="n">PriorityQueue</span><span class="p">()</span>
<span class="n">q</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;medium-priority item&#39;</span><span class="p">))</span>
<span class="n">q</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;high-priority item&#39;</span><span class="p">))</span>
<span class="n">q</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="s">&#39;low-priority item&#39;</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>(0, &#39;high-priority item&#39;)
(1, &#39;medium-priority item&#39;)
(10, &#39;low-priority item&#39;)
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="lifoqueue">
<h6>LifoQueue<a class="headerlink" href="#lifoqueue" title="Permalink to this headline">¶</a></h6>
<dl class="class">
<dt id="tornado.queues.LifoQueue">
<em class="property">class </em><code class="descclassname">tornado.queues.</code><code class="descname">LifoQueue</code><span class="sig-paren">(</span><em>maxsize=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/queues.html#LifoQueue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.queues.LifoQueue" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#tornado.queues.Queue" title="tornado.queues.Queue"><code class="xref py py-obj docutils literal"><span class="pre">Queue</span></code></a> that retrieves the most recently put items first.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado.queues</span> <span class="kn">import</span> <span class="n">LifoQueue</span>

<span class="n">q</span> <span class="o">=</span> <span class="n">LifoQueue</span><span class="p">()</span>
<span class="n">q</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">q</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">q</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>1
2
3
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="exceptions">
<h5>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h5>
<div class="section" id="queueempty">
<h6>QueueEmpty<a class="headerlink" href="#queueempty" title="Permalink to this headline">¶</a></h6>
<dl class="exception">
<dt id="tornado.queues.QueueEmpty">
<em class="property">exception </em><code class="descclassname">tornado.queues.</code><code class="descname">QueueEmpty</code><a class="reference internal" href="_modules/tornado/queues.html#QueueEmpty"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.queues.QueueEmpty" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised by <a class="reference internal" href="#tornado.queues.Queue.get_nowait" title="tornado.queues.Queue.get_nowait"><code class="xref py py-obj docutils literal"><span class="pre">Queue.get_nowait</span></code></a> when the queue has no items.</p>
</dd></dl>

</div>
<div class="section" id="queuefull">
<h6>QueueFull<a class="headerlink" href="#queuefull" title="Permalink to this headline">¶</a></h6>
<dl class="exception">
<dt id="tornado.queues.QueueFull">
<em class="property">exception </em><code class="descclassname">tornado.queues.</code><code class="descname">QueueFull</code><a class="reference internal" href="_modules/tornado/queues.html#QueueFull"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.queues.QueueFull" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised by <a class="reference internal" href="#tornado.queues.Queue.put_nowait" title="tornado.queues.Queue.put_nowait"><code class="xref py py-obj docutils literal"><span class="pre">Queue.put_nowait</span></code></a> when a queue is at its maximum size.</p>
</dd></dl>

</div>
</div>
</div>
<span id="document-process"></span><div class="section" id="module-tornado.process">
<span id="tornado-process-utilities-for-multiple-processes"></span><h4><code class="docutils literal"><span class="pre">tornado.process</span></code> &#8212; Utilities for multiple processes<a class="headerlink" href="#module-tornado.process" title="Permalink to this headline">¶</a></h4>
<p>Utilities for working with multiple processes, including both forking
the server into multiple processes and managing subprocesses.</p>
<dl class="exception">
<dt id="tornado.process.CalledProcessError">
<em class="property">exception </em><code class="descclassname">tornado.process.</code><code class="descname">CalledProcessError</code><a class="reference internal" href="_modules/subprocess.html#CalledProcessError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.process.CalledProcessError" title="Permalink to this definition">¶</a></dt>
<dd><p>An alias for <a class="reference external" href="https://docs.python.org/3.4/library/subprocess.html#subprocess.CalledProcessError" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">subprocess.CalledProcessError</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.process.cpu_count">
<code class="descclassname">tornado.process.</code><code class="descname">cpu_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/process.html#cpu_count"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.process.cpu_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of processors on this machine.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.process.fork_processes">
<code class="descclassname">tornado.process.</code><code class="descname">fork_processes</code><span class="sig-paren">(</span><em>num_processes</em>, <em>max_restarts=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/process.html#fork_processes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.process.fork_processes" title="Permalink to this definition">¶</a></dt>
<dd><p>Starts multiple worker processes.</p>
<p>If <code class="docutils literal"><span class="pre">num_processes</span></code> is None or &lt;= 0, we detect the number of cores
available on this machine and fork that number of child
processes. If <code class="docutils literal"><span class="pre">num_processes</span></code> is given and &gt; 0, we fork that
specific number of sub-processes.</p>
<p>Since we use processes and not threads, there is no shared memory
between any server code.</p>
<p>Note that multiple processes are not compatible with the autoreload
module (or the <code class="docutils literal"><span class="pre">autoreload=True</span></code> option to <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.Application</span></code></a>
which defaults to True when <code class="docutils literal"><span class="pre">debug=True</span></code>).
When using multiple processes, no IOLoops can be created or
referenced until after the call to <code class="docutils literal"><span class="pre">fork_processes</span></code>.</p>
<p>In each child process, <code class="docutils literal"><span class="pre">fork_processes</span></code> returns its <em>task id</em>, a
number between 0 and <code class="docutils literal"><span class="pre">num_processes</span></code>.  Processes that exit
abnormally (due to a signal or non-zero exit status) are restarted
with the same id (up to <code class="docutils literal"><span class="pre">max_restarts</span></code> times).  In the parent
process, <code class="docutils literal"><span class="pre">fork_processes</span></code> returns None if all child processes
have exited normally, but will otherwise only exit by throwing an
exception.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.process.task_id">
<code class="descclassname">tornado.process.</code><code class="descname">task_id</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/process.html#task_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.process.task_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the current task id, if any.</p>
<p>Returns None if this process was not created by <a class="reference internal" href="#tornado.process.fork_processes" title="tornado.process.fork_processes"><code class="xref py py-obj docutils literal"><span class="pre">fork_processes</span></code></a>.</p>
</dd></dl>

<dl class="class">
<dt id="tornado.process.Subprocess">
<em class="property">class </em><code class="descclassname">tornado.process.</code><code class="descname">Subprocess</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/process.html#Subprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.process.Subprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Wraps <code class="docutils literal"><span class="pre">subprocess.Popen</span></code> with IOStream support.</p>
<p>The constructor is the same as <code class="docutils literal"><span class="pre">subprocess.Popen</span></code> with the following
additions:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">stdin</span></code>, <code class="docutils literal"><span class="pre">stdout</span></code>, and <code class="docutils literal"><span class="pre">stderr</span></code> may have the value
<code class="docutils literal"><span class="pre">tornado.process.Subprocess.STREAM</span></code>, which will make the corresponding
attribute of the resulting Subprocess a <a class="reference internal" href="index.html#tornado.iostream.PipeIOStream" title="tornado.iostream.PipeIOStream"><code class="xref py py-obj docutils literal"><span class="pre">PipeIOStream</span></code></a>.</li>
<li>A new keyword argument <code class="docutils literal"><span class="pre">io_loop</span></code> may be used to pass in an IOLoop.</li>
</ul>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>The <code class="docutils literal"><span class="pre">io_loop</span></code> argument is deprecated.</p>
</div>
<dl class="method">
<dt id="tornado.process.Subprocess.set_exit_callback">
<code class="descname">set_exit_callback</code><span class="sig-paren">(</span><em>callback</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/process.html#Subprocess.set_exit_callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.process.Subprocess.set_exit_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs <code class="docutils literal"><span class="pre">callback</span></code> when this process exits.</p>
<p>The callback takes one argument, the return code of the process.</p>
<p>This method uses a <code class="docutils literal"><span class="pre">SIGCHLD</span></code> handler, which is a global setting
and may conflict if you have other libraries trying to handle the
same signal.  If you are using more than one <code class="docutils literal"><span class="pre">IOLoop</span></code> it may
be necessary to call <a class="reference internal" href="#tornado.process.Subprocess.initialize" title="tornado.process.Subprocess.initialize"><code class="xref py py-obj docutils literal"><span class="pre">Subprocess.initialize</span></code></a> first to designate
one <code class="docutils literal"><span class="pre">IOLoop</span></code> to run the signal handlers.</p>
<p>In many cases a close callback on the stdout or stderr streams
can be used as an alternative to an exit callback if the
signal handler is causing a problem.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.process.Subprocess.wait_for_exit">
<code class="descname">wait_for_exit</code><span class="sig-paren">(</span><em>raise_error=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/process.html#Subprocess.wait_for_exit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.process.Subprocess.wait_for_exit" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> which resolves when the process exits.</p>
<p>Usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ret</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">proc</span><span class="o">.</span><span class="n">wait_for_exit</span><span class="p">()</span>
</pre></div>
</div>
<p>This is a coroutine-friendly alternative to <a class="reference internal" href="#tornado.process.Subprocess.set_exit_callback" title="tornado.process.Subprocess.set_exit_callback"><code class="xref py py-obj docutils literal"><span class="pre">set_exit_callback</span></code></a>
(and a replacement for the blocking <a class="reference external" href="https://docs.python.org/3.4/library/subprocess.html#subprocess.Popen.wait" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">subprocess.Popen.wait</span></code></a>).</p>
<p>By default, raises <a class="reference external" href="https://docs.python.org/3.4/library/subprocess.html#subprocess.CalledProcessError" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">subprocess.CalledProcessError</span></code></a> if the process
has a non-zero exit status. Use <code class="docutils literal"><span class="pre">wait_for_exit(raise_error=False)</span></code>
to suppress this behavior and return the exit status without raising.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.2.</span></p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="tornado.process.Subprocess.initialize">
<em class="property">classmethod </em><code class="descname">initialize</code><span class="sig-paren">(</span><em>io_loop=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/process.html#Subprocess.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.process.Subprocess.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes the <code class="docutils literal"><span class="pre">SIGCHLD</span></code> handler.</p>
<p>The signal handler is run on an <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> to avoid locking issues.
Note that the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> used for signal handling need not be the
same one used by individual Subprocess objects (as long as the
<code class="docutils literal"><span class="pre">IOLoops</span></code> are each running in separate threads).</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>The <code class="docutils literal"><span class="pre">io_loop</span></code> argument is deprecated.</p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="tornado.process.Subprocess.uninitialize">
<em class="property">classmethod </em><code class="descname">uninitialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/process.html#Subprocess.uninitialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.process.Subprocess.uninitialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the <code class="docutils literal"><span class="pre">SIGCHLD</span></code> handler.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>
<span id="document-integration"></span><div class="section" id="integration-with-other-services">
<h3>Integration with other services<a class="headerlink" href="#integration-with-other-services" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
<span id="document-auth"></span><div class="section" id="tornado-auth-third-party-login-with-openid-and-oauth">
<h4><code class="docutils literal"><span class="pre">tornado.auth</span></code> &#8212; Third-party login with OpenID and OAuth<a class="headerlink" href="#tornado-auth-third-party-login-with-openid-and-oauth" title="Permalink to this headline">¶</a></h4>
<span class="target" id="module-tornado.auth"></span><p>This module contains implementations of various third-party
authentication schemes.</p>
<p>All the classes in this file are class mixins designed to be used with
the <a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.RequestHandler</span></code></a> class.  They are used in two ways:</p>
<ul class="simple">
<li>On a login handler, use methods such as <code class="docutils literal"><span class="pre">authenticate_redirect()</span></code>,
<code class="docutils literal"><span class="pre">authorize_redirect()</span></code>, and <code class="docutils literal"><span class="pre">get_authenticated_user()</span></code> to
establish the user&#8217;s identity and store authentication tokens to your
database and/or cookies.</li>
<li>In non-login handlers, use methods such as <code class="docutils literal"><span class="pre">facebook_request()</span></code>
or <code class="docutils literal"><span class="pre">twitter_request()</span></code> to use the authentication tokens to make
requests to the respective services.</li>
</ul>
<p>They all take slightly different arguments due to the fact all these
services implement authentication and authorization slightly differently.
See the individual service classes below for complete documentation.</p>
<p>Example usage for Google OAuth:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">GoogleOAuth2LoginHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">,</span>
                               <span class="n">tornado</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">GoogleOAuth2Mixin</span><span class="p">):</span>
    <span class="nd">@tornado.gen.coroutine</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_argument</span><span class="p">(</span><span class="s">&#39;code&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">user</span> <span class="o">=</span> <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_authenticated_user</span><span class="p">(</span>
                <span class="n">redirect_uri</span><span class="o">=</span><span class="s">&#39;http://your.site.com/auth/google&#39;</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_argument</span><span class="p">(</span><span class="s">&#39;code&#39;</span><span class="p">))</span>
            <span class="c"># Save the user with e.g. set_secure_cookie</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorize_redirect</span><span class="p">(</span>
                <span class="n">redirect_uri</span><span class="o">=</span><span class="s">&#39;http://your.site.com/auth/google&#39;</span><span class="p">,</span>
                <span class="n">client_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s">&#39;google_oauth&#39;</span><span class="p">][</span><span class="s">&#39;key&#39;</span><span class="p">],</span>
                <span class="n">scope</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;profile&#39;</span><span class="p">,</span> <span class="s">&#39;email&#39;</span><span class="p">],</span>
                <span class="n">response_type</span><span class="o">=</span><span class="s">&#39;code&#39;</span><span class="p">,</span>
                <span class="n">extra_params</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;approval_prompt&#39;</span><span class="p">:</span> <span class="s">&#39;auto&#39;</span><span class="p">})</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>All of the callback interfaces in this module are now guaranteed
to run their callback with an argument of <code class="docutils literal"><span class="pre">None</span></code> on error.
Previously some functions would do this while others would simply
terminate the request on their own.  This change also ensures that
errors are more consistently reported through the <code class="docutils literal"><span class="pre">Future</span></code> interfaces.</p>
</div>
<div class="section" id="common-protocols">
<h5>Common protocols<a class="headerlink" href="#common-protocols" title="Permalink to this headline">¶</a></h5>
<p>These classes implement the OpenID and OAuth standards.  They will
generally need to be subclassed to use them with any particular site.
The degree of customization required will vary, but in most cases
overridding the class attributes (which are named beginning with
underscores for historical reasons) should be sufficient.</p>
<dl class="class">
<dt id="tornado.auth.OpenIdMixin">
<em class="property">class </em><code class="descclassname">tornado.auth.</code><code class="descname">OpenIdMixin</code><a class="reference internal" href="_modules/tornado/auth.html#OpenIdMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.OpenIdMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract implementation of OpenID and Attribute Exchange.</p>
<p>Class attributes:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">_OPENID_ENDPOINT</span></code>: the identity provider&#8217;s URI.</li>
</ul>
<dl class="method">
<dt id="tornado.auth.OpenIdMixin.authenticate_redirect">
<code class="descname">authenticate_redirect</code><span class="sig-paren">(</span><em>callback_uri=None, ax_attrs=['name', 'email', 'language', 'username'], callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/auth.html#OpenIdMixin.authenticate_redirect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.OpenIdMixin.authenticate_redirect" title="Permalink to this definition">¶</a></dt>
<dd><p>Redirects to the authentication URL for this service.</p>
<p>After authentication, the service will redirect back to the given
callback URI with additional parameters including <code class="docutils literal"><span class="pre">openid.mode</span></code>.</p>
<p>We request the given attributes for the authenticated user by
default (name, email, language, and username). If you don&#8217;t need
all those attributes for your app, you can request fewer with
the ax_attrs keyword argument.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.1: </span>Returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> and takes an optional callback.  These are
not strictly necessary as this method is synchronous,
but they are supplied for consistency with
<a class="reference internal" href="#tornado.auth.OAuthMixin.authorize_redirect" title="tornado.auth.OAuthMixin.authorize_redirect"><code class="xref py py-obj docutils literal"><span class="pre">OAuthMixin.authorize_redirect</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.auth.OpenIdMixin.get_authenticated_user">
<code class="descname">get_authenticated_user</code><span class="sig-paren">(</span><em>callback</em>, <em>http_client=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/auth.html#OpenIdMixin.get_authenticated_user"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.OpenIdMixin.get_authenticated_user" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetches the authenticated user data upon redirect.</p>
<p>This method should be called by the handler that receives the
redirect from the <a class="reference internal" href="#tornado.auth.OpenIdMixin.authenticate_redirect" title="tornado.auth.OpenIdMixin.authenticate_redirect"><code class="xref py py-obj docutils literal"><span class="pre">authenticate_redirect()</span></code></a> method (which is
often the same as the one that calls it; in that case you would
call <a class="reference internal" href="#tornado.auth.OpenIdMixin.get_authenticated_user" title="tornado.auth.OpenIdMixin.get_authenticated_user"><code class="xref py py-obj docutils literal"><span class="pre">get_authenticated_user</span></code></a> if the <code class="docutils literal"><span class="pre">openid.mode</span></code> parameter
is present and <a class="reference internal" href="#tornado.auth.OpenIdMixin.authenticate_redirect" title="tornado.auth.OpenIdMixin.authenticate_redirect"><code class="xref py py-obj docutils literal"><span class="pre">authenticate_redirect</span></code></a> if it is not).</p>
<p>The result of this method will generally be used to set a cookie.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.auth.OpenIdMixin.get_auth_http_client">
<code class="descname">get_auth_http_client</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/auth.html#OpenIdMixin.get_auth_http_client"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.OpenIdMixin.get_auth_http_client" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> instance to be used for auth requests.</p>
<p>May be overridden by subclasses to use an HTTP client other than
the default.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.auth.OAuthMixin">
<em class="property">class </em><code class="descclassname">tornado.auth.</code><code class="descname">OAuthMixin</code><a class="reference internal" href="_modules/tornado/auth.html#OAuthMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.OAuthMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract implementation of OAuth 1.0 and 1.0a.</p>
<p>See <a class="reference internal" href="#tornado.auth.TwitterMixin" title="tornado.auth.TwitterMixin"><code class="xref py py-obj docutils literal"><span class="pre">TwitterMixin</span></code></a> below for an example implementation.</p>
<p>Class attributes:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">_OAUTH_AUTHORIZE_URL</span></code>: The service&#8217;s OAuth authorization url.</li>
<li><code class="docutils literal"><span class="pre">_OAUTH_ACCESS_TOKEN_URL</span></code>: The service&#8217;s OAuth access token url.</li>
<li><code class="docutils literal"><span class="pre">_OAUTH_VERSION</span></code>: May be either &#8220;1.0&#8221; or &#8220;1.0a&#8221;.</li>
<li><code class="docutils literal"><span class="pre">_OAUTH_NO_CALLBACKS</span></code>: Set this to True if the service requires
advance registration of callbacks.</li>
</ul>
<p>Subclasses must also override the <a class="reference internal" href="#tornado.auth.OAuthMixin._oauth_get_user_future" title="tornado.auth.OAuthMixin._oauth_get_user_future"><code class="xref py py-obj docutils literal"><span class="pre">_oauth_get_user_future</span></code></a> and
<a class="reference internal" href="#tornado.auth.OAuthMixin._oauth_consumer_token" title="tornado.auth.OAuthMixin._oauth_consumer_token"><code class="xref py py-obj docutils literal"><span class="pre">_oauth_consumer_token</span></code></a> methods.</p>
<dl class="method">
<dt id="tornado.auth.OAuthMixin.authorize_redirect">
<code class="descname">authorize_redirect</code><span class="sig-paren">(</span><em>callback_uri=None</em>, <em>extra_params=None</em>, <em>http_client=None</em>, <em>callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/auth.html#OAuthMixin.authorize_redirect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.OAuthMixin.authorize_redirect" title="Permalink to this definition">¶</a></dt>
<dd><p>Redirects the user to obtain OAuth authorization for this service.</p>
<p>The <code class="docutils literal"><span class="pre">callback_uri</span></code> may be omitted if you have previously
registered a callback URI with the third-party service.  For
some services (including Friendfeed), you must use a
previously-registered callback URI and cannot specify a
callback via this method.</p>
<p>This method sets a cookie called <code class="docutils literal"><span class="pre">_oauth_request_token</span></code> which is
subsequently used (and cleared) in <a class="reference internal" href="#tornado.auth.OAuthMixin.get_authenticated_user" title="tornado.auth.OAuthMixin.get_authenticated_user"><code class="xref py py-obj docutils literal"><span class="pre">get_authenticated_user</span></code></a> for
security purposes.</p>
<p>Note that this method is asynchronous, although it calls
<a class="reference internal" href="index.html#tornado.web.RequestHandler.finish" title="tornado.web.RequestHandler.finish"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.finish</span></code></a> for you so it may not be necessary
to pass a callback or use the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> it returns.  However,
if this method is called from a function decorated with
<a class="reference internal" href="index.html#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">gen.coroutine</span></code></a>, you must call it with <code class="docutils literal"><span class="pre">yield</span></code> to keep the
response from being closed prematurely.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.1: </span>Now returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> and takes an optional callback, for
compatibility with <a class="reference internal" href="index.html#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">gen.coroutine</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.auth.OAuthMixin.get_authenticated_user">
<code class="descname">get_authenticated_user</code><span class="sig-paren">(</span><em>callback</em>, <em>http_client=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/auth.html#OAuthMixin.get_authenticated_user"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.OAuthMixin.get_authenticated_user" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the OAuth authorized user and access token.</p>
<p>This method should be called from the handler for your
OAuth callback URL to complete the registration process. We run the
callback with the authenticated user dictionary.  This dictionary
will contain an <code class="docutils literal"><span class="pre">access_key</span></code> which can be used to make authorized
requests to this service on behalf of the user.  The dictionary will
also contain other fields such as <code class="docutils literal"><span class="pre">name</span></code>, depending on the service
used.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.auth.OAuthMixin._oauth_consumer_token">
<code class="descname">_oauth_consumer_token</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/auth.html#OAuthMixin._oauth_consumer_token"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.OAuthMixin._oauth_consumer_token" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override this to return their OAuth consumer keys.</p>
<p>The return value should be a <a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#dict" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">dict</span></code></a> with keys <code class="docutils literal"><span class="pre">key</span></code> and <code class="docutils literal"><span class="pre">secret</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.auth.OAuthMixin._oauth_get_user_future">
<code class="descname">_oauth_get_user_future</code><span class="sig-paren">(</span><em>access_token</em>, <em>callback</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/auth.html#OAuthMixin._oauth_get_user_future"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.OAuthMixin._oauth_get_user_future" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override this to get basic information about the
user.</p>
<p>Should return a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> whose result is a dictionary
containing information about the user, which may have been
retrieved by using <code class="docutils literal"><span class="pre">access_token</span></code> to make a request to the
service.</p>
<p>The access token will be added to the returned dictionary to make
the result of <a class="reference internal" href="#tornado.auth.OAuthMixin.get_authenticated_user" title="tornado.auth.OAuthMixin.get_authenticated_user"><code class="xref py py-obj docutils literal"><span class="pre">get_authenticated_user</span></code></a>.</p>
<p>For backwards compatibility, the callback-based <code class="docutils literal"><span class="pre">_oauth_get_user</span></code>
method is also supported.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.auth.OAuthMixin.get_auth_http_client">
<code class="descname">get_auth_http_client</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/auth.html#OAuthMixin.get_auth_http_client"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.OAuthMixin.get_auth_http_client" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> instance to be used for auth requests.</p>
<p>May be overridden by subclasses to use an HTTP client other than
the default.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.auth.OAuth2Mixin">
<em class="property">class </em><code class="descclassname">tornado.auth.</code><code class="descname">OAuth2Mixin</code><a class="reference internal" href="_modules/tornado/auth.html#OAuth2Mixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.OAuth2Mixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract implementation of OAuth 2.0.</p>
<p>See <a class="reference internal" href="#tornado.auth.FacebookGraphMixin" title="tornado.auth.FacebookGraphMixin"><code class="xref py py-obj docutils literal"><span class="pre">FacebookGraphMixin</span></code></a> or <a class="reference internal" href="#tornado.auth.GoogleOAuth2Mixin" title="tornado.auth.GoogleOAuth2Mixin"><code class="xref py py-obj docutils literal"><span class="pre">GoogleOAuth2Mixin</span></code></a> below for example
implementations.</p>
<p>Class attributes:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">_OAUTH_AUTHORIZE_URL</span></code>: The service&#8217;s authorization url.</li>
<li><code class="docutils literal"><span class="pre">_OAUTH_ACCESS_TOKEN_URL</span></code>:  The service&#8217;s access token url.</li>
</ul>
<dl class="method">
<dt id="tornado.auth.OAuth2Mixin.authorize_redirect">
<code class="descname">authorize_redirect</code><span class="sig-paren">(</span><em>redirect_uri=None</em>, <em>client_id=None</em>, <em>client_secret=None</em>, <em>extra_params=None</em>, <em>callback=None</em>, <em>scope=None</em>, <em>response_type='code'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/auth.html#OAuth2Mixin.authorize_redirect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.OAuth2Mixin.authorize_redirect" title="Permalink to this definition">¶</a></dt>
<dd><p>Redirects the user to obtain OAuth authorization for this service.</p>
<p>Some providers require that you register a redirect URL with
your application instead of passing one via this method. You
should call this method to log the user in, and then call
<code class="docutils literal"><span class="pre">get_authenticated_user</span></code> in the handler for your
redirect URL to complete the authorization process.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.1: </span>Returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> and takes an optional callback.  These are
not strictly necessary as this method is synchronous,
but they are supplied for consistency with
<a class="reference internal" href="#tornado.auth.OAuthMixin.authorize_redirect" title="tornado.auth.OAuthMixin.authorize_redirect"><code class="xref py py-obj docutils literal"><span class="pre">OAuthMixin.authorize_redirect</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.auth.OAuth2Mixin.oauth2_request">
<code class="descname">oauth2_request</code><span class="sig-paren">(</span><em>url</em>, <em>callback</em>, <em>access_token=None</em>, <em>post_args=None</em>, <em>**args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/auth.html#OAuth2Mixin.oauth2_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.OAuth2Mixin.oauth2_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetches the given URL auth an OAuth2 access token.</p>
<p>If the request is a POST, <code class="docutils literal"><span class="pre">post_args</span></code> should be provided. Query
string arguments should be given as keyword arguments.</p>
<p>Example usage:</p>
<p>..testcode:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">,</span>
                  <span class="n">tornado</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">FacebookGraphMixin</span><span class="p">):</span>
    <span class="nd">@tornado.web.authenticated</span>
    <span class="nd">@tornado.gen.coroutine</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_entry</span> <span class="o">=</span> <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">oauth2_request</span><span class="p">(</span>
            <span class="s">&quot;https://graph.facebook.com/me/feed&quot;</span><span class="p">,</span>
            <span class="n">post_args</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;message&quot;</span><span class="p">:</span> <span class="s">&quot;I am posting from my Tornado application!&quot;</span><span class="p">},</span>
            <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_user</span><span class="p">[</span><span class="s">&quot;access_token&quot;</span><span class="p">])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">new_entry</span><span class="p">:</span>
            <span class="c"># Call failed; perhaps missing permission?</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorize_redirect</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finish</span><span class="p">(</span><span class="s">&quot;Posted a message!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.3.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.auth.OAuth2Mixin.get_auth_http_client">
<code class="descname">get_auth_http_client</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/auth.html#OAuth2Mixin.get_auth_http_client"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.OAuth2Mixin.get_auth_http_client" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> instance to be used for auth requests.</p>
<p>May be overridden by subclasses to use an HTTP client other than
the default.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.3.</span></p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="google">
<h5>Google<a class="headerlink" href="#google" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.auth.GoogleOAuth2Mixin">
<em class="property">class </em><code class="descclassname">tornado.auth.</code><code class="descname">GoogleOAuth2Mixin</code><a class="reference internal" href="_modules/tornado/auth.html#GoogleOAuth2Mixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.GoogleOAuth2Mixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Google authentication using OAuth2.</p>
<p>In order to use, register your application with Google and copy the
relevant parameters to your application settings.</p>
<ul class="simple">
<li>Go to the Google Dev Console at <a class="reference external" href="http://console.developers.google.com">http://console.developers.google.com</a></li>
<li>Select a project, or create a new one.</li>
<li>In the sidebar on the left, select APIs &amp; Auth.</li>
<li>In the list of APIs, find the Google+ API service and set it to ON.</li>
<li>In the sidebar on the left, select Credentials.</li>
<li>In the OAuth section of the page, select Create New Client ID.</li>
<li>Set the Redirect URI to point to your auth handler</li>
<li>Copy the &#8220;Client secret&#8221; and &#8220;Client ID&#8221; to the application settings as
{&#8220;google_oauth&#8221;: {&#8220;key&#8221;: CLIENT_ID, &#8220;secret&#8221;: CLIENT_SECRET}}</li>
</ul>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2.</span></p>
</div>
<dl class="method">
<dt id="tornado.auth.GoogleOAuth2Mixin.get_authenticated_user">
<code class="descname">get_authenticated_user</code><span class="sig-paren">(</span><em>redirect_uri</em>, <em>code</em>, <em>callback</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/auth.html#GoogleOAuth2Mixin.get_authenticated_user"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.GoogleOAuth2Mixin.get_authenticated_user" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles the login for the Google user, returning an access token.</p>
<p>The result is a dictionary containing an <code class="docutils literal"><span class="pre">access_token</span></code> field
([among others](<a class="reference external" href="https://developers.google.com/identity/protocols/OAuth2WebServer#handlingtheresponse">https://developers.google.com/identity/protocols/OAuth2WebServer#handlingtheresponse</a>)).
Unlike other <code class="docutils literal"><span class="pre">get_authenticated_user</span></code> methods in this package,
this method does not return any additional information about the user.
The returned access token can be used with <a class="reference internal" href="#tornado.auth.OAuth2Mixin.oauth2_request" title="tornado.auth.OAuth2Mixin.oauth2_request"><code class="xref py py-obj docutils literal"><span class="pre">OAuth2Mixin.oauth2_request</span></code></a>
to request additional information (perhaps from
<code class="docutils literal"><span class="pre">https://www.googleapis.com/oauth2/v2/userinfo</span></code>)</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">GoogleOAuth2LoginHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">,</span>
                               <span class="n">tornado</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">GoogleOAuth2Mixin</span><span class="p">):</span>
    <span class="nd">@tornado.gen.coroutine</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_argument</span><span class="p">(</span><span class="s">&#39;code&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">access</span> <span class="o">=</span> <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_authenticated_user</span><span class="p">(</span>
                <span class="n">redirect_uri</span><span class="o">=</span><span class="s">&#39;http://your.site.com/auth/google&#39;</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_argument</span><span class="p">(</span><span class="s">&#39;code&#39;</span><span class="p">))</span>
            <span class="n">user</span> <span class="o">=</span> <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">oauth2_request</span><span class="p">(</span>
                <span class="s">&quot;https://www.googleapis.com/oauth2/v1/userinfo&quot;</span><span class="p">,</span>
                <span class="n">access_token</span><span class="o">=</span><span class="n">access</span><span class="p">[</span><span class="s">&quot;access_token&quot;</span><span class="p">])</span>
            <span class="c"># Save the user and access token with</span>
            <span class="c"># e.g. set_secure_cookie.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorize_redirect</span><span class="p">(</span>
                <span class="n">redirect_uri</span><span class="o">=</span><span class="s">&#39;http://your.site.com/auth/google&#39;</span><span class="p">,</span>
                <span class="n">client_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s">&#39;google_oauth&#39;</span><span class="p">][</span><span class="s">&#39;key&#39;</span><span class="p">],</span>
                <span class="n">scope</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;profile&#39;</span><span class="p">,</span> <span class="s">&#39;email&#39;</span><span class="p">],</span>
                <span class="n">response_type</span><span class="o">=</span><span class="s">&#39;code&#39;</span><span class="p">,</span>
                <span class="n">extra_params</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;approval_prompt&#39;</span><span class="p">:</span> <span class="s">&#39;auto&#39;</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="facebook">
<h5>Facebook<a class="headerlink" href="#facebook" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.auth.FacebookGraphMixin">
<em class="property">class </em><code class="descclassname">tornado.auth.</code><code class="descname">FacebookGraphMixin</code><a class="reference internal" href="_modules/tornado/auth.html#FacebookGraphMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.FacebookGraphMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Facebook authentication using the new Graph API and OAuth2.</p>
<dl class="method">
<dt id="tornado.auth.FacebookGraphMixin.get_authenticated_user">
<code class="descname">get_authenticated_user</code><span class="sig-paren">(</span><em>redirect_uri</em>, <em>client_id</em>, <em>client_secret</em>, <em>code</em>, <em>callback</em>, <em>extra_fields=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/auth.html#FacebookGraphMixin.get_authenticated_user"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.FacebookGraphMixin.get_authenticated_user" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles the login for the Facebook user, returning a user object.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">FacebookGraphLoginHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">,</span>
                                <span class="n">tornado</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">FacebookGraphMixin</span><span class="p">):</span>
  <span class="nd">@tornado.gen.coroutine</span>
  <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_argument</span><span class="p">(</span><span class="s">&quot;code&quot;</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
          <span class="n">user</span> <span class="o">=</span> <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_authenticated_user</span><span class="p">(</span>
              <span class="n">redirect_uri</span><span class="o">=</span><span class="s">&#39;/auth/facebookgraph/&#39;</span><span class="p">,</span>
              <span class="n">client_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s">&quot;facebook_api_key&quot;</span><span class="p">],</span>
              <span class="n">client_secret</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s">&quot;facebook_secret&quot;</span><span class="p">],</span>
              <span class="n">code</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_argument</span><span class="p">(</span><span class="s">&quot;code&quot;</span><span class="p">))</span>
          <span class="c"># Save the user with e.g. set_secure_cookie</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorize_redirect</span><span class="p">(</span>
              <span class="n">redirect_uri</span><span class="o">=</span><span class="s">&#39;/auth/facebookgraph/&#39;</span><span class="p">,</span>
              <span class="n">client_id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s">&quot;facebook_api_key&quot;</span><span class="p">],</span>
              <span class="n">extra_params</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;scope&quot;</span><span class="p">:</span> <span class="s">&quot;read_stream,offline_access&quot;</span><span class="p">})</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.auth.FacebookGraphMixin.facebook_request">
<code class="descname">facebook_request</code><span class="sig-paren">(</span><em>path</em>, <em>callback</em>, <em>access_token=None</em>, <em>post_args=None</em>, <em>**args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/auth.html#FacebookGraphMixin.facebook_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.FacebookGraphMixin.facebook_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetches the given relative API path, e.g., &#8220;/btaylor/picture&#8221;</p>
<p>If the request is a POST, <code class="docutils literal"><span class="pre">post_args</span></code> should be provided. Query
string arguments should be given as keyword arguments.</p>
<p>An introduction to the Facebook Graph API can be found at
<a class="reference external" href="http://developers.facebook.com/docs/api">http://developers.facebook.com/docs/api</a></p>
<p>Many methods require an OAuth access token which you can
obtain through <a class="reference internal" href="#tornado.auth.OAuth2Mixin.authorize_redirect" title="tornado.auth.OAuth2Mixin.authorize_redirect"><code class="xref py py-obj docutils literal"><span class="pre">authorize_redirect</span></code></a> and
<a class="reference internal" href="#tornado.auth.FacebookGraphMixin.get_authenticated_user" title="tornado.auth.FacebookGraphMixin.get_authenticated_user"><code class="xref py py-obj docutils literal"><span class="pre">get_authenticated_user</span></code></a>. The user returned through that
process includes an <code class="docutils literal"><span class="pre">access_token</span></code> attribute that can be
used to make authenticated requests via this method.</p>
<p>Example usage:</p>
<p>..testcode:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">,</span>
                  <span class="n">tornado</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">FacebookGraphMixin</span><span class="p">):</span>
    <span class="nd">@tornado.web.authenticated</span>
    <span class="nd">@tornado.gen.coroutine</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_entry</span> <span class="o">=</span> <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">facebook_request</span><span class="p">(</span>
            <span class="s">&quot;/me/feed&quot;</span><span class="p">,</span>
            <span class="n">post_args</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;message&quot;</span><span class="p">:</span> <span class="s">&quot;I am posting from my Tornado application!&quot;</span><span class="p">},</span>
            <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_user</span><span class="p">[</span><span class="s">&quot;access_token&quot;</span><span class="p">])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">new_entry</span><span class="p">:</span>
            <span class="c"># Call failed; perhaps missing permission?</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorize_redirect</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finish</span><span class="p">(</span><span class="s">&quot;Posted a message!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The given path is relative to <code class="docutils literal"><span class="pre">self._FACEBOOK_BASE_URL</span></code>,
by default &#8220;<a class="reference external" href="https://graph.facebook.com">https://graph.facebook.com</a>&#8221;.</p>
<p>This method is a wrapper around <a class="reference internal" href="#tornado.auth.OAuth2Mixin.oauth2_request" title="tornado.auth.OAuth2Mixin.oauth2_request"><code class="xref py py-obj docutils literal"><span class="pre">OAuth2Mixin.oauth2_request</span></code></a>;
the only difference is that this method takes a relative path,
while <code class="docutils literal"><span class="pre">oauth2_request</span></code> takes a complete url.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.1: </span>Added the ability to override <code class="docutils literal"><span class="pre">self._FACEBOOK_BASE_URL</span></code>.</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="twitter">
<h5>Twitter<a class="headerlink" href="#twitter" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.auth.TwitterMixin">
<em class="property">class </em><code class="descclassname">tornado.auth.</code><code class="descname">TwitterMixin</code><a class="reference internal" href="_modules/tornado/auth.html#TwitterMixin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.TwitterMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Twitter OAuth authentication.</p>
<p>To authenticate with Twitter, register your application with
Twitter at <a class="reference external" href="http://twitter.com/apps">http://twitter.com/apps</a>. Then copy your Consumer Key
and Consumer Secret to the application
<a class="reference internal" href="index.html#tornado.web.Application.settings" title="tornado.web.Application.settings"><code class="xref py py-obj docutils literal"><span class="pre">settings</span></code></a> <code class="docutils literal"><span class="pre">twitter_consumer_key</span></code> and
<code class="docutils literal"><span class="pre">twitter_consumer_secret</span></code>. Use this mixin on the handler for the
URL you registered as your application&#8217;s callback URL.</p>
<p>When your application is set up, you can use this mixin like this
to authenticate the user with Twitter and get access to their stream:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">TwitterLoginHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">,</span>
                          <span class="n">tornado</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">TwitterMixin</span><span class="p">):</span>
    <span class="nd">@tornado.gen.coroutine</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_argument</span><span class="p">(</span><span class="s">&quot;oauth_token&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
            <span class="n">user</span> <span class="o">=</span> <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_authenticated_user</span><span class="p">()</span>
            <span class="c"># Save the user using e.g. set_secure_cookie()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorize_redirect</span><span class="p">()</span>
</pre></div>
</div>
<p>The user object returned by <a class="reference internal" href="#tornado.auth.OAuthMixin.get_authenticated_user" title="tornado.auth.OAuthMixin.get_authenticated_user"><code class="xref py py-obj docutils literal"><span class="pre">get_authenticated_user</span></code></a>
includes the attributes <code class="docutils literal"><span class="pre">username</span></code>, <code class="docutils literal"><span class="pre">name</span></code>, <code class="docutils literal"><span class="pre">access_token</span></code>,
and all of the custom Twitter user attributes described at
<a class="reference external" href="https://dev.twitter.com/docs/api/1.1/get/users/show">https://dev.twitter.com/docs/api/1.1/get/users/show</a></p>
<dl class="method">
<dt id="tornado.auth.TwitterMixin.authenticate_redirect">
<code class="descname">authenticate_redirect</code><span class="sig-paren">(</span><em>callback_uri=None</em>, <em>callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/auth.html#TwitterMixin.authenticate_redirect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.TwitterMixin.authenticate_redirect" title="Permalink to this definition">¶</a></dt>
<dd><p>Just like <a class="reference internal" href="#tornado.auth.OAuthMixin.authorize_redirect" title="tornado.auth.OAuthMixin.authorize_redirect"><code class="xref py py-obj docutils literal"><span class="pre">authorize_redirect</span></code></a>, but
auto-redirects if authorized.</p>
<p>This is generally the right interface to use if you are using
Twitter for single-sign on.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.1: </span>Now returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> and takes an optional callback, for
compatibility with <a class="reference internal" href="index.html#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">gen.coroutine</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.auth.TwitterMixin.twitter_request">
<code class="descname">twitter_request</code><span class="sig-paren">(</span><em>path</em>, <em>callback=None</em>, <em>access_token=None</em>, <em>post_args=None</em>, <em>**args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/auth.html#TwitterMixin.twitter_request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.auth.TwitterMixin.twitter_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetches the given API path, e.g., <code class="docutils literal"><span class="pre">statuses/user_timeline/btaylor</span></code></p>
<p>The path should not include the format or API version number.
(we automatically use JSON format and API version 1).</p>
<p>If the request is a POST, <code class="docutils literal"><span class="pre">post_args</span></code> should be provided. Query
string arguments should be given as keyword arguments.</p>
<p>All the Twitter methods are documented at <a class="reference external" href="http://dev.twitter.com/">http://dev.twitter.com/</a></p>
<p>Many methods require an OAuth access token which you can
obtain through <a class="reference internal" href="#tornado.auth.OAuthMixin.authorize_redirect" title="tornado.auth.OAuthMixin.authorize_redirect"><code class="xref py py-obj docutils literal"><span class="pre">authorize_redirect</span></code></a> and
<a class="reference internal" href="#tornado.auth.OAuthMixin.get_authenticated_user" title="tornado.auth.OAuthMixin.get_authenticated_user"><code class="xref py py-obj docutils literal"><span class="pre">get_authenticated_user</span></code></a>. The user returned through that
process includes an &#8216;access_token&#8217; attribute that can be used
to make authenticated requests via this method. Example
usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">,</span>
                  <span class="n">tornado</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">TwitterMixin</span><span class="p">):</span>
    <span class="nd">@tornado.web.authenticated</span>
    <span class="nd">@tornado.gen.coroutine</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">new_entry</span> <span class="o">=</span> <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">twitter_request</span><span class="p">(</span>
            <span class="s">&quot;/statuses/update&quot;</span><span class="p">,</span>
            <span class="n">post_args</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;status&quot;</span><span class="p">:</span> <span class="s">&quot;Testing Tornado Web Server&quot;</span><span class="p">},</span>
            <span class="n">access_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">current_user</span><span class="p">[</span><span class="s">&quot;access_token&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">new_entry</span><span class="p">:</span>
            <span class="c"># Call failed; perhaps missing permission?</span>
            <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">authorize_redirect</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finish</span><span class="p">(</span><span class="s">&quot;Posted a message!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
</div>
<span id="document-wsgi"></span><div class="section" id="module-tornado.wsgi">
<span id="tornado-wsgi-interoperability-with-other-python-frameworks-and-servers"></span><h4><code class="docutils literal"><span class="pre">tornado.wsgi</span></code> &#8212; Interoperability with other Python frameworks and servers<a class="headerlink" href="#module-tornado.wsgi" title="Permalink to this headline">¶</a></h4>
<p>WSGI support for the Tornado web framework.</p>
<p>WSGI is the Python standard for web servers, and allows for interoperability
between Tornado and other Python web frameworks and servers.  This module
provides WSGI support in two ways:</p>
<ul class="simple">
<li><a class="reference internal" href="#tornado.wsgi.WSGIAdapter" title="tornado.wsgi.WSGIAdapter"><code class="xref py py-obj docutils literal"><span class="pre">WSGIAdapter</span></code></a> converts a <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.Application</span></code></a> to the WSGI application
interface.  This is useful for running a Tornado app on another
HTTP server, such as Google App Engine.  See the <a class="reference internal" href="#tornado.wsgi.WSGIAdapter" title="tornado.wsgi.WSGIAdapter"><code class="xref py py-obj docutils literal"><span class="pre">WSGIAdapter</span></code></a> class
documentation for limitations that apply.</li>
<li><a class="reference internal" href="#tornado.wsgi.WSGIContainer" title="tornado.wsgi.WSGIContainer"><code class="xref py py-obj docutils literal"><span class="pre">WSGIContainer</span></code></a> lets you run other WSGI applications and frameworks on the
Tornado HTTP server.  For example, with this class you can mix Django
and Tornado handlers in a single server.</li>
</ul>
<div class="section" id="running-tornado-apps-on-wsgi-servers">
<h5>Running Tornado apps on WSGI servers<a class="headerlink" href="#running-tornado-apps-on-wsgi-servers" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.wsgi.WSGIAdapter">
<em class="property">class </em><code class="descclassname">tornado.wsgi.</code><code class="descname">WSGIAdapter</code><span class="sig-paren">(</span><em>application</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/wsgi.html#WSGIAdapter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.wsgi.WSGIAdapter" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.Application</span></code></a> instance into a WSGI application.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">tornado.web</span>
<span class="kn">import</span> <span class="nn">tornado.wsgi</span>
<span class="kn">import</span> <span class="nn">wsgiref.simple_server</span>

<span class="k">class</span> <span class="nc">MainHandler</span><span class="p">(</span><span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Hello, world&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">application</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
        <span class="p">(</span><span class="s">r&quot;/&quot;</span><span class="p">,</span> <span class="n">MainHandler</span><span class="p">),</span>
    <span class="p">])</span>
    <span class="n">wsgi_app</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">wsgi</span><span class="o">.</span><span class="n">WSGIAdapter</span><span class="p">(</span><span class="n">application</span><span class="p">)</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">wsgiref</span><span class="o">.</span><span class="n">simple_server</span><span class="o">.</span><span class="n">make_server</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="mi">8888</span><span class="p">,</span> <span class="n">wsgi_app</span><span class="p">)</span>
    <span class="n">server</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</pre></div>
</div>
<p>See the <a class="reference external" href="https://github.com/tornadoweb/tornado/tree/stable/demos/appengine">appengine demo</a>
for an example of using this module to run a Tornado app on Google
App Engine.</p>
<p>In WSGI mode asynchronous methods are not supported.  This means
that it is not possible to use <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a>, or the
<a class="reference internal" href="index.html#module-tornado.auth" title="tornado.auth"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth</span></code></a> or <a class="reference internal" href="index.html#module-tornado.websocket" title="tornado.websocket"><code class="xref py py-obj docutils literal"><span class="pre">tornado.websocket</span></code></a> modules.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.0.</span></p>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.wsgi.WSGIApplication">
<em class="property">class </em><code class="descclassname">tornado.wsgi.</code><code class="descname">WSGIApplication</code><span class="sig-paren">(</span><em>handlers=None</em>, <em>default_host=''</em>, <em>transforms=None</em>, <em>**settings</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/wsgi.html#WSGIApplication"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.wsgi.WSGIApplication" title="Permalink to this definition">¶</a></dt>
<dd><p>A WSGI equivalent of <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.Application</span></code></a>.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 4.0: </span>Use a regular <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> and wrap it in <a class="reference internal" href="#tornado.wsgi.WSGIAdapter" title="tornado.wsgi.WSGIAdapter"><code class="xref py py-obj docutils literal"><span class="pre">WSGIAdapter</span></code></a> instead.</p>
</div>
</dd></dl>

</div>
<div class="section" id="running-wsgi-apps-on-tornado-servers">
<h5>Running WSGI apps on Tornado servers<a class="headerlink" href="#running-wsgi-apps-on-tornado-servers" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.wsgi.WSGIContainer">
<em class="property">class </em><code class="descclassname">tornado.wsgi.</code><code class="descname">WSGIContainer</code><span class="sig-paren">(</span><em>wsgi_application</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/wsgi.html#WSGIContainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.wsgi.WSGIContainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a WSGI-compatible function runnable on Tornado&#8217;s HTTP server.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">WSGI is a <em>synchronous</em> interface, while Tornado&#8217;s concurrency model
is based on single-threaded asynchronous execution.  This means that
running a WSGI app with Tornado&#8217;s <a class="reference internal" href="#tornado.wsgi.WSGIContainer" title="tornado.wsgi.WSGIContainer"><code class="xref py py-obj docutils literal"><span class="pre">WSGIContainer</span></code></a> is <em>less scalable</em>
than running the same app in a multi-threaded WSGI server like
<code class="docutils literal"><span class="pre">gunicorn</span></code> or <code class="docutils literal"><span class="pre">uwsgi</span></code>.  Use <a class="reference internal" href="#tornado.wsgi.WSGIContainer" title="tornado.wsgi.WSGIContainer"><code class="xref py py-obj docutils literal"><span class="pre">WSGIContainer</span></code></a> only when there are
benefits to combining Tornado and WSGI in the same process that
outweigh the reduced scalability.</p>
</div>
<p>Wrap a WSGI function in a <a class="reference internal" href="#tornado.wsgi.WSGIContainer" title="tornado.wsgi.WSGIContainer"><code class="xref py py-obj docutils literal"><span class="pre">WSGIContainer</span></code></a> and pass it to <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> to
run it. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">simple_app</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="s">&quot;200 OK&quot;</span>
    <span class="n">response_headers</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&quot;Content-type&quot;</span><span class="p">,</span> <span class="s">&quot;text/plain&quot;</span><span class="p">)]</span>
    <span class="n">start_response</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">response_headers</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="s">&quot;Hello world!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">]</span>

<span class="n">container</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">wsgi</span><span class="o">.</span><span class="n">WSGIContainer</span><span class="p">(</span><span class="n">simple_app</span><span class="p">)</span>
<span class="n">http_server</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">httpserver</span><span class="o">.</span><span class="n">HTTPServer</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
<span class="n">http_server</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">8888</span><span class="p">)</span>
<span class="n">tornado</span><span class="o">.</span><span class="n">ioloop</span><span class="o">.</span><span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>This class is intended to let other frameworks (Django, web.py, etc)
run on the Tornado HTTP server and I/O loop.</p>
<p>The <a class="reference internal" href="index.html#tornado.web.FallbackHandler" title="tornado.web.FallbackHandler"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.FallbackHandler</span></code></a> class is often useful for mixing
Tornado and WSGI apps in the same server.  See
<a class="reference external" href="https://github.com/bdarnell/django-tornado-demo">https://github.com/bdarnell/django-tornado-demo</a> for a complete example.</p>
<dl class="staticmethod">
<dt id="tornado.wsgi.WSGIContainer.environ">
<em class="property">static </em><code class="descname">environ</code><span class="sig-paren">(</span><em>request</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/wsgi.html#WSGIContainer.environ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.wsgi.WSGIContainer.environ" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a <a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest" title="tornado.httputil.HTTPServerRequest"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httputil.HTTPServerRequest</span></code></a> to a WSGI environment.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<span id="document-asyncio"></span><div class="section" id="module-tornado.platform.asyncio">
<span id="tornado-platform-asyncio-bridge-between-asyncio-and-tornado"></span><h4><code class="docutils literal"><span class="pre">tornado.platform.asyncio</span></code> &#8212; Bridge between <code class="docutils literal"><span class="pre">asyncio</span></code> and Tornado<a class="headerlink" href="#module-tornado.platform.asyncio" title="Permalink to this headline">¶</a></h4>
<p>Bridges between the <a class="reference external" href="https://docs.python.org/3.4/library/asyncio.html#module-asyncio" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">asyncio</span></code></a> module and Tornado IOLoop.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.2.</span></p>
</div>
<p>This module integrates Tornado with the <code class="docutils literal"><span class="pre">asyncio</span></code> module introduced
in Python 3.4 (and available <a class="reference external" href="https://pypi.python.org/pypi/asyncio">as a separate download</a> for Python 3.3).  This makes
it possible to combine the two libraries on the same event loop.</p>
<p>Most applications should use <a class="reference internal" href="#tornado.platform.asyncio.AsyncIOMainLoop" title="tornado.platform.asyncio.AsyncIOMainLoop"><code class="xref py py-obj docutils literal"><span class="pre">AsyncIOMainLoop</span></code></a> to run Tornado on the
default <code class="docutils literal"><span class="pre">asyncio</span></code> event loop.  Applications that need to run event
loops on multiple threads may use <a class="reference internal" href="#tornado.platform.asyncio.AsyncIOLoop" title="tornado.platform.asyncio.AsyncIOLoop"><code class="xref py py-obj docutils literal"><span class="pre">AsyncIOLoop</span></code></a> to create multiple
loops.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Tornado requires the <a class="reference external" href="https://docs.python.org/3.4/library/asyncio-eventloop.html#asyncio.BaseEventLoop.add_reader" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">add_reader</span></code></a> family of methods,
so it is not compatible with the <a class="reference external" href="https://docs.python.org/3.4/library/asyncio-eventloops.html#asyncio.ProactorEventLoop" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ProactorEventLoop</span></code></a> on Windows.
Use the <a class="reference external" href="https://docs.python.org/3.4/library/asyncio-eventloops.html#asyncio.SelectorEventLoop" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">SelectorEventLoop</span></code></a> instead.</p>
</div>
<dl class="class">
<dt id="tornado.platform.asyncio.AsyncIOMainLoop">
<em class="property">class </em><code class="descclassname">tornado.platform.asyncio.</code><code class="descname">AsyncIOMainLoop</code><a class="reference internal" href="_modules/tornado/platform/asyncio.html#AsyncIOMainLoop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.platform.asyncio.AsyncIOMainLoop" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">AsyncIOMainLoop</span></code> creates an <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> that corresponds to the
current <code class="docutils literal"><span class="pre">asyncio</span></code> event loop (i.e. the one returned by
<code class="docutils literal"><span class="pre">asyncio.get_event_loop()</span></code>).  Recommended usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado.platform.asyncio</span> <span class="kn">import</span> <span class="n">AsyncIOMainLoop</span>
<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="n">AsyncIOMainLoop</span><span class="p">()</span><span class="o">.</span><span class="n">install</span><span class="p">()</span>
<span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span><span class="o">.</span><span class="n">run_forever</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="tornado.platform.asyncio.AsyncIOLoop">
<em class="property">class </em><code class="descclassname">tornado.platform.asyncio.</code><code class="descname">AsyncIOLoop</code><a class="reference internal" href="_modules/tornado/platform/asyncio.html#AsyncIOLoop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.platform.asyncio.AsyncIOLoop" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">AsyncIOLoop</span></code> is an <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> that runs on an <code class="docutils literal"><span class="pre">asyncio</span></code> event loop.
This class follows the usual Tornado semantics for creating new
<code class="docutils literal"><span class="pre">IOLoops</span></code>; these loops are not necessarily related to the
<code class="docutils literal"><span class="pre">asyncio</span></code> default event loop.  Recommended usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado.ioloop</span> <span class="kn">import</span> <span class="n">IOLoop</span>
<span class="n">IOLoop</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s">&#39;tornado.platform.asyncio.AsyncIOLoop&#39;</span><span class="p">)</span>
<span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>Each <code class="docutils literal"><span class="pre">AsyncIOLoop</span></code> creates a new <code class="docutils literal"><span class="pre">asyncio.EventLoop</span></code>; this object
can be accessed with the <code class="docutils literal"><span class="pre">asyncio_loop</span></code> attribute.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.platform.asyncio.to_tornado_future">
<code class="descclassname">tornado.platform.asyncio.</code><code class="descname">to_tornado_future</code><span class="sig-paren">(</span><em>asyncio_future</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/platform/asyncio.html#to_tornado_future"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.platform.asyncio.to_tornado_future" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert an <a class="reference external" href="https://docs.python.org/3.4/library/asyncio-task.html#asyncio.Future" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">asyncio.Future</span></code></a> to a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">tornado.concurrent.Future</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.1.</span></p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.platform.asyncio.to_asyncio_future">
<code class="descclassname">tornado.platform.asyncio.</code><code class="descname">to_asyncio_future</code><span class="sig-paren">(</span><em>tornado_future</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/platform/asyncio.html#to_asyncio_future"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.platform.asyncio.to_asyncio_future" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a Tornado yieldable object to an <a class="reference external" href="https://docs.python.org/3.4/library/asyncio-task.html#asyncio.Future" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">asyncio.Future</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.1.</span></p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Now accepts any yieldable object, not just
<a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">tornado.concurrent.Future</span></code></a>.</p>
</div>
</dd></dl>

</div>
<span id="document-caresresolver"></span><div class="section" id="module-tornado.platform.caresresolver">
<span id="tornado-platform-caresresolver-asynchronous-dns-resolver-using-c-ares"></span><h4><code class="docutils literal"><span class="pre">tornado.platform.caresresolver</span></code> &#8212; Asynchronous DNS Resolver using C-Ares<a class="headerlink" href="#module-tornado.platform.caresresolver" title="Permalink to this headline">¶</a></h4>
<p>This module contains a DNS resolver using the c-ares library (and its
wrapper <code class="docutils literal"><span class="pre">pycares</span></code>).</p>
<dl class="class">
<dt id="tornado.platform.caresresolver.CaresResolver">
<em class="property">class </em><code class="descclassname">tornado.platform.caresresolver.</code><code class="descname">CaresResolver</code><a class="headerlink" href="#tornado.platform.caresresolver.CaresResolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Name resolver based on the c-ares library.</p>
<p>This is a non-blocking and non-threaded resolver.  It may not produce
the same results as the system resolver, but can be used for non-blocking
resolution when threads cannot be used.</p>
<p>c-ares fails to resolve some names when <code class="docutils literal"><span class="pre">family</span></code> is <code class="docutils literal"><span class="pre">AF_UNSPEC</span></code>,
so it is only recommended for use in <code class="docutils literal"><span class="pre">AF_INET</span></code> (i.e. IPv4).  This is
the default for <code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code>, but other libraries
may default to <code class="docutils literal"><span class="pre">AF_UNSPEC</span></code>.</p>
</dd></dl>

</div>
<span id="document-twisted"></span><div class="section" id="module-tornado.platform.twisted">
<span id="tornado-platform-twisted-bridges-between-twisted-and-tornado"></span><h4><code class="docutils literal"><span class="pre">tornado.platform.twisted</span></code> &#8212; Bridges between Twisted and Tornado<a class="headerlink" href="#module-tornado.platform.twisted" title="Permalink to this headline">¶</a></h4>
<p>Bridges between the Twisted reactor and Tornado IOLoop.</p>
<p>This module lets you run applications and libraries written for
Twisted in a Tornado application.  It can be used in two modes,
depending on which library&#8217;s underlying event loop you want to use.</p>
<p>This module has been tested with Twisted versions 11.0.0 and newer.</p>
<div class="section" id="twisted-on-tornado">
<h5>Twisted on Tornado<a class="headerlink" href="#twisted-on-tornado" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.platform.twisted.TornadoReactor">
<em class="property">class </em><code class="descclassname">tornado.platform.twisted.</code><code class="descname">TornadoReactor</code><span class="sig-paren">(</span><em>io_loop=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/platform/twisted.html#TornadoReactor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.platform.twisted.TornadoReactor" title="Permalink to this definition">¶</a></dt>
<dd><p>Twisted reactor built on the Tornado IOLoop.</p>
<p><a class="reference internal" href="#tornado.platform.twisted.TornadoReactor" title="tornado.platform.twisted.TornadoReactor"><code class="xref py py-obj docutils literal"><span class="pre">TornadoReactor</span></code></a> implements the Twisted reactor interface on top of
the Tornado IOLoop.  To use it, simply call <a class="reference internal" href="#tornado.platform.twisted.install" title="tornado.platform.twisted.install"><code class="xref py py-obj docutils literal"><span class="pre">install</span></code></a> at the beginning
of the application:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">tornado.platform.twisted</span>
<span class="n">tornado</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">twisted</span><span class="o">.</span><span class="n">install</span><span class="p">()</span>
<span class="kn">from</span> <span class="nn">twisted.internet</span> <span class="kn">import</span> <span class="n">reactor</span>
</pre></div>
</div>
<p>When the app is ready to start, call <code class="docutils literal"><span class="pre">IOLoop.current().start()</span></code>
instead of <code class="docutils literal"><span class="pre">reactor.run()</span></code>.</p>
<p>It is also possible to create a non-global reactor by calling
<code class="docutils literal"><span class="pre">tornado.platform.twisted.TornadoReactor(io_loop)</span></code>.  However, if
the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> and reactor are to be short-lived (such as those used in
unit tests), additional cleanup may be required.  Specifically, it is
recommended to call:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">reactor</span><span class="o">.</span><span class="n">fireSystemEvent</span><span class="p">(</span><span class="s">&#39;shutdown&#39;</span><span class="p">)</span>
<span class="n">reactor</span><span class="o">.</span><span class="n">disconnectAll</span><span class="p">()</span>
</pre></div>
</div>
<p>before closing the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>The <code class="docutils literal"><span class="pre">io_loop</span></code> argument is deprecated.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.platform.twisted.install">
<code class="descclassname">tornado.platform.twisted.</code><code class="descname">install</code><span class="sig-paren">(</span><em>io_loop=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/platform/twisted.html#install"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.platform.twisted.install" title="Permalink to this definition">¶</a></dt>
<dd><p>Install this package as the default Twisted reactor.</p>
<p><code class="docutils literal"><span class="pre">install()</span></code> must be called very early in the startup process,
before most other twisted-related imports. Conversely, because it
initializes the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>, it cannot be called before
<a class="reference internal" href="index.html#tornado.process.fork_processes" title="tornado.process.fork_processes"><code class="xref py py-obj docutils literal"><span class="pre">fork_processes</span></code></a> or multi-process <a class="reference internal" href="index.html#tornado.tcpserver.TCPServer.start" title="tornado.tcpserver.TCPServer.start"><code class="xref py py-obj docutils literal"><span class="pre">start</span></code></a>. These
conflicting requirements make it difficult to use <a class="reference internal" href="#tornado.platform.twisted.TornadoReactor" title="tornado.platform.twisted.TornadoReactor"><code class="xref py py-obj docutils literal"><span class="pre">TornadoReactor</span></code></a>
in multi-process mode, and an external process manager such as
<code class="docutils literal"><span class="pre">supervisord</span></code> is recommended instead.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>The <code class="docutils literal"><span class="pre">io_loop</span></code> argument is deprecated.</p>
</div>
</dd></dl>

</div>
<div class="section" id="tornado-on-twisted">
<h5>Tornado on Twisted<a class="headerlink" href="#tornado-on-twisted" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.platform.twisted.TwistedIOLoop">
<em class="property">class </em><code class="descclassname">tornado.platform.twisted.</code><code class="descname">TwistedIOLoop</code><a class="reference internal" href="_modules/tornado/platform/twisted.html#TwistedIOLoop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.platform.twisted.TwistedIOLoop" title="Permalink to this definition">¶</a></dt>
<dd><p>IOLoop implementation that runs on Twisted.</p>
<p><a class="reference internal" href="#tornado.platform.twisted.TwistedIOLoop" title="tornado.platform.twisted.TwistedIOLoop"><code class="xref py py-obj docutils literal"><span class="pre">TwistedIOLoop</span></code></a> implements the Tornado IOLoop interface on top of
the Twisted reactor. Recommended usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado.platform.twisted</span> <span class="kn">import</span> <span class="n">TwistedIOLoop</span>
<span class="kn">from</span> <span class="nn">twisted.internet</span> <span class="kn">import</span> <span class="n">reactor</span>
<span class="n">TwistedIOLoop</span><span class="p">()</span><span class="o">.</span><span class="n">install</span><span class="p">()</span>
<span class="c"># Set up your tornado application as usual using `IOLoop.instance`</span>
<span class="n">reactor</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>Uses the global Twisted reactor by default.  To create multiple
<code class="docutils literal"><span class="pre">TwistedIOLoops</span></code> in the same process, you must pass a unique reactor
when constructing each one.</p>
<p>Not compatible with <a class="reference internal" href="index.html#tornado.process.Subprocess.set_exit_callback" title="tornado.process.Subprocess.set_exit_callback"><code class="xref py py-obj docutils literal"><span class="pre">tornado.process.Subprocess.set_exit_callback</span></code></a>
because the <code class="docutils literal"><span class="pre">SIGCHLD</span></code> handlers used by Tornado and Twisted conflict
with each other.</p>
</dd></dl>

</div>
<div class="section" id="twisted-dns-resolver">
<h5>Twisted DNS resolver<a class="headerlink" href="#twisted-dns-resolver" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.platform.twisted.TwistedResolver">
<em class="property">class </em><code class="descclassname">tornado.platform.twisted.</code><code class="descname">TwistedResolver</code><a class="reference internal" href="_modules/tornado/platform/twisted.html#TwistedResolver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.platform.twisted.TwistedResolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Twisted-based asynchronous resolver.</p>
<p>This is a non-blocking and non-threaded resolver.  It is
recommended only when threads cannot be used, since it has
limitations compared to the standard <code class="docutils literal"><span class="pre">getaddrinfo</span></code>-based
<a class="reference internal" href="index.html#tornado.netutil.Resolver" title="tornado.netutil.Resolver"><code class="xref py py-obj docutils literal"><span class="pre">Resolver</span></code></a> and
<a class="reference internal" href="index.html#tornado.netutil.ThreadedResolver" title="tornado.netutil.ThreadedResolver"><code class="xref py py-obj docutils literal"><span class="pre">ThreadedResolver</span></code></a>.  Specifically, it returns at
most one result, and arguments other than <code class="docutils literal"><span class="pre">host</span></code> and <code class="docutils literal"><span class="pre">family</span></code>
are ignored.  It may fail to resolve when <code class="docutils literal"><span class="pre">family</span></code> is not
<code class="docutils literal"><span class="pre">socket.AF_UNSPEC</span></code>.</p>
<p>Requires Twisted 12.1 or newer.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>The <code class="docutils literal"><span class="pre">io_loop</span></code> argument is deprecated.</p>
</div>
</dd></dl>

</div>
</div>
</div>
</div>
<span id="document-utilities"></span><div class="section" id="utilities">
<h3>Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
<span id="document-autoreload"></span><div class="section" id="module-tornado.autoreload">
<span id="tornado-autoreload-automatically-detect-code-changes-in-development"></span><h4><code class="docutils literal"><span class="pre">tornado.autoreload</span></code> &#8212; Automatically detect code changes in development<a class="headerlink" href="#module-tornado.autoreload" title="Permalink to this headline">¶</a></h4>
<p>Automatically restart the server when a source file is modified.</p>
<p>Most applications should not access this module directly.  Instead,
pass the keyword argument <code class="docutils literal"><span class="pre">autoreload=True</span></code> to the
<a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.Application</span></code></a> constructor (or <code class="docutils literal"><span class="pre">debug=True</span></code>, which
enables this setting and several others).  This will enable autoreload
mode as well as checking for changes to templates and static
resources.  Note that restarting is a destructive operation and any
requests in progress will be aborted when the process restarts.  (If
you want to disable autoreload while using other debug-mode features,
pass both <code class="docutils literal"><span class="pre">debug=True</span></code> and <code class="docutils literal"><span class="pre">autoreload=False</span></code>).</p>
<p>This module can also be used as a command-line wrapper around scripts
such as unit test runners.  See the <a class="reference internal" href="#tornado.autoreload.main" title="tornado.autoreload.main"><code class="xref py py-obj docutils literal"><span class="pre">main</span></code></a> method for details.</p>
<p>The command-line wrapper and Application debug modes can be used together.
This combination is encouraged as the wrapper catches syntax errors and
other import-time failures, while debug mode catches changes once
the server has started.</p>
<p>This module depends on <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>, so it will not work in WSGI applications
and Google App Engine.  It also will not work correctly when <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a>&#8216;s
multi-process mode is used.</p>
<p>Reloading loses any Python interpreter command-line arguments (e.g. <code class="docutils literal"><span class="pre">-u</span></code>)
because it re-executes Python using <code class="docutils literal"><span class="pre">sys.executable</span></code> and <code class="docutils literal"><span class="pre">sys.argv</span></code>.
Additionally, modifying these variables will cause reloading to behave
incorrectly.</p>
<dl class="function">
<dt id="tornado.autoreload.start">
<code class="descclassname">tornado.autoreload.</code><code class="descname">start</code><span class="sig-paren">(</span><em>io_loop=None</em>, <em>check_time=500</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/autoreload.html#start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.autoreload.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Begins watching source files for changes.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>The <code class="docutils literal"><span class="pre">io_loop</span></code> argument is deprecated.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.autoreload.wait">
<code class="descclassname">tornado.autoreload.</code><code class="descname">wait</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/autoreload.html#wait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.autoreload.wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait for a watched file to change, then restart the process.</p>
<p>Intended to be used at the end of scripts like unit test runners,
to run the tests again after any source file changes (but see also
the command-line interface in <a class="reference internal" href="#tornado.autoreload.main" title="tornado.autoreload.main"><code class="xref py py-obj docutils literal"><span class="pre">main</span></code></a>)</p>
</dd></dl>

<dl class="function">
<dt id="tornado.autoreload.watch">
<code class="descclassname">tornado.autoreload.</code><code class="descname">watch</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/autoreload.html#watch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.autoreload.watch" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a file to the watch list.</p>
<p>All imported modules are watched by default.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.autoreload.add_reload_hook">
<code class="descclassname">tornado.autoreload.</code><code class="descname">add_reload_hook</code><span class="sig-paren">(</span><em>fn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/autoreload.html#add_reload_hook"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.autoreload.add_reload_hook" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a function to be called before reloading the process.</p>
<p>Note that for open file and socket handles it is generally
preferable to set the <code class="docutils literal"><span class="pre">FD_CLOEXEC</span></code> flag (using <a class="reference external" href="https://docs.python.org/3.4/library/fcntl.html#module-fcntl" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">fcntl</span></code></a> or
<code class="docutils literal"><span class="pre">tornado.platform.auto.set_close_exec</span></code>) instead
of using a reload hook to close them.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.autoreload.main">
<code class="descclassname">tornado.autoreload.</code><code class="descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/autoreload.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.autoreload.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Command-line wrapper to re-run a script whenever its source changes.</p>
<p>Scripts may be specified by filename or module name:</p>
<div class="highlight-python"><div class="highlight"><pre>python -m tornado.autoreload -m tornado.test.runtests
python -m tornado.autoreload tornado/test/runtests.py
</pre></div>
</div>
<p>Running a script with this wrapper is similar to calling
<a class="reference internal" href="#tornado.autoreload.wait" title="tornado.autoreload.wait"><code class="xref py py-obj docutils literal"><span class="pre">tornado.autoreload.wait</span></code></a> at the end of the script, but this wrapper
can catch import-time problems like syntax errors that would otherwise
prevent the script from reaching its call to <a class="reference internal" href="#tornado.autoreload.wait" title="tornado.autoreload.wait"><code class="xref py py-obj docutils literal"><span class="pre">wait</span></code></a>.</p>
</dd></dl>

</div>
<span id="document-log"></span><div class="section" id="module-tornado.log">
<span id="tornado-log-logging-support"></span><h4><code class="docutils literal"><span class="pre">tornado.log</span></code> &#8212; Logging support<a class="headerlink" href="#module-tornado.log" title="Permalink to this headline">¶</a></h4>
<p>Logging support for Tornado.</p>
<p>Tornado uses three logger streams:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">tornado.access</span></code>: Per-request logging for Tornado&#8217;s HTTP servers (and
potentially other servers in the future)</li>
<li><code class="docutils literal"><span class="pre">tornado.application</span></code>: Logging of errors from application code (i.e.
uncaught exceptions from callbacks)</li>
<li><code class="docutils literal"><span class="pre">tornado.general</span></code>: General-purpose logging, including any errors
or warnings from Tornado itself.</li>
</ul>
<p>These streams may be configured independently using the standard library&#8217;s
<a class="reference external" href="https://docs.python.org/3.4/library/logging.html#module-logging" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">logging</span></code></a> module.  For example, you may wish to send <code class="docutils literal"><span class="pre">tornado.access</span></code> logs
to a separate file for analysis.</p>
<dl class="class">
<dt id="tornado.log.LogFormatter">
<em class="property">class </em><code class="descclassname">tornado.log.</code><code class="descname">LogFormatter</code><span class="sig-paren">(</span><em>color=True</em>, <em>fmt='%(color)s[%(levelname)1.1s %(asctime)s %(module)s:%(lineno)d]%(end_color)s %(message)s'</em>, <em>datefmt='%y%m%d %H:%M:%S'</em>, <em>colors={40: 1</em>, <em>10: 4</em>, <em>20: 2</em>, <em>30: 3}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/log.html#LogFormatter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.log.LogFormatter" title="Permalink to this definition">¶</a></dt>
<dd><p>Log formatter used in Tornado.</p>
<p>Key features of this formatter are:</p>
<ul class="simple">
<li>Color support when logging to a terminal that supports it.</li>
<li>Timestamps on every log line.</li>
<li>Robust against str/bytes encoding problems.</li>
</ul>
<p>This formatter is enabled automatically by
<a class="reference internal" href="index.html#tornado.options.parse_command_line" title="tornado.options.parse_command_line"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.parse_command_line</span></code></a> (unless <code class="docutils literal"><span class="pre">--logging=none</span></code> is
used).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>color</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/functions.html#bool" title="(in Python v3.4)"><em>bool</em></a>) &#8211; Enables color support.</li>
<li><strong>fmt</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; Log message format.
It will be applied to the attributes dict of log records. The
text between <code class="docutils literal"><span class="pre">%(color)s</span></code> and <code class="docutils literal"><span class="pre">%(end_color)s</span></code> will be colored
depending on the level if color support is on.</li>
<li><strong>colors</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#dict" title="(in Python v3.4)"><em>dict</em></a>) &#8211; color mappings from logging level to terminal color
code</li>
<li><strong>datefmt</strong> (<a class="reference external" href="https://docs.python.org/3.4/library/string.html#module-string" title="(in Python v3.4)"><em>string</em></a>) &#8211; Datetime format.
Used for formatting <code class="docutils literal"><span class="pre">(asctime)</span></code> placeholder in <code class="docutils literal"><span class="pre">prefix_fmt</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.2: </span>Added <code class="docutils literal"><span class="pre">fmt</span></code> and <code class="docutils literal"><span class="pre">datefmt</span></code> arguments.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.log.enable_pretty_logging">
<code class="descclassname">tornado.log.</code><code class="descname">enable_pretty_logging</code><span class="sig-paren">(</span><em>options=None</em>, <em>logger=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/log.html#enable_pretty_logging"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.log.enable_pretty_logging" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns on formatted logging output as configured.</p>
<p>This is called automatically by <a class="reference internal" href="index.html#tornado.options.parse_command_line" title="tornado.options.parse_command_line"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.parse_command_line</span></code></a>
and <a class="reference internal" href="index.html#tornado.options.parse_config_file" title="tornado.options.parse_config_file"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.parse_config_file</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.log.define_logging_options">
<code class="descclassname">tornado.log.</code><code class="descname">define_logging_options</code><span class="sig-paren">(</span><em>options=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/log.html#define_logging_options"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.log.define_logging_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Add logging-related flags to <code class="docutils literal"><span class="pre">options</span></code>.</p>
<p>These options are present automatically on the default options instance;
this method is only necessary if you have created your own <a class="reference internal" href="index.html#tornado.options.OptionParser" title="tornado.options.OptionParser"><code class="xref py py-obj docutils literal"><span class="pre">OptionParser</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 4.2: </span>This function existed in prior versions but was broken and undocumented until 4.2.</p>
</div>
</dd></dl>

</div>
<span id="document-options"></span><div class="section" id="module-tornado.options">
<span id="tornado-options-command-line-parsing"></span><h4><code class="docutils literal"><span class="pre">tornado.options</span></code> &#8212; Command-line parsing<a class="headerlink" href="#module-tornado.options" title="Permalink to this headline">¶</a></h4>
<p>A command line parsing module that lets modules define their own options.</p>
<p>Each module defines its own options which are added to the global
option namespace, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado.options</span> <span class="kn">import</span> <span class="n">define</span><span class="p">,</span> <span class="n">options</span>

<span class="n">define</span><span class="p">(</span><span class="s">&quot;mysql_host&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&quot;127.0.0.1:3306&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;Main user DB&quot;</span><span class="p">)</span>
<span class="n">define</span><span class="p">(</span><span class="s">&quot;memcache_hosts&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&quot;127.0.0.1:11011&quot;</span><span class="p">,</span> <span class="n">multiple</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
       <span class="n">help</span><span class="o">=</span><span class="s">&quot;Main user memcache servers&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">database</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">mysql_host</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">main()</span></code> method of your application does not need to be aware of all of
the options used throughout your program; they are all automatically loaded
when the modules are loaded.  However, all modules that define options
must have been imported before the command line is parsed.</p>
<p>Your <code class="docutils literal"><span class="pre">main()</span></code> method can parse the command line or parse a config file with
either:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">tornado</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">parse_command_line</span><span class="p">()</span>
<span class="c"># or</span>
<span class="n">tornado</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">parse_config_file</span><span class="p">(</span><span class="s">&quot;/etc/server.conf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Command line formats are what you would expect (<code class="docutils literal"><span class="pre">--myoption=myvalue</span></code>).
Config files are just Python files. Global names become options, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">myoption</span> <span class="o">=</span> <span class="s">&quot;myvalue&quot;</span>
<span class="n">myotheroption</span> <span class="o">=</span> <span class="s">&quot;myothervalue&quot;</span>
</pre></div>
</div>
<p>We support <a class="reference external" href="https://docs.python.org/3.4/library/datetime.html#datetime.datetime" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">datetimes</span></code></a>, <a class="reference external" href="https://docs.python.org/3.4/library/datetime.html#datetime.timedelta" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">timedeltas</span></code></a>, ints, and floats (just pass a <code class="docutils literal"><span class="pre">type</span></code> kwarg to
<a class="reference internal" href="#tornado.options.define" title="tornado.options.define"><code class="xref py py-obj docutils literal"><span class="pre">define</span></code></a>). We also accept multi-value options. See the documentation for
<a class="reference internal" href="#tornado.options.define" title="tornado.options.define"><code class="xref py py-obj docutils literal"><span class="pre">define()</span></code></a> below.</p>
<p><a class="reference internal" href="#tornado.options.options" title="tornado.options.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.options</span></code></a> is a singleton instance of <a class="reference internal" href="#tornado.options.OptionParser" title="tornado.options.OptionParser"><code class="xref py py-obj docutils literal"><span class="pre">OptionParser</span></code></a>, and
the top-level functions in this module (<a class="reference internal" href="#tornado.options.define" title="tornado.options.define"><code class="xref py py-obj docutils literal"><span class="pre">define</span></code></a>, <a class="reference internal" href="#tornado.options.parse_command_line" title="tornado.options.parse_command_line"><code class="xref py py-obj docutils literal"><span class="pre">parse_command_line</span></code></a>, etc)
simply call methods on it.  You may create additional <a class="reference internal" href="#tornado.options.OptionParser" title="tornado.options.OptionParser"><code class="xref py py-obj docutils literal"><span class="pre">OptionParser</span></code></a>
instances to define isolated sets of options, such as for subcommands.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>By default, several options are defined that will configure the
standard <a class="reference external" href="https://docs.python.org/3.4/library/logging.html#module-logging" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">logging</span></code></a> module when <a class="reference internal" href="#tornado.options.parse_command_line" title="tornado.options.parse_command_line"><code class="xref py py-obj docutils literal"><span class="pre">parse_command_line</span></code></a> or <a class="reference internal" href="#tornado.options.parse_config_file" title="tornado.options.parse_config_file"><code class="xref py py-obj docutils literal"><span class="pre">parse_config_file</span></code></a>
are called.  If you want Tornado to leave the logging configuration
alone so you can manage it yourself, either pass <code class="docutils literal"><span class="pre">--logging=none</span></code>
on the command line or do the following to disable it in code:</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado.options</span> <span class="kn">import</span> <span class="n">options</span><span class="p">,</span> <span class="n">parse_command_line</span>
<span class="n">options</span><span class="o">.</span><span class="n">logging</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">parse_command_line</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Dashes and underscores are fully interchangeable in option names;
options can be defined, set, and read with any mix of the two.
Dashes are typical for command-line usage while config files require
underscores.</p>
</div>
<div class="section" id="global-functions">
<h5>Global functions<a class="headerlink" href="#global-functions" title="Permalink to this headline">¶</a></h5>
<dl class="function">
<dt id="tornado.options.define">
<code class="descclassname">tornado.options.</code><code class="descname">define</code><span class="sig-paren">(</span><em>name</em>, <em>default=None</em>, <em>type=None</em>, <em>help=None</em>, <em>metavar=None</em>, <em>multiple=False</em>, <em>group=None</em>, <em>callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/options.html#define"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.define" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines an option in the global namespace.</p>
<p>See <a class="reference internal" href="#tornado.options.OptionParser.define" title="tornado.options.OptionParser.define"><code class="xref py py-obj docutils literal"><span class="pre">OptionParser.define</span></code></a>.</p>
</dd></dl>

<dl class="data">
<dt id="tornado.options.options">
<code class="descclassname">tornado.options.</code><code class="descname">options</code><a class="headerlink" href="#tornado.options.options" title="Permalink to this definition">¶</a></dt>
<dd><p>Global options object.  All defined options are available as attributes
on this object.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.options.parse_command_line">
<code class="descclassname">tornado.options.</code><code class="descname">parse_command_line</code><span class="sig-paren">(</span><em>args=None</em>, <em>final=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/options.html#parse_command_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.parse_command_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses global options from the command line.</p>
<p>See <a class="reference internal" href="#tornado.options.OptionParser.parse_command_line" title="tornado.options.OptionParser.parse_command_line"><code class="xref py py-obj docutils literal"><span class="pre">OptionParser.parse_command_line</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.options.parse_config_file">
<code class="descclassname">tornado.options.</code><code class="descname">parse_config_file</code><span class="sig-paren">(</span><em>path</em>, <em>final=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/options.html#parse_config_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.parse_config_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses global options from a config file.</p>
<p>See <a class="reference internal" href="#tornado.options.OptionParser.parse_config_file" title="tornado.options.OptionParser.parse_config_file"><code class="xref py py-obj docutils literal"><span class="pre">OptionParser.parse_config_file</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.options.print_help">
<code class="descclassname">tornado.options.</code><code class="descname">print_help</code><span class="sig-paren">(</span><em>file=sys.stderr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/options.html#print_help"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.print_help" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints all the command line options to stderr (or another file).</p>
<p>See <a class="reference internal" href="#tornado.options.OptionParser.print_help" title="tornado.options.OptionParser.print_help"><code class="xref py py-obj docutils literal"><span class="pre">OptionParser.print_help</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.options.add_parse_callback">
<code class="descclassname">tornado.options.</code><code class="descname">add_parse_callback</code><span class="sig-paren">(</span><em>callback</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/options.html#add_parse_callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.add_parse_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a parse callback, to be invoked when option parsing is done.</p>
<p>See <a class="reference internal" href="#tornado.options.OptionParser.add_parse_callback" title="tornado.options.OptionParser.add_parse_callback"><code class="xref py py-obj docutils literal"><span class="pre">OptionParser.add_parse_callback</span></code></a></p>
</dd></dl>

<dl class="exception">
<dt id="tornado.options.Error">
<em class="property">exception </em><code class="descclassname">tornado.options.</code><code class="descname">Error</code><a class="reference internal" href="_modules/tornado/options.html#Error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised by errors in the options module.</p>
</dd></dl>

</div>
<div class="section" id="optionparser-class">
<h5>OptionParser class<a class="headerlink" href="#optionparser-class" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.options.OptionParser">
<em class="property">class </em><code class="descclassname">tornado.options.</code><code class="descname">OptionParser</code><a class="reference internal" href="_modules/tornado/options.html#OptionParser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.OptionParser" title="Permalink to this definition">¶</a></dt>
<dd><p>A collection of options, a dictionary with object-like access.</p>
<p>Normally accessed via static functions in the <a class="reference internal" href="#module-tornado.options" title="tornado.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options</span></code></a> module,
which reference a global instance.</p>
<dl class="method">
<dt id="tornado.options.OptionParser.items">
<code class="descname">items</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/options.html#OptionParser.items"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.OptionParser.items" title="Permalink to this definition">¶</a></dt>
<dd><p>A sequence of (name, value) pairs.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.options.OptionParser.groups">
<code class="descname">groups</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/options.html#OptionParser.groups"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.OptionParser.groups" title="Permalink to this definition">¶</a></dt>
<dd><p>The set of option-groups created by <code class="docutils literal"><span class="pre">define</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.options.OptionParser.group_dict">
<code class="descname">group_dict</code><span class="sig-paren">(</span><em>group</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/options.html#OptionParser.group_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.OptionParser.group_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>The names and values of options in a group.</p>
<p>Useful for copying options into Application settings:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado.options</span> <span class="kn">import</span> <span class="n">define</span><span class="p">,</span> <span class="n">parse_command_line</span><span class="p">,</span> <span class="n">options</span>

<span class="n">define</span><span class="p">(</span><span class="s">&#39;template_path&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s">&#39;application&#39;</span><span class="p">)</span>
<span class="n">define</span><span class="p">(</span><span class="s">&#39;static_path&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s">&#39;application&#39;</span><span class="p">)</span>

<span class="n">parse_command_line</span><span class="p">()</span>

<span class="n">application</span> <span class="o">=</span> <span class="n">Application</span><span class="p">(</span>
    <span class="n">handlers</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="o">.</span><span class="n">group_dict</span><span class="p">(</span><span class="s">&#39;application&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.options.OptionParser.as_dict">
<code class="descname">as_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/options.html#OptionParser.as_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.OptionParser.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>The names and values of all options.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.options.OptionParser.define">
<code class="descname">define</code><span class="sig-paren">(</span><em>name</em>, <em>default=None</em>, <em>type=None</em>, <em>help=None</em>, <em>metavar=None</em>, <em>multiple=False</em>, <em>group=None</em>, <em>callback=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/options.html#OptionParser.define"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.OptionParser.define" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines a new command line option.</p>
<p>If <code class="docutils literal"><span class="pre">type</span></code> is given (one of str, float, int, datetime, or timedelta)
or can be inferred from the <code class="docutils literal"><span class="pre">default</span></code>, we parse the command line
arguments based on the given type. If <code class="docutils literal"><span class="pre">multiple</span></code> is True, we accept
comma-separated values, and the option value is always a list.</p>
<p>For multi-value integers, we also accept the syntax <code class="docutils literal"><span class="pre">x:y</span></code>, which
turns into <code class="docutils literal"><span class="pre">range(x,</span> <span class="pre">y)</span></code> - very useful for long integer ranges.</p>
<p><code class="docutils literal"><span class="pre">help</span></code> and <code class="docutils literal"><span class="pre">metavar</span></code> are used to construct the
automatically generated command line help string. The help
message is formatted like:</p>
<div class="highlight-python"><div class="highlight"><pre>--name=METAVAR      help string
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">group</span></code> is used to group the defined options in logical
groups. By default, command line options are grouped by the
file in which they are defined.</p>
<p>Command line option names must be unique globally. They can be parsed
from the command line with <a class="reference internal" href="#tornado.options.parse_command_line" title="tornado.options.parse_command_line"><code class="xref py py-obj docutils literal"><span class="pre">parse_command_line</span></code></a> or parsed from a
config file with <a class="reference internal" href="#tornado.options.parse_config_file" title="tornado.options.parse_config_file"><code class="xref py py-obj docutils literal"><span class="pre">parse_config_file</span></code></a>.</p>
<p>If a <code class="docutils literal"><span class="pre">callback</span></code> is given, it will be run with the new value whenever
the option is changed.  This can be used to combine command-line
and file-based options:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">define</span><span class="p">(</span><span class="s">&quot;config&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">&quot;path to config file&quot;</span><span class="p">,</span>
       <span class="n">callback</span><span class="o">=</span><span class="k">lambda</span> <span class="n">path</span><span class="p">:</span> <span class="n">parse_config_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">final</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
</pre></div>
</div>
<p>With this definition, options in the file specified by <code class="docutils literal"><span class="pre">--config</span></code> will
override options set earlier on the command line, but can be overridden
by later flags.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.options.OptionParser.parse_command_line">
<code class="descname">parse_command_line</code><span class="sig-paren">(</span><em>args=None</em>, <em>final=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/options.html#OptionParser.parse_command_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.OptionParser.parse_command_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses all options given on the command line (defaults to
<a class="reference external" href="https://docs.python.org/3.4/library/sys.html#sys.argv" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">sys.argv</span></code></a>).</p>
<p>Note that <code class="docutils literal"><span class="pre">args[0]</span></code> is ignored since it is the program name
in <a class="reference external" href="https://docs.python.org/3.4/library/sys.html#sys.argv" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">sys.argv</span></code></a>.</p>
<p>We return a list of all arguments that are not parsed as options.</p>
<p>If <code class="docutils literal"><span class="pre">final</span></code> is <code class="docutils literal"><span class="pre">False</span></code>, parse callbacks will not be run.
This is useful for applications that wish to combine configurations
from multiple sources.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.options.OptionParser.parse_config_file">
<code class="descname">parse_config_file</code><span class="sig-paren">(</span><em>path</em>, <em>final=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/options.html#OptionParser.parse_config_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.OptionParser.parse_config_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses and loads the Python config file at the given path.</p>
<p>If <code class="docutils literal"><span class="pre">final</span></code> is <code class="docutils literal"><span class="pre">False</span></code>, parse callbacks will not be run.
This is useful for applications that wish to combine configurations
from multiple sources.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.1: </span>Config files are now always interpreted as utf-8 instead of
the system default encoding.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="tornado.options.OptionParser.print_help">
<code class="descname">print_help</code><span class="sig-paren">(</span><em>file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/options.html#OptionParser.print_help"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.OptionParser.print_help" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints all the command line options to stderr (or another file).</p>
</dd></dl>

<dl class="method">
<dt id="tornado.options.OptionParser.add_parse_callback">
<code class="descname">add_parse_callback</code><span class="sig-paren">(</span><em>callback</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/options.html#OptionParser.add_parse_callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.OptionParser.add_parse_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a parse callback, to be invoked when option parsing is done.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.options.OptionParser.mockable">
<code class="descname">mockable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/options.html#OptionParser.mockable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.options.OptionParser.mockable" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a wrapper around self that is compatible with
<a class="reference external" href="https://docs.python.org/3.4/library/unittest.mock.html#unittest.mock.patch" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">mock.patch</span></code></a>.</p>
<p>The <a class="reference external" href="https://docs.python.org/3.4/library/unittest.mock.html#unittest.mock.patch" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">mock.patch</span></code></a> function (included in
the standard library <a class="reference external" href="https://docs.python.org/3.4/library/unittest.mock.html#module-unittest.mock" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">unittest.mock</span></code></a> package since Python 3.3,
or in the third-party <code class="docutils literal"><span class="pre">mock</span></code> package for older versions of
Python) is incompatible with objects like <code class="docutils literal"><span class="pre">options</span></code> that
override <code class="docutils literal"><span class="pre">__getattr__</span></code> and <code class="docutils literal"><span class="pre">__setattr__</span></code>.  This function
returns an object that can be used with <a class="reference external" href="https://docs.python.org/3.4/library/unittest.mock.html#unittest.mock.patch.object" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">mock.patch.object</span></code></a> to modify option values:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">mock</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">object</span><span class="p">(</span><span class="n">options</span><span class="o">.</span><span class="n">mockable</span><span class="p">(),</span> <span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">options</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">value</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
</div>
<span id="document-stack_context"></span><div class="section" id="module-tornado.stack_context">
<span id="tornado-stack-context-exception-handling-across-asynchronous-callbacks"></span><h4><code class="docutils literal"><span class="pre">tornado.stack_context</span></code> &#8212; Exception handling across asynchronous callbacks<a class="headerlink" href="#module-tornado.stack_context" title="Permalink to this headline">¶</a></h4>
<p><a class="reference internal" href="#tornado.stack_context.StackContext" title="tornado.stack_context.StackContext"><code class="xref py py-obj docutils literal"><span class="pre">StackContext</span></code></a> allows applications to maintain threadlocal-like state
that follows execution as it moves to other execution contexts.</p>
<p>The motivating examples are to eliminate the need for explicit
<code class="docutils literal"><span class="pre">async_callback</span></code> wrappers (as in <a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.RequestHandler</span></code></a>), and to
allow some additional context to be kept for logging.</p>
<p>This is slightly magic, but it&#8217;s an extension of the idea that an
exception handler is a kind of stack-local state and when that stack
is suspended and resumed in a new context that state needs to be
preserved.  <a class="reference internal" href="#tornado.stack_context.StackContext" title="tornado.stack_context.StackContext"><code class="xref py py-obj docutils literal"><span class="pre">StackContext</span></code></a> shifts the burden of restoring that state
from each call site (e.g.  wrapping each <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> callback
in <code class="docutils literal"><span class="pre">async_callback</span></code>) to the mechanisms that transfer control from
one context to another (e.g. <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> itself, <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>,
thread pools, etc).</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@contextlib.contextmanager</span>
<span class="k">def</span> <span class="nf">die_on_error</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">yield</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&quot;exception in asynchronous operation&quot;</span><span class="p">,</span><span class="n">exc_info</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">with</span> <span class="n">StackContext</span><span class="p">(</span><span class="n">die_on_error</span><span class="p">):</span>
    <span class="c"># Any exception thrown here *or in callback and its descendants*</span>
    <span class="c"># will cause the process to exit instead of spinning endlessly</span>
    <span class="c"># in the ioloop.</span>
    <span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
<span class="n">ioloop</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<p>Most applications shouldn&#8217;t have to work with <a class="reference internal" href="#tornado.stack_context.StackContext" title="tornado.stack_context.StackContext"><code class="xref py py-obj docutils literal"><span class="pre">StackContext</span></code></a> directly.
Here are a few rules of thumb for when it&#8217;s necessary:</p>
<ul class="simple">
<li>If you&#8217;re writing an asynchronous library that doesn&#8217;t rely on a
stack_context-aware library like <a class="reference internal" href="index.html#module-tornado.ioloop" title="tornado.ioloop"><code class="xref py py-obj docutils literal"><span class="pre">tornado.ioloop</span></code></a> or <a class="reference internal" href="index.html#module-tornado.iostream" title="tornado.iostream"><code class="xref py py-obj docutils literal"><span class="pre">tornado.iostream</span></code></a>
(for example, if you&#8217;re writing a thread pool), use
<a class="reference internal" href="#tornado.stack_context.wrap" title="tornado.stack_context.wrap"><code class="xref py py-obj docutils literal"><span class="pre">stack_context.wrap()</span></code></a> before any asynchronous operations to capture the
stack context from where the operation was started.</li>
<li>If you&#8217;re writing an asynchronous library that has some shared
resources (such as a connection pool), create those shared resources
within a <code class="docutils literal"><span class="pre">with</span> <span class="pre">stack_context.NullContext():</span></code> block.  This will prevent
<code class="docutils literal"><span class="pre">StackContexts</span></code> from leaking from one request to another.</li>
<li>If you want to write something like an exception handler that will
persist across asynchronous calls, create a new <a class="reference internal" href="#tornado.stack_context.StackContext" title="tornado.stack_context.StackContext"><code class="xref py py-obj docutils literal"><span class="pre">StackContext</span></code></a> (or
<a class="reference internal" href="#tornado.stack_context.ExceptionStackContext" title="tornado.stack_context.ExceptionStackContext"><code class="xref py py-obj docutils literal"><span class="pre">ExceptionStackContext</span></code></a>), and make your asynchronous calls in a <code class="docutils literal"><span class="pre">with</span></code>
block that references your <a class="reference internal" href="#tornado.stack_context.StackContext" title="tornado.stack_context.StackContext"><code class="xref py py-obj docutils literal"><span class="pre">StackContext</span></code></a>.</li>
</ul>
<dl class="class">
<dt id="tornado.stack_context.StackContext">
<em class="property">class </em><code class="descclassname">tornado.stack_context.</code><code class="descname">StackContext</code><span class="sig-paren">(</span><em>context_factory</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/stack_context.html#StackContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.stack_context.StackContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Establishes the given context as a StackContext that will be transferred.</p>
<p>Note that the parameter is a callable that returns a context
manager, not the context itself.  That is, where for a
non-transferable context manager you would say:</p>
<div class="highlight-python"><div class="highlight"><pre>with my_context():
</pre></div>
</div>
<p>StackContext takes the function itself rather than its result:</p>
<div class="highlight-python"><div class="highlight"><pre>with StackContext(my_context):
</pre></div>
</div>
<p>The result of <code class="docutils literal"><span class="pre">with</span> <span class="pre">StackContext()</span> <span class="pre">as</span> <span class="pre">cb:</span></code> is a deactivation
callback.  Run this callback when the StackContext is no longer
needed to ensure that it is not propagated any further (note that
deactivating a context does not affect any instances of that
context that are currently pending).  This is an advanced feature
and not necessary in most applications.</p>
</dd></dl>

<dl class="class">
<dt id="tornado.stack_context.ExceptionStackContext">
<em class="property">class </em><code class="descclassname">tornado.stack_context.</code><code class="descname">ExceptionStackContext</code><span class="sig-paren">(</span><em>exception_handler</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/stack_context.html#ExceptionStackContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.stack_context.ExceptionStackContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Specialization of StackContext for exception handling.</p>
<p>The supplied <code class="docutils literal"><span class="pre">exception_handler</span></code> function will be called in the
event of an uncaught exception in this context.  The semantics are
similar to a try/finally clause, and intended use cases are to log
an error, close a socket, or similar cleanup actions.  The
<code class="docutils literal"><span class="pre">exc_info</span></code> triple <code class="docutils literal"><span class="pre">(type,</span> <span class="pre">value,</span> <span class="pre">traceback)</span></code> will be passed to the
exception_handler function.</p>
<p>If the exception handler returns true, the exception will be
consumed and will not be propagated to other exception handlers.</p>
</dd></dl>

<dl class="class">
<dt id="tornado.stack_context.NullContext">
<em class="property">class </em><code class="descclassname">tornado.stack_context.</code><code class="descname">NullContext</code><a class="reference internal" href="_modules/tornado/stack_context.html#NullContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.stack_context.NullContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets the <a class="reference internal" href="#tornado.stack_context.StackContext" title="tornado.stack_context.StackContext"><code class="xref py py-obj docutils literal"><span class="pre">StackContext</span></code></a>.</p>
<p>Useful when creating a shared resource on demand (e.g. an
<a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a>) where the stack that caused the creating is
not relevant to future operations.</p>
</dd></dl>

<dl class="function">
<dt id="tornado.stack_context.wrap">
<code class="descclassname">tornado.stack_context.</code><code class="descname">wrap</code><span class="sig-paren">(</span><em>fn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/stack_context.html#wrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.stack_context.wrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a callable object that will restore the current <a class="reference internal" href="#tornado.stack_context.StackContext" title="tornado.stack_context.StackContext"><code class="xref py py-obj docutils literal"><span class="pre">StackContext</span></code></a>
when executed.</p>
<p>Use this whenever saving a callback to be executed later in a
different execution context (either in a different thread or
asynchronously in the same thread).</p>
</dd></dl>

<dl class="function">
<dt id="tornado.stack_context.run_with_stack_context">
<code class="descclassname">tornado.stack_context.</code><code class="descname">run_with_stack_context</code><span class="sig-paren">(</span><em>context</em>, <em>func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/stack_context.html#run_with_stack_context"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.stack_context.run_with_stack_context" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a coroutine <code class="docutils literal"><span class="pre">func</span></code> in the given <a class="reference internal" href="#tornado.stack_context.StackContext" title="tornado.stack_context.StackContext"><code class="xref py py-obj docutils literal"><span class="pre">StackContext</span></code></a>.</p>
<p>It is not safe to have a <code class="docutils literal"><span class="pre">yield</span></code> statement within a <code class="docutils literal"><span class="pre">with</span> <span class="pre">StackContext</span></code>
block, so it is difficult to use stack context with <a class="reference internal" href="index.html#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">gen.coroutine</span></code></a>.
This helper function runs the function in the correct context while
keeping the <code class="docutils literal"><span class="pre">yield</span></code> and <code class="docutils literal"><span class="pre">with</span></code> statements syntactically separate.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">incorrect</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">StackContext</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
        <span class="c"># ERROR: this will raise StackContextInconsistentError</span>
        <span class="k">yield</span> <span class="n">other_coroutine</span><span class="p">()</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">correct</span><span class="p">():</span>
    <span class="k">yield</span> <span class="n">run_with_stack_context</span><span class="p">(</span><span class="n">StackContext</span><span class="p">(</span><span class="n">ctx</span><span class="p">),</span> <span class="n">other_coroutine</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

</div>
<span id="document-testing"></span><div class="section" id="module-tornado.testing">
<span id="tornado-testing-unit-testing-support-for-asynchronous-code"></span><h4><code class="docutils literal"><span class="pre">tornado.testing</span></code> &#8212; Unit testing support for asynchronous code<a class="headerlink" href="#module-tornado.testing" title="Permalink to this headline">¶</a></h4>
<p>Support classes for automated testing.</p>
<ul class="simple">
<li><a class="reference internal" href="#tornado.testing.AsyncTestCase" title="tornado.testing.AsyncTestCase"><code class="xref py py-obj docutils literal"><span class="pre">AsyncTestCase</span></code></a> and <a class="reference internal" href="#tornado.testing.AsyncHTTPTestCase" title="tornado.testing.AsyncHTTPTestCase"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPTestCase</span></code></a>:  Subclasses of unittest.TestCase
with additional support for testing asynchronous (<a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> based) code.</li>
<li><a class="reference internal" href="#tornado.testing.ExpectLog" title="tornado.testing.ExpectLog"><code class="xref py py-obj docutils literal"><span class="pre">ExpectLog</span></code></a> and <a class="reference internal" href="#tornado.testing.LogTrapTestCase" title="tornado.testing.LogTrapTestCase"><code class="xref py py-obj docutils literal"><span class="pre">LogTrapTestCase</span></code></a>: Make test logs less spammy.</li>
<li><a class="reference internal" href="#tornado.testing.main" title="tornado.testing.main"><code class="xref py py-obj docutils literal"><span class="pre">main()</span></code></a>: A simple test runner (wrapper around unittest.main()) with support
for the tornado.autoreload module to rerun the tests when code changes.</li>
</ul>
<div class="section" id="asynchronous-test-cases">
<h5>Asynchronous test cases<a class="headerlink" href="#asynchronous-test-cases" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.testing.AsyncTestCase">
<em class="property">class </em><code class="descclassname">tornado.testing.</code><code class="descname">AsyncTestCase</code><span class="sig-paren">(</span><em>methodName='runTest'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#AsyncTestCase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.AsyncTestCase" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3.4/library/unittest.html#unittest.TestCase" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">TestCase</span></code></a> subclass for testing <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>-based
asynchronous code.</p>
<p>The unittest framework is synchronous, so the test must be
complete by the time the test method returns.  This means that
asynchronous code cannot be used in quite the same way as usual.
To write test functions that use the same <code class="docutils literal"><span class="pre">yield</span></code>-based patterns
used with the <a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a> module, decorate your test methods
with <a class="reference internal" href="#tornado.testing.gen_test" title="tornado.testing.gen_test"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.gen_test</span></code></a> instead of
<a class="reference internal" href="index.html#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.coroutine</span></code></a>.  This class also provides the <a class="reference internal" href="#tornado.testing.AsyncTestCase.stop" title="tornado.testing.AsyncTestCase.stop"><code class="xref py py-obj docutils literal"><span class="pre">stop()</span></code></a>
and <a class="reference internal" href="#tornado.testing.AsyncTestCase.wait" title="tornado.testing.AsyncTestCase.wait"><code class="xref py py-obj docutils literal"><span class="pre">wait()</span></code></a> methods for a more manual style of testing.  The test
method itself must call <code class="docutils literal"><span class="pre">self.wait()</span></code>, and asynchronous
callbacks should call <code class="docutils literal"><span class="pre">self.stop()</span></code> to signal completion.</p>
<p>By default, a new <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> is constructed for each test and is available
as <code class="docutils literal"><span class="pre">self.io_loop</span></code>.  This <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> should be used in the construction of
HTTP clients/servers, etc.  If the code being tested requires a
global <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>, subclasses should override <a class="reference internal" href="#tornado.testing.AsyncTestCase.get_new_ioloop" title="tornado.testing.AsyncTestCase.get_new_ioloop"><code class="xref py py-obj docutils literal"><span class="pre">get_new_ioloop</span></code></a> to return it.</p>
<p>The <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>&#8216;s <code class="docutils literal"><span class="pre">start</span></code> and <code class="docutils literal"><span class="pre">stop</span></code> methods should not be
called directly.  Instead, use <a class="reference internal" href="#tornado.testing.AsyncTestCase.stop" title="tornado.testing.AsyncTestCase.stop"><code class="xref py py-obj docutils literal"><span class="pre">self.stop</span></code></a> and <a class="reference internal" href="#tornado.testing.AsyncTestCase.wait" title="tornado.testing.AsyncTestCase.wait"><code class="xref py py-obj docutils literal"><span class="pre">self.wait</span></code></a>.  Arguments passed to <code class="docutils literal"><span class="pre">self.stop</span></code> are returned from
<code class="docutils literal"><span class="pre">self.wait</span></code>.  It is possible to have multiple <code class="docutils literal"><span class="pre">wait</span></code>/<code class="docutils literal"><span class="pre">stop</span></code>
cycles in the same test.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># This test uses coroutine style.</span>
<span class="k">class</span> <span class="nc">MyTestCase</span><span class="p">(</span><span class="n">AsyncTestCase</span><span class="p">):</span>
    <span class="nd">@tornado.testing.gen_test</span>
    <span class="k">def</span> <span class="nf">test_http_fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">AsyncHTTPClient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">io_loop</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s">&quot;http://www.tornadoweb.org&quot;</span><span class="p">)</span>
        <span class="c"># Test contents of response</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&quot;FriendFeed&quot;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>

<span class="c"># This test uses argument passing between self.stop and self.wait.</span>
<span class="k">class</span> <span class="nc">MyTestCase2</span><span class="p">(</span><span class="n">AsyncTestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_http_fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">AsyncHTTPClient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">io_loop</span><span class="p">)</span>
        <span class="n">client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s">&quot;http://www.tornadoweb.org/&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
        <span class="c"># Test contents of response</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&quot;FriendFeed&quot;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>

<span class="c"># This test uses an explicit callback-based style.</span>
<span class="k">class</span> <span class="nc">MyTestCase3</span><span class="p">(</span><span class="n">AsyncTestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">test_http_fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">AsyncHTTPClient</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">io_loop</span><span class="p">)</span>
        <span class="n">client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s">&quot;http://www.tornadoweb.org/&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_fetch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">handle_fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
        <span class="c"># Test contents of response (failures and exceptions here</span>
        <span class="c"># will cause self.wait() to throw an exception and end the</span>
        <span class="c"># test).</span>
        <span class="c"># Exceptions thrown here are magically propagated to</span>
        <span class="c"># self.wait() in test_http_fetch() via stack_context.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s">&quot;FriendFeed&quot;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="tornado.testing.AsyncTestCase.get_new_ioloop">
<code class="descname">get_new_ioloop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#AsyncTestCase.get_new_ioloop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.AsyncTestCase.get_new_ioloop" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> for this test.  May be overridden in
subclasses for tests that require a specific <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> (usually
the singleton <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.instance" title="tornado.ioloop.IOLoop.instance"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.instance()</span></code></a>).</p>
</dd></dl>

<dl class="method">
<dt id="tornado.testing.AsyncTestCase.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><em>_arg=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#AsyncTestCase.stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.AsyncTestCase.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stops the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>, causing one pending (or future) call to <a class="reference internal" href="#tornado.testing.AsyncTestCase.wait" title="tornado.testing.AsyncTestCase.wait"><code class="xref py py-obj docutils literal"><span class="pre">wait()</span></code></a>
to return.</p>
<p>Keyword arguments or a single positional argument passed to <a class="reference internal" href="#tornado.testing.AsyncTestCase.stop" title="tornado.testing.AsyncTestCase.stop"><code class="xref py py-obj docutils literal"><span class="pre">stop()</span></code></a> are
saved and will be returned by <a class="reference internal" href="#tornado.testing.AsyncTestCase.wait" title="tornado.testing.AsyncTestCase.wait"><code class="xref py py-obj docutils literal"><span class="pre">wait()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.testing.AsyncTestCase.wait">
<code class="descname">wait</code><span class="sig-paren">(</span><em>condition=None</em>, <em>timeout=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#AsyncTestCase.wait"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.AsyncTestCase.wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> until stop is called or timeout has passed.</p>
<p>In the event of a timeout, an exception will be thrown. The
default timeout is 5 seconds; it may be overridden with a
<code class="docutils literal"><span class="pre">timeout</span></code> keyword argument or globally with the
<code class="docutils literal"><span class="pre">ASYNC_TEST_TIMEOUT</span></code> environment variable.</p>
<p>If <code class="docutils literal"><span class="pre">condition</span></code> is not None, the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> will be restarted
after <a class="reference internal" href="#tornado.testing.AsyncTestCase.stop" title="tornado.testing.AsyncTestCase.stop"><code class="xref py py-obj docutils literal"><span class="pre">stop()</span></code></a> until <code class="docutils literal"><span class="pre">condition()</span></code> returns true.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 3.1: </span>Added the <code class="docutils literal"><span class="pre">ASYNC_TEST_TIMEOUT</span></code> environment variable.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.testing.AsyncHTTPTestCase">
<em class="property">class </em><code class="descclassname">tornado.testing.</code><code class="descname">AsyncHTTPTestCase</code><span class="sig-paren">(</span><em>methodName='runTest'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#AsyncHTTPTestCase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.AsyncHTTPTestCase" title="Permalink to this definition">¶</a></dt>
<dd><p>A test case that starts up an HTTP server.</p>
<p>Subclasses must override <a class="reference internal" href="#tornado.testing.AsyncHTTPTestCase.get_app" title="tornado.testing.AsyncHTTPTestCase.get_app"><code class="xref py py-obj docutils literal"><span class="pre">get_app()</span></code></a>, which returns the
<a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.Application</span></code></a> (or other <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> callback) to be tested.
Tests will typically use the provided <code class="docutils literal"><span class="pre">self.http_client</span></code> to fetch
URLs from this server.</p>
<p>Example, assuming the &#8220;Hello, world&#8221; example from the user guide is in
<code class="docutils literal"><span class="pre">hello.py</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">hello</span>

<span class="k">class</span> <span class="nc">TestHelloApp</span><span class="p">(</span><span class="n">AsyncHTTPTestCase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get_app</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">hello</span><span class="o">.</span><span class="n">make_app</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">test_homepage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="s">&#39;Hello, world&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>That call to <code class="docutils literal"><span class="pre">self.fetch()</span></code> is equivalent to</p>
<div class="highlight-python"><div class="highlight"><pre><span class="bp">self</span><span class="o">.</span><span class="n">http_client</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_url</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</pre></div>
</div>
<p>which illustrates how AsyncTestCase can turn an asynchronous operation,
like <code class="docutils literal"><span class="pre">http_client.fetch()</span></code>, into a synchronous operation. If you need
to do other asynchronous operations in tests, you&#8217;ll probably need to use
<code class="docutils literal"><span class="pre">stop()</span></code> and <code class="docutils literal"><span class="pre">wait()</span></code> yourself.</p>
<dl class="method">
<dt id="tornado.testing.AsyncHTTPTestCase.get_app">
<code class="descname">get_app</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#AsyncHTTPTestCase.get_app"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.AsyncHTTPTestCase.get_app" title="Permalink to this definition">¶</a></dt>
<dd><p>Should be overridden by subclasses to return a
<a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.Application</span></code></a> or other <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> callback.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.testing.AsyncHTTPTestCase.fetch">
<code class="descname">fetch</code><span class="sig-paren">(</span><em>path</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#AsyncHTTPTestCase.fetch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.AsyncHTTPTestCase.fetch" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience method to synchronously fetch a url.</p>
<p>The given path will be appended to the local server&#8217;s host and
port.  Any additional kwargs will be passed directly to
<a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient.fetch" title="tornado.httpclient.AsyncHTTPClient.fetch"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient.fetch</span></code></a> (and so could be used to pass
<code class="docutils literal"><span class="pre">method=&quot;POST&quot;</span></code>, <code class="docutils literal"><span class="pre">body=&quot;...&quot;</span></code>, etc).</p>
</dd></dl>

<dl class="method">
<dt id="tornado.testing.AsyncHTTPTestCase.get_httpserver_options">
<code class="descname">get_httpserver_options</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#AsyncHTTPTestCase.get_httpserver_options"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.AsyncHTTPTestCase.get_httpserver_options" title="Permalink to this definition">¶</a></dt>
<dd><p>May be overridden by subclasses to return additional
keyword arguments for the server.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.testing.AsyncHTTPTestCase.get_http_port">
<code class="descname">get_http_port</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#AsyncHTTPTestCase.get_http_port"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.AsyncHTTPTestCase.get_http_port" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the port used by the server.</p>
<p>A new port is chosen for each test.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.testing.AsyncHTTPTestCase.get_url">
<code class="descname">get_url</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#AsyncHTTPTestCase.get_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.AsyncHTTPTestCase.get_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an absolute url for the given path on the test server.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.testing.AsyncHTTPSTestCase">
<em class="property">class </em><code class="descclassname">tornado.testing.</code><code class="descname">AsyncHTTPSTestCase</code><span class="sig-paren">(</span><em>methodName='runTest'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#AsyncHTTPSTestCase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.AsyncHTTPSTestCase" title="Permalink to this definition">¶</a></dt>
<dd><p>A test case that starts an HTTPS server.</p>
<p>Interface is generally the same as <a class="reference internal" href="#tornado.testing.AsyncHTTPTestCase" title="tornado.testing.AsyncHTTPTestCase"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPTestCase</span></code></a>.</p>
<dl class="method">
<dt id="tornado.testing.AsyncHTTPSTestCase.get_ssl_options">
<code class="descname">get_ssl_options</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#AsyncHTTPSTestCase.get_ssl_options"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.AsyncHTTPSTestCase.get_ssl_options" title="Permalink to this definition">¶</a></dt>
<dd><p>May be overridden by subclasses to select SSL options.</p>
<p>By default includes a self-signed testing certificate.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tornado.testing.gen_test">
<code class="descclassname">tornado.testing.</code><code class="descname">gen_test</code><span class="sig-paren">(</span><em>func=None</em>, <em>timeout=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#gen_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.gen_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Testing equivalent of <code class="docutils literal"><span class="pre">&#64;gen.coroutine</span></code>, to be applied to test methods.</p>
<p><code class="docutils literal"><span class="pre">&#64;gen.coroutine</span></code> cannot be used on tests because the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> is not
already running.  <code class="docutils literal"><span class="pre">&#64;gen_test</span></code> should be applied to test methods
on subclasses of <a class="reference internal" href="#tornado.testing.AsyncTestCase" title="tornado.testing.AsyncTestCase"><code class="xref py py-obj docutils literal"><span class="pre">AsyncTestCase</span></code></a>.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyTest</span><span class="p">(</span><span class="n">AsyncHTTPTestCase</span><span class="p">):</span>
    <span class="nd">@gen_test</span>
    <span class="k">def</span> <span class="nf">test_something</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">gen</span><span class="o">.</span><span class="n">Task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>By default, <code class="docutils literal"><span class="pre">&#64;gen_test</span></code> times out after 5 seconds. The timeout may be
overridden globally with the <code class="docutils literal"><span class="pre">ASYNC_TEST_TIMEOUT</span></code> environment variable,
or for each test with the <code class="docutils literal"><span class="pre">timeout</span></code> keyword argument:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyTest</span><span class="p">(</span><span class="n">AsyncHTTPTestCase</span><span class="p">):</span>
    <span class="nd">@gen_test</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">test_something_slow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">response</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">gen</span><span class="o">.</span><span class="n">Task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1: </span>The <code class="docutils literal"><span class="pre">timeout</span></code> argument and <code class="docutils literal"><span class="pre">ASYNC_TEST_TIMEOUT</span></code> environment
variable.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.0: </span>The wrapper now passes along <code class="docutils literal"><span class="pre">*args,</span> <span class="pre">**kwargs</span></code> so it can be used
on functions with arguments.</p>
</div>
</dd></dl>

</div>
<div class="section" id="controlling-log-output">
<h5>Controlling log output<a class="headerlink" href="#controlling-log-output" title="Permalink to this headline">¶</a></h5>
<dl class="class">
<dt id="tornado.testing.ExpectLog">
<em class="property">class </em><code class="descclassname">tornado.testing.</code><code class="descname">ExpectLog</code><span class="sig-paren">(</span><em>logger</em>, <em>regex</em>, <em>required=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#ExpectLog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.ExpectLog" title="Permalink to this definition">¶</a></dt>
<dd><p>Context manager to capture and suppress expected log output.</p>
<p>Useful to make tests of error conditions less noisy, while still
leaving unexpected log entries visible.  <em>Not thread safe.</em></p>
<p>The attribute <code class="docutils literal"><span class="pre">logged_stack</span></code> is set to true if any exception
stack trace was logged.</p>
<p>Usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="n">ExpectLog</span><span class="p">(</span><span class="s">&#39;tornado.application&#39;</span><span class="p">,</span> <span class="s">&quot;Uncaught exception&quot;</span><span class="p">):</span>
    <span class="n">error_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s">&quot;/some_page&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.3: </span>Added the <code class="docutils literal"><span class="pre">logged_stack</span></code> attribute.</p>
</div>
<p>Constructs an ExpectLog context manager.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>logger</strong> &#8211; Logger object (or name of logger) to watch.  Pass
an empty string to watch the root logger.</li>
<li><strong>regex</strong> &#8211; Regular expression to match.  Any log entries on
the specified logger that match this regex will be suppressed.</li>
<li><strong>required</strong> &#8211; If true, an exeption will be raised if the end of
the <code class="docutils literal"><span class="pre">with</span></code> statement is reached without matching any log entries.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="tornado.testing.LogTrapTestCase">
<em class="property">class </em><code class="descclassname">tornado.testing.</code><code class="descname">LogTrapTestCase</code><span class="sig-paren">(</span><em>methodName='runTest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#LogTrapTestCase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.LogTrapTestCase" title="Permalink to this definition">¶</a></dt>
<dd><p>A test case that captures and discards all logging output
if the test passes.</p>
<p>Some libraries can produce a lot of logging output even when
the test succeeds, so this class can be useful to minimize the noise.
Simply use it as a base class for your test case.  It is safe to combine
with AsyncTestCase via multiple inheritance
(<code class="docutils literal"><span class="pre">class</span> <span class="pre">MyTestCase(AsyncHTTPTestCase,</span> <span class="pre">LogTrapTestCase):</span></code>)</p>
<p>This class assumes that only one log handler is configured and
that it is a <a class="reference external" href="https://docs.python.org/3.4/library/logging.handlers.html#logging.StreamHandler" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">StreamHandler</span></code></a>.  This is true for both
<a class="reference external" href="https://docs.python.org/3.4/library/logging.html#logging.basicConfig" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">logging.basicConfig</span></code></a> and the &#8220;pretty logging&#8221; configured by
<a class="reference internal" href="index.html#module-tornado.options" title="tornado.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options</span></code></a>.  It is not compatible with other log buffering
mechanisms, such as those provided by some test runners.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 4.1: </span>Use the unittest module&#8217;s <code class="docutils literal"><span class="pre">--buffer</span></code> option instead, or <a class="reference internal" href="#tornado.testing.ExpectLog" title="tornado.testing.ExpectLog"><code class="xref py py-obj docutils literal"><span class="pre">ExpectLog</span></code></a>.</p>
</div>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p>
</dd></dl>

</div>
<div class="section" id="test-runner">
<h5>Test runner<a class="headerlink" href="#test-runner" title="Permalink to this headline">¶</a></h5>
<dl class="function">
<dt id="tornado.testing.main">
<code class="descclassname">tornado.testing.</code><code class="descname">main</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.main" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple test runner.</p>
<p>This test runner is essentially equivalent to <a class="reference external" href="https://docs.python.org/3.4/library/unittest.html#unittest.main" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">unittest.main</span></code></a> from
the standard library, but adds support for tornado-style option
parsing and log formatting.</p>
<p>The easiest way to run a test is via the command line:</p>
<div class="highlight-python"><div class="highlight"><pre>python -m tornado.testing tornado.test.stack_context_test
</pre></div>
</div>
<p>See the standard library unittest module for ways in which tests can
be specified.</p>
<p>Projects with many tests may wish to define a test script like
<code class="docutils literal"><span class="pre">tornado/test/runtests.py</span></code>.  This script should define a method
<code class="docutils literal"><span class="pre">all()</span></code> which returns a test suite and then call
<a class="reference internal" href="#tornado.testing.main" title="tornado.testing.main"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.main()</span></code></a>.  Note that even when a test script is
used, the <code class="docutils literal"><span class="pre">all()</span></code> test suite may be overridden by naming a
single test on the command line:</p>
<div class="highlight-python"><div class="highlight"><pre># Runs all tests
python -m tornado.test.runtests
# Runs one test
python -m tornado.test.runtests tornado.test.stack_context_test
</pre></div>
</div>
<p>Additional keyword arguments passed through to <code class="docutils literal"><span class="pre">unittest.main()</span></code>.
For example, use <code class="docutils literal"><span class="pre">tornado.testing.main(verbosity=2)</span></code>
to show many test details as they are run.
See <a class="reference external" href="http://docs.python.org/library/unittest.html#unittest.main">http://docs.python.org/library/unittest.html#unittest.main</a>
for full argument list.</p>
</dd></dl>

</div>
<div class="section" id="helper-functions">
<h5>Helper functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h5>
<dl class="function">
<dt id="tornado.testing.bind_unused_port">
<code class="descclassname">tornado.testing.</code><code class="descname">bind_unused_port</code><span class="sig-paren">(</span><em>reuse_port=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#bind_unused_port"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.bind_unused_port" title="Permalink to this definition">¶</a></dt>
<dd><p>Binds a server socket to an available port on localhost.</p>
<p>Returns a tuple (socket, port).</p>
</dd></dl>

<dl class="function">
<dt id="tornado.testing.get_unused_port">
<code class="descclassname">tornado.testing.</code><code class="descname">get_unused_port</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#get_unused_port"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.get_unused_port" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a (hopefully) unused port number.</p>
<p>This function does not guarantee that the port it returns is available,
only that a series of get_unused_port calls in a single process return
distinct ports.</p>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version Use: </span>bind_unused_port instead, which is guaranteed to find an unused port.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.testing.get_async_test_timeout">
<code class="descclassname">tornado.testing.</code><code class="descname">get_async_test_timeout</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/testing.html#get_async_test_timeout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.testing.get_async_test_timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the global timeout setting for async tests.</p>
<p>Returns a float, the timeout in seconds.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 3.1.</span></p>
</div>
</dd></dl>

</div>
</div>
<span id="document-util"></span><div class="section" id="tornado-util-general-purpose-utilities">
<h4><code class="docutils literal"><span class="pre">tornado.util</span></code> &#8212; General-purpose utilities<a class="headerlink" href="#tornado-util-general-purpose-utilities" title="Permalink to this headline">¶</a></h4>
<span class="target" id="module-tornado.util"></span><p>Miscellaneous utility functions and classes.</p>
<p>This module is used internally by Tornado.  It is not necessarily expected
that the functions and classes defined here will be useful to other
applications, but they are documented here in case they are.</p>
<p>The one public-facing part of this module is the <a class="reference internal" href="#tornado.util.Configurable" title="tornado.util.Configurable"><code class="xref py py-obj docutils literal"><span class="pre">Configurable</span></code></a> class
and its <a class="reference internal" href="#tornado.util.Configurable.configure" title="tornado.util.Configurable.configure"><code class="xref py py-obj docutils literal"><span class="pre">configure</span></code></a> method, which becomes a part of the
interface of its subclasses, including <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a>, <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>,
and <a class="reference internal" href="index.html#tornado.netutil.Resolver" title="tornado.netutil.Resolver"><code class="xref py py-obj docutils literal"><span class="pre">Resolver</span></code></a>.</p>
<dl class="class">
<dt id="tornado.util.ObjectDict">
<em class="property">class </em><code class="descclassname">tornado.util.</code><code class="descname">ObjectDict</code><a class="reference internal" href="_modules/tornado/util.html#ObjectDict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.util.ObjectDict" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a dictionary behave like an object, with attribute-style access.</p>
</dd></dl>

<dl class="class">
<dt id="tornado.util.GzipDecompressor">
<em class="property">class </em><code class="descclassname">tornado.util.</code><code class="descname">GzipDecompressor</code><a class="reference internal" href="_modules/tornado/util.html#GzipDecompressor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.util.GzipDecompressor" title="Permalink to this definition">¶</a></dt>
<dd><p>Streaming gzip decompressor.</p>
<p>The interface is like that of <a class="reference external" href="https://docs.python.org/3.4/library/zlib.html#zlib.decompressobj" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">zlib.decompressobj</span></code></a> (without some of the
optional arguments, but it understands gzip headers and checksums.</p>
<dl class="method">
<dt id="tornado.util.GzipDecompressor.decompress">
<code class="descname">decompress</code><span class="sig-paren">(</span><em>value</em>, <em>max_length=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/util.html#GzipDecompressor.decompress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.util.GzipDecompressor.decompress" title="Permalink to this definition">¶</a></dt>
<dd><p>Decompress a chunk, returning newly-available data.</p>
<p>Some data may be buffered for later processing; <a class="reference internal" href="#tornado.util.GzipDecompressor.flush" title="tornado.util.GzipDecompressor.flush"><code class="xref py py-obj docutils literal"><span class="pre">flush</span></code></a> must
be called when there is no more input data to ensure that
all data was processed.</p>
<p>If <code class="docutils literal"><span class="pre">max_length</span></code> is given, some input data may be left over
in <code class="docutils literal"><span class="pre">unconsumed_tail</span></code>; you must retrieve this value and pass
it back to a future call to <a class="reference internal" href="#tornado.util.GzipDecompressor.decompress" title="tornado.util.GzipDecompressor.decompress"><code class="xref py py-obj docutils literal"><span class="pre">decompress</span></code></a> if it is not empty.</p>
</dd></dl>

<dl class="attribute">
<dt id="tornado.util.GzipDecompressor.unconsumed_tail">
<code class="descname">unconsumed_tail</code><a class="headerlink" href="#tornado.util.GzipDecompressor.unconsumed_tail" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the unconsumed portion left over</p>
</dd></dl>

<dl class="method">
<dt id="tornado.util.GzipDecompressor.flush">
<code class="descname">flush</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/util.html#GzipDecompressor.flush"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.util.GzipDecompressor.flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Return any remaining buffered data not yet returned by decompress.</p>
<p>Also checks for errors such as truncated input.
No other methods may be called on this object after <a class="reference internal" href="#tornado.util.GzipDecompressor.flush" title="tornado.util.GzipDecompressor.flush"><code class="xref py py-obj docutils literal"><span class="pre">flush</span></code></a>.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tornado.util.import_object">
<code class="descclassname">tornado.util.</code><code class="descname">import_object</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/util.html#import_object"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.util.import_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Imports an object by name.</p>
<p>import_object(&#8216;x&#8217;) is equivalent to &#8216;import x&#8217;.
import_object(&#8216;x.y.z&#8217;) is equivalent to &#8216;from x.y import z&#8217;.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tornado.escape</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">import_object</span><span class="p">(</span><span class="s">&#39;tornado.escape&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">tornado</span><span class="o">.</span><span class="n">escape</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">import_object</span><span class="p">(</span><span class="s">&#39;tornado.escape.utf8&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">tornado</span><span class="o">.</span><span class="n">escape</span><span class="o">.</span><span class="n">utf8</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">import_object</span><span class="p">(</span><span class="s">&#39;tornado&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">tornado</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">import_object</span><span class="p">(</span><span class="s">&#39;tornado.missing_module&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">ImportError</span>: <span class="n">No module named missing_module</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tornado.util.errno_from_exception">
<code class="descclassname">tornado.util.</code><code class="descname">errno_from_exception</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/util.html#errno_from_exception"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.util.errno_from_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides the errno from an Exception object.</p>
<p>There are cases that the errno attribute was not set so we pull
the errno out of the args but if someone instantiates an Exception
without any args you will get a tuple error. So this function
abstracts all that behavior to give you a safe way to get the
errno.</p>
</dd></dl>

<dl class="class">
<dt id="tornado.util.Configurable">
<em class="property">class </em><code class="descclassname">tornado.util.</code><code class="descname">Configurable</code><a class="reference internal" href="_modules/tornado/util.html#Configurable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.util.Configurable" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for configurable interfaces.</p>
<p>A configurable interface is an (abstract) class whose constructor
acts as a factory function for one of its implementation subclasses.
The implementation subclass as well as optional keyword arguments to
its initializer can be set globally at runtime with <a class="reference internal" href="#tornado.util.Configurable.configure" title="tornado.util.Configurable.configure"><code class="xref py py-obj docutils literal"><span class="pre">configure</span></code></a>.</p>
<p>By using the constructor as the factory method, the interface
looks like a normal class, <a class="reference external" href="https://docs.python.org/3.4/library/functions.html#isinstance" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">isinstance</span></code></a> works as usual, etc.  This
pattern is most useful when the choice of implementation is likely
to be a global decision (e.g. when <a class="reference external" href="https://docs.python.org/3.4/library/select.html#select.epoll" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">epoll</span></code></a> is available,
always use it instead of <a class="reference external" href="https://docs.python.org/3.4/library/select.html#select.select" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">select</span></code></a>), or when a
previously-monolithic class has been split into specialized
subclasses.</p>
<p>Configurable subclasses must define the class methods
<a class="reference internal" href="#tornado.util.Configurable.configurable_base" title="tornado.util.Configurable.configurable_base"><code class="xref py py-obj docutils literal"><span class="pre">configurable_base</span></code></a> and <a class="reference internal" href="#tornado.util.Configurable.configurable_default" title="tornado.util.Configurable.configurable_default"><code class="xref py py-obj docutils literal"><span class="pre">configurable_default</span></code></a>, and use the instance
method <a class="reference internal" href="#tornado.util.Configurable.initialize" title="tornado.util.Configurable.initialize"><code class="xref py py-obj docutils literal"><span class="pre">initialize</span></code></a> instead of <code class="docutils literal"><span class="pre">__init__</span></code>.</p>
<dl class="classmethod">
<dt id="tornado.util.Configurable.configurable_base">
<em class="property">classmethod </em><code class="descname">configurable_base</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/util.html#Configurable.configurable_base"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.util.Configurable.configurable_base" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the base class of a configurable hierarchy.</p>
<p>This will normally return the class in which it is defined.
(which is <em>not</em> necessarily the same as the cls classmethod parameter).</p>
</dd></dl>

<dl class="classmethod">
<dt id="tornado.util.Configurable.configurable_default">
<em class="property">classmethod </em><code class="descname">configurable_default</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/util.html#Configurable.configurable_default"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.util.Configurable.configurable_default" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the implementation class to be used if none is configured.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.util.Configurable.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/util.html#Configurable.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.util.Configurable.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a <a class="reference internal" href="#tornado.util.Configurable" title="tornado.util.Configurable"><code class="xref py py-obj docutils literal"><span class="pre">Configurable</span></code></a> subclass instance.</p>
<p>Configurable classes should use <a class="reference internal" href="#tornado.util.Configurable.initialize" title="tornado.util.Configurable.initialize"><code class="xref py py-obj docutils literal"><span class="pre">initialize</span></code></a> instead of <code class="docutils literal"><span class="pre">__init__</span></code>.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 4.2: </span>Now accepts positional arguments in addition to keyword arguments.</p>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="tornado.util.Configurable.configure">
<em class="property">classmethod </em><code class="descname">configure</code><span class="sig-paren">(</span><em>impl</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/util.html#Configurable.configure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.util.Configurable.configure" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the class to use when the base class is instantiated.</p>
<p>Keyword arguments will be saved and added to the arguments passed
to the constructor.  This can be used to set global defaults for
some parameters.</p>
</dd></dl>

<dl class="classmethod">
<dt id="tornado.util.Configurable.configured_class">
<em class="property">classmethod </em><code class="descname">configured_class</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/util.html#Configurable.configured_class"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.util.Configurable.configured_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the currently configured class.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="tornado.util.ArgReplacer">
<em class="property">class </em><code class="descclassname">tornado.util.</code><code class="descname">ArgReplacer</code><span class="sig-paren">(</span><em>func</em>, <em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/util.html#ArgReplacer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.util.ArgReplacer" title="Permalink to this definition">¶</a></dt>
<dd><p>Replaces one value in an <code class="docutils literal"><span class="pre">args,</span> <span class="pre">kwargs</span></code> pair.</p>
<p>Inspects the function signature to find an argument by name
whether it is passed by position or keyword.  For use in decorators
and similar wrappers.</p>
<dl class="method">
<dt id="tornado.util.ArgReplacer.get_old_value">
<code class="descname">get_old_value</code><span class="sig-paren">(</span><em>args</em>, <em>kwargs</em>, <em>default=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/util.html#ArgReplacer.get_old_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.util.ArgReplacer.get_old_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the old value of the named argument without replacing it.</p>
<p>Returns <code class="docutils literal"><span class="pre">default</span></code> if the argument is not present.</p>
</dd></dl>

<dl class="method">
<dt id="tornado.util.ArgReplacer.replace">
<code class="descname">replace</code><span class="sig-paren">(</span><em>new_value</em>, <em>args</em>, <em>kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/util.html#ArgReplacer.replace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.util.ArgReplacer.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace the named argument in <code class="docutils literal"><span class="pre">args,</span> <span class="pre">kwargs</span></code> with <code class="docutils literal"><span class="pre">new_value</span></code>.</p>
<p>Returns <code class="docutils literal"><span class="pre">(old_value,</span> <span class="pre">args,</span> <span class="pre">kwargs)</span></code>.  The returned <code class="docutils literal"><span class="pre">args</span></code> and
<code class="docutils literal"><span class="pre">kwargs</span></code> objects may not be the same as the input objects, or
the input objects may be mutated.</p>
<p>If the named argument was not found, <code class="docutils literal"><span class="pre">new_value</span></code> will be added
to <code class="docutils literal"><span class="pre">kwargs</span></code> and None will be returned as <code class="docutils literal"><span class="pre">old_value</span></code>.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="tornado.util.timedelta_to_seconds">
<code class="descclassname">tornado.util.</code><code class="descname">timedelta_to_seconds</code><span class="sig-paren">(</span><em>td</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tornado/util.html#timedelta_to_seconds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tornado.util.timedelta_to_seconds" title="Permalink to this definition">¶</a></dt>
<dd><p>Equivalent to td.total_seconds() (introduced in python 2.7).</p>
</dd></dl>

</div>
</div>
</div>
<span id="document-faq"></span><div class="section" id="frequently-asked-questions">
<h3>Frequently Asked Questions<a class="headerlink" href="#frequently-asked-questions" title="Permalink to this headline">¶</a></h3>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#why-isn-t-this-example-with-time-sleep-running-in-parallel" id="id2">Why isn&#8217;t this example with <code class="docutils literal"><span class="pre">time.sleep()</span></code> running in parallel?</a></li>
<li><a class="reference internal" href="#my-code-is-asynchronous-but-it-s-not-running-in-parallel-in-two-browser-tabs" id="id3">My code is asynchronous, but it&#8217;s not running in parallel in two browser tabs.</a></li>
</ul>
</div>
<div class="section" id="why-isn-t-this-example-with-time-sleep-running-in-parallel">
<h4><a class="toc-backref" href="#id2">Why isn&#8217;t this example with <code class="docutils literal"><span class="pre">time.sleep()</span></code> running in parallel?</a><a class="headerlink" href="#why-isn-t-this-example-with-time-sleep-running-in-parallel" title="Permalink to this headline">¶</a></h4>
<p>Many people&#8217;s first foray into Tornado&#8217;s concurrency looks something like
this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">BadExampleHandler</span><span class="p">(</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Fetch this handler twice at the same time and you&#8217;ll see that the second
five-second countdown doesn&#8217;t start until the first one has completely
finished. The reason for this is that <a class="reference external" href="https://docs.python.org/3.4/library/time.html#time.sleep" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">time.sleep</span></code></a> is a <strong>blocking</strong>
function: it doesn&#8217;t allow control to return to the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> so that other
handlers can be run.</p>
<p>Of course, <a class="reference external" href="https://docs.python.org/3.4/library/time.html#time.sleep" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">time.sleep</span></code></a> is really just a placeholder in these examples,
the point is to show what happens when something in a handler gets slow.
No matter what the real code is doing, to achieve concurrency blocking
code must be replaced with non-blocking equivalents. This means one of three things:</p>
<ol class="arabic">
<li><p class="first"><em>Find a coroutine-friendly equivalent.</em> For <a class="reference external" href="https://docs.python.org/3.4/library/time.html#time.sleep" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">time.sleep</span></code></a>, use
<a class="reference internal" href="index.html#tornado.gen.sleep" title="tornado.gen.sleep"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.sleep</span></code></a> instead:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">CoroutineSleepHandler</span><span class="p">(</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="nd">@gen.coroutine</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">gen</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>When this option is available, it is usually the best approach.
See the <a class="reference external" href="https://github.com/tornadoweb/tornado/wiki/Links">Tornado wiki</a>
for links to asynchronous libraries that may be useful.</p>
</li>
<li><p class="first"><em>Find a callback-based equivalent.</em> Similar to the first option,
callback-based libraries are available for many tasks, although they
are slightly more complicated to use than a library designed for
coroutines. These are typically used with <a class="reference internal" href="index.html#tornado.gen.Task" title="tornado.gen.Task"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.Task</span></code></a> as an
adapter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">CoroutineTimeoutHandler</span><span class="p">(</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="nd">@gen.coroutine</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">io_loop</span> <span class="o">=</span> <span class="n">IOLoop</span><span class="o">.</span><span class="n">current</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">gen</span><span class="o">.</span><span class="n">Task</span><span class="p">(</span><span class="n">io_loop</span><span class="o">.</span><span class="n">add_timeout</span><span class="p">,</span> <span class="n">io_loop</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Again, the
<a class="reference external" href="https://github.com/tornadoweb/tornado/wiki/Links">Tornado wiki</a>
can be useful to find suitable libraries.</p>
</li>
<li><p class="first"><em>Run the blocking code on another thread.</em> When asynchronous libraries
are not available, <a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#concurrent.futures.ThreadPoolExecutor" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures.ThreadPoolExecutor</span></code></a> can be used
to run any blocking code on another thread. This is a universal solution
that can be used for any blocking function whether an asynchronous
counterpart exists or not:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">executor</span> <span class="o">=</span> <span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ThreadPoolHandler</span><span class="p">(</span><span class="n">RequestHandler</span><span class="p">):</span>
    <span class="nd">@gen.coroutine</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
<p>See the <a class="reference internal" href="index.html#document-guide/async"><em>Asynchronous I/O</em></a> chapter of the Tornado
user&#8217;s guide for more on blocking and asynchronous functions.</p>
</div>
<div class="section" id="my-code-is-asynchronous-but-it-s-not-running-in-parallel-in-two-browser-tabs">
<h4><a class="toc-backref" href="#id3">My code is asynchronous, but it&#8217;s not running in parallel in two browser tabs.</a><a class="headerlink" href="#my-code-is-asynchronous-but-it-s-not-running-in-parallel-in-two-browser-tabs" title="Permalink to this headline">¶</a></h4>
<p>Even when a handler is asynchronous and non-blocking, it can be surprisingly
tricky to verify this. Browsers will recognize that you are trying to
load the same page in two different tabs and delay the second request
until the first has finished. To work around this and see that the server
is in fact working in parallel, do one of two things:</p>
<ul class="simple">
<li>Add something to your urls to make them unique. Instead of
<code class="docutils literal"><span class="pre">http://localhost:8888</span></code> in both tabs, load
<code class="docutils literal"><span class="pre">http://localhost:8888/?x=1</span></code> in one and
<code class="docutils literal"><span class="pre">http://localhost:8888/?x=2</span></code> in the other.</li>
<li>Use two different browsers. For example, Firefox will be able to load
a url even while that same url is being loaded in a Chrome tab.</li>
</ul>
</div>
</div>
<span id="document-releases"></span><div class="section" id="release-notes">
<h3>Release notes<a class="headerlink" href="#release-notes" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
<span id="document-releases/v4.3.0"></span><div class="section" id="what-s-new-in-tornado-4-3">
<h4>What&#8217;s new in Tornado 4.3<a class="headerlink" href="#what-s-new-in-tornado-4-3" title="Permalink to this headline">¶</a></h4>
<div class="section" id="nov-6-2015">
<h5>Nov 6, 2015<a class="headerlink" href="#nov-6-2015" title="Permalink to this headline">¶</a></h5>
<div class="section" id="highlights">
<h6>Highlights<a class="headerlink" href="#highlights" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The new async/await keywords in Python 3.5 are supported. In most cases,
<code class="docutils literal"><span class="pre">async</span> <span class="pre">def</span></code> can be used in place of the <code class="docutils literal"><span class="pre">&#64;gen.coroutine</span></code> decorator.
Inside a function defined with <code class="docutils literal"><span class="pre">async</span> <span class="pre">def</span></code>, use <code class="docutils literal"><span class="pre">await</span></code> instead of
<code class="docutils literal"><span class="pre">yield</span></code> to wait on an asynchronous operation. Coroutines defined with
async/await will be faster than those defined with <code class="docutils literal"><span class="pre">&#64;gen.coroutine</span></code> and
<code class="docutils literal"><span class="pre">yield</span></code>, but do not support some features including <a class="reference internal" href="index.html#tornado.gen.Callback" title="tornado.gen.Callback"><code class="xref py py-obj docutils literal"><span class="pre">Callback</span></code></a>/<a class="reference internal" href="index.html#tornado.gen.Wait" title="tornado.gen.Wait"><code class="xref py py-obj docutils literal"><span class="pre">Wait</span></code></a> or
the ability to yield a Twisted <code class="docutils literal"><span class="pre">Deferred</span></code>. See <a class="reference internal" href="index.html#native-coroutines"><span>the users&#8217;
guide</span></a> for more.</li>
<li>The async/await keywords are also available when compiling with Cython in
older versions of Python.</li>
</ul>
</div>
<div class="section" id="deprecation-notice">
<h6>Deprecation notice<a class="headerlink" href="#deprecation-notice" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>This will be the last release of Tornado to support Python 2.6 or 3.2.
Note that PyPy3 will continue to be supported even though it implements
a mix of Python 3.2 and 3.3 features.</li>
</ul>
</div>
<div class="section" id="installation">
<h6>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Tornado has several new dependencies: <code class="docutils literal"><span class="pre">ordereddict</span></code> on Python 2.6,
<code class="docutils literal"><span class="pre">singledispatch</span></code> on all Python versions prior to 3.4 (This was an
optional dependency in prior versions of Tornado, and is now
mandatory), and <code class="docutils literal"><span class="pre">backports_abc&gt;=0.4</span></code> on all versions prior to
3.5. These dependencies will be installed automatically when installing
with <code class="docutils literal"><span class="pre">pip</span></code> or <code class="docutils literal"><span class="pre">setup.py</span> <span class="pre">install</span></code>. These dependencies will not
be required when running on Google App Engine.</li>
<li>Binary wheels are provided for Python 3.5 on Windows (32 and 64 bit).</li>
</ul>
</div>
<div class="section" id="tornado-auth">
<h6><a class="reference internal" href="index.html#module-tornado.auth" title="tornado.auth"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth</span></code></a><a class="headerlink" href="#tornado-auth" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>New method <a class="reference internal" href="index.html#tornado.auth.OAuth2Mixin.oauth2_request" title="tornado.auth.OAuth2Mixin.oauth2_request"><code class="xref py py-obj docutils literal"><span class="pre">OAuth2Mixin.oauth2_request</span></code></a> can be used to make authenticated
requests with an access token.</li>
<li>Now compatible with callbacks that have been compiled with Cython.</li>
</ul>
</div>
<div class="section" id="tornado-autoreload">
<h6><a class="reference internal" href="index.html#module-tornado.autoreload" title="tornado.autoreload"><code class="xref py py-obj docutils literal"><span class="pre">tornado.autoreload</span></code></a><a class="headerlink" href="#tornado-autoreload" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Fixed an issue with the autoreload command-line wrapper in which
imports would be incorrectly interpreted as relative.</li>
</ul>
</div>
<div class="section" id="tornado-curl-httpclient">
<h6><a class="reference internal" href="index.html#module-tornado.curl_httpclient" title="tornado.curl_httpclient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.curl_httpclient</span></code></a><a class="headerlink" href="#tornado-curl-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Fixed parsing of multi-line headers.</li>
<li><code class="docutils literal"><span class="pre">allow_nonstandard_methods=True</span></code> now bypasses body sanity checks,
in the same way as in <code class="docutils literal"><span class="pre">simple_httpclient</span></code>.</li>
<li>The <code class="docutils literal"><span class="pre">PATCH</span></code> method now allows a body without
<code class="docutils literal"><span class="pre">allow_nonstandard_methods=True</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-gen">
<h6><a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a><a class="headerlink" href="#tornado-gen" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.gen.WaitIterator" title="tornado.gen.WaitIterator"><code class="xref py py-obj docutils literal"><span class="pre">WaitIterator</span></code></a> now supports the <code class="docutils literal"><span class="pre">async</span> <span class="pre">for</span></code> statement on Python 3.5.</li>
<li><code class="docutils literal"><span class="pre">&#64;gen.coroutine</span></code> can be applied to functions compiled with Cython.
On python versions prior to 3.5, the <code class="docutils literal"><span class="pre">backports_abc</span></code> package must
be installed for this functionality.</li>
<li><code class="docutils literal"><span class="pre">Multi</span></code> and <a class="reference internal" href="index.html#tornado.gen.multi_future" title="tornado.gen.multi_future"><code class="xref py py-obj docutils literal"><span class="pre">multi_future</span></code></a> are deprecated and replaced by
a unified function <a class="reference internal" href="index.html#tornado.gen.multi" title="tornado.gen.multi"><code class="xref py py-obj docutils literal"><span class="pre">multi</span></code></a>.</li>
</ul>
</div>
<div class="section" id="tornado-httpclient">
<h6><a class="reference internal" href="index.html#module-tornado.httpclient" title="tornado.httpclient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient</span></code></a><a class="headerlink" href="#tornado-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httpclient.HTTPError" title="tornado.httpclient.HTTPError"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient.HTTPError</span></code></a> is now copyable with the <a class="reference external" href="https://docs.python.org/3.4/library/copy.html#module-copy" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">copy</span></code></a> module.</li>
</ul>
</div>
<div class="section" id="tornado-httpserver">
<h6><a class="reference internal" href="index.html#module-tornado.httpserver" title="tornado.httpserver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpserver</span></code></a><a class="headerlink" href="#tornado-httpserver" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Requests containing both <code class="docutils literal"><span class="pre">Content-Length</span></code> and <code class="docutils literal"><span class="pre">Transfer-Encoding</span></code>
will be treated as an error.</li>
</ul>
</div>
<div class="section" id="tornado-httputil">
<h6><a class="reference internal" href="index.html#module-tornado.httputil" title="tornado.httputil"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httputil</span></code></a><a class="headerlink" href="#tornado-httputil" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httputil.HTTPHeaders" title="tornado.httputil.HTTPHeaders"><code class="xref py py-obj docutils literal"><span class="pre">HTTPHeaders</span></code></a> can now be pickled and unpickled.</li>
</ul>
</div>
<div class="section" id="tornado-ioloop">
<h6><a class="reference internal" href="index.html#module-tornado.ioloop" title="tornado.ioloop"><code class="xref py py-obj docutils literal"><span class="pre">tornado.ioloop</span></code></a><a class="headerlink" href="#tornado-ioloop" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">IOLoop(make_current=True)</span></code> now works as intended instead
of raising an exception.</li>
<li>The Twisted and asyncio IOLoop implementations now clear
<code class="docutils literal"><span class="pre">current()</span></code> when they exit, like the standard IOLoops.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_callback" title="tornado.ioloop.IOLoop.add_callback"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_callback</span></code></a> is faster in the single-threaded case.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_callback" title="tornado.ioloop.IOLoop.add_callback"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_callback</span></code></a> no longer raises an error when called on
a closed IOLoop, but the callback will not be invoked.</li>
</ul>
</div>
<div class="section" id="tornado-iostream">
<h6><a class="reference internal" href="index.html#module-tornado.iostream" title="tornado.iostream"><code class="xref py py-obj docutils literal"><span class="pre">tornado.iostream</span></code></a><a class="headerlink" href="#tornado-iostream" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Coroutine-style usage of <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> now converts most errors into
<a class="reference internal" href="index.html#tornado.iostream.StreamClosedError" title="tornado.iostream.StreamClosedError"><code class="xref py py-obj docutils literal"><span class="pre">StreamClosedError</span></code></a>, which has the effect of reducing log noise from
exceptions that are outside the application&#8217;s control (especially
SSL errors).</li>
<li><a class="reference internal" href="index.html#tornado.iostream.StreamClosedError" title="tornado.iostream.StreamClosedError"><code class="xref py py-obj docutils literal"><span class="pre">StreamClosedError</span></code></a> now has a <code class="docutils literal"><span class="pre">real_error</span></code> attribute which indicates
why the stream was closed. It is the same as the <code class="docutils literal"><span class="pre">error</span></code> attribute of
<a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> but may be more easily accessible than the <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> itself.</li>
<li>Improved error handling in <a class="reference internal" href="index.html#tornado.iostream.BaseIOStream.read_until_close" title="tornado.iostream.BaseIOStream.read_until_close"><code class="xref py py-obj docutils literal"><span class="pre">read_until_close</span></code></a>.</li>
<li>Logging is less noisy when an SSL server is port scanned.</li>
<li><code class="docutils literal"><span class="pre">EINTR</span></code> is now handled on all reads.</li>
</ul>
</div>
<div class="section" id="tornado-locale">
<h6><a class="reference internal" href="index.html#module-tornado.locale" title="tornado.locale"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locale</span></code></a><a class="headerlink" href="#tornado-locale" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.locale.load_translations" title="tornado.locale.load_translations"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locale.load_translations</span></code></a> now accepts encodings other than
UTF-8. UTF-16 and UTF-8 will be detected automatically if a BOM is
present; for other encodings <a class="reference internal" href="index.html#tornado.locale.load_translations" title="tornado.locale.load_translations"><code class="xref py py-obj docutils literal"><span class="pre">load_translations</span></code></a> has an <code class="docutils literal"><span class="pre">encoding</span></code>
parameter.</li>
</ul>
</div>
<div class="section" id="tornado-locks">
<h6><a class="reference internal" href="index.html#module-tornado.locks" title="tornado.locks"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locks</span></code></a><a class="headerlink" href="#tornado-locks" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.locks.Lock" title="tornado.locks.Lock"><code class="xref py py-obj docutils literal"><span class="pre">Lock</span></code></a> and <a class="reference internal" href="index.html#tornado.locks.Semaphore" title="tornado.locks.Semaphore"><code class="xref py py-obj docutils literal"><span class="pre">Semaphore</span></code></a> now support the <code class="docutils literal"><span class="pre">async</span> <span class="pre">with</span></code> statement on
Python 3.5.</li>
</ul>
</div>
<div class="section" id="tornado-log">
<h6><a class="reference internal" href="index.html#module-tornado.log" title="tornado.log"><code class="xref py py-obj docutils literal"><span class="pre">tornado.log</span></code></a><a class="headerlink" href="#tornado-log" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>A new time-based log rotation mode is available with
<code class="docutils literal"><span class="pre">--log_rotate_mode=time</span></code>, <code class="docutils literal"><span class="pre">--log-rotate-when</span></code>, and
<code class="docutils literal"><span class="pre">log-rotate-interval</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-netutil">
<h6><a class="reference internal" href="index.html#module-tornado.netutil" title="tornado.netutil"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil</span></code></a><a class="headerlink" href="#tornado-netutil" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.netutil.bind_sockets" title="tornado.netutil.bind_sockets"><code class="xref py py-obj docutils literal"><span class="pre">bind_sockets</span></code></a> now supports <code class="docutils literal"><span class="pre">SO_REUSEPORT</span></code> with the <code class="docutils literal"><span class="pre">reuse_port=True</span></code>
argument.</li>
</ul>
</div>
<div class="section" id="tornado-options">
<h6><a class="reference internal" href="index.html#module-tornado.options" title="tornado.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options</span></code></a><a class="headerlink" href="#tornado-options" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Dashes and underscores are now fully interchangeable in option names.</li>
</ul>
</div>
<div class="section" id="tornado-queues">
<h6><a class="reference internal" href="index.html#module-tornado.queues" title="tornado.queues"><code class="xref py py-obj docutils literal"><span class="pre">tornado.queues</span></code></a><a class="headerlink" href="#tornado-queues" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.queues.Queue" title="tornado.queues.Queue"><code class="xref py py-obj docutils literal"><span class="pre">Queue</span></code></a> now supports the <code class="docutils literal"><span class="pre">async</span> <span class="pre">for</span></code> statement on Python 3.5.</li>
</ul>
</div>
<div class="section" id="tornado-simple-httpclient">
<h6><a class="reference internal" href="index.html#module-tornado.simple_httpclient" title="tornado.simple_httpclient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.simple_httpclient</span></code></a><a class="headerlink" href="#tornado-simple-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>When following redirects, <code class="docutils literal"><span class="pre">streaming_callback</span></code> and
<code class="docutils literal"><span class="pre">header_callback</span></code> will no longer be run on the redirect responses
(only the final non-redirect).</li>
<li>Responses containing both <code class="docutils literal"><span class="pre">Content-Length</span></code> and <code class="docutils literal"><span class="pre">Transfer-Encoding</span></code>
will be treated as an error.</li>
</ul>
</div>
<div class="section" id="tornado-template">
<h6><a class="reference internal" href="index.html#module-tornado.template" title="tornado.template"><code class="xref py py-obj docutils literal"><span class="pre">tornado.template</span></code></a><a class="headerlink" href="#tornado-template" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.template.ParseError" title="tornado.template.ParseError"><code class="xref py py-obj docutils literal"><span class="pre">tornado.template.ParseError</span></code></a> now includes the filename in addition to
line number.</li>
<li>Whitespace handling has become more configurable. The <a class="reference internal" href="index.html#tornado.template.Loader" title="tornado.template.Loader"><code class="xref py py-obj docutils literal"><span class="pre">Loader</span></code></a>
constructor now has a <code class="docutils literal"><span class="pre">whitespace</span></code> argument, there is a new
<code class="docutils literal"><span class="pre">template_whitespace</span></code> <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> setting, and there is a new
<code class="docutils literal"><span class="pre">{%</span> <span class="pre">whitespace</span> <span class="pre">%}</span></code> template directive. All of these options take
a mode name defined in the <a class="reference internal" href="index.html#tornado.template.filter_whitespace" title="tornado.template.filter_whitespace"><code class="xref py py-obj docutils literal"><span class="pre">tornado.template.filter_whitespace</span></code></a> function.
The default mode is <code class="docutils literal"><span class="pre">single</span></code>, which is the same behavior as prior
versions of Tornado.</li>
<li>Non-ASCII filenames are now supported.</li>
</ul>
</div>
<div class="section" id="tornado-testing">
<h6><a class="reference internal" href="index.html#module-tornado.testing" title="tornado.testing"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing</span></code></a><a class="headerlink" href="#tornado-testing" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.testing.ExpectLog" title="tornado.testing.ExpectLog"><code class="xref py py-obj docutils literal"><span class="pre">ExpectLog</span></code></a> objects now have a boolean <code class="docutils literal"><span class="pre">logged_stack</span></code> attribute to
make it easier to test whether an exception stack trace was logged.</li>
</ul>
</div>
<div class="section" id="tornado-web">
<h6><a class="reference internal" href="index.html#module-tornado.web" title="tornado.web"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web</span></code></a><a class="headerlink" href="#tornado-web" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The hard limit of 4000 bytes per outgoing header has been removed.</li>
<li><a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> returns the correct <code class="docutils literal"><span class="pre">Content-Type</span></code> for files
with <code class="docutils literal"><span class="pre">.gz</span></code>, <code class="docutils literal"><span class="pre">.bz2</span></code>, and <code class="docutils literal"><span class="pre">.xz</span></code> extensions.</li>
<li>Responses smaller than 1000 bytes will no longer be compressed.</li>
<li>The default gzip compression level is now 6 (was 9).</li>
<li>Fixed a regression in Tornado 4.2.1 that broke <a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a>
with a <code class="docutils literal"><span class="pre">path</span></code> of <code class="docutils literal"><span class="pre">/</span></code>.</li>
<li><a class="reference internal" href="index.html#tornado.web.HTTPError" title="tornado.web.HTTPError"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.HTTPError</span></code></a> is now copyable with the <a class="reference external" href="https://docs.python.org/3.4/library/copy.html#module-copy" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">copy</span></code></a> module.</li>
<li>The exception <a class="reference internal" href="index.html#tornado.web.Finish" title="tornado.web.Finish"><code class="xref py py-obj docutils literal"><span class="pre">Finish</span></code></a> now accepts an argument which will be passed to
the method <a class="reference internal" href="index.html#tornado.web.RequestHandler.finish" title="tornado.web.RequestHandler.finish"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.finish</span></code></a>.</li>
<li>New <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> setting <code class="docutils literal"><span class="pre">xsrf_cookie_kwargs</span></code> can be used to set
additional attributes such as <code class="docutils literal"><span class="pre">secure</span></code> or <code class="docutils literal"><span class="pre">httponly</span></code> on the
XSRF cookie.</li>
<li><a class="reference internal" href="index.html#tornado.web.Application.listen" title="tornado.web.Application.listen"><code class="xref py py-obj docutils literal"><span class="pre">Application.listen</span></code></a> now returns the <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> it created.</li>
</ul>
</div>
<div class="section" id="tornado-websocket">
<h6><a class="reference internal" href="index.html#module-tornado.websocket" title="tornado.websocket"><code class="xref py py-obj docutils literal"><span class="pre">tornado.websocket</span></code></a><a class="headerlink" href="#tornado-websocket" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Fixed handling of continuation frames when compression is enabled.</li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v4.2.1"></span><div class="section" id="what-s-new-in-tornado-4-2-1">
<h4>What&#8217;s new in Tornado 4.2.1<a class="headerlink" href="#what-s-new-in-tornado-4-2-1" title="Permalink to this headline">¶</a></h4>
<div class="section" id="jul-17-2015">
<h5>Jul 17, 2015<a class="headerlink" href="#jul-17-2015" title="Permalink to this headline">¶</a></h5>
<div class="section" id="security-fix">
<h6>Security fix<a class="headerlink" href="#security-fix" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>This release fixes a path traversal vulnerability in <a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a>,
in which files whose names <em>started with</em> the <code class="docutils literal"><span class="pre">static_path</span></code> directory
but were not actually <em>in</em> that directory could be accessed.</li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v4.2.0"></span><div class="section" id="what-s-new-in-tornado-4-2">
<h4>What&#8217;s new in Tornado 4.2<a class="headerlink" href="#what-s-new-in-tornado-4-2" title="Permalink to this headline">¶</a></h4>
<div class="section" id="may-26-2015">
<h5>May 26, 2015<a class="headerlink" href="#may-26-2015" title="Permalink to this headline">¶</a></h5>
<div class="section" id="backwards-compatibility-notes">
<h6>Backwards-compatibility notes<a class="headerlink" href="#backwards-compatibility-notes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">SSLIOStream.connect</span></code> and <a class="reference internal" href="index.html#tornado.iostream.IOStream.start_tls" title="tornado.iostream.IOStream.start_tls"><code class="xref py py-obj docutils literal"><span class="pre">IOStream.start_tls</span></code></a> now validate certificates
by default.</li>
<li>Certificate validation will now use the system CA root certificates instead
of <code class="docutils literal"><span class="pre">certifi</span></code> when possible (i.e. Python 2.7.9+ or 3.4+). This includes
<a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> and <code class="docutils literal"><span class="pre">simple_httpclient</span></code>, but not <code class="docutils literal"><span class="pre">curl_httpclient</span></code>.</li>
<li>The default SSL configuration has become stricter, using
<a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.create_default_context" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.create_default_context</span></code></a> where available on the client side.
(On the server side, applications are encouraged to migrate from the
<code class="docutils literal"><span class="pre">ssl_options</span></code> dict-based API to pass an <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.SSLContext</span></code></a> instead).</li>
<li>The deprecated classes in the <a class="reference internal" href="index.html#module-tornado.auth" title="tornado.auth"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth</span></code></a> module, <code class="docutils literal"><span class="pre">GoogleMixin</span></code>,
<code class="docutils literal"><span class="pre">FacebookMixin</span></code>, and <code class="docutils literal"><span class="pre">FriendFeedMixin</span></code> have been removed.</li>
</ul>
</div>
<div class="section" id="new-modules-tornado-locks-and-tornado-queues">
<h6>New modules: <a class="reference internal" href="index.html#module-tornado.locks" title="tornado.locks"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locks</span></code></a> and <a class="reference internal" href="index.html#module-tornado.queues" title="tornado.queues"><code class="xref py py-obj docutils literal"><span class="pre">tornado.queues</span></code></a><a class="headerlink" href="#new-modules-tornado-locks-and-tornado-queues" title="Permalink to this headline">¶</a></h6>
<p>These modules provide classes for coordinating coroutines, merged from
<a class="reference external" href="http://toro.readthedocs.org">Toro</a>.</p>
<p>To port your code from Toro&#8217;s queues to Tornado 4.2, import <a class="reference internal" href="index.html#tornado.queues.Queue" title="tornado.queues.Queue"><code class="xref py py-obj docutils literal"><span class="pre">Queue</span></code></a>,
<a class="reference internal" href="index.html#tornado.queues.PriorityQueue" title="tornado.queues.PriorityQueue"><code class="xref py py-obj docutils literal"><span class="pre">PriorityQueue</span></code></a>, or <a class="reference internal" href="index.html#tornado.queues.LifoQueue" title="tornado.queues.LifoQueue"><code class="xref py py-obj docutils literal"><span class="pre">LifoQueue</span></code></a> from <a class="reference internal" href="index.html#module-tornado.queues" title="tornado.queues"><code class="xref py py-obj docutils literal"><span class="pre">tornado.queues</span></code></a> instead of from
<code class="docutils literal"><span class="pre">toro</span></code>.</p>
<p>Use <a class="reference internal" href="index.html#tornado.queues.Queue" title="tornado.queues.Queue"><code class="xref py py-obj docutils literal"><span class="pre">Queue</span></code></a> instead of Toro&#8217;s <code class="docutils literal"><span class="pre">JoinableQueue</span></code>. In Tornado the methods
<a class="reference internal" href="index.html#tornado.queues.Queue.join" title="tornado.queues.Queue.join"><code class="xref py py-obj docutils literal"><span class="pre">join</span></code></a> and <a class="reference internal" href="index.html#tornado.queues.Queue.task_done" title="tornado.queues.Queue.task_done"><code class="xref py py-obj docutils literal"><span class="pre">task_done</span></code></a> are available on all queues, not on a
special <code class="docutils literal"><span class="pre">JoinableQueue</span></code>.</p>
<p>Tornado queues raise exceptions specific to Tornado instead of reusing
exceptions from the Python standard library.
Therefore instead of catching the standard <a class="reference external" href="https://docs.python.org/3.4/library/queue.html#queue.Empty" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">queue.Empty</span></code></a> exception from
<a class="reference internal" href="index.html#tornado.queues.Queue.get_nowait" title="tornado.queues.Queue.get_nowait"><code class="xref py py-obj docutils literal"><span class="pre">Queue.get_nowait</span></code></a>, catch the special <a class="reference internal" href="index.html#tornado.queues.QueueEmpty" title="tornado.queues.QueueEmpty"><code class="xref py py-obj docutils literal"><span class="pre">tornado.queues.QueueEmpty</span></code></a> exception,
and instead of catching the standard <a class="reference external" href="https://docs.python.org/3.4/library/queue.html#queue.Full" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">queue.Full</span></code></a> from <a class="reference internal" href="index.html#tornado.queues.Queue.get_nowait" title="tornado.queues.Queue.get_nowait"><code class="xref py py-obj docutils literal"><span class="pre">Queue.get_nowait</span></code></a>,
catch <a class="reference internal" href="index.html#tornado.queues.QueueFull" title="tornado.queues.QueueFull"><code class="xref py py-obj docutils literal"><span class="pre">tornado.queues.QueueFull</span></code></a>.</p>
<p>To port from Toro&#8217;s locks to Tornado 4.2, import <a class="reference internal" href="index.html#tornado.locks.Condition" title="tornado.locks.Condition"><code class="xref py py-obj docutils literal"><span class="pre">Condition</span></code></a>, <a class="reference internal" href="index.html#tornado.locks.Event" title="tornado.locks.Event"><code class="xref py py-obj docutils literal"><span class="pre">Event</span></code></a>,
<a class="reference internal" href="index.html#tornado.locks.Semaphore" title="tornado.locks.Semaphore"><code class="xref py py-obj docutils literal"><span class="pre">Semaphore</span></code></a>, <a class="reference internal" href="index.html#tornado.locks.BoundedSemaphore" title="tornado.locks.BoundedSemaphore"><code class="xref py py-obj docutils literal"><span class="pre">BoundedSemaphore</span></code></a>, or <a class="reference internal" href="index.html#tornado.locks.Lock" title="tornado.locks.Lock"><code class="xref py py-obj docutils literal"><span class="pre">Lock</span></code></a> from <a class="reference internal" href="index.html#module-tornado.locks" title="tornado.locks"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locks</span></code></a>
instead of from <code class="docutils literal"><span class="pre">toro</span></code>.</p>
<p>Toro&#8217;s <code class="docutils literal"><span class="pre">Semaphore.wait</span></code> allowed a coroutine to wait for the semaphore to
be unlocked <em>without</em> acquiring it. This encouraged unorthodox patterns; in
Tornado, just use <a class="reference internal" href="index.html#tornado.locks.Semaphore.acquire" title="tornado.locks.Semaphore.acquire"><code class="xref py py-obj docutils literal"><span class="pre">acquire</span></code></a>.</p>
<p>Toro&#8217;s <code class="docutils literal"><span class="pre">Event.wait</span></code> raised a <code class="docutils literal"><span class="pre">Timeout</span></code> exception after a timeout. In
Tornado, <a class="reference internal" href="index.html#tornado.locks.Event.wait" title="tornado.locks.Event.wait"><code class="xref py py-obj docutils literal"><span class="pre">Event.wait</span></code></a> raises <a class="reference internal" href="index.html#tornado.gen.TimeoutError" title="tornado.gen.TimeoutError"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.TimeoutError</span></code></a>.</p>
<p>Toro&#8217;s <code class="docutils literal"><span class="pre">Condition.wait</span></code> also raised <code class="docutils literal"><span class="pre">Timeout</span></code>, but in Tornado, the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>
returned by <a class="reference internal" href="index.html#tornado.locks.Condition.wait" title="tornado.locks.Condition.wait"><code class="xref py py-obj docutils literal"><span class="pre">Condition.wait</span></code></a> resolves to False after a timeout:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">await_notification</span><span class="p">():</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="k">yield</span> <span class="n">condition</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">1</span><span class="p">))):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;timed out&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;condition is true&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In lock and queue methods, wherever Toro accepted <code class="docutils literal"><span class="pre">deadline</span></code> as a keyword
argument, Tornado names the argument <code class="docutils literal"><span class="pre">timeout</span></code> instead.</p>
<p>Toro&#8217;s <code class="docutils literal"><span class="pre">AsyncResult</span></code> is not merged into Tornado, nor its exceptions
<code class="docutils literal"><span class="pre">NotReady</span></code> and <code class="docutils literal"><span class="pre">AlreadySet</span></code>. Use a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> instead. If you wrote code like
this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado</span> <span class="kn">import</span> <span class="n">gen</span>
<span class="kn">import</span> <span class="nn">toro</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">toro</span><span class="o">.</span><span class="n">AsyncResult</span><span class="p">()</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">setter</span><span class="p">():</span>
    <span class="n">result</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">getter</span><span class="p">():</span>
    <span class="n">value</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  <span class="c"># Prints &quot;1&quot;.</span>
</pre></div>
</div>
<p>Then the Tornado equivalent is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tornado</span> <span class="kn">import</span> <span class="n">gen</span>
<span class="kn">from</span> <span class="nn">tornado.concurrent</span> <span class="kn">import</span> <span class="n">Future</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">Future</span><span class="p">()</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">setter</span><span class="p">():</span>
    <span class="n">result</span><span class="o">.</span><span class="n">set_result</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="nd">@gen.coroutine</span>
<span class="k">def</span> <span class="nf">getter</span><span class="p">():</span>
    <span class="n">value</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">result</span>
    <span class="k">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>  <span class="c"># Prints &quot;1&quot;.</span>
</pre></div>
</div>
</div>
<div class="section" id="tornado-autoreload">
<h6><a class="reference internal" href="index.html#module-tornado.autoreload" title="tornado.autoreload"><code class="xref py py-obj docutils literal"><span class="pre">tornado.autoreload</span></code></a><a class="headerlink" href="#tornado-autoreload" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Improved compatibility with Windows.</li>
<li>Fixed a bug in Python 3 if a module was imported during a reload check.</li>
</ul>
</div>
<div class="section" id="tornado-concurrent">
<h6><a class="reference internal" href="index.html#module-tornado.concurrent" title="tornado.concurrent"><code class="xref py py-obj docutils literal"><span class="pre">tornado.concurrent</span></code></a><a class="headerlink" href="#tornado-concurrent" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.concurrent.run_on_executor" title="tornado.concurrent.run_on_executor"><code class="xref py py-obj docutils literal"><span class="pre">run_on_executor</span></code></a> now accepts arguments to control which attributes
it uses to find the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> and executor.</li>
</ul>
</div>
<div class="section" id="tornado-curl-httpclient">
<h6><a class="reference internal" href="index.html#module-tornado.curl_httpclient" title="tornado.curl_httpclient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.curl_httpclient</span></code></a><a class="headerlink" href="#tornado-curl-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Fixed a bug that would cause the client to stop processing requests
if an exception occurred in certain places while there is a queue.</li>
</ul>
</div>
<div class="section" id="tornado-escape">
<h6><a class="reference internal" href="index.html#module-tornado.escape" title="tornado.escape"><code class="xref py py-obj docutils literal"><span class="pre">tornado.escape</span></code></a><a class="headerlink" href="#tornado-escape" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.escape.xhtml_escape" title="tornado.escape.xhtml_escape"><code class="xref py py-obj docutils literal"><span class="pre">xhtml_escape</span></code></a> now supports numeric character references in hex
format (<code class="docutils literal"><span class="pre">&amp;#x20;</span></code>)</li>
</ul>
</div>
<div class="section" id="tornado-gen">
<h6><a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a><a class="headerlink" href="#tornado-gen" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.gen.WaitIterator" title="tornado.gen.WaitIterator"><code class="xref py py-obj docutils literal"><span class="pre">WaitIterator</span></code></a> no longer uses weak references, which fixes several
garbage-collection-related bugs.</li>
<li><code class="docutils literal"><span class="pre">tornado.gen.Multi</span></code> and <a class="reference internal" href="index.html#tornado.gen.multi_future" title="tornado.gen.multi_future"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.multi_future</span></code></a> (which are used when
yielding a list or dict in a coroutine) now log any exceptions after the
first if more than one <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> fails (previously they would be logged
when the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> was garbage-collected, but this is more reliable).
Both have a new keyword argument <code class="docutils literal"><span class="pre">quiet_exceptions</span></code> to suppress
logging of certain exception types; to use this argument you must
call <code class="docutils literal"><span class="pre">Multi</span></code> or <code class="docutils literal"><span class="pre">multi_future</span></code> directly instead of simply yielding
a list.</li>
<li><a class="reference internal" href="index.html#tornado.gen.multi_future" title="tornado.gen.multi_future"><code class="xref py py-obj docutils literal"><span class="pre">multi_future</span></code></a> now works when given multiple copies of the same <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.</li>
<li>On Python 3, catching an exception in a coroutine no longer leads to
leaks via <code class="docutils literal"><span class="pre">Exception.__context__</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-httpclient">
<h6><a class="reference internal" href="index.html#module-tornado.httpclient" title="tornado.httpclient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient</span></code></a><a class="headerlink" href="#tornado-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The <code class="docutils literal"><span class="pre">raise_error</span></code> argument now works correctly with the synchronous
<a class="reference internal" href="index.html#tornado.httpclient.HTTPClient" title="tornado.httpclient.HTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">HTTPClient</span></code></a>.</li>
<li>The synchronous <a class="reference internal" href="index.html#tornado.httpclient.HTTPClient" title="tornado.httpclient.HTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">HTTPClient</span></code></a> no longer interferes with <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.current" title="tornado.ioloop.IOLoop.current"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.current()</span></code></a>.</li>
</ul>
</div>
<div class="section" id="tornado-httpserver">
<h6><a class="reference internal" href="index.html#module-tornado.httpserver" title="tornado.httpserver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpserver</span></code></a><a class="headerlink" href="#tornado-httpserver" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> is now a subclass of <a class="reference internal" href="index.html#tornado.util.Configurable" title="tornado.util.Configurable"><code class="xref py py-obj docutils literal"><span class="pre">tornado.util.Configurable</span></code></a>.</li>
</ul>
</div>
<div class="section" id="tornado-httputil">
<h6><a class="reference internal" href="index.html#module-tornado.httputil" title="tornado.httputil"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httputil</span></code></a><a class="headerlink" href="#tornado-httputil" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httputil.HTTPHeaders" title="tornado.httputil.HTTPHeaders"><code class="xref py py-obj docutils literal"><span class="pre">HTTPHeaders</span></code></a> can now be copied with <a class="reference external" href="https://docs.python.org/3.4/library/copy.html#copy.copy" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">copy.copy</span></code></a> and <a class="reference external" href="https://docs.python.org/3.4/library/copy.html#copy.deepcopy" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">copy.deepcopy</span></code></a>.</li>
</ul>
</div>
<div class="section" id="tornado-ioloop">
<h6><a class="reference internal" href="index.html#module-tornado.ioloop" title="tornado.ioloop"><code class="xref py py-obj docutils literal"><span class="pre">tornado.ioloop</span></code></a><a class="headerlink" href="#tornado-ioloop" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> constructor now has a <code class="docutils literal"><span class="pre">make_current</span></code> keyword argument
to control whether the new <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> becomes <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.current" title="tornado.ioloop.IOLoop.current"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.current()</span></code></a>.</li>
<li>Third-party implementations of <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> should accept <code class="docutils literal"><span class="pre">**kwargs</span></code>
in their <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.initialize" title="tornado.ioloop.IOLoop.initialize"><code class="xref py py-obj docutils literal"><span class="pre">initialize</span></code></a> methods and pass them to the superclass
implementation.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.PeriodicCallback" title="tornado.ioloop.PeriodicCallback"><code class="xref py py-obj docutils literal"><span class="pre">PeriodicCallback</span></code></a> is now more efficient when the clock jumps forward
by a large amount.</li>
</ul>
</div>
<div class="section" id="tornado-iostream">
<h6><a class="reference internal" href="index.html#module-tornado.iostream" title="tornado.iostream"><code class="xref py py-obj docutils literal"><span class="pre">tornado.iostream</span></code></a><a class="headerlink" href="#tornado-iostream" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">SSLIOStream.connect</span></code> and <a class="reference internal" href="index.html#tornado.iostream.IOStream.start_tls" title="tornado.iostream.IOStream.start_tls"><code class="xref py py-obj docutils literal"><span class="pre">IOStream.start_tls</span></code></a> now validate certificates
by default.</li>
<li>New method <a class="reference internal" href="index.html#tornado.iostream.SSLIOStream.wait_for_handshake" title="tornado.iostream.SSLIOStream.wait_for_handshake"><code class="xref py py-obj docutils literal"><span class="pre">SSLIOStream.wait_for_handshake</span></code></a> allows server-side applications
to wait for the handshake to complete in order to verify client certificates
or use NPN/ALPN.</li>
<li>The <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> returned by <code class="docutils literal"><span class="pre">SSLIOStream.connect</span></code> now resolves after the
handshake is complete instead of as soon as the TCP connection is
established.</li>
<li>Reduced logging of SSL errors.</li>
<li><a class="reference internal" href="index.html#tornado.iostream.BaseIOStream.read_until_close" title="tornado.iostream.BaseIOStream.read_until_close"><code class="xref py py-obj docutils literal"><span class="pre">BaseIOStream.read_until_close</span></code></a> now works correctly when a
<code class="docutils literal"><span class="pre">streaming_callback</span></code> is given but <code class="docutils literal"><span class="pre">callback</span></code> is None (i.e. when
it returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>)</li>
</ul>
</div>
<div class="section" id="tornado-locale">
<h6><a class="reference internal" href="index.html#module-tornado.locale" title="tornado.locale"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locale</span></code></a><a class="headerlink" href="#tornado-locale" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>New method <a class="reference internal" href="index.html#tornado.locale.GettextLocale.pgettext" title="tornado.locale.GettextLocale.pgettext"><code class="xref py py-obj docutils literal"><span class="pre">GettextLocale.pgettext</span></code></a> allows additional context to be
supplied for gettext translations.</li>
</ul>
</div>
<div class="section" id="tornado-log">
<h6><a class="reference internal" href="index.html#module-tornado.log" title="tornado.log"><code class="xref py py-obj docutils literal"><span class="pre">tornado.log</span></code></a><a class="headerlink" href="#tornado-log" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.log.define_logging_options" title="tornado.log.define_logging_options"><code class="xref py py-obj docutils literal"><span class="pre">define_logging_options</span></code></a> now works correctly when given a non-default
<code class="docutils literal"><span class="pre">options</span></code> object.</li>
</ul>
</div>
<div class="section" id="tornado-process">
<h6><a class="reference internal" href="index.html#module-tornado.process" title="tornado.process"><code class="xref py py-obj docutils literal"><span class="pre">tornado.process</span></code></a><a class="headerlink" href="#tornado-process" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>New method <a class="reference internal" href="index.html#tornado.process.Subprocess.wait_for_exit" title="tornado.process.Subprocess.wait_for_exit"><code class="xref py py-obj docutils literal"><span class="pre">Subprocess.wait_for_exit</span></code></a> is a coroutine-friendly
version of <a class="reference internal" href="index.html#tornado.process.Subprocess.set_exit_callback" title="tornado.process.Subprocess.set_exit_callback"><code class="xref py py-obj docutils literal"><span class="pre">Subprocess.set_exit_callback</span></code></a>.</li>
</ul>
</div>
<div class="section" id="tornado-simple-httpclient">
<h6><a class="reference internal" href="index.html#module-tornado.simple_httpclient" title="tornado.simple_httpclient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.simple_httpclient</span></code></a><a class="headerlink" href="#tornado-simple-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Improved performance on Python 3 by reusing a single <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.SSLContext</span></code></a>.</li>
<li>New constructor argument <code class="docutils literal"><span class="pre">max_body_size</span></code> controls the maximum response
size the client is willing to accept. It may be bigger than
<code class="docutils literal"><span class="pre">max_buffer_size</span></code> if <code class="docutils literal"><span class="pre">streaming_callback</span></code> is used.</li>
</ul>
</div>
<div class="section" id="tornado-tcpserver">
<h6><a class="reference internal" href="index.html#module-tornado.tcpserver" title="tornado.tcpserver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.tcpserver</span></code></a><a class="headerlink" href="#tornado-tcpserver" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.tcpserver.TCPServer.handle_stream" title="tornado.tcpserver.TCPServer.handle_stream"><code class="xref py py-obj docutils literal"><span class="pre">TCPServer.handle_stream</span></code></a> may be a coroutine (so that any exceptions
it raises will be logged).</li>
</ul>
</div>
<div class="section" id="tornado-util">
<h6><a class="reference internal" href="index.html#module-tornado.util" title="tornado.util"><code class="xref py py-obj docutils literal"><span class="pre">tornado.util</span></code></a><a class="headerlink" href="#tornado-util" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.util.import_object" title="tornado.util.import_object"><code class="xref py py-obj docutils literal"><span class="pre">import_object</span></code></a> now supports unicode strings on Python 2.</li>
<li><a class="reference internal" href="index.html#tornado.util.Configurable.initialize" title="tornado.util.Configurable.initialize"><code class="xref py py-obj docutils literal"><span class="pre">Configurable.initialize</span></code></a> now supports positional arguments.</li>
</ul>
</div>
<div class="section" id="tornado-web">
<h6><a class="reference internal" href="index.html#module-tornado.web" title="tornado.web"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web</span></code></a><a class="headerlink" href="#tornado-web" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Key versioning support for cookie signing. <code class="docutils literal"><span class="pre">cookie_secret</span></code> application
setting can now contain a dict of valid keys with version as key. The
current signing key then must be specified via <code class="docutils literal"><span class="pre">key_version</span></code> setting.</li>
<li>Parsing of the <code class="docutils literal"><span class="pre">If-None-Match</span></code> header now follows the RFC and supports
weak validators.</li>
<li>Passing <code class="docutils literal"><span class="pre">secure=False</span></code> or <code class="docutils literal"><span class="pre">httponly=False</span></code> to
<a class="reference internal" href="index.html#tornado.web.RequestHandler.set_cookie" title="tornado.web.RequestHandler.set_cookie"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.set_cookie</span></code></a> now works as expected (previously only the
presence of the argument was considered and its value was ignored).</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.get_arguments" title="tornado.web.RequestHandler.get_arguments"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_arguments</span></code></a> now requires that its <code class="docutils literal"><span class="pre">strip</span></code> argument
be of type bool. This helps prevent errors caused by the slightly dissimilar
interfaces between the singular and plural methods.</li>
<li>Errors raised in <code class="docutils literal"><span class="pre">_handle_request_exception</span></code> are now logged more reliably.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.redirect" title="tornado.web.RequestHandler.redirect"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.redirect</span></code></a> now works correctly when called from a handler
whose path begins with two slashes.</li>
<li>Passing messages containing <code class="docutils literal"><span class="pre">%</span></code> characters to <a class="reference internal" href="index.html#tornado.web.HTTPError" title="tornado.web.HTTPError"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.HTTPError</span></code></a>
no longer causes broken error messages.</li>
</ul>
</div>
<div class="section" id="tornado-websocket">
<h6><a class="reference internal" href="index.html#module-tornado.websocket" title="tornado.websocket"><code class="xref py py-obj docutils literal"><span class="pre">tornado.websocket</span></code></a><a class="headerlink" href="#tornado-websocket" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The <code class="docutils literal"><span class="pre">on_close</span></code> method will no longer be called more than once.</li>
<li>When the other side closes a connection, we now echo the received close
code back instead of sending an empty close frame.</li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v4.1.0"></span><div class="section" id="what-s-new-in-tornado-4-1">
<h4>What&#8217;s new in Tornado 4.1<a class="headerlink" href="#what-s-new-in-tornado-4-1" title="Permalink to this headline">¶</a></h4>
<div class="section" id="feb-7-2015">
<h5>Feb 7, 2015<a class="headerlink" href="#feb-7-2015" title="Permalink to this headline">¶</a></h5>
<div class="section" id="highlights">
<h6>Highlights<a class="headerlink" href="#highlights" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>If a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> contains an exception but that exception is never
examined or re-raised (e.g. by yielding the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>), a stack
trace will be logged when the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> is garbage-collected.</li>
<li>New class <a class="reference internal" href="index.html#tornado.gen.WaitIterator" title="tornado.gen.WaitIterator"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.WaitIterator</span></code></a> provides a way to iterate
over <code class="docutils literal"><span class="pre">Futures</span></code> in the order they resolve.</li>
<li>The <a class="reference internal" href="index.html#module-tornado.websocket" title="tornado.websocket"><code class="xref py py-obj docutils literal"><span class="pre">tornado.websocket</span></code></a> module now supports compression via the
&#8220;permessage-deflate&#8221; extension.  Override
<a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler.get_compression_options" title="tornado.websocket.WebSocketHandler.get_compression_options"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler.get_compression_options</span></code></a> to enable on the server
side, and use the <code class="docutils literal"><span class="pre">compression_options</span></code> keyword argument to
<a class="reference internal" href="index.html#tornado.websocket.websocket_connect" title="tornado.websocket.websocket_connect"><code class="xref py py-obj docutils literal"><span class="pre">websocket_connect</span></code></a> on the client side.</li>
<li>When the appropriate packages are installed, it is possible to yield
<a class="reference external" href="https://docs.python.org/3.4/library/asyncio-task.html#asyncio.Future" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">asyncio.Future</span></code></a> or Twisted <code class="docutils literal"><span class="pre">Defered</span></code> objects in Tornado coroutines.</li>
</ul>
</div>
<div class="section" id="backwards-compatibility-notes">
<h6>Backwards-compatibility notes<a class="headerlink" href="#backwards-compatibility-notes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> now calls <code class="docutils literal"><span class="pre">start_request</span></code> with the correct
arguments.  This change is backwards-incompatible, afffecting any
application which implemented <a class="reference internal" href="index.html#tornado.httputil.HTTPServerConnectionDelegate" title="tornado.httputil.HTTPServerConnectionDelegate"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerConnectionDelegate</span></code></a> by
following the example of <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> instead of the documented
method signatures.</li>
</ul>
</div>
<div class="section" id="tornado-concurrent">
<h6><a class="reference internal" href="index.html#module-tornado.concurrent" title="tornado.concurrent"><code class="xref py py-obj docutils literal"><span class="pre">tornado.concurrent</span></code></a><a class="headerlink" href="#tornado-concurrent" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>If a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> contains an exception but that exception is never
examined or re-raised (e.g. by yielding the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>), a stack
trace will be logged when the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> is garbage-collected.</li>
<li><a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> now catches and logs exceptions in its callbacks.</li>
</ul>
</div>
<div class="section" id="tornado-curl-httpclient">
<h6><code class="docutils literal"><span class="pre">tornado.curl_httpclient</span></code><a class="headerlink" href="#tornado-curl-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">tornado.curl_httpclient</span></code> now supports request bodies for <code class="docutils literal"><span class="pre">PATCH</span></code>
and custom methods.</li>
<li><code class="docutils literal"><span class="pre">tornado.curl_httpclient</span></code> now supports resubmitting bodies after
following redirects for methods other than <code class="docutils literal"><span class="pre">POST</span></code>.</li>
<li><code class="docutils literal"><span class="pre">curl_httpclient</span></code> now runs the streaming and header callbacks on
the IOLoop.</li>
<li><code class="docutils literal"><span class="pre">tornado.curl_httpclient</span></code> now uses its own logger for debug output
so it can be filtered more easily.</li>
</ul>
</div>
<div class="section" id="tornado-gen">
<h6><a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a><a class="headerlink" href="#tornado-gen" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>New class <a class="reference internal" href="index.html#tornado.gen.WaitIterator" title="tornado.gen.WaitIterator"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.WaitIterator</span></code></a> provides a way to iterate
over <code class="docutils literal"><span class="pre">Futures</span></code> in the order they resolve.</li>
<li>When the <a class="reference external" href="https://docs.python.org/3.4/library/functools.html#functools.singledispatch" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">singledispatch</span></code></a> library is available (standard on
Python 3.4, available via <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">singledispatch</span></code> on older versions),
the <a class="reference internal" href="index.html#tornado.gen.convert_yielded" title="tornado.gen.convert_yielded"><code class="xref py py-obj docutils literal"><span class="pre">convert_yielded</span></code></a> function can be used to make other kinds of objects
yieldable in coroutines.</li>
<li>New function <a class="reference internal" href="index.html#tornado.gen.sleep" title="tornado.gen.sleep"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen.sleep</span></code></a> is a coroutine-friendly
analogue to <a class="reference external" href="https://docs.python.org/3.4/library/time.html#time.sleep" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">time.sleep</span></code></a>.</li>
<li><a class="reference internal" href="index.html#tornado.gen.engine" title="tornado.gen.engine"><code class="xref py py-obj docutils literal"><span class="pre">gen.engine</span></code></a> now correctly captures the stack context for its callbacks.</li>
</ul>
</div>
<div class="section" id="tornado-httpclient">
<h6><a class="reference internal" href="index.html#module-tornado.httpclient" title="tornado.httpclient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient</span></code></a><a class="headerlink" href="#tornado-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httpclient.HTTPRequest" title="tornado.httpclient.HTTPRequest"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient.HTTPRequest</span></code></a> accepts a new argument
<code class="docutils literal"><span class="pre">raise_error=False</span></code> to suppress the default behavior of raising an
error for non-200 response codes.</li>
</ul>
</div>
<div class="section" id="tornado-httpserver">
<h6><a class="reference internal" href="index.html#module-tornado.httpserver" title="tornado.httpserver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpserver</span></code></a><a class="headerlink" href="#tornado-httpserver" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> now calls <code class="docutils literal"><span class="pre">start_request</span></code> with the correct
arguments.  This change is backwards-incompatible, afffecting any
application which implemented <a class="reference internal" href="index.html#tornado.httputil.HTTPServerConnectionDelegate" title="tornado.httputil.HTTPServerConnectionDelegate"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerConnectionDelegate</span></code></a> by
following the example of <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> instead of the documented
method signatures.</li>
<li><a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> now tolerates extra newlines which are sometimes inserted
between requests on keep-alive connections.</li>
<li><a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> can now use keep-alive connections after a request
with a chunked body.</li>
<li><a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> now always reports <code class="docutils literal"><span class="pre">HTTP/1.1</span></code> instead of echoing
the request version.</li>
</ul>
</div>
<div class="section" id="tornado-httputil">
<h6><a class="reference internal" href="index.html#module-tornado.httputil" title="tornado.httputil"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httputil</span></code></a><a class="headerlink" href="#tornado-httputil" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>New function <a class="reference internal" href="index.html#tornado.httputil.split_host_and_port" title="tornado.httputil.split_host_and_port"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httputil.split_host_and_port</span></code></a> for parsing
the <code class="docutils literal"><span class="pre">netloc</span></code> portion of URLs.</li>
<li>The <code class="docutils literal"><span class="pre">context</span></code> argument to <a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest" title="tornado.httputil.HTTPServerRequest"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerRequest</span></code></a> is now optional,
and if a context is supplied the <code class="docutils literal"><span class="pre">remote_ip</span></code> attribute is also optional.</li>
<li><a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest.body" title="tornado.httputil.HTTPServerRequest.body"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerRequest.body</span></code></a> is now always a byte string (previously the default
empty body would be a unicode string on python 3).</li>
<li>Header parsing now works correctly when newline-like unicode characters
are present.</li>
<li>Header parsing again supports both CRLF and bare LF line separators.</li>
<li>Malformed <code class="docutils literal"><span class="pre">multipart/form-data</span></code> bodies will always be logged
quietly instead of raising an unhandled exception; previously
the behavior was inconsistent depending on the exact error.</li>
</ul>
</div>
<div class="section" id="tornado-ioloop">
<h6><a class="reference internal" href="index.html#module-tornado.ioloop" title="tornado.ioloop"><code class="xref py py-obj docutils literal"><span class="pre">tornado.ioloop</span></code></a><a class="headerlink" href="#tornado-ioloop" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The <code class="docutils literal"><span class="pre">kqueue</span></code> and <code class="docutils literal"><span class="pre">select</span></code> IOLoop implementations now report
writeability correctly, fixing flow control in IOStream.</li>
<li>When a new <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> is created, it automatically becomes &#8220;current&#8221;
for the thread if there is not already a current instance.</li>
<li>New method <a class="reference internal" href="index.html#tornado.ioloop.PeriodicCallback.is_running" title="tornado.ioloop.PeriodicCallback.is_running"><code class="xref py py-obj docutils literal"><span class="pre">PeriodicCallback.is_running</span></code></a> can be used to see
whether the <a class="reference internal" href="index.html#tornado.ioloop.PeriodicCallback" title="tornado.ioloop.PeriodicCallback"><code class="xref py py-obj docutils literal"><span class="pre">PeriodicCallback</span></code></a> has been started.</li>
</ul>
</div>
<div class="section" id="tornado-iostream">
<h6><a class="reference internal" href="index.html#module-tornado.iostream" title="tornado.iostream"><code class="xref py py-obj docutils literal"><span class="pre">tornado.iostream</span></code></a><a class="headerlink" href="#tornado-iostream" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.iostream.IOStream.start_tls" title="tornado.iostream.IOStream.start_tls"><code class="xref py py-obj docutils literal"><span class="pre">IOStream.start_tls</span></code></a> now uses the <code class="docutils literal"><span class="pre">server_hostname</span></code> parameter
for certificate validation.</li>
<li><a class="reference internal" href="index.html#tornado.iostream.SSLIOStream" title="tornado.iostream.SSLIOStream"><code class="xref py py-obj docutils literal"><span class="pre">SSLIOStream</span></code></a> will no longer consume 100% CPU after certain error conditions.</li>
<li><a class="reference internal" href="index.html#tornado.iostream.SSLIOStream" title="tornado.iostream.SSLIOStream"><code class="xref py py-obj docutils literal"><span class="pre">SSLIOStream</span></code></a> no longer logs <code class="docutils literal"><span class="pre">EBADF</span></code> errors during the handshake as they
can result from nmap scans in certain modes.</li>
</ul>
</div>
<div class="section" id="tornado-options">
<h6><a class="reference internal" href="index.html#module-tornado.options" title="tornado.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options</span></code></a><a class="headerlink" href="#tornado-options" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.options.parse_config_file" title="tornado.options.parse_config_file"><code class="xref py py-obj docutils literal"><span class="pre">parse_config_file</span></code></a> now always decodes the config
file as utf8 on Python 3.</li>
<li><a class="reference internal" href="index.html#tornado.options.define" title="tornado.options.define"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.define</span></code></a> more accurately finds the module defining the
option.</li>
</ul>
</div>
<div class="section" id="tornado-platform-asyncio">
<h6><code class="docutils literal"><span class="pre">tornado.platform.asyncio</span></code><a class="headerlink" href="#tornado-platform-asyncio" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>It is now possible to yield <code class="docutils literal"><span class="pre">asyncio.Future</span></code> objects in coroutines
when the <a class="reference external" href="https://docs.python.org/3.4/library/functools.html#functools.singledispatch" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">singledispatch</span></code></a> library is available and
<code class="docutils literal"><span class="pre">tornado.platform.asyncio</span></code> has been imported.</li>
<li>New methods <a class="reference internal" href="index.html#tornado.platform.asyncio.to_tornado_future" title="tornado.platform.asyncio.to_tornado_future"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.asyncio.to_tornado_future</span></code></a> and
<a class="reference internal" href="index.html#tornado.platform.asyncio.to_asyncio_future" title="tornado.platform.asyncio.to_asyncio_future"><code class="xref py py-obj docutils literal"><span class="pre">to_asyncio_future</span></code></a> convert between
the two libraries&#8217; <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> classes.</li>
</ul>
</div>
<div class="section" id="tornado-platform-twisted">
<h6><code class="docutils literal"><span class="pre">tornado.platform.twisted</span></code><a class="headerlink" href="#tornado-platform-twisted" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>It is now possible to yield <code class="docutils literal"><span class="pre">Deferred</span></code> objects in coroutines
when the <a class="reference external" href="https://docs.python.org/3.4/library/functools.html#functools.singledispatch" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">singledispatch</span></code></a> library is available and
<code class="docutils literal"><span class="pre">tornado.platform.twisted</span></code> has been imported.</li>
</ul>
</div>
<div class="section" id="tornado-tcpclient">
<h6><a class="reference internal" href="index.html#module-tornado.tcpclient" title="tornado.tcpclient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.tcpclient</span></code></a><a class="headerlink" href="#tornado-tcpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.tcpclient.TCPClient" title="tornado.tcpclient.TCPClient"><code class="xref py py-obj docutils literal"><span class="pre">TCPClient</span></code></a> will no longer raise an exception due to an ill-timed
timeout.</li>
</ul>
</div>
<div class="section" id="tornado-tcpserver">
<h6><a class="reference internal" href="index.html#module-tornado.tcpserver" title="tornado.tcpserver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.tcpserver</span></code></a><a class="headerlink" href="#tornado-tcpserver" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.tcpserver.TCPServer" title="tornado.tcpserver.TCPServer"><code class="xref py py-obj docutils literal"><span class="pre">TCPServer</span></code></a> no longer ignores its <code class="docutils literal"><span class="pre">read_chunk_size</span></code> argument.</li>
</ul>
</div>
<div class="section" id="tornado-testing">
<h6><a class="reference internal" href="index.html#module-tornado.testing" title="tornado.testing"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing</span></code></a><a class="headerlink" href="#tornado-testing" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.testing.AsyncTestCase" title="tornado.testing.AsyncTestCase"><code class="xref py py-obj docutils literal"><span class="pre">AsyncTestCase</span></code></a> has better support for multiple exceptions. Previously
it would silently swallow all but the last; now it raises the first
and logs all the rest.</li>
<li><a class="reference internal" href="index.html#tornado.testing.AsyncTestCase" title="tornado.testing.AsyncTestCase"><code class="xref py py-obj docutils literal"><span class="pre">AsyncTestCase</span></code></a> now cleans up <a class="reference internal" href="index.html#tornado.process.Subprocess" title="tornado.process.Subprocess"><code class="xref py py-obj docutils literal"><span class="pre">Subprocess</span></code></a> state on <code class="docutils literal"><span class="pre">tearDown</span></code> when
necessary.</li>
</ul>
</div>
<div class="section" id="tornado-web">
<h6><a class="reference internal" href="index.html#module-tornado.web" title="tornado.web"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web</span></code></a><a class="headerlink" href="#tornado-web" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The <a class="reference internal" href="index.html#tornado.web.asynchronous" title="tornado.web.asynchronous"><code class="xref py py-obj docutils literal"><span class="pre">asynchronous</span></code></a> decorator now understands <a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#concurrent.futures.Future" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures.Future</span></code></a>
in addition to <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">tornado.concurrent.Future</span></code></a>.</li>
<li><a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> no longer logs a stack trace if the connection is
closed while sending the file.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.send_error" title="tornado.web.RequestHandler.send_error"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.send_error</span></code></a> now supports a <code class="docutils literal"><span class="pre">reason</span></code> keyword
argument, similar to <a class="reference internal" href="index.html#tornado.web.HTTPError" title="tornado.web.HTTPError"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.HTTPError</span></code></a>.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.locale" title="tornado.web.RequestHandler.locale"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.locale</span></code></a> now has a property setter.</li>
<li><a class="reference internal" href="index.html#tornado.web.Application.add_handlers" title="tornado.web.Application.add_handlers"><code class="xref py py-obj docutils literal"><span class="pre">Application.add_handlers</span></code></a> hostname matching now works correctly with
IPv6 literals.</li>
<li>Redirects for the <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> <code class="docutils literal"><span class="pre">default_host</span></code> setting now match
the request protocol instead of redirecting HTTPS to HTTP.</li>
<li>Malformed <code class="docutils literal"><span class="pre">_xsrf</span></code> cookies are now ignored instead of causing
uncaught exceptions.</li>
<li><code class="docutils literal"><span class="pre">Application.start_request</span></code> now has the same signature as
<a class="reference internal" href="index.html#tornado.httputil.HTTPServerConnectionDelegate.start_request" title="tornado.httputil.HTTPServerConnectionDelegate.start_request"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerConnectionDelegate.start_request</span></code></a>.</li>
</ul>
</div>
<div class="section" id="tornado-websocket">
<h6><a class="reference internal" href="index.html#module-tornado.websocket" title="tornado.websocket"><code class="xref py py-obj docutils literal"><span class="pre">tornado.websocket</span></code></a><a class="headerlink" href="#tornado-websocket" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The <a class="reference internal" href="index.html#module-tornado.websocket" title="tornado.websocket"><code class="xref py py-obj docutils literal"><span class="pre">tornado.websocket</span></code></a> module now supports compression via the
&#8220;permessage-deflate&#8221; extension.  Override
<a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler.get_compression_options" title="tornado.websocket.WebSocketHandler.get_compression_options"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler.get_compression_options</span></code></a> to enable on the server
side, and use the <code class="docutils literal"><span class="pre">compression_options</span></code> keyword argument to
<a class="reference internal" href="index.html#tornado.websocket.websocket_connect" title="tornado.websocket.websocket_connect"><code class="xref py py-obj docutils literal"><span class="pre">websocket_connect</span></code></a> on the client side.</li>
<li><a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler" title="tornado.websocket.WebSocketHandler"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler</span></code></a> no longer logs stack traces when the connection
is closed.</li>
<li><a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler.open" title="tornado.websocket.WebSocketHandler.open"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler.open</span></code></a> now accepts <code class="docutils literal"><span class="pre">*args,</span> <span class="pre">**kw</span></code> for consistency
with <code class="docutils literal"><span class="pre">RequestHandler.get</span></code> and related methods.</li>
<li>The <code class="docutils literal"><span class="pre">Sec-WebSocket-Version</span></code> header now includes all supported versions.</li>
<li><a class="reference internal" href="index.html#tornado.websocket.websocket_connect" title="tornado.websocket.websocket_connect"><code class="xref py py-obj docutils literal"><span class="pre">websocket_connect</span></code></a> now has a <code class="docutils literal"><span class="pre">on_message_callback</span></code> keyword argument
for callback-style use without <code class="docutils literal"><span class="pre">read_message()</span></code>.</li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v4.0.2"></span><div class="section" id="what-s-new-in-tornado-4-0-2">
<h4>What&#8217;s new in Tornado 4.0.2<a class="headerlink" href="#what-s-new-in-tornado-4-0-2" title="Permalink to this headline">¶</a></h4>
<div class="section" id="sept-10-2014">
<h5>Sept 10, 2014<a class="headerlink" href="#sept-10-2014" title="Permalink to this headline">¶</a></h5>
<div class="section" id="bug-fixes">
<h6>Bug fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Fixed a bug that could sometimes cause a timeout to fire after being
cancelled.</li>
<li><a class="reference internal" href="index.html#tornado.testing.AsyncTestCase" title="tornado.testing.AsyncTestCase"><code class="xref py py-obj docutils literal"><span class="pre">AsyncTestCase</span></code></a> once again passes along arguments to test methods,
making it compatible with extensions such as Nose&#8217;s test generators.</li>
<li><a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> can again compress its responses when gzip is enabled.</li>
<li><code class="docutils literal"><span class="pre">simple_httpclient</span></code> passes its <code class="docutils literal"><span class="pre">max_buffer_size</span></code> argument to the
underlying stream.</li>
<li>Fixed a reference cycle that can lead to increased memory consumption.</li>
<li><a class="reference internal" href="index.html#tornado.netutil.add_accept_handler" title="tornado.netutil.add_accept_handler"><code class="xref py py-obj docutils literal"><span class="pre">add_accept_handler</span></code></a> will now limit the number of times it will call
<a class="reference external" href="https://docs.python.org/3.4/library/socket.html#socket.socket.accept" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">accept</span></code></a> per <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> iteration, addressing a potential
starvation issue.</li>
<li>Improved error handling in <a class="reference internal" href="index.html#tornado.iostream.IOStream.connect" title="tornado.iostream.IOStream.connect"><code class="xref py py-obj docutils literal"><span class="pre">IOStream.connect</span></code></a> (primarily for FreeBSD
systems)</li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v4.0.1"></span><div class="section" id="what-s-new-in-tornado-4-0-1">
<h4>What&#8217;s new in Tornado 4.0.1<a class="headerlink" href="#what-s-new-in-tornado-4-0-1" title="Permalink to this headline">¶</a></h4>
<div class="section" id="aug-12-2014">
<h5>Aug 12, 2014<a class="headerlink" href="#aug-12-2014" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>The build will now fall back to pure-python mode if the C extension
fails to build for any reason (previously it would fall back for some
errors but not others).</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop.call_at" title="tornado.ioloop.IOLoop.call_at"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.call_at</span></code></a> and <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.call_later" title="tornado.ioloop.IOLoop.call_later"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.call_later</span></code></a> now always return
a timeout handle for use with <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.remove_timeout" title="tornado.ioloop.IOLoop.remove_timeout"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.remove_timeout</span></code></a>.</li>
<li>If any callback of a <a class="reference internal" href="index.html#tornado.ioloop.PeriodicCallback" title="tornado.ioloop.PeriodicCallback"><code class="xref py py-obj docutils literal"><span class="pre">PeriodicCallback</span></code></a> or <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> returns a
<a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>, any error raised in that future will now be logged
(similar to the behavior of <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_callback" title="tornado.ioloop.IOLoop.add_callback"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_callback</span></code></a>).</li>
<li>Fixed an exception in client-side websocket connections when the
connection is closed.</li>
<li><code class="docutils literal"><span class="pre">simple_httpclient</span></code> once again correctly handles 204 status
codes with no content-length header.</li>
<li>Fixed a regression in <code class="docutils literal"><span class="pre">simple_httpclient</span></code> that would result in
timeouts for certain kinds of errors.</li>
</ul>
</div>
</div>
<span id="document-releases/v4.0.0"></span><div class="section" id="what-s-new-in-tornado-4-0">
<h4>What&#8217;s new in Tornado 4.0<a class="headerlink" href="#what-s-new-in-tornado-4-0" title="Permalink to this headline">¶</a></h4>
<div class="section" id="july-15-2014">
<h5>July 15, 2014<a class="headerlink" href="#july-15-2014" title="Permalink to this headline">¶</a></h5>
<div class="section" id="highlights">
<h6>Highlights<a class="headerlink" href="#highlights" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The <a class="reference internal" href="index.html#tornado.web.stream_request_body" title="tornado.web.stream_request_body"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.stream_request_body</span></code></a> decorator allows large files to be
uploaded with limited memory usage.</li>
<li>Coroutines are now faster and are used extensively throughout Tornado itself.
More methods now return <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Futures</span></code></a>, including most <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a>
methods and <a class="reference internal" href="index.html#tornado.web.RequestHandler.flush" title="tornado.web.RequestHandler.flush"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.flush</span></code></a>.</li>
<li>Many user-overridden methods are now allowed to return a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>
for flow control.</li>
<li>HTTP-related code is now shared between the <a class="reference internal" href="index.html#module-tornado.httpserver" title="tornado.httpserver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpserver</span></code></a>,
<code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code> and <a class="reference internal" href="index.html#module-tornado.wsgi" title="tornado.wsgi"><code class="xref py py-obj docutils literal"><span class="pre">tornado.wsgi</span></code></a> modules, making support
for features such as chunked and gzip encoding more consistent.
<a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> now uses new delegate interfaces defined in <a class="reference internal" href="index.html#module-tornado.httputil" title="tornado.httputil"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httputil</span></code></a>
in addition to its old single-callback interface.</li>
<li>New module <a class="reference internal" href="index.html#module-tornado.tcpclient" title="tornado.tcpclient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.tcpclient</span></code></a> creates TCP connections with non-blocking
DNS, SSL handshaking, and support for IPv6.</li>
</ul>
</div>
<div class="section" id="backwards-compatibility-notes">
<h6>Backwards-compatibility notes<a class="headerlink" href="#backwards-compatibility-notes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">tornado.concurrent.Future</span></code></a> is no longer thread-safe; use
<a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#concurrent.futures.Future" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures.Future</span></code></a> when thread-safety is needed.</li>
<li>Tornado now depends on the <a class="reference external" href="https://pypi.python.org/pypi/certifi">certifi</a>
package instead of bundling its own copy of the Mozilla CA list. This will
be installed automatically when using <code class="docutils literal"><span class="pre">pip</span></code> or <code class="docutils literal"><span class="pre">easy_install</span></code>.</li>
<li>This version includes the changes to the secure cookie format first
introduced in version <a class="reference internal" href="index.html#document-releases/v3.2.1"><em>3.2.1</em></a>, and the xsrf token change
in version <a class="reference internal" href="index.html#document-releases/v3.2.2"><em>3.2.2</em></a>.  If you are upgrading from an earlier
version, see those versions&#8217; release notes.</li>
<li>WebSocket connections from other origin sites are now rejected by default.
To accept cross-origin websocket connections, override
the new method <a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler.check_origin" title="tornado.websocket.WebSocketHandler.check_origin"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler.check_origin</span></code></a>.</li>
<li><a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler" title="tornado.websocket.WebSocketHandler"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler</span></code></a> no longer supports the old <code class="docutils literal"><span class="pre">draft</span> <span class="pre">76</span></code> protocol
(this mainly affects Safari 5.x browsers).  Applications should use
non-websocket workarounds for these browsers.</li>
<li>Authors of alternative <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> implementations should see the changes
to <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_handler" title="tornado.ioloop.IOLoop.add_handler"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_handler</span></code></a> in this release.</li>
<li>The <code class="docutils literal"><span class="pre">RequestHandler.async_callback</span></code> and <code class="docutils literal"><span class="pre">WebSocketHandler.async_callback</span></code>
wrapper functions have been removed; they have been obsolete for a long
time due to stack contexts (and more recently coroutines).</li>
<li><code class="docutils literal"><span class="pre">curl_httpclient</span></code> now requires a minimum of libcurl version 7.21.1 and
pycurl 7.18.2.</li>
<li>Support for <code class="docutils literal"><span class="pre">RequestHandler.get_error_html</span></code> has been removed;
override <a class="reference internal" href="index.html#tornado.web.RequestHandler.write_error" title="tornado.web.RequestHandler.write_error"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.write_error</span></code></a> instead.</li>
</ul>
</div>
<div class="section" id="other-notes">
<h6>Other notes<a class="headerlink" href="#other-notes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The git repository has moved to <a class="reference external" href="https://github.com/tornadoweb/tornado">https://github.com/tornadoweb/tornado</a>.
All old links should be redirected to the new location.</li>
<li>An <a class="reference external" href="http://groups.google.com/group/python-tornado-announce">announcement mailing list</a> is now available.</li>
<li>All Tornado modules are now importable on Google App Engine (although
the App Engine environment does not allow the system calls used
by <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> so many modules are still unusable).</li>
</ul>
</div>
<div class="section" id="tornado-auth">
<h6><a class="reference internal" href="index.html#module-tornado.auth" title="tornado.auth"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth</span></code></a><a class="headerlink" href="#tornado-auth" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Fixed a bug in <code class="docutils literal"><span class="pre">.FacebookMixin</span></code> on Python 3.</li>
<li>When using the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> interface, exceptions are more reliably delivered
to the caller.</li>
</ul>
</div>
<div class="section" id="tornado-concurrent">
<h6><a class="reference internal" href="index.html#module-tornado.concurrent" title="tornado.concurrent"><code class="xref py py-obj docutils literal"><span class="pre">tornado.concurrent</span></code></a><a class="headerlink" href="#tornado-concurrent" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">tornado.concurrent.Future</span></code></a> is now always thread-unsafe (previously
it would be thread-safe if the <a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#module-concurrent.futures" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures</span></code></a> package was available).
This improves performance and provides more consistent semantics.
The parts of Tornado that accept Futures will accept both Tornado&#8217;s
thread-unsafe Futures and the thread-safe <a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#concurrent.futures.Future" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures.Future</span></code></a>.</li>
<li><a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">tornado.concurrent.Future</span></code></a> now includes all the functionality
of the old <code class="docutils literal"><span class="pre">TracebackFuture</span></code> class.  <code class="docutils literal"><span class="pre">TracebackFuture</span></code> is now
simply an alias for <code class="docutils literal"><span class="pre">Future</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-curl-httpclient">
<h6><code class="docutils literal"><span class="pre">tornado.curl_httpclient</span></code><a class="headerlink" href="#tornado-curl-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">curl_httpclient</span></code> now passes along the HTTP &#8220;reason&#8221; string
in <code class="docutils literal"><span class="pre">response.reason</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-gen">
<h6><a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a><a class="headerlink" href="#tornado-gen" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Performance of coroutines has been improved.</li>
<li>Coroutines no longer generate <code class="docutils literal"><span class="pre">StackContexts</span></code> by default, but they
will be created on demand when needed.</li>
<li>The internals of the <a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a> module have been rewritten to
improve performance when using <code class="docutils literal"><span class="pre">Futures</span></code>, at the expense of some
performance degradation for the older <a class="reference internal" href="index.html#tornado.gen.YieldPoint" title="tornado.gen.YieldPoint"><code class="xref py py-obj docutils literal"><span class="pre">YieldPoint</span></code></a> interfaces.</li>
<li>New function <a class="reference internal" href="index.html#tornado.gen.with_timeout" title="tornado.gen.with_timeout"><code class="xref py py-obj docutils literal"><span class="pre">with_timeout</span></code></a> wraps a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> and raises an exception
if it doesn&#8217;t complete in a given amount of time.</li>
<li>New object <a class="reference internal" href="index.html#tornado.gen.moment" title="tornado.gen.moment"><code class="xref py py-obj docutils literal"><span class="pre">moment</span></code></a> can be yielded to allow the IOLoop to run for
one iteration before resuming.</li>
<li><a class="reference internal" href="index.html#tornado.gen.Task" title="tornado.gen.Task"><code class="xref py py-obj docutils literal"><span class="pre">Task</span></code></a> is now a function returning a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> instead of a <a class="reference internal" href="index.html#tornado.gen.YieldPoint" title="tornado.gen.YieldPoint"><code class="xref py py-obj docutils literal"><span class="pre">YieldPoint</span></code></a>
subclass.  This change should be transparent to application code, but
allows <a class="reference internal" href="index.html#tornado.gen.Task" title="tornado.gen.Task"><code class="xref py py-obj docutils literal"><span class="pre">Task</span></code></a> to take advantage of the newly-optimized <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>
handling.</li>
</ul>
</div>
<div class="section" id="tornado-http1connection">
<h6><a class="reference internal" href="index.html#module-tornado.http1connection" title="tornado.http1connection"><code class="xref py py-obj docutils literal"><span class="pre">tornado.http1connection</span></code></a><a class="headerlink" href="#tornado-http1connection" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>New module contains the HTTP implementation shared by <a class="reference internal" href="index.html#module-tornado.httpserver" title="tornado.httpserver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpserver</span></code></a>
and <code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-httpclient">
<h6><a class="reference internal" href="index.html#module-tornado.httpclient" title="tornado.httpclient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient</span></code></a><a class="headerlink" href="#tornado-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The command-line HTTP client (<code class="docutils literal"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">tornado.httpclient</span> <span class="pre">$URL</span></code>)
now works on Python 3.</li>
<li>Fixed a memory leak in <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> shutdown that affected
applications that created many HTTP clients and IOLoops.</li>
<li>New client request parameter <code class="docutils literal"><span class="pre">decompress_response</span></code> replaces
the existing <code class="docutils literal"><span class="pre">use_gzip</span></code> parameter; both names are accepted.</li>
</ul>
</div>
<div class="section" id="tornado-httpserver">
<h6><a class="reference internal" href="index.html#module-tornado.httpserver" title="tornado.httpserver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpserver</span></code></a><a class="headerlink" href="#tornado-httpserver" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">tornado.httpserver.HTTPRequest</span></code> has moved to
<a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest" title="tornado.httputil.HTTPServerRequest"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httputil.HTTPServerRequest</span></code></a>.</li>
<li>HTTP implementation has been unified with <code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code>
in <a class="reference internal" href="index.html#module-tornado.http1connection" title="tornado.http1connection"><code class="xref py py-obj docutils literal"><span class="pre">tornado.http1connection</span></code></a>.</li>
<li>Now supports <code class="docutils literal"><span class="pre">Transfer-Encoding:</span> <span class="pre">chunked</span></code> for request bodies.</li>
<li>Now supports <code class="docutils literal"><span class="pre">Content-Encoding:</span> <span class="pre">gzip</span></code> for request bodies if
<code class="docutils literal"><span class="pre">decompress_request=True</span></code> is passed to the <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> constructor.</li>
<li>The <code class="docutils literal"><span class="pre">connection</span></code> attribute of <a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest" title="tornado.httputil.HTTPServerRequest"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerRequest</span></code></a> is now documented
for public use; applications are expected to write their responses
via the <a class="reference internal" href="index.html#tornado.httputil.HTTPConnection" title="tornado.httputil.HTTPConnection"><code class="xref py py-obj docutils literal"><span class="pre">HTTPConnection</span></code></a> interface.</li>
<li>The <a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest.write" title="tornado.httputil.HTTPServerRequest.write"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerRequest.write</span></code></a> and <a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest.finish" title="tornado.httputil.HTTPServerRequest.finish"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerRequest.finish</span></code></a> methods
are now deprecated.  (<a class="reference internal" href="index.html#tornado.web.RequestHandler.write" title="tornado.web.RequestHandler.write"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.write</span></code></a> and <a class="reference internal" href="index.html#tornado.web.RequestHandler.finish" title="tornado.web.RequestHandler.finish"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.finish</span></code></a>
are <em>not</em> deprecated; this only applies to the methods on
<a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest" title="tornado.httputil.HTTPServerRequest"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerRequest</span></code></a>)</li>
<li><a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> now supports <a class="reference internal" href="index.html#tornado.httputil.HTTPServerConnectionDelegate" title="tornado.httputil.HTTPServerConnectionDelegate"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerConnectionDelegate</span></code></a> in addition to
the old <code class="docutils literal"><span class="pre">request_callback</span></code> interface.  The delegate interface supports
streaming of request bodies.</li>
<li><a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> now detects the error of an application sending a
<code class="docutils literal"><span class="pre">Content-Length</span></code> error that is inconsistent with the actual content.</li>
<li>New constructor arguments <code class="docutils literal"><span class="pre">max_header_size</span></code> and <code class="docutils literal"><span class="pre">max_body_size</span></code>
allow separate limits to be set for different parts of the request.
<code class="docutils literal"><span class="pre">max_body_size</span></code> is applied even in streaming mode.</li>
<li>New constructor argument <code class="docutils literal"><span class="pre">chunk_size</span></code> can be used to limit the amount
of data read into memory at one time per request.</li>
<li>New constructor arguments <code class="docutils literal"><span class="pre">idle_connection_timeout</span></code> and <code class="docutils literal"><span class="pre">body_timeout</span></code>
allow time limits to be placed on the reading of requests.</li>
<li>Form-encoded message bodies are now parsed for all HTTP methods, not just
<code class="docutils literal"><span class="pre">POST</span></code>, <code class="docutils literal"><span class="pre">PUT</span></code>, and <code class="docutils literal"><span class="pre">PATCH</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-httputil">
<h6><a class="reference internal" href="index.html#module-tornado.httputil" title="tornado.httputil"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httputil</span></code></a><a class="headerlink" href="#tornado-httputil" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httputil.HTTPServerRequest" title="tornado.httputil.HTTPServerRequest"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerRequest</span></code></a> was moved to this module from <a class="reference internal" href="index.html#module-tornado.httpserver" title="tornado.httpserver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpserver</span></code></a>.</li>
<li>New base classes <a class="reference internal" href="index.html#tornado.httputil.HTTPConnection" title="tornado.httputil.HTTPConnection"><code class="xref py py-obj docutils literal"><span class="pre">HTTPConnection</span></code></a>, <a class="reference internal" href="index.html#tornado.httputil.HTTPServerConnectionDelegate" title="tornado.httputil.HTTPServerConnectionDelegate"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServerConnectionDelegate</span></code></a>,
and <a class="reference internal" href="index.html#tornado.httputil.HTTPMessageDelegate" title="tornado.httputil.HTTPMessageDelegate"><code class="xref py py-obj docutils literal"><span class="pre">HTTPMessageDelegate</span></code></a> define the interaction between applications
and the HTTP implementation.</li>
</ul>
</div>
<div class="section" id="tornado-ioloop">
<h6><a class="reference internal" href="index.html#module-tornado.ioloop" title="tornado.ioloop"><code class="xref py py-obj docutils literal"><span class="pre">tornado.ioloop</span></code></a><a class="headerlink" href="#tornado-ioloop" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_handler" title="tornado.ioloop.IOLoop.add_handler"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_handler</span></code></a> and related methods now accept file-like objects
in addition to raw file descriptors.  Passing the objects is recommended
(when possible) to avoid a garbage-collection-related problem in unit tests.</li>
<li>New method <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.clear_instance" title="tornado.ioloop.IOLoop.clear_instance"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.clear_instance</span></code></a> makes it possible to uninstall the
singleton instance.</li>
<li>Timeout scheduling is now more robust against slow callbacks.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_timeout" title="tornado.ioloop.IOLoop.add_timeout"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_timeout</span></code></a> is now a bit more efficient.</li>
<li>When a function run by the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> and that <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>
has an exception, the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> will log the exception.</li>
<li>New method <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.spawn_callback" title="tornado.ioloop.IOLoop.spawn_callback"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.spawn_callback</span></code></a> simplifies the process of launching
a fire-and-forget callback that is separated from the caller&#8217;s stack context.</li>
<li>New methods <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.call_later" title="tornado.ioloop.IOLoop.call_later"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.call_later</span></code></a> and <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.call_at" title="tornado.ioloop.IOLoop.call_at"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.call_at</span></code></a> simplify the
specification of relative or absolute timeouts (as opposed to
<a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_timeout" title="tornado.ioloop.IOLoop.add_timeout"><code class="xref py py-obj docutils literal"><span class="pre">add_timeout</span></code></a>, which used the type of its argument).</li>
</ul>
</div>
<div class="section" id="tornado-iostream">
<h6><a class="reference internal" href="index.html#module-tornado.iostream" title="tornado.iostream"><code class="xref py py-obj docutils literal"><span class="pre">tornado.iostream</span></code></a><a class="headerlink" href="#tornado-iostream" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The <code class="docutils literal"><span class="pre">callback</span></code> argument to most <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> methods is now optional.
When called without a callback the method will return a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>
for use with coroutines.</li>
<li>New method <a class="reference internal" href="index.html#tornado.iostream.IOStream.start_tls" title="tornado.iostream.IOStream.start_tls"><code class="xref py py-obj docutils literal"><span class="pre">IOStream.start_tls</span></code></a> converts an <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> to an
<a class="reference internal" href="index.html#tornado.iostream.SSLIOStream" title="tornado.iostream.SSLIOStream"><code class="xref py py-obj docutils literal"><span class="pre">SSLIOStream</span></code></a>.</li>
<li>No longer gets confused when an <code class="docutils literal"><span class="pre">IOError</span></code> or <code class="docutils literal"><span class="pre">OSError</span></code> without
an <code class="docutils literal"><span class="pre">errno</span></code> attribute is raised.</li>
<li><a class="reference internal" href="index.html#tornado.iostream.BaseIOStream.read_bytes" title="tornado.iostream.BaseIOStream.read_bytes"><code class="xref py py-obj docutils literal"><span class="pre">BaseIOStream.read_bytes</span></code></a> now accepts a <code class="docutils literal"><span class="pre">partial</span></code> keyword argument,
which can be used to return before the full amount has been read.
This is a more coroutine-friendly alternative to <code class="docutils literal"><span class="pre">streaming_callback</span></code>.</li>
<li><a class="reference internal" href="index.html#tornado.iostream.BaseIOStream.read_until" title="tornado.iostream.BaseIOStream.read_until"><code class="xref py py-obj docutils literal"><span class="pre">BaseIOStream.read_until</span></code></a> and <code class="docutils literal"><span class="pre">read_until_regex</span></code> now acept a
<code class="docutils literal"><span class="pre">max_bytes</span></code> keyword argument which will cause the request to fail if
it cannot be satisfied from the given number of bytes.</li>
<li><a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> no longer reads from the socket into memory if it does not
need data to satisfy a pending read.  As a side effect, the close callback
will not be run immediately if the other side closes the connection
while there is unconsumed data in the buffer.</li>
<li>The default <code class="docutils literal"><span class="pre">chunk_size</span></code> has been increased to 64KB (from 4KB)</li>
<li>The <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> constructor takes a new keyword argument
<code class="docutils literal"><span class="pre">max_write_buffer_size</span></code> (defaults to unlimited).  Calls to
<a class="reference internal" href="index.html#tornado.iostream.BaseIOStream.write" title="tornado.iostream.BaseIOStream.write"><code class="xref py py-obj docutils literal"><span class="pre">BaseIOStream.write</span></code></a> will raise <a class="reference internal" href="index.html#tornado.iostream.StreamBufferFullError" title="tornado.iostream.StreamBufferFullError"><code class="xref py py-obj docutils literal"><span class="pre">StreamBufferFullError</span></code></a> if the amount
of unsent buffered data exceeds this limit.</li>
<li><code class="docutils literal"><span class="pre">ETIMEDOUT</span></code> errors are no longer logged.  If you need to distinguish
timeouts from other forms of closed connections, examine <code class="docutils literal"><span class="pre">stream.error</span></code>
from a close callback.</li>
</ul>
</div>
<div class="section" id="tornado-netutil">
<h6><a class="reference internal" href="index.html#module-tornado.netutil" title="tornado.netutil"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil</span></code></a><a class="headerlink" href="#tornado-netutil" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>When <a class="reference internal" href="index.html#tornado.netutil.bind_sockets" title="tornado.netutil.bind_sockets"><code class="xref py py-obj docutils literal"><span class="pre">bind_sockets</span></code></a> chooses a port automatically, it will now use
the same port for IPv4 and IPv6.</li>
<li>TLS compression is now disabled by default on Python 3.3 and higher
(it is not possible to change this option in older versions).</li>
</ul>
</div>
<div class="section" id="tornado-options">
<h6><a class="reference internal" href="index.html#module-tornado.options" title="tornado.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options</span></code></a><a class="headerlink" href="#tornado-options" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>It is now possible to disable the default logging configuration
by setting <code class="docutils literal"><span class="pre">options.logging</span></code> to <code class="docutils literal"><span class="pre">None</span></code> instead of the string <code class="docutils literal"><span class="pre">&quot;none&quot;</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-platform-asyncio">
<h6><a class="reference internal" href="index.html#module-tornado.platform.asyncio" title="tornado.platform.asyncio"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.asyncio</span></code></a><a class="headerlink" href="#tornado-platform-asyncio" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Now works on Python 2.6.</li>
<li>Now works with Trollius version 0.3.</li>
</ul>
</div>
<div class="section" id="tornado-platform-twisted">
<h6><a class="reference internal" href="index.html#module-tornado.platform.twisted" title="tornado.platform.twisted"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.twisted</span></code></a><a class="headerlink" href="#tornado-platform-twisted" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.platform.twisted.TwistedIOLoop" title="tornado.platform.twisted.TwistedIOLoop"><code class="xref py py-obj docutils literal"><span class="pre">TwistedIOLoop</span></code></a> now works on Python 3.3+ (with Twisted 14.0.0+).</li>
</ul>
</div>
<div class="section" id="tornado-simple-httpclient">
<h6><code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code><a class="headerlink" href="#tornado-simple-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">simple_httpclient</span></code> has better support for IPv6, which is now enabled
by default.</li>
<li>Improved default cipher suite selection (Python 2.7+).</li>
<li>HTTP implementation has been unified with <code class="docutils literal"><span class="pre">tornado.httpserver</span></code>
in <a class="reference internal" href="index.html#module-tornado.http1connection" title="tornado.http1connection"><code class="xref py py-obj docutils literal"><span class="pre">tornado.http1connection</span></code></a></li>
<li>Streaming request bodies are now supported via the <code class="docutils literal"><span class="pre">body_producer</span></code>
keyword argument to <a class="reference internal" href="index.html#tornado.httpclient.HTTPRequest" title="tornado.httpclient.HTTPRequest"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient.HTTPRequest</span></code></a>.</li>
<li>The <code class="docutils literal"><span class="pre">expect_100_continue</span></code> keyword argument to
<a class="reference internal" href="index.html#tornado.httpclient.HTTPRequest" title="tornado.httpclient.HTTPRequest"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient.HTTPRequest</span></code></a> allows the use of the HTTP <code class="docutils literal"><span class="pre">Expect:</span>
<span class="pre">100-continue</span></code> feature.</li>
<li><code class="docutils literal"><span class="pre">simple_httpclient</span></code> now raises the original exception (e.g. an <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#IOError" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">IOError</span></code></a>)
in more cases, instead of converting everything to <code class="docutils literal"><span class="pre">HTTPError</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-stack-context">
<h6><a class="reference internal" href="index.html#module-tornado.stack_context" title="tornado.stack_context"><code class="xref py py-obj docutils literal"><span class="pre">tornado.stack_context</span></code></a><a class="headerlink" href="#tornado-stack-context" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The stack context system now has less performance overhead when no
stack contexts are active.</li>
</ul>
</div>
<div class="section" id="tornado-tcpclient">
<h6><a class="reference internal" href="index.html#module-tornado.tcpclient" title="tornado.tcpclient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.tcpclient</span></code></a><a class="headerlink" href="#tornado-tcpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>New module which creates TCP connections and IOStreams, including
name resolution, connecting, and SSL handshakes.</li>
</ul>
</div>
<div class="section" id="tornado-testing">
<h6><a class="reference internal" href="index.html#module-tornado.testing" title="tornado.testing"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing</span></code></a><a class="headerlink" href="#tornado-testing" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.testing.AsyncTestCase" title="tornado.testing.AsyncTestCase"><code class="xref py py-obj docutils literal"><span class="pre">AsyncTestCase</span></code></a> now attempts to detect test methods that are generators
but were not run with <code class="docutils literal"><span class="pre">&#64;gen_test</span></code> or any similar decorator (this would
previously result in the test silently being skipped).</li>
<li>Better stack traces are now displayed when a test times out.</li>
<li>The <code class="docutils literal"><span class="pre">&#64;gen_test</span></code> decorator now passes along <code class="docutils literal"><span class="pre">*args,</span> <span class="pre">**kwargs</span></code> so it
can be used on functions with arguments.</li>
<li>Fixed the test suite when <code class="docutils literal"><span class="pre">unittest2</span></code> is installed on Python 3.</li>
</ul>
</div>
<div class="section" id="tornado-web">
<h6><a class="reference internal" href="index.html#module-tornado.web" title="tornado.web"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web</span></code></a><a class="headerlink" href="#tornado-web" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>It is now possible to support streaming request bodies with the
<a class="reference internal" href="index.html#tornado.web.stream_request_body" title="tornado.web.stream_request_body"><code class="xref py py-obj docutils literal"><span class="pre">stream_request_body</span></code></a> decorator and the new <a class="reference internal" href="index.html#tornado.web.RequestHandler.data_received" title="tornado.web.RequestHandler.data_received"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.data_received</span></code></a>
method.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.flush" title="tornado.web.RequestHandler.flush"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.flush</span></code></a> now returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> if no callback is given.</li>
<li>New exception <a class="reference internal" href="index.html#tornado.web.Finish" title="tornado.web.Finish"><code class="xref py py-obj docutils literal"><span class="pre">Finish</span></code></a> may be raised to finish a request without
triggering error handling.</li>
<li>When gzip support is enabled, all <code class="docutils literal"><span class="pre">text/*</span></code> mime types will be compressed,
not just those on a whitelist.</li>
<li><a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> now implements the <a class="reference internal" href="index.html#tornado.httputil.HTTPMessageDelegate" title="tornado.httputil.HTTPMessageDelegate"><code class="xref py py-obj docutils literal"><span class="pre">HTTPMessageDelegate</span></code></a> interface.</li>
<li><code class="docutils literal"><span class="pre">HEAD</span></code> requests in <a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> no longer read the entire file.</li>
<li><a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> now streams response bodies to the client.</li>
<li>New setting <code class="docutils literal"><span class="pre">compress_response</span></code> replaces the existing <code class="docutils literal"><span class="pre">gzip</span></code>
setting; both names are accepted.</li>
<li>XSRF cookies that were not generated by this module (i.e. strings without
any particular formatting) are once again accepted (as long as the
cookie and body/header match).  This pattern was common for
testing and non-browser clients but was broken by the changes in
Tornado 3.2.2.</li>
</ul>
</div>
<div class="section" id="tornado-websocket">
<h6><a class="reference internal" href="index.html#module-tornado.websocket" title="tornado.websocket"><code class="xref py py-obj docutils literal"><span class="pre">tornado.websocket</span></code></a><a class="headerlink" href="#tornado-websocket" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>WebSocket connections from other origin sites are now rejected by default.
Browsers do not use the same-origin policy for WebSocket connections as they
do for most other browser-initiated communications.  This can be surprising
and a security risk, so we disallow these connections on the server side
by default.  To accept cross-origin websocket connections, override
the new method <a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler.check_origin" title="tornado.websocket.WebSocketHandler.check_origin"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler.check_origin</span></code></a>.</li>
<li><a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler.close" title="tornado.websocket.WebSocketHandler.close"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler.close</span></code></a> and <a class="reference internal" href="index.html#tornado.websocket.WebSocketClientConnection.close" title="tornado.websocket.WebSocketClientConnection.close"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketClientConnection.close</span></code></a> now
support <code class="docutils literal"><span class="pre">code</span></code> and <code class="docutils literal"><span class="pre">reason</span></code> arguments to send a status code and
message to the other side of the connection when closing.  Both classes
also have <code class="docutils literal"><span class="pre">close_code</span></code> and <code class="docutils literal"><span class="pre">close_reason</span></code> attributes to receive these
values when the other side closes.</li>
<li>The C speedup module now builds correctly with MSVC, and can support
messages larger than 2GB on 64-bit systems.</li>
<li>The fallback mechanism for detecting a missing C compiler now
works correctly on Mac OS X.</li>
<li>Arguments to <a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler.open" title="tornado.websocket.WebSocketHandler.open"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler.open</span></code></a> are now decoded in the same way
as arguments to <a class="reference internal" href="index.html#tornado.web.RequestHandler.get" title="tornado.web.RequestHandler.get"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get</span></code></a> and similar methods.</li>
<li>It is now allowed to override <code class="docutils literal"><span class="pre">prepare</span></code> in a <a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler" title="tornado.websocket.WebSocketHandler"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler</span></code></a>,
and this method may generate HTTP responses (error pages) in the usual
way.  The HTTP response methods are still not allowed once the
WebSocket handshake has completed.</li>
</ul>
</div>
<div class="section" id="tornado-wsgi">
<h6><a class="reference internal" href="index.html#module-tornado.wsgi" title="tornado.wsgi"><code class="xref py py-obj docutils literal"><span class="pre">tornado.wsgi</span></code></a><a class="headerlink" href="#tornado-wsgi" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>New class <a class="reference internal" href="index.html#tornado.wsgi.WSGIAdapter" title="tornado.wsgi.WSGIAdapter"><code class="xref py py-obj docutils literal"><span class="pre">WSGIAdapter</span></code></a> supports running a Tornado <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> on
a WSGI server in a way that is more compatible with Tornado&#8217;s non-WSGI
<a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a>.  <a class="reference internal" href="index.html#tornado.wsgi.WSGIApplication" title="tornado.wsgi.WSGIApplication"><code class="xref py py-obj docutils literal"><span class="pre">WSGIApplication</span></code></a> is deprecated in favor of using
<a class="reference internal" href="index.html#tornado.wsgi.WSGIAdapter" title="tornado.wsgi.WSGIAdapter"><code class="xref py py-obj docutils literal"><span class="pre">WSGIAdapter</span></code></a> with a regular <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a>.</li>
<li><a class="reference internal" href="index.html#tornado.wsgi.WSGIAdapter" title="tornado.wsgi.WSGIAdapter"><code class="xref py py-obj docutils literal"><span class="pre">WSGIAdapter</span></code></a> now supports gzipped output.</li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v3.2.2"></span><div class="section" id="what-s-new-in-tornado-3-2-2">
<h4>What&#8217;s new in Tornado 3.2.2<a class="headerlink" href="#what-s-new-in-tornado-3-2-2" title="Permalink to this headline">¶</a></h4>
<div class="section" id="june-3-2014">
<h5>June 3, 2014<a class="headerlink" href="#june-3-2014" title="Permalink to this headline">¶</a></h5>
<div class="section" id="security-fixes">
<h6>Security fixes<a class="headerlink" href="#security-fixes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The XSRF token is now encoded with a random mask on each request.
This makes it safe to include in compressed pages without being
vulnerable to the <a class="reference external" href="http://breachattack.com">BREACH attack</a>.
This applies to most applications that use both the <code class="docutils literal"><span class="pre">xsrf_cookies</span></code>
and <code class="docutils literal"><span class="pre">gzip</span></code> options (or have gzip applied by a proxy).</li>
</ul>
</div>
<div class="section" id="backwards-compatibility-notes">
<h6>Backwards-compatibility notes<a class="headerlink" href="#backwards-compatibility-notes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>If Tornado 3.2.2 is run at the same time as older versions on the same
domain, there is some potential for issues with the differing cookie
versions.  The <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> setting <code class="docutils literal"><span class="pre">xsrf_cookie_version=1</span></code> can
be used for a transitional period to generate the older cookie format
on newer servers.</li>
</ul>
</div>
<div class="section" id="other-changes">
<h6>Other changes<a class="headerlink" href="#other-changes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">tornado.platform.asyncio</span></code> is now compatible with <code class="docutils literal"><span class="pre">trollius</span></code> version 0.3.</li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v3.2.1"></span><div class="section" id="what-s-new-in-tornado-3-2-1">
<h4>What&#8217;s new in Tornado 3.2.1<a class="headerlink" href="#what-s-new-in-tornado-3-2-1" title="Permalink to this headline">¶</a></h4>
<div class="section" id="may-5-2014">
<h5>May 5, 2014<a class="headerlink" href="#may-5-2014" title="Permalink to this headline">¶</a></h5>
<div class="section" id="security-fixes">
<h6>Security fixes<a class="headerlink" href="#security-fixes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The signed-value format used by <a class="reference internal" href="index.html#tornado.web.RequestHandler.set_secure_cookie" title="tornado.web.RequestHandler.set_secure_cookie"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.set_secure_cookie</span></code></a>
and <a class="reference internal" href="index.html#tornado.web.RequestHandler.get_secure_cookie" title="tornado.web.RequestHandler.get_secure_cookie"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_secure_cookie</span></code></a> has changed to be more secure.
<strong>This is a disruptive change</strong>.  The <code class="docutils literal"><span class="pre">secure_cookie</span></code> functions
take new <code class="docutils literal"><span class="pre">version</span></code> parameters to support transitions between cookie
formats.</li>
<li>The new cookie format fixes a vulnerability that may be present in
applications that use multiple cookies where the name of one cookie
is a prefix of the name of another.</li>
<li>To minimize disruption, cookies in the older format will be accepted
by default until they expire.  Applications that may be vulnerable
can reject all cookies in the older format by passing <code class="docutils literal"><span class="pre">min_version=2</span></code>
to <a class="reference internal" href="index.html#tornado.web.RequestHandler.get_secure_cookie" title="tornado.web.RequestHandler.get_secure_cookie"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_secure_cookie</span></code></a>.</li>
<li>Thanks to Joost Pol of <a class="reference external" href="https://www.certifiedsecure.com">Certified Secure</a>
for reporting this issue.</li>
</ul>
</div>
<div class="section" id="backwards-compatibility-notes">
<h6>Backwards-compatibility notes<a class="headerlink" href="#backwards-compatibility-notes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Signed cookies issued by <a class="reference internal" href="index.html#tornado.web.RequestHandler.set_secure_cookie" title="tornado.web.RequestHandler.set_secure_cookie"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.set_secure_cookie</span></code></a> in Tornado
3.2.1 cannot be read by older releases.  If you need to run 3.2.1
in parallel with older releases, you can pass <code class="docutils literal"><span class="pre">version=1</span></code> to
<a class="reference internal" href="index.html#tornado.web.RequestHandler.set_secure_cookie" title="tornado.web.RequestHandler.set_secure_cookie"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.set_secure_cookie</span></code></a> to issue cookies that are
backwards-compatible (but have a known weakness, so this option
should only be used for a transitional period).</li>
</ul>
</div>
<div class="section" id="other-changes">
<h6>Other changes<a class="headerlink" href="#other-changes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The C extension used to speed up the websocket module now compiles
correctly on Windows with MSVC and 64-bit mode.  The fallback to
the pure-Python alternative now works correctly on Mac OS X machines
with no C compiler installed.</li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v3.2.0"></span><div class="section" id="what-s-new-in-tornado-3-2">
<h4>What&#8217;s new in Tornado 3.2<a class="headerlink" href="#what-s-new-in-tornado-3-2" title="Permalink to this headline">¶</a></h4>
<div class="section" id="jan-14-2014">
<h5>Jan 14, 2014<a class="headerlink" href="#jan-14-2014" title="Permalink to this headline">¶</a></h5>
<div class="section" id="installation">
<h6>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Tornado now depends on the <a class="reference external" href="https://pypi.python.org/pypi/backports.ssl_match_hostname">backports.ssl_match_hostname</a> when
running on Python 2.  This will be installed automatically when using <code class="docutils literal"><span class="pre">pip</span></code>
or <code class="docutils literal"><span class="pre">easy_install</span></code></li>
<li>Tornado now includes an optional C extension module, which greatly improves
performance of websockets.  This extension will be built automatically
if a C compiler is found at install time.</li>
</ul>
</div>
<div class="section" id="new-modules">
<h6>New modules<a class="headerlink" href="#new-modules" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The <a class="reference internal" href="index.html#module-tornado.platform.asyncio" title="tornado.platform.asyncio"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.asyncio</span></code></a> module provides integration with the
<code class="docutils literal"><span class="pre">asyncio</span></code> module introduced in Python 3.4 (also available for Python
3.3 with <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">asyncio</span></code>).</li>
</ul>
</div>
<div class="section" id="tornado-auth">
<h6><a class="reference internal" href="index.html#module-tornado.auth" title="tornado.auth"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth</span></code></a><a class="headerlink" href="#tornado-auth" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Added <a class="reference internal" href="index.html#tornado.auth.GoogleOAuth2Mixin" title="tornado.auth.GoogleOAuth2Mixin"><code class="xref py py-obj docutils literal"><span class="pre">GoogleOAuth2Mixin</span></code></a> support authentication to Google services
with OAuth 2 instead of OpenID and OAuth 1.</li>
<li><a class="reference internal" href="index.html#tornado.auth.FacebookGraphMixin" title="tornado.auth.FacebookGraphMixin"><code class="xref py py-obj docutils literal"><span class="pre">FacebookGraphMixin</span></code></a> has been updated to use the current Facebook login
URL, which saves a redirect.</li>
</ul>
</div>
<div class="section" id="tornado-concurrent">
<h6><a class="reference internal" href="index.html#module-tornado.concurrent" title="tornado.concurrent"><code class="xref py py-obj docutils literal"><span class="pre">tornado.concurrent</span></code></a><a class="headerlink" href="#tornado-concurrent" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">TracebackFuture</span></code> now accepts a <code class="docutils literal"><span class="pre">timeout</span></code> keyword argument (although
it is still incorrect to use a non-zero timeout in non-blocking code).</li>
</ul>
</div>
<div class="section" id="tornado-curl-httpclient">
<h6><code class="docutils literal"><span class="pre">tornado.curl_httpclient</span></code><a class="headerlink" href="#tornado-curl-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">tornado.curl_httpclient</span></code> now works on Python 3 with the
soon-to-be-released pycurl 7.19.3, which will officially support
Python 3 for the first time.  Note that there are some unofficial
Python 3 ports of pycurl (Ubuntu has included one for its past
several releases); these are not supported for use with Tornado.</li>
</ul>
</div>
<div class="section" id="tornado-escape">
<h6><a class="reference internal" href="index.html#module-tornado.escape" title="tornado.escape"><code class="xref py py-obj docutils literal"><span class="pre">tornado.escape</span></code></a><a class="headerlink" href="#tornado-escape" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.escape.xhtml_escape" title="tornado.escape.xhtml_escape"><code class="xref py py-obj docutils literal"><span class="pre">xhtml_escape</span></code></a> now escapes apostrophes as well.</li>
<li><a class="reference internal" href="index.html#tornado.escape.utf8" title="tornado.escape.utf8"><code class="xref py py-obj docutils literal"><span class="pre">tornado.escape.utf8</span></code></a>, <a class="reference internal" href="index.html#tornado.escape.to_unicode" title="tornado.escape.to_unicode"><code class="xref py py-obj docutils literal"><span class="pre">to_unicode</span></code></a>, and <a class="reference internal" href="index.html#tornado.escape.native_str" title="tornado.escape.native_str"><code class="xref py py-obj docutils literal"><span class="pre">native_str</span></code></a> now raise
<a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#TypeError" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">TypeError</span></code></a> instead of <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#AssertionError" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">AssertionError</span></code></a> when given an invalid value.</li>
</ul>
</div>
<div class="section" id="tornado-gen">
<h6><a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a><a class="headerlink" href="#tornado-gen" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Coroutines may now yield dicts in addition to lists to wait for
multiple tasks in parallel.</li>
<li>Improved performance of <a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a> when yielding a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> that is
already done.</li>
</ul>
</div>
<div class="section" id="tornado-httpclient">
<h6><a class="reference internal" href="index.html#module-tornado.httpclient" title="tornado.httpclient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient</span></code></a><a class="headerlink" href="#tornado-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httpclient.HTTPRequest" title="tornado.httpclient.HTTPRequest"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient.HTTPRequest</span></code></a> now uses property setters so that
setting attributes after construction applies the same conversions
as <code class="docutils literal"><span class="pre">__init__</span></code> (e.g. converting the body attribute to bytes).</li>
</ul>
</div>
<div class="section" id="tornado-httpserver">
<h6><a class="reference internal" href="index.html#module-tornado.httpserver" title="tornado.httpserver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpserver</span></code></a><a class="headerlink" href="#tornado-httpserver" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Malformed <code class="docutils literal"><span class="pre">x-www-form-urlencoded</span></code> request bodies will now log a warning
and continue instead of causing the request to fail (similar to the existing
handling of malformed <code class="docutils literal"><span class="pre">multipart/form-data</span></code> bodies.  This is done mainly
because some libraries send this content type by default even when the data
is not form-encoded.</li>
<li>Fix some error messages for unix sockets (and other non-IP sockets)</li>
</ul>
</div>
<div class="section" id="tornado-ioloop">
<h6><a class="reference internal" href="index.html#module-tornado.ioloop" title="tornado.ioloop"><code class="xref py py-obj docutils literal"><span class="pre">tornado.ioloop</span></code></a><a class="headerlink" href="#tornado-ioloop" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> now uses <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.handle_callback_exception" title="tornado.ioloop.IOLoop.handle_callback_exception"><code class="xref py py-obj docutils literal"><span class="pre">handle_callback_exception</span></code></a> consistently for
error logging.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> now frees callback objects earlier, reducing memory usage
while idle.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> will no longer call <a class="reference external" href="https://docs.python.org/3.4/library/logging.html#logging.basicConfig" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">logging.basicConfig</span></code></a> if there is a handler
defined for the root logger or for the <code class="docutils literal"><span class="pre">tornado</span></code> or <code class="docutils literal"><span class="pre">tornado.application</span></code>
loggers (previously it only looked at the root logger).</li>
</ul>
</div>
<div class="section" id="tornado-iostream">
<h6><a class="reference internal" href="index.html#module-tornado.iostream" title="tornado.iostream"><code class="xref py py-obj docutils literal"><span class="pre">tornado.iostream</span></code></a><a class="headerlink" href="#tornado-iostream" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> now recognizes <code class="docutils literal"><span class="pre">ECONNABORTED</span></code> error codes in more places
(which was mainly an issue on Windows).</li>
<li><a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> now frees memory earlier if a connection is closed while
there is data in the write buffer.</li>
<li><a class="reference internal" href="index.html#tornado.iostream.PipeIOStream" title="tornado.iostream.PipeIOStream"><code class="xref py py-obj docutils literal"><span class="pre">PipeIOStream</span></code></a> now handles <code class="docutils literal"><span class="pre">EAGAIN</span></code> error codes correctly.</li>
<li><a class="reference internal" href="index.html#tornado.iostream.SSLIOStream" title="tornado.iostream.SSLIOStream"><code class="xref py py-obj docutils literal"><span class="pre">SSLIOStream</span></code></a> now initiates the SSL handshake automatically without
waiting for the application to try and read or write to the connection.</li>
<li>Swallow a spurious exception from <code class="docutils literal"><span class="pre">set_nodelay</span></code> when a connection
has been reset.</li>
</ul>
</div>
<div class="section" id="tornado-locale">
<h6><a class="reference internal" href="index.html#module-tornado.locale" title="tornado.locale"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locale</span></code></a><a class="headerlink" href="#tornado-locale" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.locale.Locale.format_date" title="tornado.locale.Locale.format_date"><code class="xref py py-obj docutils literal"><span class="pre">Locale.format_date</span></code></a> no longer forces the use of absolute
dates in Russian.</li>
</ul>
</div>
<div class="section" id="tornado-log">
<h6><a class="reference internal" href="index.html#module-tornado.log" title="tornado.log"><code class="xref py py-obj docutils literal"><span class="pre">tornado.log</span></code></a><a class="headerlink" href="#tornado-log" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Fix an error from <a class="reference internal" href="index.html#tornado.log.enable_pretty_logging" title="tornado.log.enable_pretty_logging"><code class="xref py py-obj docutils literal"><span class="pre">tornado.log.enable_pretty_logging</span></code></a> when
<a class="reference external" href="https://docs.python.org/3.4/library/sys.html#sys.stderr" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">sys.stderr</span></code></a> does not have an <code class="docutils literal"><span class="pre">isatty</span></code> method.</li>
<li><a class="reference internal" href="index.html#tornado.log.LogFormatter" title="tornado.log.LogFormatter"><code class="xref py py-obj docutils literal"><span class="pre">tornado.log.LogFormatter</span></code></a> now accepts keyword arguments <code class="docutils literal"><span class="pre">fmt</span></code>
and <code class="docutils literal"><span class="pre">datefmt</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-netutil">
<h6><a class="reference internal" href="index.html#module-tornado.netutil" title="tornado.netutil"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil</span></code></a><a class="headerlink" href="#tornado-netutil" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.netutil.is_valid_ip" title="tornado.netutil.is_valid_ip"><code class="xref py py-obj docutils literal"><span class="pre">is_valid_ip</span></code></a> (and therefore <code class="docutils literal"><span class="pre">HTTPRequest.remote_ip</span></code>) now rejects
empty strings.</li>
<li>Synchronously using <a class="reference internal" href="index.html#tornado.netutil.ThreadedResolver" title="tornado.netutil.ThreadedResolver"><code class="xref py py-obj docutils literal"><span class="pre">ThreadedResolver</span></code></a> at import time to resolve
a unicode hostname no longer deadlocks.</li>
</ul>
</div>
<div class="section" id="tornado-platform-twisted">
<h6><a class="reference internal" href="index.html#module-tornado.platform.twisted" title="tornado.platform.twisted"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.twisted</span></code></a><a class="headerlink" href="#tornado-platform-twisted" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.platform.twisted.TwistedResolver" title="tornado.platform.twisted.TwistedResolver"><code class="xref py py-obj docutils literal"><span class="pre">TwistedResolver</span></code></a> now has better error handling.</li>
</ul>
</div>
<div class="section" id="tornado-process">
<h6><a class="reference internal" href="index.html#module-tornado.process" title="tornado.process"><code class="xref py py-obj docutils literal"><span class="pre">tornado.process</span></code></a><a class="headerlink" href="#tornado-process" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.process.Subprocess" title="tornado.process.Subprocess"><code class="xref py py-obj docutils literal"><span class="pre">Subprocess</span></code></a> no longer leaks file descriptors if <a class="reference external" href="https://docs.python.org/3.4/library/subprocess.html#subprocess.Popen" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">subprocess.Popen</span></code></a> fails.</li>
</ul>
</div>
<div class="section" id="tornado-simple-httpclient">
<h6><code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code><a class="headerlink" href="#tornado-simple-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">simple_httpclient</span></code> now applies the <code class="docutils literal"><span class="pre">connect_timeout</span></code> to requests
that are queued and have not yet started.</li>
<li>On Python 2.6, <code class="docutils literal"><span class="pre">simple_httpclient</span></code> now uses TLSv1 instead of SSLv3.</li>
<li><code class="docutils literal"><span class="pre">simple_httpclient</span></code> now enforces the connect timeout during DNS resolution.</li>
<li>The embedded <code class="docutils literal"><span class="pre">ca-certificates.crt</span></code> file has been updated with the current
Mozilla CA list.</li>
</ul>
</div>
<div class="section" id="tornado-web">
<h6><a class="reference internal" href="index.html#module-tornado.web" title="tornado.web"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web</span></code></a><a class="headerlink" href="#tornado-web" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> no longer fails if the client requests a <code class="docutils literal"><span class="pre">Range</span></code> that
is larger than the entire file (Facebook has a crawler that does this).</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.on_connection_close" title="tornado.web.RequestHandler.on_connection_close"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.on_connection_close</span></code></a> now works correctly on subsequent
requests of a keep-alive connection.</li>
<li>New application setting <code class="docutils literal"><span class="pre">default_handler_class</span></code> can be used to easily
set up custom 404 pages.</li>
<li>New application settings <code class="docutils literal"><span class="pre">autoreload</span></code>, <code class="docutils literal"><span class="pre">compiled_template_cache</span></code>,
<code class="docutils literal"><span class="pre">static_hash_cache</span></code>, and <code class="docutils literal"><span class="pre">serve_traceback</span></code> can be used to control
individual aspects of debug mode.</li>
<li>New methods <a class="reference internal" href="index.html#tornado.web.RequestHandler.get_query_argument" title="tornado.web.RequestHandler.get_query_argument"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_query_argument</span></code></a> and
<a class="reference internal" href="index.html#tornado.web.RequestHandler.get_body_argument" title="tornado.web.RequestHandler.get_body_argument"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_body_argument</span></code></a> and new attributes
<code class="docutils literal"><span class="pre">HTTPRequest.query_arguments</span></code> and <code class="docutils literal"><span class="pre">HTTPRequest.body_arguments</span></code> allow access
to arguments without intermingling those from the query string with those
from the request body.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.decode_argument" title="tornado.web.RequestHandler.decode_argument"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.decode_argument</span></code></a> and related methods now raise
an <code class="docutils literal"><span class="pre">HTTPError(400)</span></code> instead of <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#UnicodeDecodeError" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">UnicodeDecodeError</span></code></a> when the
argument could not be decoded.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.clear_all_cookies" title="tornado.web.RequestHandler.clear_all_cookies"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.clear_all_cookies</span></code></a> now accepts <code class="docutils literal"><span class="pre">domain</span></code> and <code class="docutils literal"><span class="pre">path</span></code>
arguments, just like <a class="reference internal" href="index.html#tornado.web.RequestHandler.clear_cookie" title="tornado.web.RequestHandler.clear_cookie"><code class="xref py py-obj docutils literal"><span class="pre">clear_cookie</span></code></a>.</li>
<li>It is now possible to specify handlers by name when using the <a class="reference internal" href="index.html#tornado.web.URLSpec" title="tornado.web.URLSpec"><code class="xref py py-obj docutils literal"><span class="pre">URLSpec</span></code></a>
class.</li>
<li><a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> now accepts 4-tuples to specify the <code class="docutils literal"><span class="pre">name</span></code> parameter
(which previously required constructing a <a class="reference internal" href="index.html#tornado.web.URLSpec" title="tornado.web.URLSpec"><code class="xref py py-obj docutils literal"><span class="pre">URLSpec</span></code></a> object instead of
a tuple).</li>
<li>Fixed an incorrect error message when handler methods return a value
other than None or a Future.</li>
<li>Exceptions will no longer be logged twice when using both <code class="docutils literal"><span class="pre">&#64;asynchronous</span></code>
and <code class="docutils literal"><span class="pre">&#64;gen.coroutine</span></code></li>
</ul>
</div>
<div class="section" id="tornado-websocket">
<h6><a class="reference internal" href="index.html#module-tornado.websocket" title="tornado.websocket"><code class="xref py py-obj docutils literal"><span class="pre">tornado.websocket</span></code></a><a class="headerlink" href="#tornado-websocket" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler.write_message" title="tornado.websocket.WebSocketHandler.write_message"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler.write_message</span></code></a> now raises <a class="reference internal" href="index.html#tornado.websocket.WebSocketClosedError" title="tornado.websocket.WebSocketClosedError"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketClosedError</span></code></a> instead
of <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#AttributeError" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">AttributeError</span></code></a> when the connection has been closed.</li>
<li><a class="reference internal" href="index.html#tornado.websocket.websocket_connect" title="tornado.websocket.websocket_connect"><code class="xref py py-obj docutils literal"><span class="pre">websocket_connect</span></code></a> now accepts preconstructed <code class="docutils literal"><span class="pre">HTTPRequest</span></code> objects.</li>
<li>Fix a bug with <a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler" title="tornado.websocket.WebSocketHandler"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler</span></code></a> when used with some proxies that
unconditionally modify the <code class="docutils literal"><span class="pre">Connection</span></code> header.</li>
<li><a class="reference internal" href="index.html#tornado.websocket.websocket_connect" title="tornado.websocket.websocket_connect"><code class="xref py py-obj docutils literal"><span class="pre">websocket_connect</span></code></a> now returns an error immediately for refused connections
instead of waiting for the timeout.</li>
<li><a class="reference internal" href="index.html#tornado.websocket.WebSocketClientConnection" title="tornado.websocket.WebSocketClientConnection"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketClientConnection</span></code></a> now has a <code class="docutils literal"><span class="pre">close</span></code> method.</li>
</ul>
</div>
<div class="section" id="tornado-wsgi">
<h6><a class="reference internal" href="index.html#module-tornado.wsgi" title="tornado.wsgi"><code class="xref py py-obj docutils literal"><span class="pre">tornado.wsgi</span></code></a><a class="headerlink" href="#tornado-wsgi" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.wsgi.WSGIContainer" title="tornado.wsgi.WSGIContainer"><code class="xref py py-obj docutils literal"><span class="pre">WSGIContainer</span></code></a> now calls the iterable&#8217;s <code class="docutils literal"><span class="pre">close()</span></code> method even if
an error is raised, in compliance with the spec.</li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v3.1.1"></span><div class="section" id="what-s-new-in-tornado-3-1-1">
<h4>What&#8217;s new in Tornado 3.1.1<a class="headerlink" href="#what-s-new-in-tornado-3-1-1" title="Permalink to this headline">¶</a></h4>
<div class="section" id="sep-1-2013">
<h5>Sep 1, 2013<a class="headerlink" href="#sep-1-2013" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> no longer fails if the client requests a <code class="docutils literal"><span class="pre">Range</span></code> that
is larger than the entire file (Facebook has a crawler that does this).</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.on_connection_close" title="tornado.web.RequestHandler.on_connection_close"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.on_connection_close</span></code></a> now works correctly on subsequent
requests of a keep-alive connection.</li>
</ul>
</div>
</div>
<span id="document-releases/v3.1.0"></span><div class="section" id="what-s-new-in-tornado-3-1">
<h4>What&#8217;s new in Tornado 3.1<a class="headerlink" href="#what-s-new-in-tornado-3-1" title="Permalink to this headline">¶</a></h4>
<div class="section" id="jun-15-2013">
<h5>Jun 15, 2013<a class="headerlink" href="#jun-15-2013" title="Permalink to this headline">¶</a></h5>
<div class="section" id="multiple-modules">
<h6>Multiple modules<a class="headerlink" href="#multiple-modules" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Many reference cycles have been broken up throughout the package,
allowing for more efficient garbage collection on CPython.</li>
<li>Silenced some log messages when connections are opened and immediately
closed (i.e. port scans), or other situations related to closed
connections.</li>
<li>Various small speedups: <a class="reference internal" href="index.html#tornado.httputil.HTTPHeaders" title="tornado.httputil.HTTPHeaders"><code class="xref py py-obj docutils literal"><span class="pre">HTTPHeaders</span></code></a> case normalization, <a class="reference internal" href="index.html#tornado.web.UIModule" title="tornado.web.UIModule"><code class="xref py py-obj docutils literal"><span class="pre">UIModule</span></code></a>
proxy objects, precompile some regexes.</li>
</ul>
</div>
<div class="section" id="tornado-auth">
<h6><a class="reference internal" href="index.html#module-tornado.auth" title="tornado.auth"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth</span></code></a><a class="headerlink" href="#tornado-auth" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.auth.OAuthMixin" title="tornado.auth.OAuthMixin"><code class="xref py py-obj docutils literal"><span class="pre">OAuthMixin</span></code></a> always sends <code class="docutils literal"><span class="pre">oauth_version=1.0</span></code> in its
request as required by the spec.</li>
<li><a class="reference internal" href="index.html#tornado.auth.FacebookGraphMixin" title="tornado.auth.FacebookGraphMixin"><code class="xref py py-obj docutils literal"><span class="pre">FacebookGraphMixin</span></code></a> now uses <code class="docutils literal"><span class="pre">self._FACEBOOK_BASE_URL</span></code>
in <a class="reference internal" href="index.html#tornado.auth.FacebookGraphMixin.facebook_request" title="tornado.auth.FacebookGraphMixin.facebook_request"><code class="xref py py-obj docutils literal"><span class="pre">facebook_request</span></code></a> to allow the base url to be
overridden.</li>
<li>The <code class="docutils literal"><span class="pre">authenticate_redirect</span></code> and <code class="docutils literal"><span class="pre">authorize_redirect</span></code> methods in the
<a class="reference internal" href="index.html#module-tornado.auth" title="tornado.auth"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth</span></code></a> mixin classes all now return Futures.  These methods
are asynchronous in <a class="reference internal" href="index.html#tornado.auth.OAuthMixin" title="tornado.auth.OAuthMixin"><code class="xref py py-obj docutils literal"><span class="pre">OAuthMixin</span></code></a> and derived classes, although they
do not take a callback.  The <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> these methods return must be
yielded if they are called from a function decorated with <a class="reference internal" href="index.html#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">gen.coroutine</span></code></a>
(but not <a class="reference internal" href="index.html#tornado.gen.engine" title="tornado.gen.engine"><code class="xref py py-obj docutils literal"><span class="pre">gen.engine</span></code></a>).</li>
<li><a class="reference internal" href="index.html#tornado.auth.TwitterMixin" title="tornado.auth.TwitterMixin"><code class="xref py py-obj docutils literal"><span class="pre">TwitterMixin</span></code></a> now uses <code class="docutils literal"><span class="pre">/account/verify_credentials</span></code> to get information
about the logged-in user, which is more robust against changing screen
names.</li>
<li>The <code class="docutils literal"><span class="pre">demos</span></code> directory (in the source distribution) has a new
<code class="docutils literal"><span class="pre">twitter</span></code> demo using <a class="reference internal" href="index.html#tornado.auth.TwitterMixin" title="tornado.auth.TwitterMixin"><code class="xref py py-obj docutils literal"><span class="pre">TwitterMixin</span></code></a>.</li>
</ul>
</div>
<div class="section" id="tornado-escape">
<h6><a class="reference internal" href="index.html#module-tornado.escape" title="tornado.escape"><code class="xref py py-obj docutils literal"><span class="pre">tornado.escape</span></code></a><a class="headerlink" href="#tornado-escape" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.escape.url_escape" title="tornado.escape.url_escape"><code class="xref py py-obj docutils literal"><span class="pre">url_escape</span></code></a> and <a class="reference internal" href="index.html#tornado.escape.url_unescape" title="tornado.escape.url_unescape"><code class="xref py py-obj docutils literal"><span class="pre">url_unescape</span></code></a> have a new <code class="docutils literal"><span class="pre">plus</span></code> argument (defaulting
to True for consistency with the previous behavior) which specifies
whether they work like <a class="reference external" href="https://docs.python.org/3.4/library/urllib.parse.html#urllib.parse.unquote" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">urllib.parse.unquote</span></code></a> or <a class="reference external" href="https://docs.python.org/3.4/library/urllib.parse.html#urllib.parse.unquote_plus" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">urllib.parse.unquote_plus</span></code></a>.</li>
</ul>
</div>
<div class="section" id="tornado-gen">
<h6><a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a><a class="headerlink" href="#tornado-gen" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Fixed a potential memory leak with long chains of <a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a> coroutines.</li>
</ul>
</div>
<div class="section" id="tornado-httpclient">
<h6><a class="reference internal" href="index.html#module-tornado.httpclient" title="tornado.httpclient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient</span></code></a><a class="headerlink" href="#tornado-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httpclient.HTTPRequest" title="tornado.httpclient.HTTPRequest"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient.HTTPRequest</span></code></a> takes a new argument <code class="docutils literal"><span class="pre">auth_mode</span></code>,
which can be either <code class="docutils literal"><span class="pre">basic</span></code> or <code class="docutils literal"><span class="pre">digest</span></code>.  Digest authentication
is only supported with <code class="docutils literal"><span class="pre">tornado.curl_httpclient</span></code>.</li>
<li><code class="docutils literal"><span class="pre">tornado.curl_httpclient</span></code> no longer goes into an infinite loop when
pycurl returns a negative timeout.</li>
<li><code class="docutils literal"><span class="pre">curl_httpclient</span></code> now supports the <code class="docutils literal"><span class="pre">PATCH</span></code> and <code class="docutils literal"><span class="pre">OPTIONS</span></code> methods
without the use of <code class="docutils literal"><span class="pre">allow_nonstandard_methods=True</span></code>.</li>
<li>Worked around a class of bugs in libcurl that would result in
errors from <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.update_handler" title="tornado.ioloop.IOLoop.update_handler"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.update_handler</span></code></a> in various scenarios including
digest authentication and socks proxies.</li>
<li>The <code class="docutils literal"><span class="pre">TCP_NODELAY</span></code> flag is now set when appropriate in <code class="docutils literal"><span class="pre">simple_httpclient</span></code>.</li>
<li><code class="docutils literal"><span class="pre">simple_httpclient</span></code> no longer logs exceptions, since those exceptions
are made available to the caller as <code class="docutils literal"><span class="pre">HTTPResponse.error</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-httpserver">
<h6><a class="reference internal" href="index.html#module-tornado.httpserver" title="tornado.httpserver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpserver</span></code></a><a class="headerlink" href="#tornado-httpserver" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpserver.HTTPServer</span></code></a> handles malformed HTTP headers more
gracefully.</li>
<li><a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> now supports lists of IPs in <code class="docutils literal"><span class="pre">X-Forwarded-For</span></code>
(it chooses the last, i.e. nearest one).</li>
<li>Memory is now reclaimed promptly on CPython when an HTTP request
fails because it exceeded the maximum upload size.</li>
<li>The <code class="docutils literal"><span class="pre">TCP_NODELAY</span></code> flag is now set when appropriate in <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a>.</li>
<li>The <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> <code class="docutils literal"><span class="pre">no_keep_alive</span></code> option is now respected with
HTTP 1.0 connections that explicitly pass <code class="docutils literal"><span class="pre">Connection:</span> <span class="pre">keep-alive</span></code>.</li>
<li>The <code class="docutils literal"><span class="pre">Connection:</span> <span class="pre">keep-alive</span></code> check for HTTP 1.0 connections is now
case-insensitive.</li>
<li>The <a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#str" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a> and <a class="reference external" href="https://docs.python.org/3.4/library/functions.html#repr" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">repr</span></code></a> of <code class="docutils literal"><span class="pre">tornado.httpserver.HTTPRequest</span></code> no longer
include the request body, reducing log spam on errors (and potential
exposure/retention of private data).</li>
</ul>
</div>
<div class="section" id="tornado-httputil">
<h6><a class="reference internal" href="index.html#module-tornado.httputil" title="tornado.httputil"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httputil</span></code></a><a class="headerlink" href="#tornado-httputil" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The cache used in <a class="reference internal" href="index.html#tornado.httputil.HTTPHeaders" title="tornado.httputil.HTTPHeaders"><code class="xref py py-obj docutils literal"><span class="pre">HTTPHeaders</span></code></a> will no longer grow without bound.</li>
</ul>
</div>
<div class="section" id="tornado-ioloop">
<h6><a class="reference internal" href="index.html#module-tornado.ioloop" title="tornado.ioloop"><code class="xref py py-obj docutils literal"><span class="pre">tornado.ioloop</span></code></a><a class="headerlink" href="#tornado-ioloop" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Some <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> implementations (such as <code class="docutils literal"><span class="pre">pyzmq</span></code>) accept objects
other than integer file descriptors; these objects will now have
their <code class="docutils literal"><span class="pre">.close()</span></code> method called when the <code class="docutils literal"><span class="pre">IOLoop`</span> <span class="pre">is</span> <span class="pre">closed</span> <span class="pre">with</span>
<span class="pre">``all_fds=True</span></code>.</li>
<li>The stub handles left behind by <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.remove_timeout" title="tornado.ioloop.IOLoop.remove_timeout"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.remove_timeout</span></code></a> will now get
cleaned up instead of waiting to expire.</li>
</ul>
</div>
<div class="section" id="tornado-iostream">
<h6><a class="reference internal" href="index.html#module-tornado.iostream" title="tornado.iostream"><code class="xref py py-obj docutils literal"><span class="pre">tornado.iostream</span></code></a><a class="headerlink" href="#tornado-iostream" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Fixed a bug in <a class="reference internal" href="index.html#tornado.iostream.BaseIOStream.read_until_close" title="tornado.iostream.BaseIOStream.read_until_close"><code class="xref py py-obj docutils literal"><span class="pre">BaseIOStream.read_until_close</span></code></a> that would sometimes
cause data to be passed to the final callback instead of the streaming
callback.</li>
<li>The <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> close callback is now run more reliably if there is
an exception in <code class="docutils literal"><span class="pre">_try_inline_read</span></code>.</li>
<li>New method <a class="reference internal" href="index.html#tornado.iostream.BaseIOStream.set_nodelay" title="tornado.iostream.BaseIOStream.set_nodelay"><code class="xref py py-obj docutils literal"><span class="pre">BaseIOStream.set_nodelay</span></code></a> can be used to set the
<code class="docutils literal"><span class="pre">TCP_NODELAY</span></code> flag.</li>
<li>Fixed a case where errors in <code class="docutils literal"><span class="pre">SSLIOStream.connect</span></code> (and
<code class="docutils literal"><span class="pre">SimpleAsyncHTTPClient</span></code>) were not being reported correctly.</li>
</ul>
</div>
<div class="section" id="tornado-locale">
<h6><a class="reference internal" href="index.html#module-tornado.locale" title="tornado.locale"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locale</span></code></a><a class="headerlink" href="#tornado-locale" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.locale.Locale.format_date" title="tornado.locale.Locale.format_date"><code class="xref py py-obj docutils literal"><span class="pre">Locale.format_date</span></code></a> now works on Python 3.</li>
</ul>
</div>
<div class="section" id="tornado-netutil">
<h6><a class="reference internal" href="index.html#module-tornado.netutil" title="tornado.netutil"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil</span></code></a><a class="headerlink" href="#tornado-netutil" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The default <a class="reference internal" href="index.html#tornado.netutil.Resolver" title="tornado.netutil.Resolver"><code class="xref py py-obj docutils literal"><span class="pre">Resolver</span></code></a> implementation now works on Solaris.</li>
<li><a class="reference internal" href="index.html#tornado.netutil.Resolver" title="tornado.netutil.Resolver"><code class="xref py py-obj docutils literal"><span class="pre">Resolver</span></code></a> now has a <a class="reference internal" href="index.html#tornado.netutil.Resolver.close" title="tornado.netutil.Resolver.close"><code class="xref py py-obj docutils literal"><span class="pre">close</span></code></a> method.</li>
<li>Fixed a potential CPU DoS when <code class="docutils literal"><span class="pre">tornado.netutil.ssl_match_hostname</span></code>
is used on certificates with an abusive wildcard pattern.</li>
<li>All instances of <a class="reference internal" href="index.html#tornado.netutil.ThreadedResolver" title="tornado.netutil.ThreadedResolver"><code class="xref py py-obj docutils literal"><span class="pre">ThreadedResolver</span></code></a> now share a single thread pool,
whose size is set by the first one to be created (or the static
<code class="docutils literal"><span class="pre">Resolver.configure</span></code> method).</li>
<li><a class="reference internal" href="index.html#tornado.netutil.ExecutorResolver" title="tornado.netutil.ExecutorResolver"><code class="xref py py-obj docutils literal"><span class="pre">ExecutorResolver</span></code></a> is now documented for public use.</li>
<li><a class="reference internal" href="index.html#tornado.netutil.bind_sockets" title="tornado.netutil.bind_sockets"><code class="xref py py-obj docutils literal"><span class="pre">bind_sockets</span></code></a> now works in configurations with incomplete IPv6 support.</li>
</ul>
</div>
<div class="section" id="tornado-options">
<h6><a class="reference internal" href="index.html#module-tornado.options" title="tornado.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options</span></code></a><a class="headerlink" href="#tornado-options" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.options.define" title="tornado.options.define"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.define</span></code></a> with <code class="docutils literal"><span class="pre">multiple=True</span></code> now works on Python 3.</li>
<li><a class="reference internal" href="index.html#tornado.options.options" title="tornado.options.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.options</span></code></a> and other <a class="reference internal" href="index.html#tornado.options.OptionParser" title="tornado.options.OptionParser"><code class="xref py py-obj docutils literal"><span class="pre">OptionParser</span></code></a> instances support some
new dict-like methods: <a class="reference internal" href="index.html#tornado.options.OptionParser.items" title="tornado.options.OptionParser.items"><code class="xref py py-obj docutils literal"><span class="pre">items()</span></code></a>, iteration over keys,
and (read-only) access to options with square braket syntax.
<a class="reference internal" href="index.html#tornado.options.OptionParser.group_dict" title="tornado.options.OptionParser.group_dict"><code class="xref py py-obj docutils literal"><span class="pre">OptionParser.group_dict</span></code></a> returns all options with a given group
name, and <a class="reference internal" href="index.html#tornado.options.OptionParser.as_dict" title="tornado.options.OptionParser.as_dict"><code class="xref py py-obj docutils literal"><span class="pre">OptionParser.as_dict</span></code></a> returns all options.</li>
</ul>
</div>
<div class="section" id="tornado-process">
<h6><a class="reference internal" href="index.html#module-tornado.process" title="tornado.process"><code class="xref py py-obj docutils literal"><span class="pre">tornado.process</span></code></a><a class="headerlink" href="#tornado-process" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.process.Subprocess" title="tornado.process.Subprocess"><code class="xref py py-obj docutils literal"><span class="pre">tornado.process.Subprocess</span></code></a> no longer leaks file descriptors into
the child process, which fixes a problem in which the child could not
detect that the parent process had closed its stdin pipe.</li>
<li><a class="reference internal" href="index.html#tornado.process.Subprocess.set_exit_callback" title="tornado.process.Subprocess.set_exit_callback"><code class="xref py py-obj docutils literal"><span class="pre">Subprocess.set_exit_callback</span></code></a> now works for subprocesses created
without an explicit <code class="docutils literal"><span class="pre">io_loop</span></code> parameter.</li>
</ul>
</div>
<div class="section" id="tornado-stack-context">
<h6><a class="reference internal" href="index.html#module-tornado.stack_context" title="tornado.stack_context"><code class="xref py py-obj docutils literal"><span class="pre">tornado.stack_context</span></code></a><a class="headerlink" href="#tornado-stack-context" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#module-tornado.stack_context" title="tornado.stack_context"><code class="xref py py-obj docutils literal"><span class="pre">tornado.stack_context</span></code></a> has been rewritten and is now much faster.</li>
<li>New function <a class="reference internal" href="index.html#tornado.stack_context.run_with_stack_context" title="tornado.stack_context.run_with_stack_context"><code class="xref py py-obj docutils literal"><span class="pre">run_with_stack_context</span></code></a> facilitates the use of stack
contexts with coroutines.</li>
</ul>
</div>
<div class="section" id="tornado-tcpserver">
<h6><a class="reference internal" href="index.html#module-tornado.tcpserver" title="tornado.tcpserver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.tcpserver</span></code></a><a class="headerlink" href="#tornado-tcpserver" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The constructors of <a class="reference internal" href="index.html#tornado.tcpserver.TCPServer" title="tornado.tcpserver.TCPServer"><code class="xref py py-obj docutils literal"><span class="pre">TCPServer</span></code></a> and <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> now take a
<code class="docutils literal"><span class="pre">max_buffer_size</span></code> keyword argument.</li>
</ul>
</div>
<div class="section" id="tornado-template">
<h6><a class="reference internal" href="index.html#module-tornado.template" title="tornado.template"><code class="xref py py-obj docutils literal"><span class="pre">tornado.template</span></code></a><a class="headerlink" href="#tornado-template" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Some internal names used by the template system have been changed;
now all &#8220;reserved&#8221; names in templates start with <code class="docutils literal"><span class="pre">_tt_</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-testing">
<h6><a class="reference internal" href="index.html#module-tornado.testing" title="tornado.testing"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing</span></code></a><a class="headerlink" href="#tornado-testing" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.testing.AsyncTestCase.wait" title="tornado.testing.AsyncTestCase.wait"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.AsyncTestCase.wait</span></code></a> now raises the correct exception
when it has been modified by <a class="reference internal" href="index.html#module-tornado.stack_context" title="tornado.stack_context"><code class="xref py py-obj docutils literal"><span class="pre">tornado.stack_context</span></code></a>.</li>
<li><a class="reference internal" href="index.html#tornado.testing.gen_test" title="tornado.testing.gen_test"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.gen_test</span></code></a> can now be called as <code class="docutils literal"><span class="pre">&#64;gen_test(timeout=60)</span></code>
to give some tests a longer timeout than others.</li>
<li>The environment variable <code class="docutils literal"><span class="pre">ASYNC_TEST_TIMEOUT</span></code> can now be set to
override the default timeout for <a class="reference internal" href="index.html#tornado.testing.AsyncTestCase.wait" title="tornado.testing.AsyncTestCase.wait"><code class="xref py py-obj docutils literal"><span class="pre">AsyncTestCase.wait</span></code></a> and <a class="reference internal" href="index.html#tornado.testing.gen_test" title="tornado.testing.gen_test"><code class="xref py py-obj docutils literal"><span class="pre">gen_test</span></code></a>.</li>
<li><a class="reference internal" href="index.html#tornado.testing.bind_unused_port" title="tornado.testing.bind_unused_port"><code class="xref py py-obj docutils literal"><span class="pre">bind_unused_port</span></code></a> now passes <code class="docutils literal"><span class="pre">None</span></code> instead of <code class="docutils literal"><span class="pre">0</span></code> as the port
to <code class="docutils literal"><span class="pre">getaddrinfo</span></code>, which works better with some unusual network
configurations.</li>
</ul>
</div>
<div class="section" id="tornado-util">
<h6><a class="reference internal" href="index.html#module-tornado.util" title="tornado.util"><code class="xref py py-obj docutils literal"><span class="pre">tornado.util</span></code></a><a class="headerlink" href="#tornado-util" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.util.import_object" title="tornado.util.import_object"><code class="xref py py-obj docutils literal"><span class="pre">tornado.util.import_object</span></code></a> now works with top-level module names that
do not contain a dot.</li>
<li><a class="reference internal" href="index.html#tornado.util.import_object" title="tornado.util.import_object"><code class="xref py py-obj docutils literal"><span class="pre">tornado.util.import_object</span></code></a> now consistently raises <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#ImportError" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ImportError</span></code></a>
instead of <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#AttributeError" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">AttributeError</span></code></a> when it fails.</li>
</ul>
</div>
<div class="section" id="tornado-web">
<h6><a class="reference internal" href="index.html#module-tornado.web" title="tornado.web"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web</span></code></a><a class="headerlink" href="#tornado-web" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The <code class="docutils literal"><span class="pre">handlers</span></code> list passed to the <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.Application</span></code></a> constructor
and <a class="reference internal" href="index.html#tornado.web.Application.add_handlers" title="tornado.web.Application.add_handlers"><code class="xref py py-obj docutils literal"><span class="pre">add_handlers</span></code></a> methods can now contain
lists in addition to tuples and <a class="reference internal" href="index.html#tornado.web.URLSpec" title="tornado.web.URLSpec"><code class="xref py py-obj docutils literal"><span class="pre">URLSpec</span></code></a> objects.</li>
<li><a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.StaticFileHandler</span></code></a> now works on Windows when the client
passes an <code class="docutils literal"><span class="pre">If-Modified-Since</span></code> timestamp before 1970.</li>
<li>New method <a class="reference internal" href="index.html#tornado.web.RequestHandler.log_exception" title="tornado.web.RequestHandler.log_exception"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.log_exception</span></code></a> can be overridden to
customize the logging behavior when an exception is uncaught.  Most
apps that currently override <code class="docutils literal"><span class="pre">_handle_request_exception</span></code> can now
use a combination of <a class="reference internal" href="index.html#tornado.web.RequestHandler.log_exception" title="tornado.web.RequestHandler.log_exception"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.log_exception</span></code></a> and
<a class="reference internal" href="index.html#tornado.web.RequestHandler.write_error" title="tornado.web.RequestHandler.write_error"><code class="xref py py-obj docutils literal"><span class="pre">write_error</span></code></a>.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.get_argument" title="tornado.web.RequestHandler.get_argument"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_argument</span></code></a> now raises <a class="reference internal" href="index.html#tornado.web.MissingArgumentError" title="tornado.web.MissingArgumentError"><code class="xref py py-obj docutils literal"><span class="pre">MissingArgumentError</span></code></a>
(a subclass of <a class="reference internal" href="index.html#tornado.web.HTTPError" title="tornado.web.HTTPError"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.HTTPError</span></code></a>, which is what it raised previously)
if the argument cannot be found.</li>
<li><a class="reference internal" href="index.html#tornado.web.Application.reverse_url" title="tornado.web.Application.reverse_url"><code class="xref py py-obj docutils literal"><span class="pre">Application.reverse_url</span></code></a> now uses <a class="reference internal" href="index.html#tornado.escape.url_escape" title="tornado.escape.url_escape"><code class="xref py py-obj docutils literal"><span class="pre">url_escape</span></code></a> with <code class="docutils literal"><span class="pre">plus=False</span></code>,
i.e. spaces are encoded as <code class="docutils literal"><span class="pre">%20</span></code> instead of <code class="docutils literal"><span class="pre">+</span></code>.</li>
<li>Arguments extracted from the url path are now decoded with
<a class="reference internal" href="index.html#tornado.escape.url_unescape" title="tornado.escape.url_unescape"><code class="xref py py-obj docutils literal"><span class="pre">url_unescape</span></code></a> with <code class="docutils literal"><span class="pre">plus=False</span></code>, so plus signs are left as-is
instead of being turned into spaces.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.send_error" title="tornado.web.RequestHandler.send_error"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.send_error</span></code></a> will now only be called once per request,
even if multiple exceptions are caught by the stack context.</li>
<li>The <a class="reference internal" href="index.html#tornado.web.asynchronous" title="tornado.web.asynchronous"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.asynchronous</span></code></a> decorator is no longer necessary for
methods that return a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> (i.e. those that use the <a class="reference internal" href="index.html#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">gen.coroutine</span></code></a>
or <a class="reference internal" href="index.html#tornado.concurrent.return_future" title="tornado.concurrent.return_future"><code class="xref py py-obj docutils literal"><span class="pre">return_future</span></code></a> decorators)</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.prepare" title="tornado.web.RequestHandler.prepare"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.prepare</span></code></a> may now be asynchronous if it returns a
<a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.  The <a class="reference internal" href="index.html#tornado.web.asynchronous" title="tornado.web.asynchronous"><code class="xref py py-obj docutils literal"><span class="pre">asynchronous</span></code></a> decorator is not used with
<code class="docutils literal"><span class="pre">prepare</span></code>; one of the <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>-related decorators should be used instead.</li>
<li><code class="docutils literal"><span class="pre">RequestHandler.current_user</span></code> may now be assigned to normally.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.redirect" title="tornado.web.RequestHandler.redirect"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.redirect</span></code></a> no longer silently strips control characters
and whitespace.  It is now an error to pass control characters, newlines
or tabs.</li>
<li><a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> has been reorganized internally and now has additional
extension points that can be overridden in subclasses.</li>
<li><a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> now supports HTTP <code class="docutils literal"><span class="pre">Range</span></code> requests.
<a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> is still not suitable for files too large to
comfortably fit in memory, but <code class="docutils literal"><span class="pre">Range</span></code> support is necessary in some
browsers to enable seeking of HTML5 audio and video.</li>
<li><a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> now uses longer hashes by default, and uses the same
hashes for <code class="docutils literal"><span class="pre">Etag</span></code> as it does for versioned urls.</li>
<li><a class="reference internal" href="index.html#tornado.web.StaticFileHandler.make_static_url" title="tornado.web.StaticFileHandler.make_static_url"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler.make_static_url</span></code></a> and <a class="reference internal" href="index.html#tornado.web.RequestHandler.static_url" title="tornado.web.RequestHandler.static_url"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.static_url</span></code></a>
now have an additional keyword argument <code class="docutils literal"><span class="pre">include_version</span></code> to suppress
the url versioning.</li>
<li><a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> now reads its file in chunks, which will reduce
memory fragmentation.</li>
<li>Fixed a problem with the <code class="docutils literal"><span class="pre">Date</span></code> header and cookie expiration dates
when the system locale is set to a non-english configuration.</li>
</ul>
</div>
<div class="section" id="tornado-websocket">
<h6><a class="reference internal" href="index.html#module-tornado.websocket" title="tornado.websocket"><code class="xref py py-obj docutils literal"><span class="pre">tornado.websocket</span></code></a><a class="headerlink" href="#tornado-websocket" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler" title="tornado.websocket.WebSocketHandler"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler</span></code></a> now catches <a class="reference internal" href="index.html#tornado.iostream.StreamClosedError" title="tornado.iostream.StreamClosedError"><code class="xref py py-obj docutils literal"><span class="pre">StreamClosedError</span></code></a> and runs
<a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler.on_close" title="tornado.websocket.WebSocketHandler.on_close"><code class="xref py py-obj docutils literal"><span class="pre">on_close</span></code></a> immediately instead of logging a
stack trace.</li>
<li>New method <a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler.set_nodelay" title="tornado.websocket.WebSocketHandler.set_nodelay"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler.set_nodelay</span></code></a> can be used to set the
<code class="docutils literal"><span class="pre">TCP_NODELAY</span></code> flag.</li>
</ul>
</div>
<div class="section" id="tornado-wsgi">
<h6><a class="reference internal" href="index.html#module-tornado.wsgi" title="tornado.wsgi"><code class="xref py py-obj docutils literal"><span class="pre">tornado.wsgi</span></code></a><a class="headerlink" href="#tornado-wsgi" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Fixed an exception in <a class="reference internal" href="index.html#tornado.wsgi.WSGIContainer" title="tornado.wsgi.WSGIContainer"><code class="xref py py-obj docutils literal"><span class="pre">WSGIContainer</span></code></a> when the connection is closed
while output is being written.</li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v3.0.2"></span><div class="section" id="what-s-new-in-tornado-3-0-2">
<h4>What&#8217;s new in Tornado 3.0.2<a class="headerlink" href="#what-s-new-in-tornado-3-0-2" title="Permalink to this headline">¶</a></h4>
<div class="section" id="jun-2-2013">
<h5>Jun 2, 2013<a class="headerlink" href="#jun-2-2013" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.auth.TwitterMixin" title="tornado.auth.TwitterMixin"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth.TwitterMixin</span></code></a> now defaults to version 1.1 of the
Twitter API, instead of version 1.0 which is being <a class="reference external" href="https://dev.twitter.com/calendar">discontinued on
June 11</a>.  It also now uses HTTPS
when talking to Twitter.</li>
<li>Fixed a potential memory leak with a long chain of <a class="reference internal" href="index.html#tornado.gen.coroutine" title="tornado.gen.coroutine"><code class="xref py py-obj docutils literal"><span class="pre">gen.coroutine</span></code></a>
or <a class="reference internal" href="index.html#tornado.gen.engine" title="tornado.gen.engine"><code class="xref py py-obj docutils literal"><span class="pre">gen.engine</span></code></a> functions.</li>
</ul>
</div>
</div>
<span id="document-releases/v3.0.1"></span><div class="section" id="what-s-new-in-tornado-3-0-1">
<h4>What&#8217;s new in Tornado 3.0.1<a class="headerlink" href="#what-s-new-in-tornado-3-0-1" title="Permalink to this headline">¶</a></h4>
<div class="section" id="apr-8-2013">
<h5>Apr 8, 2013<a class="headerlink" href="#apr-8-2013" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>The interface of <a class="reference internal" href="index.html#tornado.auth.FacebookGraphMixin" title="tornado.auth.FacebookGraphMixin"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth.FacebookGraphMixin</span></code></a> is now consistent
with its documentation and the rest of the module.  The
<code class="docutils literal"><span class="pre">get_authenticated_user</span></code> and <code class="docutils literal"><span class="pre">facebook_request</span></code> methods return a
<code class="docutils literal"><span class="pre">Future</span></code> and the <code class="docutils literal"><span class="pre">callback</span></code> argument is optional.</li>
<li>The <a class="reference internal" href="index.html#tornado.testing.gen_test" title="tornado.testing.gen_test"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.gen_test</span></code></a> decorator will no longer be recognized
as a (broken) test by <code class="docutils literal"><span class="pre">nose</span></code>.</li>
<li>Work around a bug in Ubuntu 13.04 betas involving an incomplete backport
of the <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.match_hostname" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.match_hostname</span></code></a> function.</li>
<li><a class="reference internal" href="index.html#tornado.websocket.websocket_connect" title="tornado.websocket.websocket_connect"><code class="xref py py-obj docutils literal"><span class="pre">tornado.websocket.websocket_connect</span></code></a> now fails cleanly when it attempts
to connect to a non-websocket url.</li>
<li><a class="reference internal" href="index.html#tornado.testing.LogTrapTestCase" title="tornado.testing.LogTrapTestCase"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.LogTrapTestCase</span></code></a> once again works with byte strings
on Python 2.</li>
<li>The <code class="docutils literal"><span class="pre">request</span></code> attribute of <a class="reference internal" href="index.html#tornado.httpclient.HTTPResponse" title="tornado.httpclient.HTTPResponse"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient.HTTPResponse</span></code></a> is
now always an <a class="reference internal" href="index.html#tornado.httpclient.HTTPRequest" title="tornado.httpclient.HTTPRequest"><code class="xref py py-obj docutils literal"><span class="pre">HTTPRequest</span></code></a>, never a <code class="docutils literal"><span class="pre">_RequestProxy</span></code>.</li>
<li>Exceptions raised by the <a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a> module now have better messages
when tuples are used as callback keys.</li>
</ul>
</div>
</div>
<span id="document-releases/v3.0.0"></span><div class="section" id="what-s-new-in-tornado-3-0">
<h4>What&#8217;s new in Tornado 3.0<a class="headerlink" href="#what-s-new-in-tornado-3-0" title="Permalink to this headline">¶</a></h4>
<div class="section" id="mar-29-2013">
<h5>Mar 29, 2013<a class="headerlink" href="#mar-29-2013" title="Permalink to this headline">¶</a></h5>
<div class="section" id="highlights">
<h6>Highlights<a class="headerlink" href="#highlights" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>The <code class="docutils literal"><span class="pre">callback</span></code> argument to many asynchronous methods is now
optional, and these methods return a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>.  The <a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a>
module now understands <code class="docutils literal"><span class="pre">Futures</span></code>, and these methods can be used
directly without a <a class="reference internal" href="index.html#tornado.gen.Task" title="tornado.gen.Task"><code class="xref py py-obj docutils literal"><span class="pre">gen.Task</span></code></a> wrapper.</li>
<li>New function <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.current" title="tornado.ioloop.IOLoop.current"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.current</span></code></a> returns the <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> that is running
on the current thread (as opposed to <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.instance" title="tornado.ioloop.IOLoop.instance"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.instance</span></code></a>, which
returns a specific thread&#8217;s (usually the main thread&#8217;s) IOLoop.</li>
<li>New class <a class="reference internal" href="index.html#tornado.netutil.Resolver" title="tornado.netutil.Resolver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil.Resolver</span></code></a> provides an asynchronous
interface to DNS resolution.  The default implementation is still
blocking, but non-blocking implementations are available using one
of three optional dependencies: <a class="reference internal" href="index.html#tornado.netutil.ThreadedResolver" title="tornado.netutil.ThreadedResolver"><code class="xref py py-obj docutils literal"><span class="pre">ThreadedResolver</span></code></a>
using the <a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#module-concurrent.futures" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures</span></code></a> thread pool,
<code class="docutils literal"><span class="pre">tornado.platform.caresresolver.CaresResolver</span></code> using the <code class="docutils literal"><span class="pre">pycares</span></code>
library, or <code class="docutils literal"><span class="pre">tornado.platform.twisted.TwistedResolver</span></code> using <code class="docutils literal"><span class="pre">twisted</span></code></li>
<li>Tornado&#8217;s logging is now less noisy, and it no longer goes directly
to the root logger, allowing for finer-grained configuration.</li>
<li>New class <a class="reference internal" href="index.html#tornado.process.Subprocess" title="tornado.process.Subprocess"><code class="xref py py-obj docutils literal"><span class="pre">tornado.process.Subprocess</span></code></a> wraps <a class="reference external" href="https://docs.python.org/3.4/library/subprocess.html#subprocess.Popen" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">subprocess.Popen</span></code></a> with
<a class="reference internal" href="index.html#tornado.iostream.PipeIOStream" title="tornado.iostream.PipeIOStream"><code class="xref py py-obj docutils literal"><span class="pre">PipeIOStream</span></code></a> access to the child&#8217;s file descriptors.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> now has a static <a class="reference internal" href="index.html#tornado.util.Configurable.configure" title="tornado.util.Configurable.configure"><code class="xref py py-obj docutils literal"><span class="pre">configure</span></code></a>
method like the one on <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a>, which can be used to
select an <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> implementation other than the default.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> can now optionally use a monotonic clock if available
(see below for more details).</li>
</ul>
</div>
<div class="section" id="backwards-incompatible-changes">
<h6>Backwards-incompatible changes<a class="headerlink" href="#backwards-incompatible-changes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Python 2.5 is no longer supported.  Python 3 is now supported in a single
codebase instead of using <code class="docutils literal"><span class="pre">2to3</span></code></li>
<li>The <code class="docutils literal"><span class="pre">tornado.database</span></code> module has been removed.  It is now available
as a separate package, <a class="reference external" href="https://github.com/bdarnell/torndb">torndb</a></li>
<li>Functions that take an <code class="docutils literal"><span class="pre">io_loop</span></code> parameter now default to
<a class="reference internal" href="index.html#tornado.ioloop.IOLoop.current" title="tornado.ioloop.IOLoop.current"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.current()</span></code></a> instead of <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.instance" title="tornado.ioloop.IOLoop.instance"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.instance()</span></code></a>.</li>
<li>Empty HTTP request arguments are no longer ignored.  This applies to
<code class="docutils literal"><span class="pre">HTTPRequest.arguments</span></code> and <code class="docutils literal"><span class="pre">RequestHandler.get_argument[s]</span></code>
in WSGI and non-WSGI modes.</li>
<li>On Python 3, <a class="reference internal" href="index.html#tornado.escape.json_encode" title="tornado.escape.json_encode"><code class="xref py py-obj docutils literal"><span class="pre">tornado.escape.json_encode</span></code></a> no longer accepts byte strings.</li>
<li>On Python 3, the <code class="docutils literal"><span class="pre">get_authenticated_user</span></code> methods in <a class="reference internal" href="index.html#module-tornado.auth" title="tornado.auth"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth</span></code></a>
now return character strings instead of byte strings.</li>
<li><code class="docutils literal"><span class="pre">tornado.netutil.TCPServer</span></code> has moved to its own module,
<a class="reference internal" href="index.html#module-tornado.tcpserver" title="tornado.tcpserver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.tcpserver</span></code></a>.</li>
<li>The Tornado test suite now requires <code class="docutils literal"><span class="pre">unittest2</span></code> when run on Python 2.6.</li>
<li><a class="reference internal" href="index.html#tornado.options.options" title="tornado.options.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.options</span></code></a> is no longer a subclass of <a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#dict" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">dict</span></code></a>; attribute-style
access is now required.</li>
</ul>
</div>
<div class="section" id="detailed-changes-by-module">
<h6>Detailed changes by module<a class="headerlink" href="#detailed-changes-by-module" title="Permalink to this headline">¶</a></h6>
<div class="section" id="multiple-modules">
<h7>Multiple modules<a class="headerlink" href="#multiple-modules" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li>Tornado no longer logs to the root logger.  Details on the new logging
scheme can be found under the <a class="reference internal" href="index.html#module-tornado.log" title="tornado.log"><code class="xref py py-obj docutils literal"><span class="pre">tornado.log</span></code></a> module.  Note that in some
cases this will require that you add an explicit logging configuration
in order to see any output (perhaps just calling <code class="docutils literal"><span class="pre">logging.basicConfig()</span></code>),
although both <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.start" title="tornado.ioloop.IOLoop.start"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.start()</span></code></a> and <a class="reference internal" href="index.html#tornado.options.parse_command_line" title="tornado.options.parse_command_line"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.parse_command_line</span></code></a>
will do this for you.</li>
<li>On python 3.2+, methods that take an <code class="docutils literal"><span class="pre">ssl_options</span></code> argument (on
<a class="reference internal" href="index.html#tornado.iostream.SSLIOStream" title="tornado.iostream.SSLIOStream"><code class="xref py py-obj docutils literal"><span class="pre">SSLIOStream</span></code></a>, <a class="reference internal" href="index.html#tornado.tcpserver.TCPServer" title="tornado.tcpserver.TCPServer"><code class="xref py py-obj docutils literal"><span class="pre">TCPServer</span></code></a>, and <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a>) now accept either a
dictionary of options or an <a class="reference external" href="https://docs.python.org/3.4/library/ssl.html#ssl.SSLContext" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">ssl.SSLContext</span></code></a> object.</li>
<li>New optional dependency on <a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#module-concurrent.futures" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures</span></code></a> to provide better support
for working with threads.  <a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#module-concurrent.futures" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures</span></code></a> is in the standard library
for Python 3.2+, and can be installed on older versions with
<code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">futures</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-autoreload">
<h7><a class="reference internal" href="index.html#module-tornado.autoreload" title="tornado.autoreload"><code class="xref py py-obj docutils literal"><span class="pre">tornado.autoreload</span></code></a><a class="headerlink" href="#tornado-autoreload" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li><a class="reference internal" href="index.html#module-tornado.autoreload" title="tornado.autoreload"><code class="xref py py-obj docutils literal"><span class="pre">tornado.autoreload</span></code></a> is now more reliable when there are errors at import
time.</li>
<li>Calling <a class="reference internal" href="index.html#tornado.autoreload.start" title="tornado.autoreload.start"><code class="xref py py-obj docutils literal"><span class="pre">tornado.autoreload.start</span></code></a> (or creating an <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a> with
<code class="docutils literal"><span class="pre">debug=True</span></code>) twice on the same <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> now does nothing (instead of
creating multiple periodic callbacks).  Starting autoreload on
more than one <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> in the same process now logs a warning.</li>
<li>Scripts run by autoreload no longer inherit <code class="docutils literal"><span class="pre">__future__</span></code> imports
used by Tornado.</li>
</ul>
</div>
<div class="section" id="tornado-auth">
<h7><a class="reference internal" href="index.html#module-tornado.auth" title="tornado.auth"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth</span></code></a><a class="headerlink" href="#tornado-auth" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li>On Python 3, the <code class="docutils literal"><span class="pre">get_authenticated_user</span></code> method family now returns
character strings instead of byte strings.</li>
<li>Asynchronous methods defined in <a class="reference internal" href="index.html#module-tornado.auth" title="tornado.auth"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth</span></code></a> now return a
<a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>, and their <code class="docutils literal"><span class="pre">callback</span></code> argument is optional.  The
<code class="docutils literal"><span class="pre">Future</span></code> interface is preferred as it offers better error handling
(the previous interface just logged a warning and returned None).</li>
<li>The <a class="reference internal" href="index.html#module-tornado.auth" title="tornado.auth"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth</span></code></a> mixin classes now define a method
<code class="docutils literal"><span class="pre">get_auth_http_client</span></code>, which can be overridden to use a non-default
<a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> instance (e.g. to use a different <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>)</li>
<li>Subclasses of <a class="reference internal" href="index.html#tornado.auth.OAuthMixin" title="tornado.auth.OAuthMixin"><code class="xref py py-obj docutils literal"><span class="pre">OAuthMixin</span></code></a> are encouraged to override
<a class="reference internal" href="index.html#tornado.auth.OAuthMixin._oauth_get_user_future" title="tornado.auth.OAuthMixin._oauth_get_user_future"><code class="xref py py-obj docutils literal"><span class="pre">OAuthMixin._oauth_get_user_future</span></code></a> instead of <code class="docutils literal"><span class="pre">_oauth_get_user</span></code>,
although both methods are still supported.</li>
</ul>
</div>
<div class="section" id="tornado-concurrent">
<h7><a class="reference internal" href="index.html#module-tornado.concurrent" title="tornado.concurrent"><code class="xref py py-obj docutils literal"><span class="pre">tornado.concurrent</span></code></a><a class="headerlink" href="#tornado-concurrent" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li>New module <a class="reference internal" href="index.html#module-tornado.concurrent" title="tornado.concurrent"><code class="xref py py-obj docutils literal"><span class="pre">tornado.concurrent</span></code></a> contains code to support working with
<a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#module-concurrent.futures" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures</span></code></a>, or to emulate future-based interface when that module
is not available.</li>
</ul>
</div>
<div class="section" id="tornado-curl-httpclient">
<h7><code class="docutils literal"><span class="pre">tornado.curl_httpclient</span></code><a class="headerlink" href="#tornado-curl-httpclient" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li>Preliminary support for <code class="docutils literal"><span class="pre">tornado.curl_httpclient</span></code> on Python 3.  The latest
official release of pycurl only supports Python 2, but Ubuntu has a
port available in 12.10 (<code class="docutils literal"><span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">python3-pycurl</span></code>).  This port
currently has bugs that prevent it from handling arbitrary binary data
but it should work for textual (utf8) resources.</li>
<li>Fix a crash with libcurl 7.29.0 if a curl object is created and closed
without being used.</li>
</ul>
</div>
<div class="section" id="tornado-escape">
<h7><a class="reference internal" href="index.html#module-tornado.escape" title="tornado.escape"><code class="xref py py-obj docutils literal"><span class="pre">tornado.escape</span></code></a><a class="headerlink" href="#tornado-escape" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li>On Python 3, <a class="reference internal" href="index.html#tornado.escape.json_encode" title="tornado.escape.json_encode"><code class="xref py py-obj docutils literal"><span class="pre">json_encode</span></code></a> no longer accepts byte strings.
This mirrors the behavior of the underlying json module.  Python 2 behavior
is unchanged but should be faster.</li>
</ul>
</div>
<div class="section" id="tornado-gen">
<h7><a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a><a class="headerlink" href="#tornado-gen" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li>New decorator <code class="docutils literal"><span class="pre">&#64;gen.coroutine</span></code> is available as an alternative to
<code class="docutils literal"><span class="pre">&#64;gen.engine</span></code>.  It automatically returns a
<a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a>, and within the function instead of
calling a callback you return a value with <code class="docutils literal"><span class="pre">raise</span>
<span class="pre">gen.Return(value)</span></code> (or simply <code class="docutils literal"><span class="pre">return</span> <span class="pre">value</span></code> in Python 3.3).</li>
<li>Generators may now yield <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> objects.</li>
<li>Callbacks produced by <a class="reference internal" href="index.html#tornado.gen.Callback" title="tornado.gen.Callback"><code class="xref py py-obj docutils literal"><span class="pre">gen.Callback</span></code></a> and <a class="reference internal" href="index.html#tornado.gen.Task" title="tornado.gen.Task"><code class="xref py py-obj docutils literal"><span class="pre">gen.Task</span></code></a> are now automatically
stack-context-wrapped, to minimize the risk of context leaks when used
with asynchronous functions that don&#8217;t do their own wrapping.</li>
<li>Fixed a memory leak involving generators, <a class="reference internal" href="index.html#tornado.web.RequestHandler.flush" title="tornado.web.RequestHandler.flush"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.flush</span></code></a>,
and clients closing connections while output is being written.</li>
<li>Yielding a large list no longer has quadratic performance.</li>
</ul>
</div>
<div class="section" id="tornado-httpclient">
<h7><a class="reference internal" href="index.html#module-tornado.httpclient" title="tornado.httpclient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient</span></code></a><a class="headerlink" href="#tornado-httpclient" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient.fetch" title="tornado.httpclient.AsyncHTTPClient.fetch"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient.fetch</span></code></a> now returns a <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> and its callback argument
is optional.  When the future interface is used, any error will be raised
automatically, as if <a class="reference internal" href="index.html#tornado.httpclient.HTTPResponse.rethrow" title="tornado.httpclient.HTTPResponse.rethrow"><code class="xref py py-obj docutils literal"><span class="pre">HTTPResponse.rethrow</span></code></a> was called.</li>
<li><a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient.configure" title="tornado.httpclient.AsyncHTTPClient.configure"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient.configure</span></code></a> and all <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> constructors
now take a <code class="docutils literal"><span class="pre">defaults</span></code> keyword argument.  This argument should be a
dictionary, and its values will be used in place of corresponding
attributes of <a class="reference internal" href="index.html#tornado.httpclient.HTTPRequest" title="tornado.httpclient.HTTPRequest"><code class="xref py py-obj docutils literal"><span class="pre">HTTPRequest</span></code></a> that are not set.</li>
<li>All unset attributes of <a class="reference internal" href="index.html#tornado.httpclient.HTTPRequest" title="tornado.httpclient.HTTPRequest"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient.HTTPRequest</span></code></a> are now
<code class="docutils literal"><span class="pre">None</span></code>.  The default values of some attributes
(<code class="docutils literal"><span class="pre">connect_timeout</span></code>, <code class="docutils literal"><span class="pre">request_timeout</span></code>, <code class="docutils literal"><span class="pre">follow_redirects</span></code>,
<code class="docutils literal"><span class="pre">max_redirects</span></code>, <code class="docutils literal"><span class="pre">use_gzip</span></code>, <code class="docutils literal"><span class="pre">proxy_password</span></code>,
<code class="docutils literal"><span class="pre">allow_nonstandard_methods</span></code>, and <code class="docutils literal"><span class="pre">validate_cert</span></code> have been moved
from <a class="reference internal" href="index.html#tornado.httpclient.HTTPRequest" title="tornado.httpclient.HTTPRequest"><code class="xref py py-obj docutils literal"><span class="pre">HTTPRequest</span></code></a> to the client
implementations.</li>
<li>The <code class="docutils literal"><span class="pre">max_clients</span></code> argument to <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> is now a keyword-only
argument.</li>
<li>Keyword arguments to <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient.configure" title="tornado.httpclient.AsyncHTTPClient.configure"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient.configure</span></code></a> are no longer used
when instantiating an implementation subclass directly.</li>
<li>Secondary <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a> callbacks (<code class="docutils literal"><span class="pre">streaming_callback</span></code>,
<code class="docutils literal"><span class="pre">header_callback</span></code>, and <code class="docutils literal"><span class="pre">prepare_curl_callback</span></code>) now respect
<a class="reference internal" href="index.html#tornado.stack_context.StackContext" title="tornado.stack_context.StackContext"><code class="xref py py-obj docutils literal"><span class="pre">StackContext</span></code></a>.</li>
</ul>
</div>
<div class="section" id="tornado-httpserver">
<h7><a class="reference internal" href="index.html#module-tornado.httpserver" title="tornado.httpserver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpserver</span></code></a><a class="headerlink" href="#tornado-httpserver" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> no longer logs an error when it is unable to read a second
request from an HTTP 1.1 keep-alive connection.</li>
<li><a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> now takes a <code class="docutils literal"><span class="pre">protocol</span></code> keyword argument which can be set
to <code class="docutils literal"><span class="pre">https</span></code> if the server is behind an SSL-decoding proxy that does not
set any supported X-headers.</li>
<li><code class="docutils literal"><span class="pre">tornado.httpserver.HTTPConnection</span></code> now has a <code class="docutils literal"><span class="pre">set_close_callback</span></code>
method that should be used instead of reaching into its <code class="docutils literal"><span class="pre">stream</span></code>
attribute.</li>
<li>Empty HTTP request arguments are no longer ignored.  This applies to
<code class="docutils literal"><span class="pre">HTTPRequest.arguments</span></code> and <code class="docutils literal"><span class="pre">RequestHandler.get_argument[s]</span></code>
in WSGI and non-WSGI modes.</li>
</ul>
</div>
<div class="section" id="tornado-ioloop">
<h7><a class="reference internal" href="index.html#module-tornado.ioloop" title="tornado.ioloop"><code class="xref py py-obj docutils literal"><span class="pre">tornado.ioloop</span></code></a><a class="headerlink" href="#tornado-ioloop" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li>New function <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.current" title="tornado.ioloop.IOLoop.current"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.current</span></code></a> returns the <code class="docutils literal"><span class="pre">IOLoop</span></code> that is running
on the current thread (as opposed to <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.instance" title="tornado.ioloop.IOLoop.instance"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.instance</span></code></a>, which returns a
specific thread&#8217;s (usually the main thread&#8217;s) IOLoop).</li>
<li>New method <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_future" title="tornado.ioloop.IOLoop.add_future"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_future</span></code></a> to run a callback on the IOLoop when
an asynchronous <a class="reference internal" href="index.html#tornado.concurrent.Future" title="tornado.concurrent.Future"><code class="xref py py-obj docutils literal"><span class="pre">Future</span></code></a> finishes.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> now has a static <a class="reference internal" href="index.html#tornado.util.Configurable.configure" title="tornado.util.Configurable.configure"><code class="xref py py-obj docutils literal"><span class="pre">configure</span></code></a>
method like the one on <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a>, which can be used to
select an <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> implementation other than the default.</li>
<li>The <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> poller implementations (<code class="docutils literal"><span class="pre">select</span></code>, <code class="docutils literal"><span class="pre">epoll</span></code>, <code class="docutils literal"><span class="pre">kqueue</span></code>)
are now available as distinct subclasses of <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a>.  Instantiating
<a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> will continue to automatically choose the best available
implementation.</li>
<li>The <a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> constructor has a new keyword argument <code class="docutils literal"><span class="pre">time_func</span></code>,
which can be used to set the time function used when scheduling callbacks.
This is most useful with the <a class="reference external" href="https://docs.python.org/3.4/library/time.html#time.monotonic" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">time.monotonic</span></code></a> function, introduced
in Python 3.3 and backported to older versions via the <code class="docutils literal"><span class="pre">monotime</span></code>
module.  Using a monotonic clock here avoids problems when the system
clock is changed.</li>
<li>New function <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.time" title="tornado.ioloop.IOLoop.time"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.time</span></code></a> returns the current time according to the
IOLoop.  To use the new monotonic clock functionality, all calls to
<a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_timeout" title="tornado.ioloop.IOLoop.add_timeout"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_timeout</span></code></a> must be either pass a <a class="reference external" href="https://docs.python.org/3.4/library/datetime.html#datetime.timedelta" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">datetime.timedelta</span></code></a> or
a time relative to <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.time" title="tornado.ioloop.IOLoop.time"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.time</span></code></a>, not <a class="reference external" href="https://docs.python.org/3.4/library/time.html#time.time" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">time.time</span></code></a>.  (<a class="reference external" href="https://docs.python.org/3.4/library/time.html#time.time" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">time.time</span></code></a> will
continue to work only as long as the IOLoop&#8217;s <code class="docutils literal"><span class="pre">time_func</span></code> argument
is not used).</li>
<li>New convenience method <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.run_sync" title="tornado.ioloop.IOLoop.run_sync"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.run_sync</span></code></a> can be used to start an IOLoop
just long enough to run a single coroutine.</li>
<li>New method <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_callback_from_signal" title="tornado.ioloop.IOLoop.add_callback_from_signal"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_callback_from_signal</span></code></a> is safe to use in a signal
handler (the regular <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_callback" title="tornado.ioloop.IOLoop.add_callback"><code class="xref py py-obj docutils literal"><span class="pre">add_callback</span></code></a> method may deadlock).</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> now uses <a class="reference external" href="https://docs.python.org/3.4/library/signal.html#signal.set_wakeup_fd" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">signal.set_wakeup_fd</span></code></a> where available (Python 2.6+
on Unix) to avoid a race condition that could result in Python signal
handlers being delayed.</li>
<li>Method <code class="docutils literal"><span class="pre">IOLoop.running()</span></code> has been removed.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop</span></code></a> has been refactored to better support subclassing.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_callback" title="tornado.ioloop.IOLoop.add_callback"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_callback</span></code></a> and <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_callback_from_signal" title="tornado.ioloop.IOLoop.add_callback_from_signal"><code class="xref py py-obj docutils literal"><span class="pre">add_callback_from_signal</span></code></a> now take
<code class="docutils literal"><span class="pre">*args,</span> <span class="pre">**kwargs</span></code> to pass along to the callback.</li>
</ul>
</div>
<div class="section" id="tornado-iostream">
<h7><a class="reference internal" href="index.html#module-tornado.iostream" title="tornado.iostream"><code class="xref py py-obj docutils literal"><span class="pre">tornado.iostream</span></code></a><a class="headerlink" href="#tornado-iostream" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.iostream.IOStream.connect" title="tornado.iostream.IOStream.connect"><code class="xref py py-obj docutils literal"><span class="pre">IOStream.connect</span></code></a> now has an optional <code class="docutils literal"><span class="pre">server_hostname</span></code> argument
which will be used for SSL certificate validation when applicable.
Additionally, when supported (on Python 3.2+), this hostname
will be sent via SNI (and this is supported by <code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code>)</li>
<li>Much of <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> has been refactored into a separate class
<a class="reference internal" href="index.html#tornado.iostream.BaseIOStream" title="tornado.iostream.BaseIOStream"><code class="xref py py-obj docutils literal"><span class="pre">BaseIOStream</span></code></a>.</li>
<li>New class <a class="reference internal" href="index.html#tornado.iostream.PipeIOStream" title="tornado.iostream.PipeIOStream"><code class="xref py py-obj docutils literal"><span class="pre">tornado.iostream.PipeIOStream</span></code></a> provides the IOStream
interface on pipe file descriptors.</li>
<li><a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> now raises a new exception
<code class="docutils literal"><span class="pre">tornado.iostream.StreamClosedError</span></code> when you attempt to read or
write after the stream has been closed (by either side).</li>
<li><a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> now simply closes the connection when it gets an
<code class="docutils literal"><span class="pre">ECONNRESET</span></code> error, rather than logging it as an error.</li>
<li><code class="docutils literal"><span class="pre">IOStream.error</span></code> no longer picks up unrelated exceptions.</li>
<li><a class="reference internal" href="index.html#tornado.iostream.BaseIOStream.close" title="tornado.iostream.BaseIOStream.close"><code class="xref py py-obj docutils literal"><span class="pre">BaseIOStream.close</span></code></a> now has an <code class="docutils literal"><span class="pre">exc_info</span></code> argument (similar to the
one used in the <a class="reference external" href="https://docs.python.org/3.4/library/logging.html#module-logging" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">logging</span></code></a> module) that can be used to set the stream&#8217;s
<code class="docutils literal"><span class="pre">error</span></code> attribute when closing it.</li>
<li><a class="reference internal" href="index.html#tornado.iostream.BaseIOStream.read_until_close" title="tornado.iostream.BaseIOStream.read_until_close"><code class="xref py py-obj docutils literal"><span class="pre">BaseIOStream.read_until_close</span></code></a> now works correctly when it is called
while there is buffered data.</li>
<li>Fixed a major performance regression when run on PyPy (introduced in
Tornado 2.3).</li>
</ul>
</div>
<div class="section" id="tornado-log">
<h7><a class="reference internal" href="index.html#module-tornado.log" title="tornado.log"><code class="xref py py-obj docutils literal"><span class="pre">tornado.log</span></code></a><a class="headerlink" href="#tornado-log" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li>New module containing <a class="reference internal" href="index.html#tornado.log.enable_pretty_logging" title="tornado.log.enable_pretty_logging"><code class="xref py py-obj docutils literal"><span class="pre">enable_pretty_logging</span></code></a> and <a class="reference internal" href="index.html#tornado.log.LogFormatter" title="tornado.log.LogFormatter"><code class="xref py py-obj docutils literal"><span class="pre">LogFormatter</span></code></a>,
moved from the options module.</li>
<li><a class="reference internal" href="index.html#tornado.log.LogFormatter" title="tornado.log.LogFormatter"><code class="xref py py-obj docutils literal"><span class="pre">LogFormatter</span></code></a> now handles non-ascii data in messages and tracebacks better.</li>
</ul>
</div>
<div class="section" id="tornado-netutil">
<h7><a class="reference internal" href="index.html#module-tornado.netutil" title="tornado.netutil"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil</span></code></a><a class="headerlink" href="#tornado-netutil" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li>New class <a class="reference internal" href="index.html#tornado.netutil.Resolver" title="tornado.netutil.Resolver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil.Resolver</span></code></a> provides an asynchronous
interface to DNS resolution.  The default implementation is still
blocking, but non-blocking implementations are available using one
of three optional dependencies: <a class="reference internal" href="index.html#tornado.netutil.ThreadedResolver" title="tornado.netutil.ThreadedResolver"><code class="xref py py-obj docutils literal"><span class="pre">ThreadedResolver</span></code></a>
using the <a class="reference external" href="https://docs.python.org/3.4/library/concurrent.futures.html#module-concurrent.futures" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">concurrent.futures</span></code></a> thread pool,
<a class="reference internal" href="index.html#tornado.platform.caresresolver.CaresResolver" title="tornado.platform.caresresolver.CaresResolver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.caresresolver.CaresResolver</span></code></a> using the <code class="docutils literal"><span class="pre">pycares</span></code>
library, or <a class="reference internal" href="index.html#tornado.platform.twisted.TwistedResolver" title="tornado.platform.twisted.TwistedResolver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.twisted.TwistedResolver</span></code></a> using <code class="docutils literal"><span class="pre">twisted</span></code></li>
<li>New function <a class="reference internal" href="index.html#tornado.netutil.is_valid_ip" title="tornado.netutil.is_valid_ip"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil.is_valid_ip</span></code></a> returns true if a given string
is a valid IP (v4 or v6) address.</li>
<li><a class="reference internal" href="index.html#tornado.netutil.bind_sockets" title="tornado.netutil.bind_sockets"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil.bind_sockets</span></code></a> has a new <code class="docutils literal"><span class="pre">flags</span></code> argument that can
be used to pass additional flags to <code class="docutils literal"><span class="pre">getaddrinfo</span></code>.</li>
<li><a class="reference internal" href="index.html#tornado.netutil.bind_sockets" title="tornado.netutil.bind_sockets"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil.bind_sockets</span></code></a> no longer sets <code class="docutils literal"><span class="pre">AI_ADDRCONFIG</span></code>; this will
cause it to bind to both ipv4 and ipv6 more often than before.</li>
<li><a class="reference internal" href="index.html#tornado.netutil.bind_sockets" title="tornado.netutil.bind_sockets"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil.bind_sockets</span></code></a> now works when Python was compiled
with <code class="docutils literal"><span class="pre">--disable-ipv6</span></code> but IPv6 DNS resolution is available on the
system.</li>
<li><code class="docutils literal"><span class="pre">tornado.netutil.TCPServer</span></code> has moved to its own module, <a class="reference internal" href="index.html#module-tornado.tcpserver" title="tornado.tcpserver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.tcpserver</span></code></a>.</li>
</ul>
</div>
<div class="section" id="tornado-options">
<h7><a class="reference internal" href="index.html#module-tornado.options" title="tornado.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options</span></code></a><a class="headerlink" href="#tornado-options" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li>The class underlying the functions in <a class="reference internal" href="index.html#module-tornado.options" title="tornado.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options</span></code></a> is now public
(<a class="reference internal" href="index.html#tornado.options.OptionParser" title="tornado.options.OptionParser"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.OptionParser</span></code></a>).  This can be used to create multiple
independent option sets, such as for subcommands.</li>
<li><a class="reference internal" href="index.html#tornado.options.parse_config_file" title="tornado.options.parse_config_file"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.parse_config_file</span></code></a> now configures logging automatically
by default, in the same way that <a class="reference internal" href="index.html#tornado.options.parse_command_line" title="tornado.options.parse_command_line"><code class="xref py py-obj docutils literal"><span class="pre">parse_command_line</span></code></a> does.</li>
<li>New function <a class="reference internal" href="index.html#tornado.options.add_parse_callback" title="tornado.options.add_parse_callback"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.add_parse_callback</span></code></a> schedules a callback
to be run after the command line or config file has been parsed.  The
keyword argument <code class="docutils literal"><span class="pre">final=False</span></code> can be used on either parsing function
to supress these callbacks.</li>
<li><a class="reference internal" href="index.html#tornado.options.define" title="tornado.options.define"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.define</span></code></a> now takes a <code class="docutils literal"><span class="pre">callback</span></code> argument.  This callback
will be run with the new value whenever the option is changed.  This is
especially useful for options that set other options, such as by reading
from a config file.</li>
<li><a class="reference internal" href="index.html#tornado.options.parse_command_line" title="tornado.options.parse_command_line"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.parse_command_line</span></code></a> <code class="docutils literal"><span class="pre">--help</span></code> output now goes to <code class="docutils literal"><span class="pre">stderr</span></code>
rather than <code class="docutils literal"><span class="pre">stdout</span></code>.</li>
<li><a class="reference internal" href="index.html#tornado.options.options" title="tornado.options.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.options</span></code></a> is no longer a subclass of <a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#dict" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">dict</span></code></a>; attribute-style
access is now required.</li>
<li><a class="reference internal" href="index.html#tornado.options.options" title="tornado.options.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.options</span></code></a> (and <a class="reference internal" href="index.html#tornado.options.OptionParser" title="tornado.options.OptionParser"><code class="xref py py-obj docutils literal"><span class="pre">OptionParser</span></code></a> instances generally) now
have a <a class="reference internal" href="index.html#tornado.options.OptionParser.mockable" title="tornado.options.OptionParser.mockable"><code class="xref py py-obj docutils literal"><span class="pre">mockable()</span></code></a> method that returns a wrapper object compatible with
<a class="reference external" href="https://docs.python.org/3.4/library/unittest.mock.html#unittest.mock.patch" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">mock.patch</span></code></a>.</li>
<li>Function <code class="docutils literal"><span class="pre">tornado.options.enable_pretty_logging</span></code> has been moved to the
<a class="reference internal" href="index.html#module-tornado.log" title="tornado.log"><code class="xref py py-obj docutils literal"><span class="pre">tornado.log</span></code></a> module.</li>
</ul>
</div>
<div class="section" id="tornado-platform-caresresolver">
<h7><a class="reference internal" href="index.html#module-tornado.platform.caresresolver" title="tornado.platform.caresresolver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.caresresolver</span></code></a><a class="headerlink" href="#tornado-platform-caresresolver" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li>New module containing an asynchronous implementation of the <a class="reference internal" href="index.html#tornado.netutil.Resolver" title="tornado.netutil.Resolver"><code class="xref py py-obj docutils literal"><span class="pre">Resolver</span></code></a>
interface, using the <code class="docutils literal"><span class="pre">pycares</span></code> library.</li>
</ul>
</div>
<div class="section" id="tornado-platform-twisted">
<h7><a class="reference internal" href="index.html#module-tornado.platform.twisted" title="tornado.platform.twisted"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.twisted</span></code></a><a class="headerlink" href="#tornado-platform-twisted" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li>New class <a class="reference internal" href="index.html#tornado.platform.twisted.TwistedIOLoop" title="tornado.platform.twisted.TwistedIOLoop"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.twisted.TwistedIOLoop</span></code></a> allows Tornado
code to be run on the Twisted reactor (as opposed to the existing
<a class="reference internal" href="index.html#tornado.platform.twisted.TornadoReactor" title="tornado.platform.twisted.TornadoReactor"><code class="xref py py-obj docutils literal"><span class="pre">TornadoReactor</span></code></a>, which bridges the gap in the other direction).</li>
<li>New class <a class="reference internal" href="index.html#tornado.platform.twisted.TwistedResolver" title="tornado.platform.twisted.TwistedResolver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.twisted.TwistedResolver</span></code></a> is an asynchronous
implementation of the <a class="reference internal" href="index.html#tornado.netutil.Resolver" title="tornado.netutil.Resolver"><code class="xref py py-obj docutils literal"><span class="pre">Resolver</span></code></a> interface.</li>
</ul>
</div>
<div class="section" id="tornado-process">
<h7><a class="reference internal" href="index.html#module-tornado.process" title="tornado.process"><code class="xref py py-obj docutils literal"><span class="pre">tornado.process</span></code></a><a class="headerlink" href="#tornado-process" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li>New class <a class="reference internal" href="index.html#tornado.process.Subprocess" title="tornado.process.Subprocess"><code class="xref py py-obj docutils literal"><span class="pre">tornado.process.Subprocess</span></code></a> wraps <a class="reference external" href="https://docs.python.org/3.4/library/subprocess.html#subprocess.Popen" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">subprocess.Popen</span></code></a> with
<a class="reference internal" href="index.html#tornado.iostream.PipeIOStream" title="tornado.iostream.PipeIOStream"><code class="xref py py-obj docutils literal"><span class="pre">PipeIOStream</span></code></a> access to the child&#8217;s file descriptors.</li>
</ul>
</div>
<div class="section" id="tornado-simple-httpclient">
<h7><code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code><a class="headerlink" href="#tornado-simple-httpclient" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">SimpleAsyncHTTPClient</span></code> now takes a <code class="docutils literal"><span class="pre">resolver</span></code> keyword argument
(which may be passed to either the constructor or <a class="reference internal" href="index.html#tornado.util.Configurable.configure" title="tornado.util.Configurable.configure"><code class="xref py py-obj docutils literal"><span class="pre">configure</span></code></a>), to allow it to use the new non-blocking
<a class="reference internal" href="index.html#tornado.netutil.Resolver" title="tornado.netutil.Resolver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil.Resolver</span></code></a>.</li>
<li>When following redirects, <code class="docutils literal"><span class="pre">SimpleAsyncHTTPClient</span></code> now treats a 302
response code the same as a 303.  This is contrary to the HTTP spec
but consistent with all browsers and other major HTTP clients
(including <code class="docutils literal"><span class="pre">CurlAsyncHTTPClient</span></code>).</li>
<li>The behavior of <code class="docutils literal"><span class="pre">header_callback</span></code> with <code class="docutils literal"><span class="pre">SimpleAsyncHTTPClient</span></code> has
changed and is now the same as that of <code class="docutils literal"><span class="pre">CurlAsyncHTTPClient</span></code>.  The
header callback now receives the first line of the response (e.g.
<code class="docutils literal"><span class="pre">HTTP/1.0</span> <span class="pre">200</span> <span class="pre">OK</span></code>) and the final empty line.</li>
<li><code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code> now accepts responses with a 304
status code that include a <code class="docutils literal"><span class="pre">Content-Length</span></code> header.</li>
<li>Fixed a bug in which <code class="docutils literal"><span class="pre">SimpleAsyncHTTPClient</span></code> callbacks were being run in the
client&#8217;s <code class="docutils literal"><span class="pre">stack_context</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-stack-context">
<h7><a class="reference internal" href="index.html#module-tornado.stack_context" title="tornado.stack_context"><code class="xref py py-obj docutils literal"><span class="pre">tornado.stack_context</span></code></a><a class="headerlink" href="#tornado-stack-context" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.stack_context.wrap" title="tornado.stack_context.wrap"><code class="xref py py-obj docutils literal"><span class="pre">stack_context.wrap</span></code></a> now runs the wrapped callback in a more consistent
environment by recreating contexts even if they already exist on the
stack.</li>
<li>Fixed a bug in which stack contexts could leak from one callback
chain to another.</li>
<li>Yield statements inside a <code class="docutils literal"><span class="pre">with</span></code> statement can cause stack
contexts to become inconsistent; an exception will now be raised
when this case is detected.</li>
</ul>
</div>
<div class="section" id="tornado-template">
<h7><a class="reference internal" href="index.html#module-tornado.template" title="tornado.template"><code class="xref py py-obj docutils literal"><span class="pre">tornado.template</span></code></a><a class="headerlink" href="#tornado-template" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li>Errors while rendering templates no longer log the generated code,
since the enhanced stack traces (from version 2.1) should make this
unnecessary.</li>
<li>The <code class="docutils literal"><span class="pre">{%</span> <span class="pre">apply</span> <span class="pre">%}</span></code> directive now works properly with functions that return
both unicode strings and byte strings (previously only byte strings were
supported).</li>
<li>Code in templates is no longer affected by Tornado&#8217;s <code class="docutils literal"><span class="pre">__future__</span></code> imports
(which previously included <code class="docutils literal"><span class="pre">absolute_import</span></code> and <code class="docutils literal"><span class="pre">division</span></code>).</li>
</ul>
</div>
<div class="section" id="tornado-testing">
<h7><a class="reference internal" href="index.html#module-tornado.testing" title="tornado.testing"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing</span></code></a><a class="headerlink" href="#tornado-testing" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li>New function <a class="reference internal" href="index.html#tornado.testing.bind_unused_port" title="tornado.testing.bind_unused_port"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.bind_unused_port</span></code></a> both chooses a port
and binds a socket to it, so there is no risk of another process
using the same port.  <code class="docutils literal"><span class="pre">get_unused_port</span></code> is now deprecated.</li>
<li>New decorator <a class="reference internal" href="index.html#tornado.testing.gen_test" title="tornado.testing.gen_test"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.gen_test</span></code></a> can be used to allow for
yielding <a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a> objects in tests, as an alternative to the
<code class="docutils literal"><span class="pre">stop</span></code> and <code class="docutils literal"><span class="pre">wait</span></code> methods of <a class="reference internal" href="index.html#tornado.testing.AsyncTestCase" title="tornado.testing.AsyncTestCase"><code class="xref py py-obj docutils literal"><span class="pre">AsyncTestCase</span></code></a>.</li>
<li><a class="reference internal" href="index.html#tornado.testing.AsyncTestCase" title="tornado.testing.AsyncTestCase"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.AsyncTestCase</span></code></a> and friends now extend <code class="docutils literal"><span class="pre">unittest2.TestCase</span></code>
when it is available (and continue to use the standard <code class="docutils literal"><span class="pre">unittest</span></code> module
when <code class="docutils literal"><span class="pre">unittest2</span></code> is not available)</li>
<li><a class="reference internal" href="index.html#tornado.testing.ExpectLog" title="tornado.testing.ExpectLog"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.ExpectLog</span></code></a> can be used as a finer-grained alternative
to <a class="reference internal" href="index.html#tornado.testing.LogTrapTestCase" title="tornado.testing.LogTrapTestCase"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.LogTrapTestCase</span></code></a></li>
<li>The command-line interface to <a class="reference internal" href="index.html#tornado.testing.main" title="tornado.testing.main"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.main</span></code></a> now supports
additional arguments from the underlying <a class="reference external" href="https://docs.python.org/3.4/library/unittest.html#module-unittest" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">unittest</span></code></a> module:
<code class="docutils literal"><span class="pre">verbose</span></code>, <code class="docutils literal"><span class="pre">quiet</span></code>, <code class="docutils literal"><span class="pre">failfast</span></code>, <code class="docutils literal"><span class="pre">catch</span></code>, <code class="docutils literal"><span class="pre">buffer</span></code>.</li>
<li>The deprecated <code class="docutils literal"><span class="pre">--autoreload</span></code> option of <a class="reference internal" href="index.html#tornado.testing.main" title="tornado.testing.main"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.main</span></code></a> has
been removed.  Use <code class="docutils literal"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">tornado.autoreload</span></code> as a prefix command
instead.</li>
<li>The <code class="docutils literal"><span class="pre">--httpclient</span></code> option of <a class="reference internal" href="index.html#tornado.testing.main" title="tornado.testing.main"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.main</span></code></a> has been moved
to <code class="docutils literal"><span class="pre">tornado.test.runtests</span></code> so as not to pollute the application
option namespace.  The <a class="reference internal" href="index.html#module-tornado.options" title="tornado.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options</span></code></a> module&#8217;s new callback
support now makes it easy to add options from a wrapper script
instead of putting all possible options in <a class="reference internal" href="index.html#tornado.testing.main" title="tornado.testing.main"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.main</span></code></a>.</li>
<li><a class="reference internal" href="index.html#tornado.testing.AsyncHTTPTestCase" title="tornado.testing.AsyncHTTPTestCase"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPTestCase</span></code></a> no longer calls <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient.close" title="tornado.httpclient.AsyncHTTPClient.close"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient.close</span></code></a> for tests
that use the singleton <a class="reference internal" href="index.html#tornado.ioloop.IOLoop.instance" title="tornado.ioloop.IOLoop.instance"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.instance</span></code></a>.</li>
<li><a class="reference internal" href="index.html#tornado.testing.LogTrapTestCase" title="tornado.testing.LogTrapTestCase"><code class="xref py py-obj docutils literal"><span class="pre">LogTrapTestCase</span></code></a> no longer fails when run in unknown logging
configurations.  This allows tests to be run under nose, which does its
own log buffering (<a class="reference internal" href="index.html#tornado.testing.LogTrapTestCase" title="tornado.testing.LogTrapTestCase"><code class="xref py py-obj docutils literal"><span class="pre">LogTrapTestCase</span></code></a> doesn&#8217;t do anything useful in this
case, but at least it doesn&#8217;t break things any more).</li>
</ul>
</div>
<div class="section" id="tornado-util">
<h7><code class="docutils literal"><span class="pre">tornado.util</span></code><a class="headerlink" href="#tornado-util" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">tornado.util.b</span></code> (which was only intended for internal use) is gone.</li>
</ul>
</div>
<div class="section" id="tornado-web">
<h7><a class="reference internal" href="index.html#module-tornado.web" title="tornado.web"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web</span></code></a><a class="headerlink" href="#tornado-web" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.set_header" title="tornado.web.RequestHandler.set_header"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.set_header</span></code></a> now overwrites previous header values
case-insensitively.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.RequestHandler</span></code></a> has new attributes <code class="docutils literal"><span class="pre">path_args</span></code> and
<code class="docutils literal"><span class="pre">path_kwargs</span></code>, which contain the positional and keyword arguments
that are passed to the <code class="docutils literal"><span class="pre">get</span></code>/<code class="docutils literal"><span class="pre">post</span></code>/etc method.  These attributes
are set before those methods are called, so they are available during
<code class="docutils literal"><span class="pre">prepare()</span></code></li>
<li><a class="reference internal" href="index.html#tornado.web.ErrorHandler" title="tornado.web.ErrorHandler"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.ErrorHandler</span></code></a> no longer requires XSRF tokens on <code class="docutils literal"><span class="pre">POST</span></code>
requests, so posts to an unknown url will always return 404 instead of
complaining about XSRF tokens.</li>
<li>Several methods related to HTTP status codes now take a <code class="docutils literal"><span class="pre">reason</span></code> keyword
argument to specify an alternate &#8220;reason&#8221; string (i.e. the &#8220;Not Found&#8221; in
&#8220;HTTP/1.1 404 Not Found&#8221;).  It is now possible to set status codes other
than those defined in the spec, as long as a reason string is given.</li>
<li>The <code class="docutils literal"><span class="pre">Date</span></code> HTTP header is now set by default on all responses.</li>
<li><code class="docutils literal"><span class="pre">Etag</span></code>/<code class="docutils literal"><span class="pre">If-None-Match</span></code> requests now work with <a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a>.</li>
<li><a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> no longer sets <code class="docutils literal"><span class="pre">Cache-Control:</span> <span class="pre">public</span></code> unnecessarily.</li>
<li>When gzip is enabled in a <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.Application</span></code></a>, appropriate
<code class="docutils literal"><span class="pre">Vary:</span> <span class="pre">Accept-Encoding</span></code> headers are now sent.</li>
<li>It is no longer necessary to pass all handlers for a host in a single
<a class="reference internal" href="index.html#tornado.web.Application.add_handlers" title="tornado.web.Application.add_handlers"><code class="xref py py-obj docutils literal"><span class="pre">Application.add_handlers</span></code></a> call.  Now the request will be matched
against the handlers for any <code class="docutils literal"><span class="pre">host_pattern</span></code> that includes the request&#8217;s
<code class="docutils literal"><span class="pre">Host</span></code> header.</li>
</ul>
</div>
<div class="section" id="tornado-websocket">
<h7><a class="reference internal" href="index.html#module-tornado.websocket" title="tornado.websocket"><code class="xref py py-obj docutils literal"><span class="pre">tornado.websocket</span></code></a><a class="headerlink" href="#tornado-websocket" title="Permalink to this headline">¶</a></h7>
<ul class="simple">
<li>Client-side WebSocket support is now available:
<a class="reference internal" href="index.html#tornado.websocket.websocket_connect" title="tornado.websocket.websocket_connect"><code class="xref py py-obj docutils literal"><span class="pre">tornado.websocket.websocket_connect</span></code></a></li>
<li><a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler" title="tornado.websocket.WebSocketHandler"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler</span></code></a> has new methods <a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler.ping" title="tornado.websocket.WebSocketHandler.ping"><code class="xref py py-obj docutils literal"><span class="pre">ping</span></code></a> and
<a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler.on_pong" title="tornado.websocket.WebSocketHandler.on_pong"><code class="xref py py-obj docutils literal"><span class="pre">on_pong</span></code></a> to send pings to the browser (not
supported on the <code class="docutils literal"><span class="pre">draft76</span></code> protocol)</li>
</ul>
</div>
</div>
</div>
</div>
<span id="document-releases/v2.4.1"></span><div class="section" id="what-s-new-in-tornado-2-4-1">
<h4>What&#8217;s new in Tornado 2.4.1<a class="headerlink" href="#what-s-new-in-tornado-2-4-1" title="Permalink to this headline">¶</a></h4>
<div class="section" id="nov-24-2012">
<h5>Nov 24, 2012<a class="headerlink" href="#nov-24-2012" title="Permalink to this headline">¶</a></h5>
<div class="section" id="bug-fixes">
<h6>Bug fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Fixed a memory leak in <a class="reference internal" href="index.html#module-tornado.stack_context" title="tornado.stack_context"><code class="xref py py-obj docutils literal"><span class="pre">tornado.stack_context</span></code></a> that was especially likely
with long-running <code class="docutils literal"><span class="pre">&#64;gen.engine</span></code> functions.</li>
<li><a class="reference internal" href="index.html#tornado.auth.TwitterMixin" title="tornado.auth.TwitterMixin"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth.TwitterMixin</span></code></a> now works on Python 3.</li>
<li>Fixed a bug in which <code class="docutils literal"><span class="pre">IOStream.read_until_close</span></code> with a streaming callback
would sometimes pass the last chunk of data to the final callback instead
of the streaming callback.</li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v2.4.0"></span><div class="section" id="what-s-new-in-tornado-2-4">
<h4>What&#8217;s new in Tornado 2.4<a class="headerlink" href="#what-s-new-in-tornado-2-4" title="Permalink to this headline">¶</a></h4>
<div class="section" id="sep-4-2012">
<h5>Sep 4, 2012<a class="headerlink" href="#sep-4-2012" title="Permalink to this headline">¶</a></h5>
<div class="section" id="general">
<h6>General<a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Fixed Python 3 bugs in <a class="reference internal" href="index.html#module-tornado.auth" title="tornado.auth"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth</span></code></a>, <a class="reference internal" href="index.html#module-tornado.locale" title="tornado.locale"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locale</span></code></a>, and <a class="reference internal" href="index.html#module-tornado.wsgi" title="tornado.wsgi"><code class="xref py py-obj docutils literal"><span class="pre">tornado.wsgi</span></code></a>.</li>
</ul>
</div>
<div class="section" id="http-clients">
<h6>HTTP clients<a class="headerlink" href="#http-clients" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Removed <code class="docutils literal"><span class="pre">max_simultaneous_connections</span></code> argument from <a class="reference internal" href="index.html#module-tornado.httpclient" title="tornado.httpclient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient</span></code></a>
(both implementations).  This argument hasn&#8217;t been useful for some time
(if you were using it you probably want <code class="docutils literal"><span class="pre">max_clients</span></code> instead)</li>
<li><code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code> now accepts and ignores HTTP 1xx status
responses.</li>
</ul>
</div>
<div class="section" id="tornado-ioloop-and-tornado-iostream">
<h6><a class="reference internal" href="index.html#module-tornado.ioloop" title="tornado.ioloop"><code class="xref py py-obj docutils literal"><span class="pre">tornado.ioloop</span></code></a> and <a class="reference internal" href="index.html#module-tornado.iostream" title="tornado.iostream"><code class="xref py py-obj docutils literal"><span class="pre">tornado.iostream</span></code></a><a class="headerlink" href="#tornado-ioloop-and-tornado-iostream" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Fixed a bug introduced in 2.3 that would cause <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> close callbacks
to not run if there were pending reads.</li>
<li>Improved error handling in <a class="reference internal" href="index.html#tornado.iostream.SSLIOStream" title="tornado.iostream.SSLIOStream"><code class="xref py py-obj docutils literal"><span class="pre">SSLIOStream</span></code></a> and SSL-enabled <a class="reference internal" href="index.html#tornado.tcpserver.TCPServer" title="tornado.tcpserver.TCPServer"><code class="xref py py-obj docutils literal"><span class="pre">TCPServer</span></code></a>.</li>
<li><code class="docutils literal"><span class="pre">SSLIOStream.get_ssl_certificate</span></code> now has a <code class="docutils literal"><span class="pre">binary_form</span></code> argument
which is passed to <code class="docutils literal"><span class="pre">SSLSocket.getpeercert</span></code>.</li>
<li><code class="docutils literal"><span class="pre">SSLIOStream.write</span></code> can now be called while the connection is in progress,
same as non-SSL <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> (but be careful not to send sensitive data until
the connection has completed and the certificate has been verified).</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_handler" title="tornado.ioloop.IOLoop.add_handler"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_handler</span></code></a> cannot be called more than once with the same file
descriptor.  This was always true for <code class="docutils literal"><span class="pre">epoll</span></code>, but now the other
implementations enforce it too.</li>
<li>On Windows, <a class="reference internal" href="index.html#tornado.tcpserver.TCPServer" title="tornado.tcpserver.TCPServer"><code class="xref py py-obj docutils literal"><span class="pre">TCPServer</span></code></a> uses <code class="docutils literal"><span class="pre">SO_EXCLUSIVEADDRUSER</span></code> instead of <code class="docutils literal"><span class="pre">SO_REUSEADDR</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-template">
<h6><a class="reference internal" href="index.html#module-tornado.template" title="tornado.template"><code class="xref py py-obj docutils literal"><span class="pre">tornado.template</span></code></a><a class="headerlink" href="#tornado-template" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">{%</span> <span class="pre">break</span> <span class="pre">%}</span></code> and <code class="docutils literal"><span class="pre">{%</span> <span class="pre">continue</span> <span class="pre">%}</span></code> can now be used looping constructs
in templates.</li>
<li>It is no longer an error for an if/else/for/etc block in a template to
have an empty body.</li>
</ul>
</div>
<div class="section" id="tornado-testing">
<h6><a class="reference internal" href="index.html#module-tornado.testing" title="tornado.testing"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing</span></code></a><a class="headerlink" href="#tornado-testing" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>New class <a class="reference internal" href="index.html#tornado.testing.AsyncHTTPSTestCase" title="tornado.testing.AsyncHTTPSTestCase"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.AsyncHTTPSTestCase</span></code></a> is like <a class="reference internal" href="index.html#tornado.testing.AsyncHTTPTestCase" title="tornado.testing.AsyncHTTPTestCase"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPTestCase</span></code></a>.
but enables SSL for the testing server (by default using a self-signed
testing certificate).</li>
<li><a class="reference internal" href="index.html#tornado.testing.main" title="tornado.testing.main"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.main</span></code></a> now accepts additional keyword arguments and forwards
them to <a class="reference external" href="https://docs.python.org/3.4/library/unittest.html#unittest.main" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">unittest.main</span></code></a>.</li>
</ul>
</div>
<div class="section" id="tornado-web">
<h6><a class="reference internal" href="index.html#module-tornado.web" title="tornado.web"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web</span></code></a><a class="headerlink" href="#tornado-web" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>New method <a class="reference internal" href="index.html#tornado.web.RequestHandler.get_template_namespace" title="tornado.web.RequestHandler.get_template_namespace"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_template_namespace</span></code></a> can be overridden to
add additional variables without modifying keyword arguments to
<code class="docutils literal"><span class="pre">render_string</span></code>.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.add_header" title="tornado.web.RequestHandler.add_header"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.add_header</span></code></a> now works with <a class="reference internal" href="index.html#tornado.wsgi.WSGIApplication" title="tornado.wsgi.WSGIApplication"><code class="xref py py-obj docutils literal"><span class="pre">WSGIApplication</span></code></a>.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.get_secure_cookie" title="tornado.web.RequestHandler.get_secure_cookie"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_secure_cookie</span></code></a> now handles a potential error case.</li>
<li><code class="docutils literal"><span class="pre">RequestHandler.__init__</span></code> now calls <code class="docutils literal"><span class="pre">super().__init__</span></code> to ensure that
all constructors are called when multiple inheritance is used.</li>
<li>Docs have been updated with a description of all available
<a class="reference internal" href="index.html#tornado.web.Application.settings" title="tornado.web.Application.settings"><code class="xref py py-attr docutils literal"><span class="pre">Application</span> <span class="pre">settings</span></code></a></li>
</ul>
</div>
<div class="section" id="other-modules">
<h6>Other modules<a class="headerlink" href="#other-modules" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.auth.OAuthMixin" title="tornado.auth.OAuthMixin"><code class="xref py py-obj docutils literal"><span class="pre">OAuthMixin</span></code></a> now accepts <code class="docutils literal"><span class="pre">&quot;oob&quot;</span></code> as a <code class="docutils literal"><span class="pre">callback_uri</span></code>.</li>
<li><a class="reference internal" href="index.html#tornado.auth.OpenIdMixin" title="tornado.auth.OpenIdMixin"><code class="xref py py-obj docutils literal"><span class="pre">OpenIdMixin</span></code></a> now also returns the <code class="docutils literal"><span class="pre">claimed_id</span></code> field for the user.</li>
<li><a class="reference internal" href="index.html#module-tornado.platform.twisted" title="tornado.platform.twisted"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.twisted</span></code></a> shutdown sequence is now more compatible.</li>
<li>The logging configuration used in <a class="reference internal" href="index.html#module-tornado.options" title="tornado.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options</span></code></a> is now more tolerant
of non-ascii byte strings.</li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v2.3.0"></span><div class="section" id="what-s-new-in-tornado-2-3">
<h4>What&#8217;s new in Tornado 2.3<a class="headerlink" href="#what-s-new-in-tornado-2-3" title="Permalink to this headline">¶</a></h4>
<div class="section" id="may-31-2012">
<h5>May 31, 2012<a class="headerlink" href="#may-31-2012" title="Permalink to this headline">¶</a></h5>
<div class="section" id="http-clients">
<h6>HTTP clients<a class="headerlink" href="#http-clients" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httpclient.HTTPClient" title="tornado.httpclient.HTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient.HTTPClient</span></code></a> now supports the same constructor
keyword arguments as <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient" title="tornado.httpclient.AsyncHTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient</span></code></a>.</li>
<li>The <code class="docutils literal"><span class="pre">max_clients</span></code> keyword argument to <a class="reference internal" href="index.html#tornado.httpclient.AsyncHTTPClient.configure" title="tornado.httpclient.AsyncHTTPClient.configure"><code class="xref py py-obj docutils literal"><span class="pre">AsyncHTTPClient.configure</span></code></a> now works.</li>
<li><code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code> now supports the <code class="docutils literal"><span class="pre">OPTIONS</span></code> and <code class="docutils literal"><span class="pre">PATCH</span></code>
HTTP methods.</li>
<li><code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code> is better about closing its sockets
instead of leaving them for garbage collection.</li>
<li><code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code> correctly verifies SSL certificates for
URLs containing IPv6 literals (This bug affected Python 2.5 and 2.6).</li>
<li><code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code> no longer includes basic auth credentials
in the <code class="docutils literal"><span class="pre">Host</span></code> header when those credentials are extracted from the URL.</li>
<li><code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code> no longer modifies the caller-supplied header
dictionary, which caused problems when following redirects.</li>
<li><code class="docutils literal"><span class="pre">tornado.curl_httpclient</span></code> now supports client SSL certificates (using
the same <code class="docutils literal"><span class="pre">client_cert</span></code> and <code class="docutils literal"><span class="pre">client_key</span></code> arguments as
<code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code>)</li>
</ul>
</div>
<div class="section" id="http-server">
<h6>HTTP Server<a class="headerlink" href="#http-server" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> now works correctly with paths starting with <code class="docutils literal"><span class="pre">//</span></code></li>
<li><code class="docutils literal"><span class="pre">HTTPHeaders.copy</span></code> (inherited from <a class="reference external" href="https://docs.python.org/3.4/library/stdtypes.html#dict.copy" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">dict.copy</span></code></a>) now works correctly.</li>
<li><code class="docutils literal"><span class="pre">HTTPConnection.address</span></code> is now always the socket address, even for non-IP
sockets.  <code class="docutils literal"><span class="pre">HTTPRequest.remote_ip</span></code> is still always an IP-style address
(fake data is used for non-IP sockets)</li>
<li>Extra data at the end of multipart form bodies is now ignored, which fixes
a compatibility problem with an iOS HTTP client library.</li>
</ul>
</div>
<div class="section" id="ioloop-and-iostream">
<h6><code class="docutils literal"><span class="pre">IOLoop</span></code> and <code class="docutils literal"><span class="pre">IOStream</span></code><a class="headerlink" href="#ioloop-and-iostream" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> now has an <code class="docutils literal"><span class="pre">error</span></code> attribute that can be used to determine
why a socket was closed.</li>
<li><code class="docutils literal"><span class="pre">tornado.iostream.IOStream.read_until</span></code> and <code class="docutils literal"><span class="pre">read_until_regex</span></code> are much
faster with large input.</li>
<li><code class="docutils literal"><span class="pre">IOStream.write</span></code> performs better when given very large strings.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop.instance" title="tornado.ioloop.IOLoop.instance"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.instance()</span></code></a> is now thread-safe.</li>
</ul>
</div>
<div class="section" id="tornado-options">
<h6><code class="docutils literal"><span class="pre">tornado.options</span></code><a class="headerlink" href="#tornado-options" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#module-tornado.options" title="tornado.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options</span></code></a> options with <code class="docutils literal"><span class="pre">multiple=True</span></code> that are set more than
once now overwrite rather than append.  This makes it possible to override
values set in <code class="docutils literal"><span class="pre">parse_config_file</span></code> with <code class="docutils literal"><span class="pre">parse_command_line</span></code>.</li>
<li><a class="reference internal" href="index.html#module-tornado.options" title="tornado.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options</span></code></a> <code class="docutils literal"><span class="pre">--help</span></code> output is now prettier.</li>
<li><a class="reference internal" href="index.html#tornado.options.options" title="tornado.options.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.options</span></code></a> now supports attribute assignment.</li>
</ul>
</div>
<div class="section" id="tornado-template">
<h6><code class="docutils literal"><span class="pre">tornado.template</span></code><a class="headerlink" href="#tornado-template" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Template files containing non-ASCII (utf8) characters now work on Python 3
regardless of the locale environment variables.</li>
<li>Templates now support <code class="docutils literal"><span class="pre">else</span></code> clauses in
<code class="docutils literal"><span class="pre">try</span></code>/<code class="docutils literal"><span class="pre">except</span></code>/<code class="docutils literal"><span class="pre">finally</span></code>/<code class="docutils literal"><span class="pre">else</span></code> blocks.</li>
</ul>
</div>
<div class="section" id="tornado-web">
<h6><code class="docutils literal"><span class="pre">tornado.web</span></code><a class="headerlink" href="#tornado-web" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.RequestHandler</span></code></a> now supports the <code class="docutils literal"><span class="pre">PATCH</span></code> HTTP method.
Note that this means any existing methods named <code class="docutils literal"><span class="pre">patch</span></code> in
<code class="docutils literal"><span class="pre">RequestHandler</span></code> subclasses will need to be renamed.</li>
<li><a class="reference internal" href="index.html#tornado.web.addslash" title="tornado.web.addslash"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.addslash</span></code></a> and <code class="docutils literal"><span class="pre">removeslash</span></code> decorators now send permanent
redirects (301) instead of temporary (302).</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.flush" title="tornado.web.RequestHandler.flush"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.flush</span></code></a> now invokes its callback whether there was any data
to flush or not.</li>
<li>Repeated calls to <a class="reference internal" href="index.html#tornado.web.RequestHandler.set_cookie" title="tornado.web.RequestHandler.set_cookie"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.set_cookie</span></code></a> with the same name now
overwrite the previous cookie instead of producing additional copies.</li>
<li><code class="docutils literal"><span class="pre">tornado.web.OutputTransform.transform_first_chunk</span></code> now takes and returns
a status code in addition to the headers and chunk.  This is a
backwards-incompatible change to an interface that was never technically
private, but was not included in the documentation and does not appear
to have been used outside Tornado itself.</li>
<li>Fixed a bug on python versions before 2.6.5 when <a class="reference internal" href="index.html#tornado.web.URLSpec" title="tornado.web.URLSpec"><code class="xref py py-obj docutils literal"><span class="pre">URLSpec</span></code></a> regexes
are constructed from unicode strings and keyword arguments are extracted.</li>
<li>The <code class="docutils literal"><span class="pre">reverse_url</span></code> function in the template namespace now comes from
the <a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a> rather than the <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a>.  (Unless overridden,
<a class="reference internal" href="index.html#tornado.web.RequestHandler.reverse_url" title="tornado.web.RequestHandler.reverse_url"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.reverse_url</span></code></a> is just an alias for the <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">Application</span></code></a>
method).</li>
<li>The <code class="docutils literal"><span class="pre">Etag</span></code> header is now returned on 304 responses to an <code class="docutils literal"><span class="pre">If-None-Match</span></code>
request, improving compatibility with some caches.</li>
<li><a class="reference internal" href="index.html#module-tornado.web" title="tornado.web"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web</span></code></a> will no longer produce responses with status code 304
that also have entity headers such as <code class="docutils literal"><span class="pre">Content-Length</span></code>.</li>
</ul>
</div>
<div class="section" id="other-modules">
<h6>Other modules<a class="headerlink" href="#other-modules" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.auth.FacebookGraphMixin" title="tornado.auth.FacebookGraphMixin"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth.FacebookGraphMixin</span></code></a> no longer sends <code class="docutils literal"><span class="pre">post_args</span></code> redundantly
in the url.</li>
<li>The <code class="docutils literal"><span class="pre">extra_params</span></code> argument to <a class="reference internal" href="index.html#tornado.escape.linkify" title="tornado.escape.linkify"><code class="xref py py-obj docutils literal"><span class="pre">tornado.escape.linkify</span></code></a> may now be
a callable, to allow parameters to be chosen separately for each link.</li>
<li><a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a> no longer leaks <code class="docutils literal"><span class="pre">StackContexts</span></code> when a <code class="docutils literal"><span class="pre">&#64;gen.engine</span></code> wrapped
function is called repeatedly.</li>
<li><a class="reference internal" href="index.html#tornado.locale.get_supported_locales" title="tornado.locale.get_supported_locales"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locale.get_supported_locales</span></code></a> no longer takes a meaningless
<code class="docutils literal"><span class="pre">cls</span></code> argument.</li>
<li><a class="reference internal" href="index.html#tornado.stack_context.StackContext" title="tornado.stack_context.StackContext"><code class="xref py py-obj docutils literal"><span class="pre">StackContext</span></code></a> instances now have a deactivation callback that can be
used to prevent further propagation.</li>
<li><a class="reference internal" href="index.html#tornado.testing.AsyncTestCase.wait" title="tornado.testing.AsyncTestCase.wait"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.AsyncTestCase.wait</span></code></a> now resets its timeout on each call.</li>
<li><a class="reference internal" href="index.html#tornado.wsgi.WSGIApplication" title="tornado.wsgi.WSGIApplication"><code class="xref py py-obj docutils literal"><span class="pre">tornado.wsgi.WSGIApplication</span></code></a> now parses arguments correctly on Python 3.</li>
<li>Exception handling on Python 3 has been improved; previously some exceptions
such as <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#UnicodeDecodeError" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">UnicodeDecodeError</span></code></a> would generate <code class="docutils literal"><span class="pre">TypeErrors</span></code></li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v2.2.1"></span><div class="section" id="what-s-new-in-tornado-2-2-1">
<h4>What&#8217;s new in Tornado 2.2.1<a class="headerlink" href="#what-s-new-in-tornado-2-2-1" title="Permalink to this headline">¶</a></h4>
<div class="section" id="apr-23-2012">
<h5>Apr 23, 2012<a class="headerlink" href="#apr-23-2012" title="Permalink to this headline">¶</a></h5>
<div class="section" id="security-fixes">
<h6>Security fixes<a class="headerlink" href="#security-fixes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.set_header" title="tornado.web.RequestHandler.set_header"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.RequestHandler.set_header</span></code></a> now properly sanitizes input
values to protect against header injection, response splitting, etc.
(it has always attempted to do this, but the check was incorrect).
Note that redirects, the most likely source of such bugs, are protected
by a separate check in <a class="reference internal" href="index.html#tornado.web.RequestHandler.redirect" title="tornado.web.RequestHandler.redirect"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.redirect</span></code></a>.</li>
</ul>
</div>
<div class="section" id="bug-fixes">
<h6>Bug fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Colored logging configuration in <a class="reference internal" href="index.html#module-tornado.options" title="tornado.options"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options</span></code></a> is compatible with
Python 3.2.3 (and 3.3).</li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v2.2.0"></span><div class="section" id="what-s-new-in-tornado-2-2">
<h4>What&#8217;s new in Tornado 2.2<a class="headerlink" href="#what-s-new-in-tornado-2-2" title="Permalink to this headline">¶</a></h4>
<div class="section" id="jan-30-2012">
<h5>Jan 30, 2012<a class="headerlink" href="#jan-30-2012" title="Permalink to this headline">¶</a></h5>
<div class="section" id="highlights">
<h6>Highlights<a class="headerlink" href="#highlights" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Updated and expanded WebSocket support.</li>
<li>Improved compatibility in the Twisted/Tornado bridge.</li>
<li>Template errors now generate better stack traces.</li>
<li>Better exception handling in <a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a>.</li>
</ul>
</div>
<div class="section" id="security-fixes">
<h6>Security fixes<a class="headerlink" href="#security-fixes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code> now disables SSLv2 in all cases.  Previously
SSLv2 would be allowed if the Python interpreter was linked against a
pre-1.0 version of OpenSSL.</li>
</ul>
</div>
<div class="section" id="backwards-incompatible-changes">
<h6>Backwards-incompatible changes<a class="headerlink" href="#backwards-incompatible-changes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.process.fork_processes" title="tornado.process.fork_processes"><code class="xref py py-obj docutils literal"><span class="pre">tornado.process.fork_processes</span></code></a> now raises <a class="reference external" href="https://docs.python.org/3.4/library/exceptions.html#SystemExit" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">SystemExit</span></code></a> if all child
processes exit cleanly rather than returning <code class="docutils literal"><span class="pre">None</span></code>.  The old behavior
was surprising and inconsistent with most of the documented examples
of this function (which did not check the return value).</li>
<li>On Python 2.6, <code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code> only supports SSLv3.  This
is because Python 2.6 does not expose a way to support both SSLv3 and TLSv1
without also supporting the insecure SSLv2.</li>
<li><a class="reference internal" href="index.html#module-tornado.websocket" title="tornado.websocket"><code class="xref py py-obj docutils literal"><span class="pre">tornado.websocket</span></code></a> no longer supports the older &#8220;draft 76&#8221; version
of the websocket protocol by default, although this version can
be enabled by overriding <code class="docutils literal"><span class="pre">tornado.websocket.WebSocketHandler.allow_draft76</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-httpclient">
<h6><code class="docutils literal"><span class="pre">tornado.httpclient</span></code><a class="headerlink" href="#tornado-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">SimpleAsyncHTTPClient</span></code> no longer hangs on <code class="docutils literal"><span class="pre">HEAD</span></code> requests,
responses with no content, or empty <code class="docutils literal"><span class="pre">POST</span></code>/<code class="docutils literal"><span class="pre">PUT</span></code> response bodies.</li>
<li><code class="docutils literal"><span class="pre">SimpleAsyncHTTPClient</span></code> now supports 303 and 307 redirect codes.</li>
<li><code class="docutils literal"><span class="pre">tornado.curl_httpclient</span></code> now accepts non-integer timeouts.</li>
<li><code class="docutils literal"><span class="pre">tornado.curl_httpclient</span></code> now supports basic authentication with an
empty password.</li>
</ul>
</div>
<div class="section" id="tornado-httpserver">
<h6><code class="docutils literal"><span class="pre">tornado.httpserver</span></code><a class="headerlink" href="#tornado-httpserver" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> with <code class="docutils literal"><span class="pre">xheaders=True</span></code> will no longer accept
<code class="docutils literal"><span class="pre">X-Real-IP</span></code> headers that don&#8217;t look like valid IP addresses.</li>
<li><a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> now treats the <code class="docutils literal"><span class="pre">Connection</span></code> request header as
case-insensitive.</li>
</ul>
</div>
<div class="section" id="tornado-ioloop-and-tornado-iostream">
<h6><code class="docutils literal"><span class="pre">tornado.ioloop</span></code> and <code class="docutils literal"><span class="pre">tornado.iostream</span></code><a class="headerlink" href="#tornado-ioloop-and-tornado-iostream" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">IOStream.write</span></code> now works correctly when given an empty string.</li>
<li><code class="docutils literal"><span class="pre">IOStream.read_until</span></code> (and <code class="docutils literal"><span class="pre">read_until_regex</span></code>) now perform better
when there is a lot of buffered data, which improves peformance of
<code class="docutils literal"><span class="pre">SimpleAsyncHTTPClient</span></code> when downloading files with lots of
chunks.</li>
<li><a class="reference internal" href="index.html#tornado.iostream.SSLIOStream" title="tornado.iostream.SSLIOStream"><code class="xref py py-obj docutils literal"><span class="pre">SSLIOStream</span></code></a> now works correctly when <code class="docutils literal"><span class="pre">ssl_version</span></code> is set to
a value other than <code class="docutils literal"><span class="pre">SSLv23</span></code>.</li>
<li>Idle <code class="docutils literal"><span class="pre">IOLoops</span></code> no longer wake up several times a second.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.PeriodicCallback" title="tornado.ioloop.PeriodicCallback"><code class="xref py py-obj docutils literal"><span class="pre">tornado.ioloop.PeriodicCallback</span></code></a> no longer triggers duplicate callbacks
when stopped and started repeatedly.</li>
</ul>
</div>
<div class="section" id="tornado-template">
<h6><code class="docutils literal"><span class="pre">tornado.template</span></code><a class="headerlink" href="#tornado-template" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Exceptions in template code will now show better stack traces that
reference lines from the original template file.</li>
<li><code class="docutils literal"><span class="pre">{#</span></code> and <code class="docutils literal"><span class="pre">#}</span></code> can now be used for comments (and unlike the old
<code class="docutils literal"><span class="pre">{%</span> <span class="pre">comment</span> <span class="pre">%}</span></code> directive, these can wrap other template directives).</li>
<li>Template directives may now span multiple lines.</li>
</ul>
</div>
<div class="section" id="tornado-web">
<h6><code class="docutils literal"><span class="pre">tornado.web</span></code><a class="headerlink" href="#tornado-web" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Now behaves better when given malformed <code class="docutils literal"><span class="pre">Cookie</span></code> headers</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.redirect" title="tornado.web.RequestHandler.redirect"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.redirect</span></code></a> now has a <code class="docutils literal"><span class="pre">status</span></code> argument to send
status codes other than 301 and 302.</li>
<li>New method <a class="reference internal" href="index.html#tornado.web.RequestHandler.on_finish" title="tornado.web.RequestHandler.on_finish"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.on_finish</span></code></a> may be overridden for post-request
processing (as a counterpart to <a class="reference internal" href="index.html#tornado.web.RequestHandler.prepare" title="tornado.web.RequestHandler.prepare"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.prepare</span></code></a>)</li>
<li><a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> now outputs <code class="docutils literal"><span class="pre">Content-Length</span></code> and <code class="docutils literal"><span class="pre">Etag</span></code> headers
on <code class="docutils literal"><span class="pre">HEAD</span></code> requests.</li>
<li><a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> now has overridable <code class="docutils literal"><span class="pre">get_version</span></code> and
<code class="docutils literal"><span class="pre">parse_url_path</span></code> methods for use in subclasses.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.static_url" title="tornado.web.RequestHandler.static_url"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.static_url</span></code></a> now takes an <code class="docutils literal"><span class="pre">include_host</span></code> parameter
(in addition to the old support for the <code class="docutils literal"><span class="pre">RequestHandler.include_host</span></code>
attribute).</li>
</ul>
</div>
<div class="section" id="tornado-websocket">
<h6><code class="docutils literal"><span class="pre">tornado.websocket</span></code><a class="headerlink" href="#tornado-websocket" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Updated to support the latest version of the protocol, as finalized
in RFC 6455.</li>
<li>Many bugs were fixed in all supported protocol versions.</li>
<li><a class="reference internal" href="index.html#module-tornado.websocket" title="tornado.websocket"><code class="xref py py-obj docutils literal"><span class="pre">tornado.websocket</span></code></a> no longer supports the older &#8220;draft 76&#8221; version
of the websocket protocol by default, although this version can
be enabled by overriding <code class="docutils literal"><span class="pre">tornado.websocket.WebSocketHandler.allow_draft76</span></code>.</li>
<li><a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler.write_message" title="tornado.websocket.WebSocketHandler.write_message"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler.write_message</span></code></a> now accepts a <code class="docutils literal"><span class="pre">binary</span></code> argument
to send binary messages.</li>
<li>Subprotocols (i.e. the <code class="docutils literal"><span class="pre">Sec-WebSocket-Protocol</span></code> header) are now supported;
see the <a class="reference internal" href="index.html#tornado.websocket.WebSocketHandler.select_subprotocol" title="tornado.websocket.WebSocketHandler.select_subprotocol"><code class="xref py py-obj docutils literal"><span class="pre">WebSocketHandler.select_subprotocol</span></code></a> method for details.</li>
<li><code class="docutils literal"><span class="pre">.WebSocketHandler.get_websocket_scheme</span></code> can be used to select the
appropriate url scheme (<code class="docutils literal"><span class="pre">ws://</span></code> or <code class="docutils literal"><span class="pre">wss://</span></code>) in cases where
<code class="docutils literal"><span class="pre">HTTPRequest.protocol</span></code> is not set correctly.</li>
</ul>
</div>
<div class="section" id="other-modules">
<h6>Other modules<a class="headerlink" href="#other-modules" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.auth.TwitterMixin.authenticate_redirect" title="tornado.auth.TwitterMixin.authenticate_redirect"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth.TwitterMixin.authenticate_redirect</span></code></a> now takes a
<code class="docutils literal"><span class="pre">callback_uri</span></code> parameter.</li>
<li><a class="reference internal" href="index.html#tornado.auth.TwitterMixin.twitter_request" title="tornado.auth.TwitterMixin.twitter_request"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth.TwitterMixin.twitter_request</span></code></a> now accepts both URLs and
partial paths (complete URLs are useful for the search API which follows
different patterns).</li>
<li>Exception handling in <a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a> has been improved.  It is now possible
to catch exceptions thrown by a <code class="docutils literal"><span class="pre">Task</span></code>.</li>
<li><a class="reference internal" href="index.html#tornado.netutil.bind_sockets" title="tornado.netutil.bind_sockets"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil.bind_sockets</span></code></a> now works when <code class="docutils literal"><span class="pre">getaddrinfo</span></code> returns
duplicate addresses.</li>
<li><a class="reference internal" href="index.html#module-tornado.platform.twisted" title="tornado.platform.twisted"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.twisted</span></code></a> compatibility has been significantly improved.
Twisted version 11.1.0 is now supported in addition to 11.0.0.</li>
<li><a class="reference internal" href="index.html#tornado.process.fork_processes" title="tornado.process.fork_processes"><code class="xref py py-obj docutils literal"><span class="pre">tornado.process.fork_processes</span></code></a> correctly reseeds the <a class="reference external" href="https://docs.python.org/3.4/library/random.html#module-random" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">random</span></code></a> module
even when <a class="reference external" href="https://docs.python.org/3.4/library/os.html#os.urandom" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">os.urandom</span></code></a> is not implemented.</li>
<li><a class="reference internal" href="index.html#tornado.testing.main" title="tornado.testing.main"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.main</span></code></a> supports a new flag <code class="docutils literal"><span class="pre">--exception_on_interrupt</span></code>,
which can be set to false to make <code class="docutils literal"><span class="pre">Ctrl-C</span></code> kill the process more
reliably (at the expense of stack traces when it does so).</li>
<li><code class="docutils literal"><span class="pre">tornado.version_info</span></code> is now a four-tuple so official releases can be
distinguished from development branches.</li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v2.1.1"></span><div class="section" id="what-s-new-in-tornado-2-1-1">
<h4>What&#8217;s new in Tornado 2.1.1<a class="headerlink" href="#what-s-new-in-tornado-2-1-1" title="Permalink to this headline">¶</a></h4>
<div class="section" id="oct-4-2011">
<h5>Oct 4, 2011<a class="headerlink" href="#oct-4-2011" title="Permalink to this headline">¶</a></h5>
<div class="section" id="bug-fixes">
<h6>Bug fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Fixed handling of closed connections with the <code class="docutils literal"><span class="pre">epoll</span></code> (i.e. Linux)
<code class="docutils literal"><span class="pre">IOLoop</span></code>.  Previously, closed connections could be shut down too early,
which most often manifested as &#8220;Stream is closed&#8221; exceptions in
<code class="docutils literal"><span class="pre">SimpleAsyncHTTPClient</span></code>.</li>
<li>Fixed a case in which chunked responses could be closed prematurely,
leading to truncated output.</li>
<li><code class="docutils literal"><span class="pre">IOStream.connect</span></code> now reports errors more consistently via logging
and the close callback (this affects e.g. connections to localhost
on FreeBSD).</li>
<li><code class="docutils literal"><span class="pre">IOStream.read_bytes</span></code> again accepts both <code class="docutils literal"><span class="pre">int</span></code> and <code class="docutils literal"><span class="pre">long</span></code> arguments.</li>
<li><code class="docutils literal"><span class="pre">PeriodicCallback</span></code> no longer runs repeatedly when <code class="docutils literal"><span class="pre">IOLoop</span></code> iterations
complete faster than the resolution of <code class="docutils literal"><span class="pre">time.time()</span></code> (mainly a problem
on Windows).</li>
</ul>
</div>
<div class="section" id="backwards-compatibility-note">
<h6>Backwards-compatibility note<a class="headerlink" href="#backwards-compatibility-note" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Listening for <code class="docutils literal"><span class="pre">IOLoop.ERROR</span></code> alone is no longer sufficient for detecting
closed connections on an otherwise unused socket.  <code class="docutils literal"><span class="pre">IOLoop.ERROR</span></code> must
always be used in combination with <code class="docutils literal"><span class="pre">READ</span></code> or <code class="docutils literal"><span class="pre">WRITE</span></code>.</li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v2.1.0"></span><div class="section" id="what-s-new-in-tornado-2-1">
<h4>What&#8217;s new in Tornado 2.1<a class="headerlink" href="#what-s-new-in-tornado-2-1" title="Permalink to this headline">¶</a></h4>
<div class="section" id="sep-20-2011">
<h5>Sep 20, 2011<a class="headerlink" href="#sep-20-2011" title="Permalink to this headline">¶</a></h5>
<div class="section" id="backwards-incompatible-changes">
<h6>Backwards-incompatible changes<a class="headerlink" href="#backwards-incompatible-changes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Support for secure cookies written by pre-1.0 releases of Tornado has
been removed.  The <a class="reference internal" href="index.html#tornado.web.RequestHandler.get_secure_cookie" title="tornado.web.RequestHandler.get_secure_cookie"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.get_secure_cookie</span></code></a> method no longer
takes an <code class="docutils literal"><span class="pre">include_name</span></code> parameter.</li>
<li>The <code class="docutils literal"><span class="pre">debug</span></code> application setting now causes stack traces to be displayed
in the browser on uncaught exceptions.  Since this may leak sensitive
information, debug mode is not recommended for public-facing servers.</li>
</ul>
</div>
<div class="section" id="security-fixes">
<h6>Security fixes<a class="headerlink" href="#security-fixes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Diginotar has been removed from the default CA certificates file used
by <code class="docutils literal"><span class="pre">SimpleAsyncHTTPClient</span></code>.</li>
</ul>
</div>
<div class="section" id="new-modules">
<h6>New modules<a class="headerlink" href="#new-modules" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#module-tornado.gen" title="tornado.gen"><code class="xref py py-obj docutils literal"><span class="pre">tornado.gen</span></code></a>:  A generator-based interface to simplify writing
asynchronous functions.</li>
<li><a class="reference internal" href="index.html#module-tornado.netutil" title="tornado.netutil"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil</span></code></a>:  Parts of <a class="reference internal" href="index.html#module-tornado.httpserver" title="tornado.httpserver"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpserver</span></code></a> have been extracted into
a new module for use with non-HTTP protocols.</li>
<li><a class="reference internal" href="index.html#module-tornado.platform.twisted" title="tornado.platform.twisted"><code class="xref py py-obj docutils literal"><span class="pre">tornado.platform.twisted</span></code></a>:  A bridge between the Tornado IOLoop and the
Twisted Reactor, allowing code written for Twisted to be run on Tornado.</li>
<li><a class="reference internal" href="index.html#module-tornado.process" title="tornado.process"><code class="xref py py-obj docutils literal"><span class="pre">tornado.process</span></code></a>:  Multi-process mode has been improved, and can now restart
crashed child processes.  A new entry point has been added at
<a class="reference internal" href="index.html#tornado.process.fork_processes" title="tornado.process.fork_processes"><code class="xref py py-obj docutils literal"><span class="pre">tornado.process.fork_processes</span></code></a>, although
<code class="docutils literal"><span class="pre">tornado.httpserver.HTTPServer.start</span></code> is still supported.</li>
</ul>
</div>
<div class="section" id="tornado-web">
<h6><code class="docutils literal"><span class="pre">tornado.web</span></code><a class="headerlink" href="#tornado-web" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.write_error" title="tornado.web.RequestHandler.write_error"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.RequestHandler.write_error</span></code></a> replaces <code class="docutils literal"><span class="pre">get_error_html</span></code> as the
preferred way to generate custom error pages (<code class="docutils literal"><span class="pre">get_error_html</span></code> is still
supported, but deprecated)</li>
<li>In <a class="reference internal" href="index.html#tornado.web.Application" title="tornado.web.Application"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.Application</span></code></a>, handlers may be specified by
(fully-qualified) name instead of importing and passing the class object
itself.</li>
<li>It is now possible to use a custom subclass of <code class="docutils literal"><span class="pre">StaticFileHandler</span></code>
with the <code class="docutils literal"><span class="pre">static_handler_class</span></code> application setting, and this subclass
can override the behavior of the <code class="docutils literal"><span class="pre">static_url</span></code> method.</li>
<li><a class="reference internal" href="index.html#tornado.web.StaticFileHandler" title="tornado.web.StaticFileHandler"><code class="xref py py-obj docutils literal"><span class="pre">StaticFileHandler</span></code></a> subclasses can now override
<code class="docutils literal"><span class="pre">get_cache_time</span></code> to customize cache control behavior.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.get_secure_cookie" title="tornado.web.RequestHandler.get_secure_cookie"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.RequestHandler.get_secure_cookie</span></code></a> now has a <code class="docutils literal"><span class="pre">max_age_days</span></code>
parameter to allow applications to override the default one-month expiration.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.set_cookie" title="tornado.web.RequestHandler.set_cookie"><code class="xref py py-obj docutils literal"><span class="pre">set_cookie</span></code></a> now accepts a <code class="docutils literal"><span class="pre">max_age</span></code> keyword
argument to set the <code class="docutils literal"><span class="pre">max-age</span></code> cookie attribute (note underscore vs dash)</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.set_default_headers" title="tornado.web.RequestHandler.set_default_headers"><code class="xref py py-obj docutils literal"><span class="pre">tornado.web.RequestHandler.set_default_headers</span></code></a> may be overridden to set
headers in a way that does not get reset during error handling.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.add_header" title="tornado.web.RequestHandler.add_header"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.add_header</span></code></a> can now be used to set a header that can
appear multiple times in the response.</li>
<li><a class="reference internal" href="index.html#tornado.web.RequestHandler.flush" title="tornado.web.RequestHandler.flush"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler.flush</span></code></a> can now take a callback for flow control.</li>
<li>The <code class="docutils literal"><span class="pre">application/json</span></code> content type can now be gzipped.</li>
<li>The cookie-signing functions are now accessible as static functions
<code class="docutils literal"><span class="pre">tornado.web.create_signed_value</span></code> and <code class="docutils literal"><span class="pre">tornado.web.decode_signed_value</span></code>.</li>
</ul>
</div>
<div class="section" id="tornado-httpserver">
<h6><code class="docutils literal"><span class="pre">tornado.httpserver</span></code><a class="headerlink" href="#tornado-httpserver" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>To facilitate some advanced multi-process scenarios, <code class="docutils literal"><span class="pre">HTTPServer</span></code>
has a new method <code class="docutils literal"><span class="pre">add_sockets</span></code>, and socket-opening code is
available separately as <a class="reference internal" href="index.html#tornado.netutil.bind_sockets" title="tornado.netutil.bind_sockets"><code class="xref py py-obj docutils literal"><span class="pre">tornado.netutil.bind_sockets</span></code></a>.</li>
<li>The <code class="docutils literal"><span class="pre">cookies</span></code> property is now available on <code class="docutils literal"><span class="pre">tornado.httpserver.HTTPRequest</span></code>
(it is also available in its old location as a property of
<a class="reference internal" href="index.html#tornado.web.RequestHandler" title="tornado.web.RequestHandler"><code class="xref py py-obj docutils literal"><span class="pre">RequestHandler</span></code></a>)</li>
<li><code class="docutils literal"><span class="pre">tornado.httpserver.HTTPServer.bind</span></code> now takes a backlog argument with the
same meaning as <code class="docutils literal"><span class="pre">socket.listen</span></code>.</li>
<li><a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a> can now be run on a unix socket as well
as TCP.</li>
<li>Fixed exception at startup when <code class="docutils literal"><span class="pre">socket.AI_ADDRCONFIG</span></code> is not available,
as on Windows XP</li>
</ul>
</div>
<div class="section" id="ioloop-and-iostream">
<h6><code class="docutils literal"><span class="pre">IOLoop</span></code> and <code class="docutils literal"><span class="pre">IOStream</span></code><a class="headerlink" href="#ioloop-and-iostream" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> performance has been improved, especially for
small synchronous requests.</li>
<li>New methods <code class="docutils literal"><span class="pre">tornado.iostream.IOStream.read_until_close</span></code> and
<code class="docutils literal"><span class="pre">tornado.iostream.IOStream.read_until_regex</span></code>.</li>
<li><code class="docutils literal"><span class="pre">IOStream.read_bytes</span></code> and <code class="docutils literal"><span class="pre">IOStream.read_until_close</span></code> now take a
<code class="docutils literal"><span class="pre">streaming_callback</span></code> argument to return data as it is received rather
than all at once.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop.add_timeout" title="tornado.ioloop.IOLoop.add_timeout"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.add_timeout</span></code></a> now accepts <a class="reference external" href="https://docs.python.org/3.4/library/datetime.html#datetime.timedelta" title="(in Python v3.4)"><code class="xref py py-obj docutils literal"><span class="pre">datetime.timedelta</span></code></a> objects in addition
to absolute timestamps.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.PeriodicCallback" title="tornado.ioloop.PeriodicCallback"><code class="xref py py-obj docutils literal"><span class="pre">PeriodicCallback</span></code></a> now sticks to the specified period
instead of creeping later due to accumulated errors.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop" title="tornado.ioloop.IOLoop"><code class="xref py py-obj docutils literal"><span class="pre">tornado.ioloop.IOLoop</span></code></a> and <a class="reference internal" href="index.html#tornado.httpclient.HTTPClient" title="tornado.httpclient.HTTPClient"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient.HTTPClient</span></code></a> now have
<code class="docutils literal"><span class="pre">close()</span></code> methods that should be used in applications that create
and destroy many of these objects.</li>
<li><a class="reference internal" href="index.html#tornado.ioloop.IOLoop.install" title="tornado.ioloop.IOLoop.install"><code class="xref py py-obj docutils literal"><span class="pre">IOLoop.install</span></code></a> can now be used to use a custom subclass of IOLoop
as the singleton without monkey-patching.</li>
<li><a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> should now always call the close callback
instead of the connect callback on a connection error.</li>
<li>The <a class="reference internal" href="index.html#tornado.iostream.IOStream" title="tornado.iostream.IOStream"><code class="xref py py-obj docutils literal"><span class="pre">IOStream</span></code></a> close callback will no longer be called while there
are pending read callbacks that can be satisfied with buffered data.</li>
</ul>
</div>
<div class="section" id="tornado-simple-httpclient">
<h6><code class="docutils literal"><span class="pre">tornado.simple_httpclient</span></code><a class="headerlink" href="#tornado-simple-httpclient" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Now supports client SSL certificates with the <code class="docutils literal"><span class="pre">client_key</span></code> and
<code class="docutils literal"><span class="pre">client_cert</span></code> parameters to <a class="reference internal" href="index.html#tornado.httpclient.HTTPRequest" title="tornado.httpclient.HTTPRequest"><code class="xref py py-obj docutils literal"><span class="pre">tornado.httpclient.HTTPRequest</span></code></a></li>
<li>Now takes a maximum buffer size, to allow reading files larger than 100MB</li>
<li>Now works with HTTP 1.0 servers that don&#8217;t send a Content-Length header</li>
<li>The <code class="docutils literal"><span class="pre">allow_nonstandard_methods</span></code> flag on HTTP client requests now
permits methods other than <code class="docutils literal"><span class="pre">POST</span></code> and <code class="docutils literal"><span class="pre">PUT</span></code> to contain bodies.</li>
<li>Fixed file descriptor leaks and multiple callback invocations in
<code class="docutils literal"><span class="pre">SimpleAsyncHTTPClient</span></code></li>
<li>No longer consumes extra connection resources when following redirects.</li>
<li>Now works with buggy web servers that separate headers with <code class="docutils literal"><span class="pre">\n</span></code> instead
of <code class="docutils literal"><span class="pre">\r\n\r\n</span></code>.</li>
<li>Now sets <code class="docutils literal"><span class="pre">response.request_time</span></code> correctly.</li>
<li>Connect timeouts now work correctly.</li>
</ul>
</div>
<div class="section" id="other-modules">
<h6>Other modules<a class="headerlink" href="#other-modules" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li><a class="reference internal" href="index.html#tornado.auth.OpenIdMixin" title="tornado.auth.OpenIdMixin"><code class="xref py py-obj docutils literal"><span class="pre">tornado.auth.OpenIdMixin</span></code></a> now uses the correct realm when the
callback URI is on a different domain.</li>
<li><a class="reference internal" href="index.html#module-tornado.autoreload" title="tornado.autoreload"><code class="xref py py-obj docutils literal"><span class="pre">tornado.autoreload</span></code></a> has a new command-line interface which can be used
to wrap any script.  This replaces the <code class="docutils literal"><span class="pre">--autoreload</span></code> argument to
<a class="reference internal" href="index.html#tornado.testing.main" title="tornado.testing.main"><code class="xref py py-obj docutils literal"><span class="pre">tornado.testing.main</span></code></a> and is more robust against syntax errors.</li>
<li><a class="reference internal" href="index.html#tornado.autoreload.watch" title="tornado.autoreload.watch"><code class="xref py py-obj docutils literal"><span class="pre">tornado.autoreload.watch</span></code></a> can be used to watch files other than
the sources of imported modules.</li>
<li><code class="docutils literal"><span class="pre">tornado.database.Connection</span></code> has new variants of <code class="docutils literal"><span class="pre">execute</span></code> and
<code class="docutils literal"><span class="pre">executemany</span></code> that return the number of rows affected instead of
the last inserted row id.</li>
<li><a class="reference internal" href="index.html#tornado.locale.load_translations" title="tornado.locale.load_translations"><code class="xref py py-obj docutils literal"><span class="pre">tornado.locale.load_translations</span></code></a> now accepts any properly-formatted
locale name, not just those in the predefined <code class="docutils literal"><span class="pre">LOCALE_NAMES</span></code> list.</li>
<li><a class="reference internal" href="index.html#tornado.options.define" title="tornado.options.define"><code class="xref py py-obj docutils literal"><span class="pre">tornado.options.define</span></code></a> now takes a <code class="docutils literal"><span class="pre">group</span></code> parameter to group options
in <code class="docutils literal"><span class="pre">--help</span></code> output.</li>
<li>Template loaders now take a <code class="docutils literal"><span class="pre">namespace</span></code> constructor argument to add
entries to the template namespace.</li>
<li><a class="reference internal" href="index.html#module-tornado.websocket" title="tornado.websocket"><code class="xref py py-obj docutils literal"><span class="pre">tornado.websocket</span></code></a> now supports the latest (&#8220;hybi-10&#8221;) version of the
protocol (the old version, &#8220;hixie-76&#8221; is still supported; the correct
version is detected automatically).</li>
<li><a class="reference internal" href="index.html#module-tornado.websocket" title="tornado.websocket"><code class="xref py py-obj docutils literal"><span class="pre">tornado.websocket</span></code></a> now works on Python 3</li>
</ul>
</div>
<div class="section" id="bug-fixes">
<h6>Bug fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this headline">¶</a></h6>
<ul class="simple">
<li>Windows support has been improved.  Windows is still not an officially
supported platform, but the test suite now passes and
<a class="reference internal" href="index.html#module-tornado.autoreload" title="tornado.autoreload"><code class="xref py py-obj docutils literal"><span class="pre">tornado.autoreload</span></code></a> works.</li>
<li>Uploading files whose names contain special characters will now work.</li>
<li>Cookie values containing special characters are now properly quoted
and unquoted.</li>
<li>Multi-line headers are now supported.</li>
<li>Repeated Content-Length headers (which may be added by certain proxies)
are now supported in <a class="reference internal" href="index.html#tornado.httpserver.HTTPServer" title="tornado.httpserver.HTTPServer"><code class="xref py py-obj docutils literal"><span class="pre">HTTPServer</span></code></a>.</li>
<li>Unicode string literals now work in template expressions.</li>
<li>The template <code class="docutils literal"><span class="pre">{%</span> <span class="pre">module</span> <span class="pre">%}</span></code> directive now works even if applications
use a template variable named <code class="docutils literal"><span class="pre">modules</span></code>.</li>
<li>Requests with &#8220;Expect: 100-continue&#8221; now work on python 3</li>
</ul>
</div>
</div>
</div>
<span id="document-releases/v2.0.0"></span><div class="section" id="what-s-new-in-tornado-2-0">
<h4>What&#8217;s new in Tornado 2.0<a class="headerlink" href="#what-s-new-in-tornado-2-0" title="Permalink to this headline">¶</a></h4>
<div class="section" id="jun-21-2011">
<h5>Jun 21, 2011<a class="headerlink" href="#jun-21-2011" title="Permalink to this headline">¶</a></h5>
<div class="highlight-python"><div class="highlight"><pre>Major changes:
* Template output is automatically escaped by default; see backwards
  compatibility note below.
* The default AsyncHTTPClient implementation is now simple_httpclient.
* Python 3.2 is now supported.

Backwards compatibility:
* Template autoescaping is enabled by default.  Applications upgrading from
  a previous release of Tornado must either disable autoescaping or adapt
  their templates to work with it.  For most applications, the simplest
  way to do this is to pass autoescape=None to the Application constructor.
  Note that this affects certain built-in methods, e.g. xsrf_form_html
  and linkify, which must now be called with {% raw %} instead of {}
* Applications that wish to continue using curl_httpclient instead of
  simple_httpclient may do so by calling
    AsyncHTTPClient.configure(&quot;tornado.curl_httpclient.CurlAsyncHTTPClient&quot;)
  at the beginning of the process.  Users of Python 2.5 will probably want
  to use curl_httpclient as simple_httpclient only supports ssl on Python 2.6+.
* Python 3 compatibility involved many changes throughout the codebase,
  so users are encouraged to test their applications more thoroughly than
  usual when upgrading to this release.

Other changes in this release:
* Templates support several new directives:
  - {% autoescape ...%} to control escaping behavior
  - {% raw ... %} for unescaped output
  - {% module ... %} for calling UIModules
* {% module Template(path, **kwargs) %} may now be used to call another
  template with an independent namespace
* All IOStream callbacks are now run directly on the IOLoop via add_callback.
* HTTPServer now supports IPv6 where available.  To disable, pass
  family=socket.AF_INET to HTTPServer.bind().
* HTTPClient now supports IPv6, configurable via allow_ipv6=bool on the
  HTTPRequest.  allow_ipv6 defaults to false on simple_httpclient and true
  on curl_httpclient.
* RequestHandlers can use an encoding other than utf-8 for query parameters
  by overriding decode_argument()
* Performance improvements, especially for applications that use a lot of
  IOLoop timeouts
* HTTP OPTIONS method no longer requires an XSRF token.
* JSON output (RequestHandler.write(dict)) now sets Content-Type to
  application/json
* Etag computation can now be customized or disabled by overriding
  RequestHandler.compute_etag
* USE_SIMPLE_HTTPCLIENT environment variable is no longer supported.
  Use AsyncHTTPClient.configure instead.
</pre></div>
</div>
</div>
</div>
<span id="document-releases/v1.2.1"></span><div class="section" id="what-s-new-in-tornado-1-2-1">
<h4>What&#8217;s new in Tornado 1.2.1<a class="headerlink" href="#what-s-new-in-tornado-1-2-1" title="Permalink to this headline">¶</a></h4>
<div class="section" id="mar-3-2011">
<h5>Mar 3, 2011<a class="headerlink" href="#mar-3-2011" title="Permalink to this headline">¶</a></h5>
<div class="highlight-python"><div class="highlight"><pre>We are pleased to announce the release of Tornado 1.2.1, available from
https://github.com/downloads/facebook/tornado/tornado-1.2.1.tar.gz

This release contains only two small changes relative to version 1.2:
* FacebookGraphMixin has been updated to work with a recent change to the
  Facebook API.
* Running &quot;setup.py install&quot; will no longer attempt to automatically
  install pycurl.  This wasn&#39;t working well on platforms where the best way
  to install pycurl is via something like apt-get instead of easy_install.

This is an important upgrade if you are using FacebookGraphMixin, but
otherwise it can be safely ignored.
</pre></div>
</div>
</div>
</div>
<span id="document-releases/v1.2.0"></span><div class="section" id="what-s-new-in-tornado-1-2">
<h4>What&#8217;s new in Tornado 1.2<a class="headerlink" href="#what-s-new-in-tornado-1-2" title="Permalink to this headline">¶</a></h4>
<div class="section" id="feb-20-2011">
<h5>Feb 20, 2011<a class="headerlink" href="#feb-20-2011" title="Permalink to this headline">¶</a></h5>
<div class="highlight-python"><div class="highlight"><pre>We are pleased to announce the release of Tornado 1.2, available from
https://github.com/downloads/facebook/tornado/tornado-1.2.tar.gz

Backwards compatibility notes:
* This release includes the backwards-incompatible security change from
  version 1.1.1.  Users upgrading from 1.1 or earlier should read the
  release notes from that release:
  http://groups.google.com/group/python-tornado/browse_thread/thread/b36191c781580cde
* StackContexts that do something other than catch exceptions may need to
  be modified to be reentrant.
  https://github.com/tornadoweb/tornado/commit/7a7e24143e77481d140fb5579bc67e4c45cbcfad
* When XSRF tokens are used, the token must also be present on PUT and
  DELETE requests (anything but GET and HEAD)

New features:
* A new HTTP client implementation is available in the module
  tornado.simple_httpclient.  This HTTP client does not depend on pycurl.
  It has not yet been tested extensively in production, but is intended
  to eventually replace the pycurl-based HTTP client in a future release of
  Tornado.  To transparently replace tornado.httpclient.AsyncHTTPClient with
  this new implementation, you can set the environment variable
  USE_SIMPLE_HTTPCLIENT=1 (note that the next release of Tornado will
  likely include a different way to select HTTP client implementations)
* Request logging is now done by the Application rather than the
  RequestHandler.  Logging behavior may be customized by either overriding
  Application.log_request in a subclass or by passing log_function
  as an Application setting
* Application.listen(port): Convenience method as an alternative to
  explicitly creating an HTTPServer
* tornado.escape.linkify(): Wrap urls in &lt;a&gt; tags
* RequestHandler.create_signed_value(): Create signatures like the
  secure_cookie methods without setting cookies.
* tornado.testing.get_unused_port(): Returns a port selected in the same
  way as inAsyncHTTPTestCase
* AsyncHTTPTestCase.fetch(): Convenience method for synchronous fetches
* IOLoop.set_blocking_signal_threshold(): Set a callback to be run when
  the IOLoop is blocked.
* IOStream.connect(): Asynchronously connect a client socket
* AsyncHTTPClient.handle_callback_exception(): May be overridden
  in subclass for custom error handling
* httpclient.HTTPRequest has two new keyword arguments, validate_cert and
  ca_certs. Setting validate_cert=False will disable all certificate checks
  when fetching https urls.  ca_certs may be set to a filename containing
  trusted certificate authorities (defaults will be used if this is
  unspecified)
* HTTPRequest.get_ssl_certificate(): Returns the client&#39;s SSL certificate
  (if client certificates were requested in the server&#39;s ssl_options
* StaticFileHandler can be configured to return a default file (e.g.
  index.html) when a directory is requested
* Template directives of the form &quot;{% from x import y %}&quot; are now
  supported (in addition to the existing support for &quot;{% import x
  %}&quot;
* FacebookGraphMixin.get_authenticated_user now accepts a new
  parameter &#39;extra_fields&#39; which may be used to request additional
  information about the user

Bug fixes:
* auth: Fixed KeyError with Facebook offline_access
* auth: Uses request.uri instead of request.path as the default redirect
  so that parameters are preserved.
* escape: xhtml_escape() now returns a unicode string, not
  utf8-encoded bytes
* ioloop: Callbacks added with add_callback are now run in the order they
  were added
* ioloop: PeriodicCallback.stop can now be called from inside the callback.
* iostream: Fixed several bugs in SSLIOStream
* iostream: Detect when the other side has closed the connection even with
  the select()-based IOLoop
* iostream: read_bytes(0) now works as expected
* iostream: Fixed bug when writing large amounts of data on windows
* iostream: Fixed infinite loop that could occur with unhandled exceptions
* httpclient: Fix bugs when some requests use proxies and others don&#39;t
* httpserver: HTTPRequest.protocol is now set correctly when using the
  built-in SSL support
* httpserver: When using multiple processes, the standard library&#39;s
  random number generator is re-seeded in each child process
* httpserver: With xheaders enabled, X-Forwarded-Proto is supported as an
  alternative to X-Scheme
* httpserver: Fixed bugs in multipart/form-data parsing
* locale: format_date() now behaves sanely with dates in the future
* locale: Updates to the language list
* stack_context: Fixed bug with contexts leaking through reused IOStreams
* stack_context: Simplified semantics and improved performance
* web: The order of css_files from UIModules is now preserved
* web: Fixed error with default_host redirect
* web: StaticFileHandler works when os.path.sep != &#39;/&#39; (i.e. on Windows)
* web: Fixed a caching-related bug in StaticFileHandler when a file&#39;s
  timestamp has changed but its contents have not.
* web: Fixed bugs with HEAD requests and e.g. Etag headers
* web: Fix bugs when different handlers have different static_paths
* web: @removeslash will no longer cause a redirect loop when applied to the
  root path
* websocket: Now works over SSL
* websocket: Improved compatibility with proxies

Many thanks to everyone who contributed patches, bug reports, and feedback
that went into this release!

-Ben
</pre></div>
</div>
</div>
</div>
<span id="document-releases/v1.1.1"></span><div class="section" id="what-s-new-in-tornado-1-1-1">
<h4>What&#8217;s new in Tornado 1.1.1<a class="headerlink" href="#what-s-new-in-tornado-1-1-1" title="Permalink to this headline">¶</a></h4>
<div class="section" id="feb-8-2011">
<h5>Feb 8, 2011<a class="headerlink" href="#feb-8-2011" title="Permalink to this headline">¶</a></h5>
<div class="highlight-python"><div class="highlight"><pre>Tornado 1.1.1 is a BACKWARDS-INCOMPATIBLE security update that fixes an
XSRF vulnerability.  It is available at
https://github.com/downloads/facebook/tornado/tornado-1.1.1.tar.gz

This is a backwards-incompatible change.  Applications that previously
relied on a blanket exception for XMLHTTPRequest may need to be modified
to explicitly include the XSRF token when making ajax requests.

The tornado chat demo application demonstrates one way of adding this
token (specifically the function postJSON in demos/chat/static/chat.js).

More information about this change and its justification can be found at
http://www.djangoproject.com/weblog/2011/feb/08/security/
http://weblog.rubyonrails.org/2011/2/8/csrf-protection-bypass-in-ruby-on-rails
</pre></div>
</div>
</div>
</div>
<span id="document-releases/v1.1.0"></span><div class="section" id="what-s-new-in-tornado-1-1">
<h4>What&#8217;s new in Tornado 1.1<a class="headerlink" href="#what-s-new-in-tornado-1-1" title="Permalink to this headline">¶</a></h4>
<div class="section" id="sep-7-2010">
<h5>Sep 7, 2010<a class="headerlink" href="#sep-7-2010" title="Permalink to this headline">¶</a></h5>
<div class="highlight-python"><div class="highlight"><pre>We are pleased to announce the release of Tornado 1.1, available from
https://github.com/downloads/facebook/tornado/tornado-1.1.tar.gz

Changes in this release:
* RequestHandler.async_callback and related functions in other classes
  are no longer needed in most cases (although it&#39;s harmless to continue
  using them).  Uncaught exceptions will now cause the request to be closed
  even in a callback.  If you&#39;re curious how this works, see the new
  tornado.stack_context module.
* The new tornado.testing module contains support for unit testing
  asynchronous IOLoop-based code.
* AsyncHTTPClient has been rewritten (the new implementation was
  available as AsyncHTTPClient2 in Tornado 1.0; both names are
  supported for backwards compatibility).
* The tornado.auth module has had a number of updates, including support
  for OAuth 2.0 and the Facebook Graph API, and upgrading Twitter and
  Google support to OAuth 1.0a.
* The websocket module is back and supports the latest version (76) of the
  websocket protocol.  Note that this module&#39;s interface is different
  from the websocket module that appeared in pre-1.0 versions of Tornado.
* New method RequestHandler.initialize() can be overridden in subclasses
  to simplify handling arguments from URLSpecs.  The sequence of methods
  called during initialization is documented at
  http://tornadoweb.org/documentation#overriding-requesthandler-methods
* get_argument() and related methods now work on PUT requests in addition
  to POST.
* The httpclient module now supports HTTP proxies.
* When HTTPServer is run in SSL mode, the SSL handshake is now non-blocking.
* Many smaller bug fixes and documentation updates

Backwards-compatibility notes:
* While most users of Tornado should not have to deal with the stack_context
  module directly, users of worker thread pools and similar constructs may
  need to use stack_context.wrap and/or NullContext to avoid memory leaks.
* The new AsyncHTTPClient still works with libcurl version 7.16.x, but it
  performs better when both libcurl and pycurl are at least version 7.18.2.
* OAuth transactions started under previous versions of the auth module
  cannot be completed under the new module.  This applies only to the
  initial authorization process; once an authorized token is issued that
  token works with either version.

Many thanks to everyone who contributed patches, bug reports, and feedback
that went into this release!

-Ben
</pre></div>
</div>
</div>
</div>
<span id="document-releases/v1.0.1"></span><div class="section" id="what-s-new-in-tornado-1-0-1">
<h4>What&#8217;s new in Tornado 1.0.1<a class="headerlink" href="#what-s-new-in-tornado-1-0-1" title="Permalink to this headline">¶</a></h4>
<div class="section" id="aug-13-2010">
<h5>Aug 13, 2010<a class="headerlink" href="#aug-13-2010" title="Permalink to this headline">¶</a></h5>
<div class="highlight-python"><div class="highlight"><pre>This release fixes a bug with RequestHandler.get_secure_cookie, which would
in some circumstances allow an attacker to tamper with data stored in the
cookie.
</pre></div>
</div>
</div>
</div>
<span id="document-releases/v1.0.0"></span><div class="section" id="what-s-new-in-tornado-1-0">
<h4>What&#8217;s new in Tornado 1.0<a class="headerlink" href="#what-s-new-in-tornado-1-0" title="Permalink to this headline">¶</a></h4>
<div class="section" id="july-22-2010">
<h5>July 22, 2010<a class="headerlink" href="#july-22-2010" title="Permalink to this headline">¶</a></h5>
<div class="highlight-python"><div class="highlight"><pre>We are pleased to announce the release of Tornado 1.0, available
from
https://github.com/downloads/facebook/tornado/tornado-1.0.tar.gz.
There have been many changes since version 0.2; here are some of
the highlights:

New features:
* Improved support for running other WSGI applications in a
  Tornado server (tested with Django and CherryPy)
* Improved performance on Mac OS X and BSD (kqueue-based IOLoop),
  and experimental support for win32
* Rewritten AsyncHTTPClient available as
  tornado.httpclient.AsyncHTTPClient2 (this will become the
  default in a future release)
* Support for standard .mo files in addition to .csv in the locale
  module
* Pre-forking support for running multiple Tornado processes at
  once (see HTTPServer.start())
* SSL and gzip support in HTTPServer
* reverse_url() function refers to urls from the Application
  config by name from templates and RequestHandlers
* RequestHandler.on_connection_close() callback is called when the
  client has closed the connection (subject to limitations of the
  underlying network stack, any proxies, etc)
* Static files can now be served somewhere other than /static/ via
  the static_url_prefix application setting
* URL regexes can now use named groups (&quot;(?P&lt;name&gt;)&quot;) to pass
  arguments to get()/post() via keyword instead of position
* HTTP header dictionary-like objects now support multiple values
  for the same header via the get_all() and add() methods.
* Several new options in the httpclient module, including
  prepare_curl_callback and header_callback
* Improved logging configuration in tornado.options.
* UIModule.html_body() can be used to return html to be inserted
  at the end of the document body.

Backwards-incompatible changes:
* RequestHandler.get_error_html() now receives the exception
  object as a keyword argument if the error was caused by an
  uncaught exception.
* Secure cookies are now more secure, but incompatible with
  cookies set by Tornado 0.2.  To read cookies set by older
  versions of Tornado, pass include_name=False to
  RequestHandler.get_secure_cookie()
* Parameters passed to RequestHandler.get/post() by extraction
  from the path now have %-escapes decoded, for consistency with
  the processing that was already done with other query
  parameters.

Many thanks to everyone who contributed patches, bug reports, and
feedback that went into this release!

-Ben
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span>Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span>Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span>Search Page</span></a></li>
</ul>
</div>
<div class="section" id="discussion-and-support">
<h2>Discussion and support<a class="headerlink" href="#discussion-and-support" title="Permalink to this headline">¶</a></h2>
<p>You can discuss Tornado on <a class="reference external" href="http://groups.google.com/group/python-tornado">the Tornado developer mailing list</a>, and report bugs on
the <a class="reference external" href="https://github.com/tornadoweb/tornado/issues">GitHub issue tracker</a>.  Links to additional
resources can be found on the <a class="reference external" href="https://github.com/tornadoweb/tornado/wiki/Links">Tornado wiki</a>.  New releases are
announced on the <a class="reference external" href="http://groups.google.com/group/python-tornado-announce">announcements mailing list</a>.</p>
<p>Tornado is available under
the <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License, Version 2.0</a>.</p>
<p>This web site and all documentation is licensed under <a class="reference external" href="http://creativecommons.org/licenses/by/3.0/">Creative
Commons 3.0</a>.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2009-2015, The Tornado Authors.
      
        <span class="commit">
          Revision <code>26a5a6b8</code>.
        </span>
      

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: stable
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="/en/latest/">latest</a></dd>
        
          <dd><a href="/en/stable/">stable</a></dd>
        
          <dd><a href="/en/branch4.0/">branch4.0</a></dd>
        
          <dd><a href="/en/branch3.2/">branch3.2</a></dd>
        
          <dd><a href="/en/branch3.1/">branch3.1</a></dd>
        
          <dd><a href="/en/branch3.0/">branch3.0</a></dd>
        
          <dd><a href="/en/branch2.4/">branch2.4</a></dd>
        
          <dd><a href="/en/branch2.3/">branch2.3</a></dd>
        
          <dd><a href="/en/branch2.2/">branch2.2</a></dd>
        
          <dd><a href="/en/branch2.1/">branch2.1</a></dd>
        
          <dd><a href="/en/branch2.0/">branch2.0</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="//readthedocs.org/projects/tornado/downloads/pdf/stable/">pdf</a></dd>
        
          <dd><a href="//readthedocs.org/projects/tornado/downloads/htmlzip/stable/">htmlzip</a></dd>
        
          <dd><a href="//readthedocs.org/projects/tornado/downloads/epub/stable/">epub</a></dd>
        
      </dl>
      <dl>
        <dt>On Read the Docs</dt>
          <dd>
            <a href="//readthedocs.org/projects/tornado/?fromdocs=tornado">Project Home</a>
          </dd>
          <dd>
            <a href="//readthedocs.org/builds/tornado/?fromdocs=tornado">Builds</a>
          </dd>
      </dl>
      <hr/>
      Free document hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>.

    </div>
  </div>

</body>
</html>
